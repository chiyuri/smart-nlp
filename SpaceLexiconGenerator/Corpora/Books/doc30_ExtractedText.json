{"content": "\nGuidance and \nControl Technology \nof Spacecraft on \nElliptical Orbit\n\nNavigation: Science and Technology\n\nFucheng Liu\nShan Lu\nYue Sun\n\n\n\nNavigation: Science and Technology\n\n\n\nThis series Navigation: Science and Technology (NST) presents new developments\nand advances in various aspects of navigation - from land navigation, marine\nnavigation, aeronautic navigation to space navigation; and from basic theories,\nmechanisms, to modern techniques. It publishes monographs, edited volumes,\nlecture notes and professional books on topics relevant to navigation - quickly, up\nto date and with a high quality. A special focus of the series is the technologies\nof the Global Navigation Satellite Systems (GNSSs), as well as the latest progress\nmade in the existing systems (GPS, BDS, Galileo, GLONASS, etc.). To help\nreaders keep abreast of the latest advances in the field, the key topics in NST\ninclude but are not limited to:\n\n\u2013 Satellite Navigation Signal Systems\n\u2013 GNSS Navigation Applications\n\u2013 Position Determination\n\u2013 Navigational Instrument\n\u2013 Atomic Clock Technique and Time-Frequency System\n\u2013 X-ray Pulsar-based Navigation and Timing\n\u2013 Test and Evaluation\n\u2013 User Terminal Technology\n\u2013 Navigation in Space\n\u2013 New Theories and Technologies of Navigation\n\u2013 Policies and Standards\n\nMore information about this series at http://www.springer.com/series/15704\n\nhttp://www.springer.com/series/15704\n\n\nFucheng Liu \u2022 Shan Lu \u2022 Yue Sun\n\nGuidance and Control\nTechnology of Spacecraft\non Elliptical Orbit\n\n123\n\n\n\nFucheng Liu\nShanghai Aerospace Control Technology\nInstitute\n\nShanghai, Shanghai, China\n\nShan Lu\nShanghai Aerospace Control Technology\nInstitute\n\nShanghai, Shanghai, China\n\nYue Sun\nShanghai Aerospace Control Technology\nInstitute\n\nShanghai, Shanghai, China\n\nISSN 2522-0454 ISSN 2522-0462 (electronic)\nNavigation: Science and Technology\nISBN 978-981-10-7958-0 ISBN 978-981-10-7959-7 (eBook)\nhttps://doi.org/10.1007/978-981-10-7959-7\n\nJointly published with National Defense Industry Press, Beijing, China\n\nThe print edition is not for sale in China Mainland. Customers from China Mainland please order the\nprint book from: National Defense Industry Press.\n\nLibrary of Congress Control Number: 2018940885\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nThis work is subject to copyright. All rights are reserved by the Publishers, whether the whole or part\nof the material is concerned, specifically the rights of translation, reprinting, reuse of illustrations,\nrecitation, broadcasting, reproduction on microfilms or in any other physical way, and transmission\nor information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar\nmethodology now known or hereafter developed.\nThe use of general descriptive names, registered names, trademarks, service marks, etc. in this\npublication does not imply, even in the absence of a specific statement, that such names are exempt from\nthe relevant protective laws and regulations and therefore free for general use.\nThe publishers, the authors and the editors are safe to assume that the advice and information in this\nbook are believed to be true and accurate at the date of publication. Neither the publishers nor the\nauthors or the editors give a warranty, express or implied, with respect to the material contained herein or\nfor any errors or omissions that may have been made. The publishers remains neutral with regard to\njurisdictional claims in published maps and institutional affiliations.\n\nThis Springer imprint is published by the registered company Springer Nature Singapore Pte Ltd.\nThe registered company address is: 152 Beach Road, #21-01/04 Gateway East, Singapore 189721,\nSingapore\n\nhttps://doi.org/10.1007/?978-?981-?10-?7959-?7\n\n\nPreface\n\nSince 1957, the first man-made satellite being launched into space, steps of human\nbeings exploring space has never stopped. So far, there are already about 6000\nsatellites have been launched globally, and over 900 of them are in orbit, which are\nmainly distributed in nearly circular orbit, such as near-earth orbit, medium orbit,\nand earth synchronous orbit, according to different mission requirements. While\ncontrol precision and capability of satellite being enhanced constantly, the ren-\ndezvous and dock technology being represented by space station is also\never-increasing sophisticated and has played an important role in space exploration\nmission of human being.\n\nViewing spacecrafts being launched by each country, vast majority of them are\noperating in circular orbit or nearly circular orbit, which is decided upon com-\nprehensive factors, such as difficulty level of spacecraft\u2019s real-time location, attitude\nand orbit control, and distribution of ground monitoring and control station.\nHowever, in recent years, another type of orbit, elliptical orbit has been continu-\nously developed and utilized by each country. The distance from spacecrafts\noperating on such orbit to earth changes continuously within one orbital period.\nThese spacecrafts operate slowly in apogee and operate quickly when passing\nperigee. Especially when the spacecraft is on the large elliptical orbit, whose\nperigee altitude is near near-earth orbit and apogee altitude is near earth syn-\nchronous orbit, it can operate near the apogee for a long time. With this charac-\nteristic, the spacecraft can maintain the capability of long-time earth observation\nand communication over special area from apogee and especially utilizes large\nelliptical orbit of large inclination to realize long-time observation and communi-\ncation over high latitude areas on the earth, which cannot be realized with space-\ncrafts on circular orbit. One of the typical examples is Molniya series of\ncommunication satellite of Russia and SBIRS of America.\n\nStrictly speaking, no orbit can realize true circular orbit; however, the nearly\ncircular orbit with very small orbital eccentricity can be approximately regarded as\ncircular orbit, so as to simplify mission requirements, such as spacecraft location\nand control. The research focus of this book is large elliptical orbit, especially high\n\nv\n\n\n\nutility ones with perigee altitude near near-earth orbit and apogee altitude near earth\nsynchronous orbit.\n\nTo make good use of large elliptical orbit, the design of GNC system of\nspacecraft will face a series of challenge. First, according to different mission\nrequirements, how to design large elliptical orbit so as to take advantage of\nspacecraft specifically is the premise of adopting large elliptical orbit. Second, orbit\naltitude of large elliptical orbit spacecraft changes quite big and autonomous nav-\nigation method which traditionally suited for circular orbit is very limited, espe-\ncially when large elliptical orbit spacecraft operates near the apogee, navigation\nsatellites, such as GPS cannot be used, so new methods should be found for\nautonomous navigation of large elliptical orbit spacecraft. Meanwhile, autonomous\nrendezvous and formation flight on large elliptical orbit are the technology devel-\nopment direction of further playing the role of large elliptical orbit; however, there\nis an essential distinction in relative orbit dynamics between elliptical orbit and\ncircular orbit, so brand new methods are needed to be taken on the guidance and\ncontrol of relative motion between spacecrafts. Research over GNC technology of\nelliptical orbit will propel further development and integrity of world aerospace\ntechnology.\n\nThe book is divided into eight chapters. Chapter 1 mainly introduces charac-\nteristic, application, and development prospect of elliptical orbit, as well as the key\nissues of control system which is worthy of research. Chapters 2 and 3 mainly\nintroduce large elliptical orbit design method for different mission requirements and\nconfiguration design method of formation flight under elliptical orbit. Chapters 4\u20136\nmainly introduce autonomous navigation method of single spacecraft on elliptical\norbit, autonomous navigation method of regional constellation, and relative navi-\ngation method. Chapters 7 and 8 mainly introduce control method of formation\nconfiguration keeping, rendezvous, and docking of elliptical orbit.\n\nThe publication of this book should be owed to the support of Shanghai\nAerospace Control Technology Institute and Shanghai Key Laboratory of\nAerospace Intelligent Control Technology and sponsor of the National Defense\nScience and Technology Publishing Fund and Program of Shanghai Technology\nResearch Leader (Program No: 17XD1420700).\n\nThis book is the summary of the author\u2019s years of experience in aerospace\nengineering technology development. It can not only be taken as reference teaching\nmaterial for high-grade undergraduates and postgraduates, but can also provide\nnecessary professional knowledge and engineering reference for researchers and\nengineering technology personnel engaged in the development of GNC system of\nspacecraft. Due to limited knowledge, there might be some mistakes and flaws in\nthis book, please do not hesitate to correct me.\n\nShanghai, China Fucheng Liu\nJanuary 2016 Shan Lu\n\nYue Sun\n\nvi Preface\n\n\n\nCompilation Committee\n\nDirector: Fucheng Liu\nVice-director: Shan Lu, Yue Sun\nCommittee: Hailei Wu, Longyu Tan, Pengyu Zhan, Wei Xu, Shaoxiong Tian,\nYueyang Hou, Youfeng Wang, Yang Peng, Chenglong Jia, Fengwen Wang\n\nvii\n\n\n\nContents\n\n1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.1 Characteristics of Elliptical Orbit . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.2 Development of Elliptical Orbit Satellite Application . . . . . . . . . . 2\n1.3 Key Problems in Control System of Elliptical Orbit Spacecraft . . . 3\n1.4 Structure of This Book . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n2 Orbit Design of Spacecraft on Elliptical Orbit . . . . . . . . . . . . . . . . . 7\n2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n2.2 Absolute Dynamics Analysis of Elliptical Orbit . . . . . . . . . . . . . . 8\n\n2.2.1 Basic Features of Elliptical Orbit . . . . . . . . . . . . . . . . . . . 8\n2.2.2 Elliptical Orbit Perturbation . . . . . . . . . . . . . . . . . . . . . . . 11\n\n2.3 Autonomous Orbit Prediction of Elliptical Orbit . . . . . . . . . . . . . . 16\n2.3.1 Autonomous Orbit Prediction . . . . . . . . . . . . . . . . . . . . . . 16\n2.3.2 Onboard Orbit Prediction Algorithm of Elliptical Orbit . . . . 17\n2.3.3 Analysis and Predigestion of Elliptical Orbit Dynamics\n\nModel . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 20\n2.4 Design of Apogee Rendezvous Orbit . . . . . . . . . . . . . . . . . . . . . . 22\n\n2.4.1 Drift Characteristics Analysis of Elliptical Orbit . . . . . . . . 24\n2.4.2 Design of Frozen Elliptical Orbit . . . . . . . . . . . . . . . . . . . 27\n2.4.3 Design of Little Inclination Elliptical Orbit . . . . . . . . . . . . 42\n\n2.5 Elliptical Orbit Rendezvous Method for Inspecting GEO\nSatellites . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 47\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n\n3 Formation Configuration Design of Elliptical Orbit . . . . . . . . . . . . . 53\n3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n3.2 Formation Configuration Design Based on Algebraic Method . . . . 54\n\n3.2.1 Relative Dynamic Equation . . . . . . . . . . . . . . . . . . . . . . . 54\n3.2.2 Relative Periodic Motion . . . . . . . . . . . . . . . . . . . . . . . . . 58\n\nix\n\n\n\n3.2.3 Characteristics Analysis of Relative Motion Trajectory . . . 61\n3.2.4 Fly-Around Configuration Design . . . . . . . . . . . . . . . . . . . 62\n3.2.5 Accompanying Flying Configuration Design . . . . . . . . . . . 65\n\n3.3 Formation Configuration Design Based on Geometry . . . . . . . . . . 68\n3.3.1 Precise Model of Relative Motion . . . . . . . . . . . . . . . . . . 68\n3.3.2 First-Order Approximation Model of Relative Motion . . . . 72\n3.3.3 Formation Configuration Design . . . . . . . . . . . . . . . . . . . . 73\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n\n4 Autonomous Navigation Technology of Whole Space . . . . . . . . . . . . 77\n4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n4.2 Common Autonomous Navigation Method of Elliptical Orbit . . . . 79\n\n4.2.1 Autonomous Navigation Technology of Elliptical Orbit\nBased on Astronomical Observation . . . . . . . . . . . . . . . . . 79\n\n4.2.2 Autonomous Navigation Technology of Elliptical Orbit\nBased on GNSS . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS . . . . . 101\n4.3.1 State Equation of Inertial Navigation . . . . . . . . . . . . . . . . 101\n4.3.2 Observation Equation of SINS/Star Sensor/GNSS\n\nNavigation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 106\n4.3.3 Merge Scheme of SINS/Star Sensor/GNSS System . . . . . . 109\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116\n\n5 Autonomous Navigation Technology of Regional Constellation . . . . . 117\n5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n5.2 Regional Constellation Autonomous Navigation Based\n\non Inter-satellite Ranging . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 118\n5.2.1 Constellation Autonomous Navigation System\n\nScheme of Elliptical Orbit . . . . . . . . . . . . . . . . . . . . . . . . 118\n5.2.2 High-Precision Orbit Prediction Technology of\n\nConstellation Autonomous Navigation System on\nElliptical Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 119\n\n5.2.3 Technology of Inter-satellite Link Ranging . . . . . . . . . . . . 126\n5.2.4 Whole Net Filter Scheme of Constellation Autonomous\n\nNavigation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129\n5.3 Rotation Error Estimation of Constellation Configuration Based\n\non Inter-satellite Observation . . . . . . . . . . . . . . . . . . . . . . . . . . . . 134\n5.3.1 Rotation Error Analysis of Region Constellation\n\nAutonomous Navigation on Elliptical Orbit . . . . . . . . . . . . 134\n5.3.2 Rotation Error Mitigation Method Based on Inter-satellite\n\nObservation of Constellation Autonomous Navigation on\nElliptical Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139\n\n5.4 High-Precision Orbit Determination Technology Based\non Inter-satellite Orientation Determination of Elliptical Orbit . . . . 147\n\nx Contents\n\n\n\n5.4.1 Constellation Autonomous Navigation Scheme Based on\nInter-satellite Orientation Determination/Ranging . . . . . . . . 147\n\n5.4.2 Constellation Autonomous Navigation Scheme Based on\nInter-satellite Orientation Determination/Ranging of\nElliptical Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 149\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162\n\n6 Relative Navigation Technology . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163\n6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163\n6.2 Relative Navigation Technology in the Orbit Coordinate\n\nSystem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164\n6.2.1 Coordinate System Definition . . . . . . . . . . . . . . . . . . . . . . 164\n6.2.2 Relative Navigation System Modeling in the Orbit\n\nCoordinate System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165\n6.2.3 Simulation Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 170\n\n6.3 Relative Navigation Technology in the Inertial Coordinate\nSystem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172\n6.3.1 Relative Navigation System Modeling in the Inertial\n\nCoordinate System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 172\n6.3.2 Simulation Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 175\n\n6.4 Comparison of Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176\n\n7 Technology of Formation Configuration Maintenance on Elliptical\nOrbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179\n7.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179\n7.2 Characteristic Analysis of Relative Motion . . . . . . . . . . . . . . . . . . 180\n\n7.2.1 Relative Motion Equation Based on Relative Orbit\nElement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180\n\n7.2.2 Relative Motion Analysis Based on Orbit Element . . . . . . 182\n7.3 Control Method of Formation Configuration Maintenance . . . . . . . 184\n\n7.3.1 Configuration Maintenance Based on LQR . . . . . . . . . . . . 185\n7.3.2 Companying Flying Control Based on Relative Orbit\n\nElement . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 189\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191\n\n8 Autonomous Rendezvous Technology of Elliptical Orbit . . . . . . . . . 193\n8.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193\n8.2 Autonomous Rendezvous Optimization Method . . . . . . . . . . . . . . 195\n\n8.2.1 Feedback Linearized Dynamic Model\nof Elliptical Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195\n\n8.2.2 Optimal Control of Linear Quadratic Regulator . . . . . . . . . 198\n8.2.3 Double-Pulse Control Based on T-H Equation . . . . . . . . . . 203\n\nContents xi\n\n\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit\nInformation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 208\n8.3.1 Fuzzy PD Control . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 208\n8.3.2 Robust Sliding Mode Control . . . . . . . . . . . . . . . . . . . . . . 220\n\nReferences . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233\n\nMain Symbol Meaning Table . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 235\n\nxii Contents\n\n\n\nChapter 1\nIntroduction\n\n1.1 Characteristics of Elliptical Orbit\n\nThe distance between spacecraft operating on elliptical orbit and the earth changes\nconstantly within an orbit cycle, that is, the eccentricity of the orbit, which the\nspacecraft is on is not zero, and the point with the smallest distance from spacecraft\noperating under this condition to the earth is called perigee, and the farthest point is\ncalled apogee.\n\nStrictly speaking, all earth satellites operate on elliptical orbit, and the absolute\ncircular orbit never exists; however, for nearly circular orbit with very small\neccentricity, it can be regarded as circular orbit approximately, and the task\nrequirements, such as spacecraft orientation and control can be simplified. This\nbook emphasizes large eccentricity elliptical orbits, and among them, the one with\nthe most practical application value is the large elliptical orbit whose perigee alti-\ntude is near earth orbit and apogee altitude is near GEO.\n\nThe operating velocity of large elliptical orbit spacecraft at apogee is slow, but it\nis quick at perigee; especially, for the large elliptical orbit whose perigee altitude is\nnear-earth orbit and apogee altitude is near GEO, spacecraft can operate near the\napogee for a long time. Making use of this characteristic, spacecrafts can implement\ncorresponding tasks for specific region or specific target at apogee.\n\nFor example, making use of large-inclination large elliptical orbit, when\nspacecraft reaches near the apogee, it can make long-time observation and com-\nmunication over high-latitude areas on the earth, and the longest time can reach 2/3\nof one orbit cycle, which cannot be achieved by spacecrafts operating on circular\norbit. Because most land of Russia is in high-latitude area of the earth, the Molniya\nseries communication satellite developed by Russia make use of characteristic of\nlarge elliptical orbit; that is, multiple satellites distributedly operate on large\nelliptical orbit to achieve continuous communication over high-latitude area. SBIRS\nof America also includes multiple satellites operating on large elliptical orbit, which\ncan ensure long-time observation and monitoring over high-latitude region.\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_1\n\n1\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_1&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_1&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_1&amp;domain=pdf\n\n\nOn the other hand, because apogee of large elliptical orbit is near the GEO, when\nspacecraft is on the apogee, it can make transient rendezvous with GEO satellite.\nHowever, because orbit cycle of large elliptical orbit is different from the GEO,\neach time the spacecraft on large elliptical orbit reaches apogee, the available\nspacecraft target point for rendezvous also changes. Upon this characteristic and\nreasonable orbit design, traversal of specific target group on GEO can be achieved\nby making use of large elliptical orbit.\n\nIt can be seen that if characteristics of large elliptical orbit can be used ade-\nquately and reasonably, functions of earth satellites can be further expanded, which\nwill bring new difficulties and challenges to the design of spacecraft, especially the\ndesign of control system.\n\n1.2 Development of Elliptical Orbit Satellite Application\n\nMaking avail of characteristic of elliptical orbit, elliptical orbit satellite can play\nsignificant role in the fields, such as earth observation and space navigation. Its\nhuge application potential can be summarized as follows.\n\n1. Rendezvous with high-orbit satellite\n\nBeing widely used in fields of communication, broadcast, weather, which are\npertinent to people\u2019s daily life, high-orbit satellite is of great value. Use charac-\nteristic that rendezvous exists between apogee of large elliptical orbit and high-orbit\nsatellite to make short-time short-distance access to high-orbit satellite. Orbit tasks,\nsuch as photographing, communication can be implemented by high-precision\npointing tracking.\n\nHigh-orbit satellites in complicated space environment may lose application\nvalue or be obsolete for failure, and launching substitute satellite will cause cost\nmultiplied; however, if they have not been recovered or removed in time, it will be a\nbig waste for natural resource. Therefore, it is very necessary to conduct on-orbit\nservice over high-orbit satellite. Observation of rendezvous between large elliptical\norbit and high-orbit satellite can provide required target characteristic information\nfor on-orbit service. In addition, by adjusting large elliptical apse line, single\nsatellite from one launch can achieve successive access to multiple target satellites,\nwhich has good economic value.\n\n2. Observation of local region\n\nBecause apogee of large elliptical orbit satellite is near GEO and its angular velocity\nis low near apogee, local specific space can be passed through for a long time,\nwhich is conducive to long-term observation over local region. It is an advantage vs\nlow-orbit satellite observation; Meanwhile, because cycle of large elliptical orbit is\nonly half of cycle of high-orbit satellite, the time interval between the two obser-\nvations over local key region is short, which is an advantage vs high-orbit satellite\n\n2 1 Introduction\n\n\n\nobservation. Therefore, large elliptical orbit satellite is of great importance for\ndeveloping long-term observation over key local regions.\n\n3. Construction of navigation constellation\n\nElliptical orbit satellite has the advantages of low motion velocity at apogee, wide\ncoverage area, and long service time for specific region [1], and the advantage of\nelliptical orbit constellation composed of elliptical orbit satellites is more obvious,\nwhich has got more and more application. The second generation of Beidou global\nnavigation system [2] of our country, which will achieve global navigation in 2020,\nadopts three elliptical orbit satellites to guarantee and enhance coverage of navi-\ngation system over high-latitude region. With the constantly development of\naerospace technology, assisted navigation satellite group and regional enhancement\nconstellation constituted by elliptical orbit satellites, even whole navigation con-\nstellation will keep emerging, and will play an irreplaceable role.\n\n4. Distributed formation replaces function of single satellite\n\nCombination of spacecraft formation flying and synthesis aperture technology\ncan form big aperture space-based radar and space-based interferometer, which\ngreatly improve resolution of radar and interferometer. Although relative motion\ntrajectory of elliptical orbit spacecraft is complicated, under some conditions, it is\ngood for improving plane coverage of synthesis aperture.\n\nCompared with circular orbit accompanying flying/around flying, accompanying\nflying/around flying on different planes of elliptical orbit is more universal and more\nchallenging. Adjusting inclination between accompanying flying/around flying and\ntarget satellite orbit canmonitor target health condition from each angle and direction.\n\n1.3 Key Problems in Control System of Elliptical\nOrbit Spacecraft\n\nCompared with control system of circular orbit spacecraft, key problems in control\nsystem of elliptical orbit spacecraft are as follows, which should be paid special\nattention in navigation, designing, and control of orbit.\n\n(1) In orbit design of large elliptical orbit rendezvous with high-orbit satellite,\nbecause dynamics changes apparently when large elliptical orbit transfers from\nlow orbit to high orbit, the perturbations, such as non-spherical, lunisolar\ngravitation, sunlight pressure, and atmospheric drag have great influence on\nabsolute dynamics of large elliptical orbit. Because of limited ground com-\nmunication capability, real-time forecast for large elliptical orbit completely\nbased on equipment onboard is needed.\nIn orbit design of large elliptical orbit rendezvous with high-orbit satellite,\nmaking use of the characteristic that rendezvous point exists between apogee of\nlarge elliptical orbit and GEO, we can make short-time and short-distance\n\n1.2 Development of Elliptical Orbit Satellite Application 3\n\n\n\naccess to GEO satellite at apogee; during the time, multiple orbit tasks, such as\nphotographing and communication can be implemented. However, because the\nrelative velocity is very large when large elliptical orbit rendezvous with\nhigh-orbit satellite, and rendezvous time is limited, reasonable orbit should be\ndesigned to guarantee change rate of line-of-sight distance and line-of-sight\nangular velocity and other parameters of the two satellites during the ren-\ndezvous process in accordance with measurement capability of tracking\nequipment itself.\nIn addition, single large elliptical orbit satellite can achieve traversal over\nmultiple coplanar GEO satellites by adjusting apse line. Its key technology is\nselecting the method of apse line adjustment, so as to satisfy traversal ren-\ndezvous task of multiple targets.\n\n(2) In autonomous navigation method design of single satellite on large elliptical\norbit, because the variation range of satellite orbit is large, especially dynamic\ncharacteristic in perigee changes drastically [3], problems exist in any single\nautonomous navigation method. For example, in astronomical autonomous\nnavigation method based on star celestial observation, during the process of\nsatellite on-orbit operation, the change of its earth sensitive field of view ranges\nfrom over 10\u00b0 to nearly 100\u00b0, which makes horizon sensor hard to capture\ngeocentric vector of the earth correctly; in inertial navigation method, because it\nachieves navigation and orientation upon integral principle of inertial device\nmeasurement, the navigation error will be accumulated with the time; In nav-\nigation method based on global satellite position system, because orbit altitude\nof elliptical orbit satellite is higher than navigation satellite of position system,\nit can only receive navigation satellite signal from the back of the earth, and\nbeing limited by earth shielding and linkage loss, the number of its effective\nvisible navigation satellite is no more than 4, and the visible time is not long.\nTherefore, it needs to combine astronomical navigation, inertial navigation, and\nsatellite navigation organically, that is, adopting different combination in dif-\nferent operating segment of elliptical orbit satellite, which can not only improve\nthe accuracy of autonomous navigation, but can also enhance fault tolerance\nand reliability of navigation system.\n\n(3) In autonomous navigation method design of large elliptical orbit constellation,\nlarge elliptical orbit constellation, which does not rely on measurement and\ncontrol of ground station needs to use inter-satellite mutual-measurement\ncommunication system and onboard autonomous measurement equipment to\nmeasure the information, then combine the information with high-precision\norbit forecast to obtain long-term high-precision orbit parameters of the whole\nconstellation by optimal estimate of information fusion, so as to achieve\nautonomous navigation. However, constellation autonomous navigation\nmethod based on inter-satellite mutual ranging and velocity measurement can\nonly constrain the trend that estimated error of constellation orbit parameters\ndiverging along different directions, but cannot refrain the trend that estimated\nerror of constellation orbit parameters diverging along the same direction (the\n\n4 1 Introduction\n\n\n\nrotating divergence and drifting divergence trend of estimated error), therefore,\nit needs to adopt photographing observation equipment on the basis of\ninter-satellite ranging to provide absolute direction information of constellation\nunder inertial coordinate through optical observation over its background stars,\nwhich can refrain rotating error and drift error of the whole constellation, and\nachieve high-precision autonomous navigation of elliptical orbit constellation\ngroup.\n\n(4) In configuration design of distributed formation, being different from circular\norbit, configuration on large elliptical orbit is more diversified, and its relative\ntrack is spatial twisted closed curve, forming plane and regular track only under\nspecial conditions. The complexity of relative track makes the current research\nlack systematic and complete knowledge about it, and the analysis for the con-\nfiguration is inadequate. In addition, comparedwith circular orbit, the impact of J2\nperturbation on elliptical orbit spacecraft is much greater, and the relative motion\ncharacteristic under perturbation is more complicated. Therefore, it needs to\nconduct extensive research over design of distributed formation configuration\nwith emphasis on the special motion characteristic of elliptical orbit.\n\n(5) In relative navigation and control of elliptical orbit, because orbit has eccen-\ntricity, elliptical orbit spacecraft moves with variable orbit angular velocity. The\nchange rule of its angular velocity cannot be expressed as an explicit expression\nof time function, so it can only be given as differential formulation. For\ntime-varying differential formula, the solving process of formula is complex,\nand the form of its solution is also complex; because of the time-varying\ncharacteristic of the formula, the control system is also time-varying, which\nbrings challenge to design of control system, and the control methods which are\nsuitable for relative navigation and relative position control of circular orbit are\nnot applicable. Thus, high-precision relative navigation and control method\nwhich is suitable for time-varying system needs to be developed.\n\n1.4 Structure of This Book\n\nThis chapter mainly introduces characteristic, application prospect of elliptical orbit\nand key issues of control system to help readers have a direct knowledge about\nelliptical orbit, and know key issues of control system design of spacecraft oper-\nating on large elliptical orbit.\n\nChapters 2 and 3 mainly involve orbit design issues under background of\nelliptical orbit task. They introduce large elliptical orbit design method for different\ntask requirements and configuration design method of formation flying on elliptical\norbit, respectively, that is, mainly elaborate orbit issues of single and multiple\nsatellite operation on elliptical orbit.\n\nChapters 4, 5 and 6 mainly refer to navigation issues of elliptical orbit. They\nintroduce autonomous navigation method of single spacecraft on elliptical orbit,\n\n1.3 Key Problems in Control System of Elliptical Orbit Spacecraft 5\n\n\n\nautonomous navigation method of regional constellation, and inter-satellite relative\nnavigation method, respectively. With these three chapters, readers can understand\nhow problems, such as autonomous navigation in whole space and relative navi-\ngation, which are brought by the discontinuity of navigation satellite and change of\nrelative orbit dynamics when spacecraft operating on elliptical orbit to be solved.\n\nChapters 7 and 8 mainly refer to relative guidance and control problem of\nelliptical orbit. They introduce control method of formation configuration keeping,\nrendezvous and docking of elliptical orbit, respectively. Through these two chap-\nters, readers can clearly understand that because of the essential difference between\nrelative dynamic formula of elliptical orbit and circular orbit, new methods which\nare suitable for control of relative motion can provide reference for design work of\nreaders.\n\nReferences\n\n1. Wu Shiqi. New Technology of Satellite Mobile Communication [M]. Beijing: National\nDefense Industry Press, 2001.\n\n2. Lu Jianye, Zeng Qinghua, Zhaowei. Theory and Application of Navigation System [M]. Xian:\nNWPT Press, 2009.\n\n3. Li Jingjing, Li Huayi, Li Baohua. Combination Navigation Method of Large Elliptical Orbit\nSatellite Astronomical/Radar Altimeter [J]. Journal of Chinese Inertial Technology, 2012, 20\n(3): 300\u2013305.\n\n6 1 Introduction\n\n\n\nChapter 2\nOrbit Design of Spacecraft\non Elliptical Orbit\n\n2.1 Introduction\n\nThe large elliptical orbit is a large-eccentricity orbit with the apogee altitude several\ntimes higher than the earth\u2019s radius. Because of its orbital characteristics, the\nsatellite has a slow operating velocity and long duration on the side of the apogee.\nWith wide coverage area, it can complete various space and earth observation\nmissions. As shown in Fig. 2.1, it can also make close access to the geostationary\nsatellites in a short time by making use of the characteristics that intersection exists\nbetween the elliptical orbit and high-orbit synchronous orbit, and during the time, it\ncan implement multiple tasks, such as photographing, communication.\n\nIn this chapter, the orbit design of elliptical orbit spacecraft is studied for the\ndemand of the task of the fast rendezvous of the elliptical orbit and the high-orbit\ngeostationary satellites. Firstly, the basic characteristics of the elliptical orbit are\nintroduced, and the influence of the non-spherical perturbation of the earth, the\nlunisolar perturbation, the perturbation of the atmospheric drag, and the perturba-\ntion of the sun radiation pressure on the elliptical orbit is analyzed. Secondly, the\nautonomous orbit prediction method is introduced for the demand of the ren-\ndezvous task of the elliptical orbit\u2019s apogee and the high-orbit geostationary\nsatellites. Thirdly, the drift characteristics of the frozen elliptical orbit and the small\ninclination elliptical orbit which are designed, respectively, are introduced. Finally,\ntwo phase-adjustment methods, by which the elliptical orbit can traverse the\nhigh-orbit satellites, are introduced to realize the inspection of different phase tar-\ngets on high orbit [1, 2], and advantages and disadvantages of each are also\nanalyzed.\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_2\n\n7\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_2&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_2&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_2&amp;domain=pdf\n\n\n2.2 Absolute Dynamics Analysis of Elliptical Orbit\n\n2.2.1 Basic Features of Elliptical Orbit\n\nWhen studying the relative movement between an artificial satellite and the earth,\nthe satellite can be regarded as a particle because its size is much smaller than the\ndistance between the earth and itself. The earth can be seen as either a sphere or the\nparticle, whose mass concentrates on the geometrical center. In short, the satellite\nand the earth approximately form a two-body problem.\n\nTo describe the position of the satellite in space, the equatorial inertial coordinate\nsystem OXYZ is defined: The origin of the coordinate O is the center of the earth;\nthe X-axis points to the vernal equinox ! along the intersection line between earth\u2019s\nequatorial plane and the ecliptic plane; the Z-axis points to the north pole; the Y-axis\nis perpendicular to the X-axis on the equatorial plane, as shown in Fig. 2.2.\n\nIn the earth inertial coordinate system, the motion of the satellite under the ideal\ncondition can be described by the two-body dynamics equation, that is\n\nGEO\n\nSynchronous transfer Orbit \n\nSSO\n\nTarget\n\nTarget\n\nChaser\n\nChaser\n\nFig. 2.1 Diagram of large elliptical orbit intersection with high-orbit satellite\n\n8 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\n\u20acx \u00bc ? lxr3\n\u20acy \u00bc ? lyr3\n\u20acz \u00bc ? lzr3\n\n8<\n: \u00f02:1\u00de\n\nwhere x, y, z are the coordinates of the satellite at the earth inertial coordinate\nsystem, respectively; r is the distance from the satellite to the center of the earth,ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\nx2 \u00fe y2 \u00fe z2\np\n\n; l is the earth\u2019s gravitational constant, l = 398,600.436 km3/s2.\nThis is a nonlinear differential equation which is completely solvable if the six\n\ninitial conditions are given, i.e., the position and velocity of the satellite at time t0.\nThe initial conditions can determine six integral constants, and each of them\ndescribes a characteristic of the orbit of the satellite.\n\nThey can be converted into six orbital elements of the satellite, i.e., the orbital\nsemi-major axis a, the elliptical eccentricity e, the orbital inclination i, the longitude\nascending node X, the perigee argument x, and the true anomaly h or mean\nanomaly M. It can meet the requirements of the track design by selecting the six\nelements. The six orbital elements are often used to describe the motion charac-\nteristics of satellites in space. The geometric significance of the elements above in\nspatial coordinates is summarized in Fig. 2.3.\n\nIn Fig. 2.3, OXYZ is the equatorial inertial coordinate system; the X-axis points\nto the vernal equinox !; ON is the nodal line of the orbit of the satellite, N is the\nascending node; S is the position of the satellite; P is the perigee of the satellite\norbit; e is the eccentricity vector from the earth center to the perigee; W is the\nnormal unit vector of the plane along the movement direction of the satellite by the\nright-hand definition.\n\nThe six orbital elements are defined as:\n\n(1) Semi-major axis of the orbit a\u2014the semi-major axis of elliptical orbit.\n(2) Eccentricity e\u2014the eccentricity of elliptical orbit.\n(3) Orbital inclination i\u2014the angle between W and the Z-axis.\n\nY\n\nZ\n\nO\n\nN\n\nS\n\nSatellite orbit\n\nequator\n\n?,X\n\nFig. 2.2 Equatorial inertial\ncoordinate system\n\n2.2 Absolute Dynamics Analysis of Elliptical Orbit 9\n\n\n\n(4) Longitude ascending node X\u2014the angle between the nodal line ON and X-axis.\n(5) Perigee argument x\u2014the angle from perigee to ascending node.\n(6) True anomaly h\u2014the angle of the satellite position relative to the perigee.\n\nThe position vector r and velocity vector v of the satellite in the inertial equa-\ntorial coordinate system are in one-to-one correspondence to the orbital elements of\nthe satellite, if any set of parameters is known, another set of parameters can be\nobtained.\n\nAccording to the orbital eccentricity e, it can be categorized as circular orbit\n(e = 0), elliptical orbit (0 < e < 1), parabolic orbit (e = 1), and hyperbolic orbit\n(e > 1).\n\nThe rp and ra can be got from the elliptical semi-major axis a and the elliptical\neccentricity e:\n\nrp \u00bc a\u00f01? e\u00de\nra \u00bc a\u00f01\u00fe e\u00de\n\n?\n\nThe elliptical orbital period T is\n\nT \u00bc 2p\nl2\n\na3=2\n\nThe elliptical orbital period is the same as the circular orbital period with radius\na, indicating that the elliptical orbital period is independent with the eccentricity.\n\nY\n\nX\n\nZ\n\nW\n\nN\n\nO\n\nS\n\nP\nD\n\n? r\n\ne\n??\n\ni\n\n?\n\nFig. 2.3 Description of\norbital elements in space\n\n10 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\n2.2.2 Elliptical Orbit Perturbation\n\nThe two-body problem is based on the condition that the earth is a positive sphere\nof uniform mass and ignores the effects of other forces. But the elliptical orbit\ninvolves a complex spatial environment: On the one hand, the earth is not the ideal\nsphere which is affected by non-spherical perturbation; on the other hand, the\nelliptical orbit satellite on orbit is also subject to the perturbation of atmospheric\ndrag, sun radiation pressure, the lunisolar gravitational and other forces which\ncannot be ignored. Therefore, there is a large deviation between the actual satellite\norbit and the ideal two-body orbit, and the perturbation factors need to be con-\nsidered in the dynamic analysis.\n\nThe basic dynamics equation of elliptical orbit satellites under the influence of\nperturbation is\n\n\u20acr\u00fe l\nr3\nr \u00bc f \u00f02:2\u00de\n\nwhere f is the set of all perturbation acceleration of the satellite.\n\nf \u00bc Dg\u00fe f sr \u00fe f l \u00fe f s \u00fe f P \u00f02:3\u00de\n\nwhere Dg is the non-spherical gravitational acceleration of the earth, f sr is the sun\nradiation pressure acceleration, f l is the Lunar gravitational acceleration, f s is the\nsun gravitational acceleration, f P is the thrust acceleration of the orbit control\nengine.\n\nIn all kinds of perturbation, the earth flattening perturbation is the main per-\nturbation factor which plays a decisive role in the aspects of the long-term orbit drift\nand short-period vibration. Atmospheric drag perturbation has a greater impact on\nthe orbital motion below the 1000 km orbital altitude, and sun radiation pressure\nperturbation is generally smaller at least one order of magnitude than the lunisolar\ngravitational perturbation. The impact of them is far less than J2 perturbation\nimpact in the elliptical orbit mission.\n\n(1) Earth non-spherical perturbation\n\nIn general, the perturbation of the satellite orbit to be considered includes the earth\nshape perturbation, atmospheric drag perturbation, lunisolar gravitational perturba-\ntion, sun radiation pressure perturbation, geomagnetic perturbation, tide (solid tide,\ntide) perturbation, the earth reflex radiation pressure perturbation, the orbital and\nattitude control jet force perturbation. Among the perturbations, the earth\u2019s gravita-\ntional field is the most important and even plays a decisive role in the spacecraft\nmovement. The earth\u2019s gravitational field is a conservative force field whose potential\nis often called the earth\u2019s gravitational potential. When the earth is regarded as a\nhomogeneous sphere, its gravitational potential is just a function of the geocentric\ndistance:U \u00bc U\u00f0r\u00de. But when the irregular shape and uneven quality distribution are\n\n2.2 Absolute Dynamics Analysis of Elliptical Orbit 11\n\n\n\nconsidered, the gravitational potential is the function of geocentric distance, longitude\nk, latitude u (the geocentric latitude strictly speaking), that is U \u00bc U\u00f0r; k;u\u00de.\n\nOver the years, there are more than ten kinds of earth gravitational field models\nmeasured by the ground gravity data and spatial satellite data. Four kinds of them\nwith WGS84, JGM2, JGM3, and GEM-T1 are used much more extensively.\n\nU \u00bc l\nr\n\n1\u00fe\nX1\nl\u00bc1\n\nXl\nm\u00bc0\n\nRe\nr\n\n? ?l\nPlm\u00f0sinu\u00de\u00f0Clm cos\u00f0mk\u00de\u00fe Slm sin\u00f0mk\u00de\u00de\n\n\" #\n\u00f02:4\u00de\n\nwhere Plm is the normalized Legendre polynomial and the adjoint polynomial;\nClm; Slm are the normalized potential coefficient. Note that l and Re are slightly\ndifferent in the different gravitational field models, where\nl \u00bc 398;600:436 km3=s2; Re \u00bc 6;378;137m.\n\nThe earth gravitational field can be divided into two parts: the central gravita-\ntional potential Uc and the perturbation potential DU, that is\n\nU \u00bc Uc \u00feDU\n\nThe earth gravitational acceleration for the satellite can be expressed as\n\ng \u00bc gc \u00feDg \u00bc ?\nl\nr3\nr\u00fe gradDU \u00f02:5\u00de\n\nwhere gc is the central gravitational acceleration and Dg is the perturbation gravi-\ntational acceleration.\n\nIn the existing earth\u2019s gravitational field models, the order of the oblate coeffi-\ncient J2 is 10?3 and the rest of the harmonic coefficient are almost 10?6\u201310?7. In\naddition to the item J2, the other zonal harmonic terms and tesseral harmonic terms\nalso reflect the irregularities of the earth, but for the gravity of the space, and their\nrole is expressed as a whole, the impact on the satellite orbit is not simply super-\nimposed. In a certain precision requirements, their impact on the satellite orbit can\nbe ignored from a certain item (corresponding to a positive integer n). It needs to\nconsider the actual effect of many items, not just one when the impact of the earth\u2019s\nshape perturbation on the satellite orbit is analyzed. Generally, for a specific\nsatellite, it can achieve high accuracy by taking several major items, such as\nJ2; J3; J4 and J22; J31; J32; J33; J41; J42; J43; J44 and meet the requirements of dynamic\nsimulation and analysis. The values of the fourth-order zonal harmonic and tesseral\nharmonic terms of the earth are listed in Table 2.1.\n\nIn the mathematical simulation, only the influence of the fourth-order earth\nnon-spherical perturbation needs to be considered. In the theoretical analysis, only\nthe second-order terms J2 and J22 are considered.\n\nFor the elliptical orbit satellite, the J2 perturbation relative to the earth flatness is\nthe main perturbation of the satellite and which can be expressed as\n\n12 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\n_a \u00bc 0\n_e \u00bc 0\n_i \u00bc 0\n_X \u00bc ? 3J2R2E2p2 n cos i\n_x \u00bc 3J2R2E2p2 n\u00f02? 52 sin2 i\u00de\n_M \u00bc 3J2R2E2p2 n\u00f01? 32 sin2 i\u00de\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\n\n8>>>>>>>><\n>>>>>>>>:\n\n\u00f02:6\u00de\n\nwhere RE is the earth\u2019s radius; n is the average orbit angular velocity; p is the\nhalf-diameter of the ellipse.\n\n(2) Lunisolar gravitational force perturbation\n\nThe gravity of other celestial bodies except the earth (mainly the moon and the\nsun) will also pose a perturbation to the motion of the satellite; the reality is that the\ndifference between the gravitational acceleration caused by the other celestial\nbodies and the one caused by the earth poses the orbital perturbation. The gravi-\ntational perturbation acceleration can be expressed as\n\nf g \u00bc\nXn\ni\u00bc1\n\nli\npi\np3i\n\n? qi\nq3i\n\n? ?\n\u00f02:7\u00de\n\nwhere li is the gravitational constant of the ith celestial body; pi is the position\nvector from the satellite to the ith celestial body; qi is the position vector from the\ngeocentric to the ith celestial body. If r represents the position vector from the\ngeocentric to the satellite, the relationship among the earth, the sun, and the\nspacecraft is shown in Fig. 2.4.\n\npi \u00bc qi ? r \u00f02:8\u00de\n\nConsidering the gravitational perturbation caused by the moon (shown subscript\nl) and the sun (subscript s), the perturbation acceleration is\n\nTable 2.1 Perturbation\nparameter\n\nn Jn ? 10?6 nm Jnm ? 10?6 knm (\u00b0)\n2 1082.63 22 1.81222 ?14.545\n\n3 ?2.5356 31 2.20792 7.0805\n\n4 ?1.62336 32 0.37190 ?17.4649\n\n33 0.21984 21.2097\n\n41 0.45600 ?138.756\n\n42 0.16806 31.0335\n\n43 0.06030 ?3.8459\n\n44 0.00754 30.7920\n\n2.2 Absolute Dynamics Analysis of Elliptical Orbit 13\n\n\n\nf l \u00bc ll\npl\np3l\n\n? ql\nq3l\n\n? ?\n\nf s \u00bc ls\nps\np3s\n\n? qs\nq3s\n\n? ? \u00f02:9\u00de\n\nwhere ll \u00bc 4:902; 802; 627? 1012 m3=s2; ls \u00bc 1:32;712;440? 1020 m3=s2.\nWhen calculating the position of the sun and the moon, use components in the\n\nJ2000 geocentric equatorial coordinate system, and then convert it into the satellite\norbit motion coordinate system. The ratio of the earth perturbation of zonal har-\nmonic terms with the gravitational force is 3:7? 10?5. The perturbation effect on\nthe elliptical orbit of the lunisolar gravitational perturbation is almost the same as\nthe order of magnitude of the zonal harmonic terms, and it has long-term impact on\nelliptical orbit, so the impact of lunisolar perturbation must be considered when\nanalyzing the characteristics of the elliptical orbit.\n\n(3) Atmospheric drag perturbation\n\nThe large elliptical orbit covers widely, including the low orbit, middle orbit and the\nhigh orbit. The impact of atmospheric drag on near-earth orbit, especially the\nlow-orbit satellite, is very significant. As the part of the arc of the elliptical orbit\noperates on the low track, it will have a greater impact because of the long-term\ncumulative effect.\n\nThe atmospheric drag acceleration of the satellite is\n\nf a \u00bc\n1\n2\ncD\n\nA\nm\nqvv \u00f02:10\u00de\n\nwhere cD is the drag coefficient; A is the projection area of the satellite along the\nvelocity direction; m is the satellite mass; v is the velocity vector; v is the velocity; q\nrepresents the atmospheric density.\n\nSpacecraft\n\nSun\n\nGeocentric\n\np\n\nq\n\nO\n\nr\n\nzi\n\nxi yi\n\nFig. 2.4 Relationship among\nearth, sun, and the spacecraft\n\n14 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nAssuming that the atmosphere does not rotate with the earth\u2019s rotation, the\nnormal acceleration component is zero and the radial and lateral components are,\nrespectively,\n\nFR \u00bc ? 12 kqvvr\nFs \u00bc ? 12 kqvvh\n\n?\n\u00f02:11\u00de\n\nwhere k \u00bc cDA=m; vr and vh are the radial and lateral velocity components of the\nsatellite, respectively:\n\nvr \u00bc\nffiffi\nl\np\n\nq\ne sin h\n\nvh \u00bc\nffiffi\nl\np\n\nq\n\u00f01\u00fe e cos h\u00de\n\nv \u00bc\nffiffi\nl\np\n\nq\n\u00f01\u00fe 2e cos h\u00fe e2\u00de12\n\n8>>><\n>>>:\n\n\u00f02:12\u00de\n\nAtmospheric density is often expressed as an exponential model\n\nq \u00bc qp exp\u00f0?\nr ? rp\nH\n\n\u00de \u00f02:13\u00de\n\nwhere qp is the atmospheric density of the perigee; rp is the perigee distance; H is\nthe density elevation.\n\nDue to\n\nr \u00bc a\u00f01? e cosE\u00de\nrp \u00bc a\u00f01? e\u00de\n\n?\n\u00f02:14\u00de\n\nGet\n\n?\u00f0r ? rp\u00de \u00bc ae\u00f0cosE ? 1\u00de \u00f02:15\u00de\n\nThen\n\nq \u00bc qp exp\u00f0?\nae\nH\n\u00de exp\u00f0ae\n\nH\ncosE\u00de \u00f02:16\u00de\n\n(4) Solar pressure perturbation\n\nLight pressure effect, which is produced by solar light irradiating on the surface of\nthe spacecraft, will have perturbation effect on the on-orbit spacecraft.\n\nThe total pressure p acting on the unit area dA in the n (normal direction) and s\n(tangential direction) direction is expressed as\n\n2.2 Absolute Dynamics Analysis of Elliptical Orbit 15\n\n\n\npn \u00bc Psun cos h 1\u00feCrs\u00f0 \u00de cos h\u00fe 23Crd\n? ?\n\nps \u00bc Psun sin h cos h 1? Crs\u00f0 \u00de\n\u00f02:17\u00de\n\nwhere Crs is the total reflection coefficient; Crd is the diffuse reflection coefficient;\nPsun is the sun pressure parameter; h is the angle between the normal of the plate\nsatellite and the sun vector.\n\nAnd the radiation pressure acted on the surface of the whole satellite should be\nthe integral of the two quantities above, that is\n\nf sr \u00bc\nZ\nA\n\npn \u00fe ps\u00f0 \u00dedA \u00f02:18\u00de\n\nThe solar panels or solar panels of the satellite are the flat structure, and the\nradiation pressure is\n\nf srn \u00bc pnA\nf srs \u00bc psA\n\n\u00f02:19\u00de\n\nIt should be pointed out that satellite will be interfered by sunlight pressure only\nwhen being irradiated by sunlight, so it should judge whether the satellite is in the\nearth shadow area before calculating the sunlight pressure. If it is in the shadow\narea, the sunlight pressure perturbation is 0.\n\n2.3 Autonomous Orbit Prediction of Elliptical Orbit\n\n2.3.1 Autonomous Orbit Prediction\n\nSpaceborne orbit prediction plays a vital role in space mission. Through the\nonboard orbit prediction, the design of the track can be optimized, which provides\nthe basis for the orbital maneuver and also prepares for the ground data transmis-\nsion, monitoring, and so on [3]. In order to realize the orbital prediction of the\nsatellite, the analytic method and the numerical method are mainly adopted at\npresent.\n\nThe analytic method is to predict the orbit by analyzing and obtaining the\nanalytic expression of the main disturbance force which affects the orbital motion.\nThe advantage of the method is that the calculation is simple and rapid, accounting\nfor less computing resources; but its drawback is that the calculation accuracy is not\nhigh, so a variety of models are needed to use combinedly when the space envi-\nronment changes. The SGP/SDP [4] algorithm is a typical representation of this\nmethod.\n\n16 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nThe numerical method does not need to get the analytic expression of the orbital\nmotion. It obtains the orbital prediction by establishing the detailed dynamic model\nwhich affects the orbital motion and making recursion by adopting the specific\nnumerical iteration algorithm. The advantage of the method is that the calculation\naccuracy is high, which can adapt to the complex dynamic environment and does\nnot need to combinedly use a variety of models to calculate. The disadvantage of\nthe method is that it calculates slowly, and needs to simplify the dynamic model\nproperly and use the appropriate iterative solver.\n\nWith the development of the onboard processor technology and the increasing of\nthe accuracy requirements of orbital forecast in space applications, more and more\nsatellites adopt the numerical method for orbital prediction. The spaceborne\nhigh-precision forecast of the elliptical orbit satellite has the particularity compared\nwith the low-orbit one:\n\nFirstly, an accurate and reasonable kinetic model is needed to establish because\nthe spatial dynamics environment changes are particularly obvious when the\nelliptical orbit [5, 6] transfers from the low orbit to the high orbit.\n\nSecondly, because the communication capacity is limited between the elliptical\norbital satellite and the ground, and the orbital forecast method based on the ground\nstation has a great limitation, the satellites need to carry out real-time autonomous\norbit prediction completely.\n\nFinally, the autonomous orbital prediction capability demands that when\ndesigning orbit prediction algorithm, the spatial environment model should be\nsimplified reasonably and the appropriate solver should be selected to meet the\nreal-time orbital forecasting requirements.\n\nAs shown in Fig. 2.5, the structure of the spaceborne prediction system of the\nelliptical orbital satellite is based on the numerical iterative algorithm. In the pro-\ncess of each numerical iteration, firstly, calculate various interference forces which\naffect the orbit according to the current orbit value, and then call the solver to\ncalculate the orbital value for the next moment and add a step size at the current\nmoment. In Fig. 2.5, it represents the current time, and h represents the iteration\nstep. According to the characteristics of elliptical spaceborne orbit forecast, the orbit\ndynamic model is simplified and the appropriate solver is selected.\n\n2.3.2 Onboard Orbit Prediction Algorithm of Elliptical Orbit\n\nThe elliptical spaceborne orbit prediction has real-time requirements for the solver,\nso the single-step and low-order solvers are usually selected. Here, four solvers are\nselected: the fourth-order Runge\u2013Kutta method (RK4), the fifth-order Runge\u2013Kutta\nmethod (RK5), the fifth-order Runge\u2013Kutta\u2013Nystr\u00f6m method (RKN5), and\nfifth-order Dormand\u2013Prince Method (DP5).\n\n2.3 Autonomous Orbit Prediction of Elliptical Orbit 17\n\n\n\n1. The fourth-order Runge\u2013Kutta method\n\nThe general form of the Runge\u2013Kutta method is as follows [7]:\n\ny\u00f0t\u00fe h\u00de \u00bc y\u00f0t\u00de\u00fe hP4\ni\u00bc1\n\nbiki\n\nki \u00bc f \u00f0t\u00fe cih; y\u00f0t\u00de\u00fe h\nPi?1\nj\u00bc1\n\naijkj\u00de\n\n8>>><\n>>>:\n\n\u00f02:20\u00de\n\nFor the fourth-order Runge\u2013Kutta method, the expression is as follows:\n\nyn\u00fe 1 \u00bc yn \u00fe 16 \u00f0K1 \u00fe 2K2 \u00fe 2K3 \u00feK4\u00de \u00f02:21\u00de\n\nwhere\n\nK1 \u00bc hf \u00f0tn; yn\u00de\nK2 \u00bc hf \u00f0tn \u00fe h2 ; yn \u00fe K12 \u00de\nK3 \u00bc hf \u00f0tn \u00fe h2 ; yn \u00fe K22 \u00de\nK4 \u00bc hf \u00f0tn \u00fe h; yn \u00feK3\u00de\n\n8>><\n>>: \u00f02:22\u00de\n\nThe purpose of the RK4 method is to get the estimation result whose accuracy\nand truncation error are h4 and const?h5, respectively.\n\nCalculate   perturbations at \nthe moment\n\nCall the solver to calculate the \norbital value in the next moment\n\nOutput orbital value\n\nY\n\n?\nN\n\nEnter  initial orbital value, \nforecast time\n\nReach the forecast\nend time\n\nt=t+h\n\nFig. 2.5 Elliptical\nspaceborne orbital forecasting\nsystem\n\n18 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\n2. Fifth-order Runge\u2013Kutta method\n\nThe fifth-order Runge\u2013Kutta method has a similar structure with (2.22), and its\ncoefficients can be found in [7].\n\nThe purpose of the RK5 method is to get the estimation result whose accuracy\nand truncation error are h5 and const?h6, respectively.\n3. Fifth-order Runge\u2013Kutta\u2013Nystr\u00f6m method\n\nThe expression of Runge\u2013Kutta\u2013Nystr\u00f6m method is as follows:\n\nr\u00f0t0 \u00fe h\u00de \u00bc r0 \u00fe hv0 \u00fe h2\nXs\ni\u00bc0\n\nbiki\n\nr?\u00f0t0 \u00fe h\u00de \u00bc r0 \u00fe hv0 \u00fe h2\nX5\ni\u00bc0\n\nb?iki\n\nv?\u00f0t0 \u00fe h\u00de \u00bc v0 \u00fe h\nXs\ni\u00bc0\n\nb?iki\n\nki \u00bc a t0 \u00fe cih; r0 \u00fe cihv0 \u00fe h2\nXi?1\nj\u00bc0\n\nbijkj\n\n !\n\u00f02:23\u00de\n\nThe parameters of the fifth-order system can be seen in the literature [8]. The\nfixed-step calculation is also selected here, which has the accuracy of h5 and need to\ncalculate six functions in each iteration.\n\n4. Fifth-order Dormand\u2013Prince Method\n\nThe fifth-order Dormand\u2013Prince Method has the same structure as the Formula\n(2.22). Because its parameters are complex, they are not listed here and can be seen\nin the literature [7]. The fixed-step method is selected here which has the accuracy\nof h5 and need to calculate six functions in each iteration.\n\nThe calculation amount of the function in each step and the final iteration\naccuracy of RK4, RK5, DP5, and RKN5 are listed in Table 2.2.\n\nBy comparing the performance of multiple single-step methods, it can be seen\nthat the calculation amount of the RK4 method is smaller and RK5, DP5, and\nRKN5 have advantages on the accuracy. However, since the small calculation\namount and high reliability of the RK4 method, which has been tested in the actual\n\nTable 2.2 Comparison of single-step method performance\n\nType of single-step method Function calculated amount each step Accuracy\n\nRK4 4 O(h4)\n\nRK5 6 O(h5)\n\nDP5 6 O(h5)\n\nRKN5 6 O(h5)\n\n2.3 Autonomous Orbit Prediction of Elliptical Orbit 19\n\n\n\nengineering of a number of foreign satellites, it is chosen in the actual application.\nThe orbital forecast needs to get the orbital value at any time, while RK4 method is\na fixed step-size solver, so an interpolation method is needed. The commonly\n5-order Hermite interpolation method is chosen in this book. By the coordination of\nfourth-order Runge\u2013Kutta step-size integral and the fifth-order Hermite interpola-\ntion, it can be guaranteed to get the orbit value with sufficient precision and high\ncomputational efficiency at any time.\n\n2.3.3 Analysis and Predigestion of Elliptical\nOrbit Dynamics Model\n\n(1) Accuracy requirements of elliptical orbital dynamic model\n\nIn order to simplify the elliptical orbit dynamic model reasonably, first, it is nec-\nessary to analyze the accuracy requirement on the dynamic model of the elliptical\nspaceborne orbit prediction. It is supposed that Ds is the orbital error and t is the\ntime of orbital prediction, and the prediction error of elliptical spaceborne orbit is\nless than Ds during the time t.\n\nThere are unmodeled errors and simplified dynamic model errors between the\norbital dynamics model and the real model. The effect of them on the orbit can be\nconsidered to be an acceleration deviation which will cause the difference Ds0\n\nbetween the orbit forecast and the real orbit. If the acceleration deviation is Da, the\ndifference can be expressed as\n\nDs0 \u00bc 1\n2\nDa ? t2 \u00f02:24\u00de\n\nBut Ds0 is the components of Ds, it is assumed that the ratio between them is k,\nthen\n\nDs0 \u00bc k ? Ds \u00f02:25\u00de\n\nIt is possible to obtain the requirement for dynamic modeling error, that is\n\n1\n2\nDa ? t2 \u00bc Ds0 ? kDs \u00f02:26\u00de\n\nThe Eq. (2.26) is the accuracy requirement on the dynamic model of the ellip-\ntical spaceborne orbit prediction. When the magnitude caused by the error term in\nthe dynamic model is less than the requirement above, it can be neglected.\n\n(2) Simplification of Elliptical orbit dynamic model\n\nIt is necessary to further analyze the dynamic characteristics of the elliptical orbit in\ndifferent orbital altitude after knowing the accuracy requirement on the dynamic\nmodel of the elliptical spaceborne orbit prediction. It is assumed that the mass of the\n\n20 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nsatellite is 50 kg, the equivalent area of the windward surface is 1 m2, the complete\nreflection coefficient is 0.4, the complete diffuse reflection coefficient is 0.3, the\ncomplete absorption coefficient is 0.3, the atmospheric rotation speed is\n0.00007292 rad/s, the atmospheric drag coefficient is 2, the equivalent area of solar\nradiation is 1 m2, and the dynamic characteristics of the influence of all kinds of the\nforces of the elliptical orbit at different orbital altitude can be obtained, as listed in\nTable 2.3.\n\nAfter obtaining the dynamic characteristics of elliptical orbits in different alti-\ntude, the model can be simplified by combining the accuracy requirement of the\nelliptical orbital dynamic model.\n\nTo facilitate analysis, the requirements of the orbit prediction are taken to be\nwithin 300 m in 5 h. Substituting this requirement into Eq. (2.26) (taking k = 0.1 at\nthe same time), the accuracy requirement of the elliptical dynamics model can be\nobtained:\n\nDa\\\n1\n\n5:4? 106 m=s\n2 \u00f02:27\u00de\n\nOn the basis of Eqs. (2.27) and Table 2.3, the elliptical orbit dynamic model is\nsimplified.\n\nFirstly, the gravity field model and order are considered. The gravity field model\nadopted here is GEM-1, and the selection for order of the gravity field model is got\nby analyzing the influence of the order of the gravitational field on the orbital\ndynamics. The influence of the gravity field order on orbital dynamics is obtained\nby analyzing the error characteristics of different gravitational field orders in the\ncase of two sets of orbit initial values. The highest order of the GEM-1 model is\n36 ? 36, so the orbital value under the condition that gravitational field is 36 ? 36\n\nTable 2.3 Dynamic characteristics of elliptical orbits with different heights\n\nOrbital\nheight (km)\n\nGravity\n(N)\n\nLunisolar gravitational\nforce (N)\n\nSolar radiation\nforce (N)\n\nAtmospheric\ndrag (N)\n\n300 447.6 0.00003782 5.472 ? 10?6 1.302 ? 10?3\n800 387.3 0.00004064 5.472 ? 10?6 2.011\n\n1300 338.4 0.00004345 5.472 ? 10?6 7.759 ? 10?8\n1800 298.3 0.00004627 5.472 ? 10?6 1.476 ? 10?8\n2300 264.9 0.00004908 5.472 ? 10?6 0\n3300 212.9 0.00005470 5.472 ? 10?6 0\n4300 174.9 0.00006031 5.472 ? 10?6 0\n9300 81.1 0.00008824 5.472 ? 10?6 0\n\n19,300 30.2 0.0001434 5.472 ? 10?6 0\n24,300 21.2 0.0001706 5.472 ? 10?6 0\n29,300 15.7 0.0001976 5.472 ? 10?6 0\n39,300 9.6 0.0002508 5.472 ? 10?6 0\n49,300 6.4 0.0003027 5.472 ? 10?6 0\n\n2.3 Autonomous Orbit Prediction of Elliptical Orbit 21\n\n\n\nis chosen as the standard reference. The overall trend of the error caused by the\ngravitational field order decreases with the increase of the order, but when the order\nis much smaller, the error is still relatively larger, so the final order selected is\n36 ? 36.\n\nThe amplitude of the lunisolar gravitational force perturbation is much large, so\nit cannot be ignored in the elliptical orbit forecast, but the analytic method can be\nused for the ephemeris calculation. The accuracy of the analytical method is less\nthan that of the numerical method, but the magnitude of error caused by the method\nis about 1/100 of the lunisolar gravitational force perturbation.\n\nThe solar radiation flux in the elliptical orbit can be approximately the same\nbecause the distance between the sun and the satellite is far.\n\nWhen the orbit altitude is less than 2000 km, the effect of the atmospheric drag\nneeds to be taken into account; when it is greater than the altitude, the effect of\natmospheric drag can be neglected. The improved Harris\u2013Priester model being used\nin the atmospheric density model of atmospheric drag perturbation is obtained by\nstoring the prescribed maximum density and minimum density at a given height hi\nin advance and conducting interpolation over the density values in the table.\n\nThe lunisolar gravitational force perturbation coefficients and atmospheric drag\nperturbation coefficients are fit by the measured data of the satellite orbit to\ndetermine the best coefficients, then injected in real time by the ground or writing\ninto the calculation program as the known parameters according to the different\norbit altitude of the satellite orbit.\n\n2.4 Design of Apogee Rendezvous Orbit\n\nMaking use of the characteristics that rendezvous exists between apogee of the\nlarge elliptical orbital satellite and high-orbit geostationary satellite to access to the\ngeostationary satellite within the short range for short time. During the time, it can\nimplement multiple tasks, such as the observation and communication. In this\nsection, firstly, the drift characteristics of the elliptical orbit are analyzed, and then\nthe parameters of the frozen elliptical orbit and the small inclination elliptical orbit\nare designed, respectively, to realize the fast rendezvous between the elliptical orbit\nsatellites and the geostationary satellite. At the same time, the parameters such as\nthe change rate of the line-of-sight distance and the angular velocity of the\nline-of-sight change rate are needed to meet the measurement requirements of the\ntracking device to ensure capture the target which is tracked and observed.\n\nThe following strategies are adopted in the design of the rendezvous orbit on the\napogee:\n\n(1) Firstly, design the initial parameters which meet the locked rendezvous orbit\nwithout considering the perturbation;\n\n(2) Secondly, consider the impact of J2 perturbation and modify the initial\ndesigned orbital parameters;\n\n22 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\n(3) Finally, consider the engineering constraints and amend the orbital parameters\naccording to the performance index of the tracking unit.\n\nWhen the large elliptical orbit satellite accesses to the geostationary satellite,\nelliptical orbit which can satisfy periodic locked access to the geostationary orbit\nneeds to be defined.\n\nAs shown in Fig. 2.6, the spacecraft T operates in the geostationary orbit.\nAssuming that the elliptical orbital spacecraft C encounters T at time t0 on G point,\nif the T operates for M loops, the corresponding C operates for exactly N loops\n(N > M), the two can meet at the G point, the elliptical orbit is the locked orbit of\nthe geostationary orbital spacecraft.\n\nIn the process of designing the apogee rendezvous orbit, it is required that in\napogee rendezvous, the altitude of the apogee is required to be 55 km lower than\nthat of the geostationary orbit, and the parameters of the geostationary orbit are\nlisted in Table 2.4.\n\nAssume that the maximum detection range of radar is 150 km, the gradient of\nthe angle of view is in the range of ?2 to +2 \u00b0/s, and the gradient of the line-of-sight\ndistance varies in the range of ?2 to +2 km/s, so the parameters of the rendezvous\nduration, gradient of the line-of-sight distance, gradient of the line-of-sight azimuth\nand the elevation, etc., should be analyzed to ensure the rendezvous orbit meet the\ndetecting capability requirements since the target entering the relative distance of\n150 km.\n\nO\n\nr\n\nRE\n\ngeostationary orbitLarge ellipse access orbit\n\nT (C )\n\nT \u2019\n\nC \u2019\n\nG\n\nFig. 2.6 Elliptical locked orbit illustration\n\nTable 2.4 High-orbit geostationary satellite\n\nOrbital\nelements\n\nsemi-major\naxis a (km)\n\nEccentricity\ne\n\nOrbital\ninclination\ni (\u00b0)\n\nPerigee\nargument\nx (\u00b0)\n\nLongitude\nascending node X\n(\u00b0)\n\nValue 42,165.258 0.0005224 6.4954 285.0568 63.8179\n\n2.4 Design of Apogee Rendezvous Orbit 23\n\n\n\n2.4.1 Drift Characteristics Analysis of Elliptical Orbit\n\nTwo special elliptical orbits are considered: frozen elliptical orbit and small incli-\nnation orbit. Frozen elliptical orbit is the elliptical orbit with the orbital inclination\nof 63.43\u00b0, which has the characteristics that the perigee argument does not drift\nunder the influence of the J2 perturbation. The small inclination elliptical orbit is\nthe elliptical orbit with the inclination close to 0\u00b0.\n\nAssume that the initial orbital parameters of two kinds of the elliptical orbits are\nlisted in Table 2.5, the drift characteristics of two special kinds of elliptical orbits\nare analyzed in this section.\n\nIt is assumed that the initial simulation time of elliptical orbit satellite is July 1,\n2012, the simulation terminal is on July 30, 2012, and the simulation step is 60 s.\nThe drift characteristics of the J2 perturbation, lunisolar gravitational perturbation\nand the high-precision orbit prediction models (HPOP) are simulated and analyzed,\nrespectively.\n\n(1) Analysis of Drift Characteristics of Frozen Elliptical Orbit\n\nFirstly, the effect of J2 term on the orbital elements should be considered. Secondly,\nthe ratio of perturbation force of the earth\u2019s zonal harmonic and the earth\u2019s geo-\ncenter gravity is 3.7 ? 10?5, while the perturbation impact of the lunisolar per-\nturbation on elliptical orbit is almost the same as the magnitude of the earth zonal\nharmonic, which has a long-term effect on the elliptical orbital satellite, so when\nanalyzing the characteristics of the elliptical orbit, impact of lunisolar perturbation\nmust be considered. J2000.0 geocentric equatorial coordinate system is used when\ncalculating the positions of the sun and the moon, and then it is converted into the\ncomponents in the orbital motion coordinate system of the satellite. Finally, after\nconsidering the two perturbations (J2 perturbation and lunisolar gravitational per-\nturbation) which have the greatest influence on the elliptical orbital satellite, factors\nwhich affect the drift characteristics elliptical orbit should be considered as much as\npossible.\n\nThe effects of the perturbation factors including the J2 perturbation acceleration,\natmospheric drag, sun radiation pressure, and lunisolar gravitational are shown in\nTable 2.6.\n\n(1) With the simulation of the non-spherical J2 perturbation, atmospheric drag\nperturbation, sun radiation pressure, and lunisolar gravitational perturbation,\nfollowing conclusions can be obtained. Unlike the circular orbit, the elliptical\norbit J2 perturbation acceleration on the apogee is 5-order-magnitude difference\n\nTable 2.5 Initial orbital elements of elliptical orbit satellites\n\nOrbital elements a (m) e i (\u00b0) X (\u00b0) x (\u00b0) h (\u00b0)\n\nFrozen elliptical orbit 24,556,497 0.7146 63.43 63.8179 180 75.3624\n\nSmall inclination elliptical orbit 26,562,448 0.58533 0.01 63.8179 180 94.4\n\n24 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nfrom the perigee. The J2 perturbation has no effect on the long-term item of the\nsemi-major axis, eccentricity, orbital inclination, and perigee argument of the\nelliptical orbital satellite, while its short-term term effect is that the satellite orbit\noscillates up and down with a certain amplitude and frequency, but it has a\nsignificant effect on the longitude ascending node of the frozen elliptical orbit\nwhose first-order long-term item changes in the negative rate, that is, J2 per-\nturbation leads to the ascending node recede westward.\n\n(2) In the perigee, the perturbation acceleration is mainly the non-spherical J2 of\nthe earth, and the atmospheric drag perturbation, the solar radiation perturba-\ntion, the lunisolar gravitational perturbation are smaller than the non-spherical\nJ2 perturbation acceleration. In the apogee, the atmospheric drag perturbation is\nsmaller which can be ignored, and the other perturbation impact is almost the\nsame as in the perigee.\n\n(3) For the frozen large elliptical orbital satellite, the lunisolar gravitational per-\nturbation will make the oscillation of semi-major axis change periodically\nwithin the magnitude of 1 km, gradually reduce the eccentricity with change\namount about 0.001 per day in average, make the orbital inclination oscillate\nperiodically, reduce the longitude ascending node with change amount about\n0.0006\u00b0 per day, and the perigee argument increases in oscillation.\n\n(4) Considering various perturbation influence on the large elliptical frozen orbit,\nthe semi-major axis, being mainly affected by the J2 perturbation, its long-term\nitem is 0, while its short term oscillates with certain amplitude. The orbital\ninclination, being jointly affected by lunisolar gravitational perturbation and J2\nperturbation, reduces in oscillation periodically; and the first-order and\nsecond-order long term of orbit inclination are zero, and its variation only exists\nin the short-term term, that is, orbit inclination oscillates within a certain range;\nthe first-order long-term changing term of the longitude ascending node is\nnegative, with the change amount about 0.17\u00b0 per day in average, which is\nmainly caused by the perturbation of J2. The perigee argument changes peri-\nodically with a certain amplitude in the short term and gradually increases in the\nlong term.\n\n(2) Drift Characteristics analysis of Small Inclined Inclination elliptical orbit\n\nUnder the various perturbations, the actual orbit will gradually deviate from the\ndesigned orbit [8]. When the deviation reaches a certain level over time, the actual\n\nTable 2.6 Comparison of influence of various perturbation factors\n\nPerturbation factor Influence magnitude (m/s2) Periodicity\n\nJ2 perturbation Perigee 10\n?2 Yes\n\nApogee 10?7\n\nAtmospheric drag perturbation Perigee 10?7 Yes\n\nPerigee 10?13\n\nSun radiation pressure 10?8 No\n\nLunisolar gravitational force perturbation 10?6 Yes\n\n2.4 Design of Apogee Rendezvous Orbit 25\n\n\n\norbit will not meet the task requirements. Before implementing rendezvous task, the\norbital maneuvering spacecraft may need to fly freely in a small inclination ellip-\ntical parking orbit for a long time, and the effect of the various perturbations on the\norbital inclination will prevent the elliptical parking orbit from keeping in the\nequatorial plane and the unique advantages of the small inclination elliptical orbital\nspacecraft will be lost, so it is necessary to keep the spacecraft in the vicinity of the\ndesigned orbit by orbital control. Yang Weilian [9] gives the analytical model of the\nsolar synchronous orbit under the change of perturbation and the orbital control\nstrategy. Soop [10] studies the inclination drift phenomenon and physical mecha-\nnism of the geostationary orbit.\n\nThe J2 perturbation has no effect on the semi-major axis; the lunisolar gravita-\ntional perturbation has a periodic effect on the semi-major axis of the elliptical orbit\nand the periodic variation range is within 0.7 km with very subtle influence; the\ninfluence of the sun radiation pressure on the semi-major axis is subtle, which\ndecreases in oscillation by 0.08 km within 30 days; the amplitude of the\nsemi-major axis in the high-precision perturbation model is within 24 km, which is\nmainly caused by the earth\u2019s non-spherical perturbation.\n\nThe J2 perturbation has no effect on the orbital eccentricity of the satellite; the\nlunisolar gravitational perturbation makes the elliptical orbit eccentricity decrease in\noscillation by 0.000847 within 30 days, whose effect is very subtle; the sun radi-\nation pressure perturbation makes the elliptical orbit eccentricity increase by\n0.000048 within 30 days, which is one magnitude smaller than the lunisolar\ngravitational perturbation; the eccentricity of high-precision perturbation model\ndecreases in oscillation with the amplitude about 0.0005, and decreases by 0.001\nwithin 30 days.\n\nThe J2 perturbation has no effect on the orbital inclination; the lunisolar gravi-\ntational perturbation makes the elliptical orbit inclination increase monotonously\nwith the average change amount about 0.0037\u00b0 per day. The sun radiation pressure\nperturbation makes the elliptical orbit eccentricity decrease monotonously with a\nsmaller effect; the orbit inclination in the high-precision perturbation model\nincreases monotonously, which increases by 0.1\u00b0 within 30 days.\n\nUnder the influence of the J2 perturbation, the first-order long-term item of the\nchange rate of the longitude ascending node is negative that is, the J2 perturbation\nwill make the ascending node recede westward with the change amount about\n0.151\u00b0 per day; the lunisolar gravitational perturbation will make the longitude\nascending node increase in oscillation with the increase amount about 10\u00b0 within\n30 days; the lunisolar gravitational perturbation will make the longitude ascending\nnode increase in oscillation with the change amount about 10\u00b0 within 30 days; the\nsun radiation pressure perturbation will make the longitude ascending node\ndecreases in oscillation with the change amount about 0.0034\u00b0 per day; the lon-\ngitude ascending node in the high-precision perturbation model begins to increase\nin oscillation with a larger change rate at first, and then begins to oscillate with a\nsmaller amplitude.\n\nUnder the influence of the J2 perturbation, the first-order long-term item of the\nchange rate of the perigee argument is positive with the change amount about 0.3\u00b0\n\n26 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nper day, which makes the apse line of the elliptical orbit change rapidly to access\nthe high-orbit target naturally. The lunisolar gravitational perturbation will make the\nperigee argument reduce in oscillation with reduction amount about 9\u00b0 within\n30 days. The sun radiation pressure perturbation will make the perigee argument\nincrease in oscillation with a very small effect. The perigee argument in the\nhigh-precision perturbation model begins to decrease in oscillation with large\nchange rate at first, and then begins to oscillate with smaller amplitude.\n\nThrough the analysis of the perturbation force of the non-spherical J2, the\nlunisolar gravitational and the sun radiation pressure, the main conclusions are as\nfollows:\n\n1. The J2 perturbation has no effect on the semi-major axis, eccentricity, and orbital\ninclination of the small inclination and big elliptical orbit, and makes the lon-\ngitude ascending node reduce gradually, and the perigee argument increase\nsignificantly, so as to make the apse line drift.\n\n2. The effect magnitude of the lunisolar gravitational perturbation on the\nsemi-major axis of the small inclination elliptical orbit is within 0.7 km. It\nmakes the eccentricity decrease in oscillation, orbital inclination increase\nmonotonously, longitude ascending node increase in oscillation and perigee\nargument decrease in oscillation.\n\n3. The effect of the sun radiation pressure perturbation on the orbital elements in\nthe short time is very subtle which makes the semi-major axis decrease in\noscillation by 0.08 km in 30 days, the eccentricity of the elliptical orbit increase,\nthe orbital inclination decrease monotonously, the longitude ascending node\nreduces in oscillation and the perigee argument increase in oscillation.\n\n4. Comprehensively considering the influence of various perturbations on the small\ninclination elliptical orbit, when the amplitude of semi-axis is within 24 km, the\norbital eccentricity will decrease in oscillation and the orbital inclination will\nincrease monotonously. The changes of the longitude ascending node and the\nperigee argument are much greater, especially near the inclination of 0\u00b0.\n\nThe designed methods of the elliptical orbit will be introduced based on the\nspecific examples in the following.\n\n2.4.2 Design of Frozen Elliptical Orbit\n\n(1) The preliminary design of orbit\n\nIn order to satisfy the needs of low-orbit and high-orbit spacecraft making obser-\nvation simultaneously, perigee of large elliptical orbit is designed to be the altitude\nof sun synchronous orbit. Considering altitude of sun synchronous orbit is mostly\n500\u20131000 km, the altitude of perigee can be set as 500\u20131000 km. For the apogee,\nthe apogee altitude is designed to be 55 km lower than the geostationary orbit, i.e.,\n35,738 km.\n\n2.4 Design of Apogee Rendezvous Orbit 27\n\n\n\nIt is assumed that T1 is the locking orbital period and T0 is the period of the\ncircular orbital satellite, it can be known from the definition of the locking orbit:\n\nNT1 \u00bc T0\nThe semi-major axis of the locking orbit and the geocentric distance of the\n\nperigee are, respectively\n\naI \u00bc N?23r; rp \u00bc 2aI ? r \u00f02:28\u00de\n\nAs the geocentric distance of the locking orbit cannot be less than the earth\u2019s\nradius, that is rp [Re, so\n\nN\\\n2r\n\nr\u00feRE\n\n? ?3\n2\n\n\u00bc 2:29 \u00f02:29\u00de\n\nThis is the constraint condition of N.\nThe corresponding ratio of the period is listed in Table 2.7, when the apogee is\n\nfixed and the altitude of the perigee changes.\nIt can be seen from Table 2.7 that when the perigee altitude is 631 km,\n\nthe period ratio of the elliptical orbit to the geostationary orbit is 4/9, that is, since\nthe two satellites rendezvous every four days, the orbit can observe the low-orbit\nand high-orbit satellites at the same time. When N = 9/4, the semi-major axis\n\naI \u00bc \u00f09=4\u00de?\n2\n3 ? 42;165;258 \u00bc 24;556;497 m.\n\nThe eccentricity is determined by the semi-major axis and the geocentric dis-\ntance of the apogee, whose calculation needs to consider the shortcut point distance.\nAs the active spacecraft and the target spacecraft intersect on the equatorial plane, to\nensure that the distance between active spacecraft and target spacecraft is 55 km\nwhen the two arrives the equatorial plane at the same time, the altitude of the\napogee of active spacecraft is 55 km lower than the target spacecraft, upon cal-\nculation, the eccentricity of the target spacecraft is e \u00bc 0:7146.\n\nAs the active spacecraft and the target spacecraft intersect on the equatorial\nplane, the orbit inclination can be chosen randomly based on the design of the\norbital elements mentioned above, however, to ensure that J2 not drift, i = 63.43\u00b0 is\nselected.\n\nIn order to ensure the active spacecraft intersect with the target spacecraft at the\napogee on the equatorial plane, the perigee argument should be 0\u00b0 or 180\u00b0, while\nthe perigee argument of the synchronous transfer orbit is generally 180\u00b0, and the\nlongitude ascending node should be the same, so the elliptical orbit is designed to\nbe X = 63.818\u00b0, and the perigee argument x \u00bc 180?.\n\nTable 2.7 Relationship of ratio of perigee altitude to period\n\nPerigee altitude (km) 631 1373 1883 2255 2539 4643\n\nPeriod ratio to the geostationary orbit 4/9 5/11 6/13 7/15 8/17 1/2\n\n28 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nAssuming that the active spacecraft is just below the target spacecraft at the\nrendezvous point, then conduct the design of initial true anomaly. The obtained\ninitial true anomaly of active spacecraft is hc \u00bc 75:11?.\n\nThe perigee altitude designed is 630 km, the apogee designed is 55 km below\nthe geostationary orbit, and the active spacecraft is just below the target spacecraft\nat the rendezvous point. The orbital parameters of the two spacecrafts designed for\nhigh orbit and low orbit are listed in Table 2.8.\n\nSimulation time: 450,000 s (about 5 days, rendezvous twice), simulation step:\n2 s, the line-of-sight distance, and its change rate of the two spacecrafts in ren-\ndezvous process within 150 km can be obtained.\n\nFrom Figs. 2.7 and 2.8, it can be seen that during the first rendezvous, the\nline-of-sight gradient of the two spacecrafts within the distance of 150 km changes\ngradually from ?2414 to 2402 m/s and the rendezvous time is 112 s; during the\nsecond rendezvous, the line-of-sight gradient of the two spacecrafts within the\ndistance of 150 km changes gradually from ?2412 to 2392 m/s and the rendezvous\ntime is 110 s. According to the preliminary designed orbital parameters, it can be\nachieved that the active spacecraft rendezvous with the target spacecraft once after\norbiting every nine loops, as well as the shortcut point distance of 55 km.\n\nName \n\nParameter a(m) e i(\u00b0) ?(\u00b0) ? (\u00b0) ? (\u00b0)\n\n42,165,258 0.0005224 6.4954 63.8179 285.0568 0Target\nChaser 24,556,497 0.7146 63.43 63.8179 180 75.11\n\nTable 2.8 Orbital parameters of the two spacecrafts for high orbit and low orbit\n\n1.787 1.788 1.789 1.79 1.791 1.792 1.793 1.794 1.795 1.796 1.797 1.798\n\nx 10\n4\n\n0\n\n5\n\n10\n\n15\nx 10\n\n4\n\n1.787 1.788 1.789 1.79 1.791 1.792 1.793 1.794 1.795 1.796 1.797 1.798\n\nx 10\n4\n\n-2000\n\n-1000\n\n0\n\n1000\n\n2000\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\nLO\n\nS \ndi\n\nst\nan\n\nce\n g\n\nra\ndi\n\nen\nt/(\n\nm\n/s\n\n)\n\nt /s\n\nFig. 2.7 Line-of-sight distance and its gradient curve of two spacecrafts in the first rendezvous\n\n2.4 Design of Apogee Rendezvous Orbit 29\n\n\n\n(2) Orbit parameter correction under J2 perturbation\n\n? The analysis of the J2 perturbation impact\n\nThe perturbation impact must be considered in the process of orbital design and\nthe J2 perturbation related to the earth oblateness is the main perturbation of the\nartificial satellite, and the model is\n\n_a \u00bc 0\n_e \u00bc 0\n_i \u00bc 0\n_X \u00bc ? 3J2R\n\n2\nE\n\n2p2\nn cos i\n\n_x \u00bc 3J2R\n2\nE\n\n2p2\nn\u00f02? 5\n\n2\nsin2 i\u00de\n\n_M \u00bc 3J2R\n2\nE\n\n2p2\nn\u00f01? 3\n\n2\nsin2 i\u00de\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\n\n\u00f02:30\u00de\n\nUnder the influence of the oblateness perturbation of the earth, the first-order\nlong-term, second-order long-term, and first-order long-period terms of the\nsemi-major axis of the orbit are all zero, so the change of the semi-major axis of the\nsatellite is mainly the first-order short period which specifically reflects that the\n\n0\n\n5\n\n10\n\n15\n\n?2000\n\n?1000\n\n0\n\n1000\n\n2000\n\n\u00d7104\n\n\u00d7105\n\n\u00d7105\n\nt/s\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\nLO\n\nS \ndi\n\nst\nan\n\nce\n g\n\nra\ndi\n\nen\nt/(\n\nm\n/s\n\n)\n\n3.6\n25\n\n4\n3.6\n\n25\n5\n\n3.6\n25\n\n6\n3.6\n\n25\n7\n\n3.6\n25\n\n8\n3.6\n\n25\n9\n\n3.6\n26\n\n3.6\n26\n\n1\n3.6\n\n26\n2\n\n3.6\n26\n\n3\n3.6\n\n26\n4\n\n3.6\n25\n\n4\n3.6\n\n25\n5\n\n3.6\n25\n\n6\n3.6\n\n25\n7\n\n3.6\n25\n\n8\n3.6\n\n25\n9\n\n3.6\n26\n\n3.6\n26\n\n1\n3.6\n\n26\n2\n\n3.6\n26\n\n3\n3.6\n\n26\n4\n\n(a)\n\n(b)\n\nFig. 2.8 Line-of-sight distance and its gradient curve of two spacecrafts in the second rendezvous\n\n30 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nsemi-major axis of the orbit oscillates up and down with the fixed frequency and\namplitude; the long-term variation of the eccentricity is zero, so there is only the\nperiodic variation of the orbital eccentricity of the satellite and the first-order\nshort-period term is primary; the first-order long-term and second-order long-term\nitems of the orbital inclination are both 0 and its change has only periodic items,\nwhich specifically reflects that it fluctuates within a certain range. For the ascending\norbit with i \u00bc 63:43?, the first-order long-term item of the gradient of the longitude\nascending node is negative, that is, the earth oblateness perturbation will make the\nascending node westward with the order of magnitude 1\u00b0; when i \u00bc 63:43?, the\nlong-term effect of the earth oblateness on the perigee argument disappears, how-\never, due to the perturbation effect, the orbital inclination changes near the critical\ninclination and the perigee argument changes periodically around 180\u00b0.\n\nAccording to the simulation parameters used in the preliminary design, the\nperturbation is added in the Simulink model. The orbit parameters of the target\nspacecraft and the active spacecraft are shown in Table 2.8. Simulation time:\n450,000 s (about 5 days, rendezvous twice), simulation step: 2 s, the line-of-sight\ndistance, and its change rate of the two spacecrafts in rendezvous process within\n150 km can be obtained.\n\nFrom Figs. 2.9 and 2.10, it can be seen that during the first rendezvous, the\nshortcut point distance of the two spacecrafts is 50 km, and the distance of the two\nis within 150 km, the line-of-sight gradient changes gradually from ?2414 to\n2402 m/s and the rendezvous time is 112 s; during the second rendezvous, the\nshortcut point distance is 1300 km, which is much different from 55 km. This is\ndue to that the J2 perturbation is introduced in the model to make the designed\n\n1.787 1.788 1.789 1.79 1.791 1.792 1.793 1.794 1.795 1.796 1.797\n\nx 10\n4\n\n0\n\n5\n\n10\n\n15\nx 10\n\n4\n\n1.787 1.788 1.789 1.79 1.791 1.792 1.793 1.794 1.795 1.796 1.797\n\nx 10\n4\n\n-2000\n\n-1000\n\n0\n\n1000\n\n2000\n\nt /s\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\nLO\n\nS \ndi\n\nst\nan\n\nce\n g\n\nra\ndi\n\nen\nt/(\n\nm\n/s\n\n)\n\nFig. 2.9 Line-of-sight distance and its gradient curve of two spacecrafts in the first rendezvous\n\n2.4 Design of Apogee Rendezvous Orbit 31\n\n\n\nrendezvous orbit not achieve locking access, so it is necessary to correct the orbital\nparameters with taking the J2 perturbation into consideration.\n\n? Orbit parameters correction\n\nThe formula of the gradient of the perigee argument considering the J2 pertur-\nbation is\n\n_x \u00bc 3J2R\n2\nE\n\n2p2\nn\u00f02? 5\n\n2\nsin2 i\u00de \u00f02:31\u00de\n\nThe inclination is selected as 63.43\u00b0 to avoid the drift of the apse line and the drift\namount generated by earth oblateness perturbation is about ?4.7\u00b0. The orbital plane\ninevitably generates the precession due to the perturbation, and the rendezvous orbit\ncannot lock the geostationary orbit target due to the gradual westward receding. If\nthe orbit maneuvering method is used to adjust the longitude ascending node, it is\nnecessary to impose a considerable velocity increment in the direction perpendicular\nto the orbital plane which will cost a great cost in engineering. Therefore, reducing\nthe speed increment by adjusting the semi-major axis of orbit is considered.\n\nIt is supposed that the period of the locking orbit is T1 and the period of the\ntarget geostationary orbit is T0, and T1=T0 \u00bc 4=9. During the four days, the drift\namount of the longitude ascending node of the elliptical orbit is DX \u00bc _X ? 9T1,\nwhere _X is the average gradient of the longitude ascending node caused by the earth\noblateness perturbation.\n\n3.6236 3.6238 3.624 3.6242 3.6244 3.6246 3.6248\n\nx 10\n5\n\n1.33\n\n1.34\n\n1.35\n\n1.36\n\n1.37\nx 10\n\n6\n\n3.6236 3.6238 3.624 3.6242 3.6244 3.6246 3.6248\n\nx 10\n5\n\n-2000\n\n-1000\n\n0\n\n1000\n\n2000\n\nt /s\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\nLO\n\nS \ndi\n\nst\nan\n\nce\n g\n\nra\ndi\n\nen\nt/(\n\nm\n/s\n\n)\n\nFig. 2.10 Line-of-sight distance and its gradient curve of two spacecrafts in the second\nrendezvous\n\n32 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nSince the orbit plane precesses westward, the target geostationary satellite must\nsatisfy the following relation to make the active spacecraft rendezvous with the\ntarget at the equatorial plane:\n\nxE ? 9T1 \u00bc M2 ?M1 \u00f02:32\u00de\n\nwhere xE is the average orbit angular velocity of the stationary satellite; T1 is the\nperiod of the elliptical orbit; M1, M2 are the mean anomaly of the target satellite\nduring the first and second rendezvous, respectively.\n\nThe semi-major axis equation which satisfies the condition of the ascending\nnode changes can be obtained. Semi-major axis a = 24,547.897 km can be\nobtained by the Newton\u2019s iteration method, which is 8.5 km smaller than the initial\ndesigned value. The corresponding new orbital period is 38,279 s which is 17.6 s\nshorter than the initial Kepler orbital period 38,296.6 s and the correction amplitude\nis small, but it can compensate the influence of long-term precession.\n\nThe eccentricity is determined by the semi-major axis and the geocentric dis-\ntance of the apogee, where the semi-major axis has been modified and the geo-\ncentric distance of the apogee is still considered to be 55 km below the altitude of\nthe target spacecraft when it reaches the equatorial plane. Therefore, the eccentricity\nis recalculated and the eccentricity of the active spacecraft e is 0.7152, and the earth\noblateness perturbations have no long-term effects on the orbital eccentricity with\nonly the short-period fluctuations effect.\n\nConduct stimulation according to the modified orbit parameters mentioned\nabove to make the active spacecraft just below 55 km of the target spacecraft at the\ninitial time. Simulation time: 700,000 s (about 8 days, rendezvous three times),\nsimulation step: 2 s, the orbital parameters of the target spacecraft, and the target\nspacecraft are listed in Table 2.9.\n\nThe line-of-sight distance and its change rate of the two satellites within 150 km\nin rendezvous process can be got through the simulation, as shown in Figs. 2.11\nand 2.12.\n\nFrom Figs. 2.11 and 2.12, it can be seen during the second rendezvous, the\nshortcut point distance of two satellites is 111 km. During the third rendezvous, the\nshortcut point distance of two satellites is 200 km. Because theoretical correction is\nadopted in orbital parameters, the shortcut point distance of the second rendezvous\nand the third rendezvous are 111 and 200 km respectively, which has a gap from\nthe designed shortcut point distance of 55 km, manual correction needs to be\nconducted on the basis of the theoretical correction of orbital parameters, so as to fit\nthe designed requirement.\n\nTable 2.9 Orbit parameters of two spacecrafts after orbit correction\n\na (m) e i (\u00b0) X \u00f0?\u00de x (?) h (?)\nTarget 42,165,258 0.0005224 6.4954 63.8179 285.0568 74.9432\n\nChaser 24,556,497 0.7152 63.43 63.8179 180 180\n\n2.4 Design of Apogee Rendezvous Orbit 33\n\n\n\nDuring the second rendezvous, when the target spacecraft arrives at the equa-\ntorial plane, the phase of the active spacecraft is ahead of about 0.4\u00b0 and does not\nreach the equatorial plane at the same time. Because the orbital inclination of the\ntarget spacecraft is 6.4954\u00b0 and the orbital inclination of the active spacecraft is\n\n3.444 3.4442 3.4444 3.4446 3.4448 3.445 3.4452 3.4454 3.4456 3.4458 3.446\n0\n\n1\n\n2\n\n3\n\n3.444 3.4442 3.4444 3.4446 3.4448 3.445 3.4452 3.4454 3.4456 3.4458 3.446\n\n?2000\n\n?1000\n\n0\n\n1000\n\n2000\n\n\u00d7105\n\n\u00d7105\n\n\u00d7105\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\nLO\n\nS \ndi\n\nst\nan\n\nce\n g\n\nra\ndi\n\nen\nt/(\n\nm\n/s\n\n)\n\nt/s\n\n(a)\n\n(b)\n\nFig. 2.11 Line-of-sight distance and its gradient curve of two satellites in the second rendezvous\n\n6.889 6.8892 6.8894 6.8896 6.8898 6.89 6.8902 6.8904 6.8906 6.8908 6.891\n\nx 10\n5\n\n0\n\n1\n\n2\n\n3\n\nx 10\n5\n\n6.889 6.8892 6.8894 6.8896 6.8898 6.89 6.8902 6.8904 6.8906 6.8908 6.891\n\nx 10\n5\n\n-2000\n\n-1000\n\n0\n\n1000\n\n2000\n\nt /s\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n g\nra\n\ndi\nen\n\nt/(\nm\n\n/s\n)\n\nFig. 2.12 Line-of-sight distance and its gradient curve of two satellites in the third rendezvous\n\n34 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\n63.43\u00b0, there is a big difference between the orbital inclination of the target and the\nactive spacecraft. When phase difference exists between the two satellites, the\nshortcut point distance actually includes the out-of-plane distance, which leads to\nshortcut point distance of 110 km. Therefore, it can be considered that by\nincreasing the semi-major axis, the period of the active spacecraft can be longer,\nand the active spacecraft can reach the equatorial plane when the target spacecraft\nreaches the equatorial plane, so as to achieve the purpose of the rendezvous on the\nequatorial plane and meet the requirement of shortcut point distance. The simulated\ndistances of the two rendezvous by adding the semi-major axis are shown in\nTable 2.10.\n\nFrom Table 2.10, it can be seen that when the semi-major axis increases by\n2500 m, the shortcut point distance of the three times rendezvous are 50, 50.9, and\n54 km, respectively, and the rendezvous time is 110 s. So the performance of the\nvisiting orbit can be better improved with the modification of the semi-major axis to\nmeet the requirements of the shortcut point distance for each rendezvous.\n\n? Orbit Parameters Correction under Engineering Constraints\n\nConsidering the engineering index constraints of tracking unit, it is assumed that\nthe line-of-sight angle gradient is in the range of ?2 to +2 \u00b0/s and the line-of-sight\ndistance gradient is in the range of ?2 to +2 km/s.\n\n1. Primary method\n\nIf the active spacecraft is just below the target spacecraft in the rendezvous, it can\nensure that the distance between two satellites at the rendezvous point is the nearest,\nbut it will make the relative angle of two satellites changes rather greatly and\nrapidly, which makes the platform attitude control system difficult to track the\ntarget.\n\nWhen they rendezvous just at the apogee, the movement trend of the azimuth a\nin the vicinity of the rendezvous point is shown in Fig. 2.13.\n\nIt can be seen from Fig. 2.13 that due to the velocity of two satellites before and\nafter the rendezvous forms a fixed proportion, the azimuth is also a fixed value,\nhowever, there is a change of 180\u00b0 of azimuth of two satellites at the rendezvous\nmoment, and its gradient is also great.\n\nTable 2.10 Shortcut point distance under different correction values of the semi-major axis\n\nDa (m) e The shortcut point distance first\nintersection r1 (km)\n\nThe shortcut point distance\nsecond intersection r2 (km)\n\n500 0.715205 54 96\n\n1000 0.715210 53 81\n\n1500 0.715216 52 68\n\n2000 0.715222 51 57.8\n\n2500 0.715228 50 51\n\n3000 0.715234 49 49\n\n2.4 Design of Apogee Rendezvous Orbit 35\n\n\n\nThe change trend of the elevation angle of two satellites at the rendezvous point\nis shown in Fig. 2.14.\n\nIt can be seen that the theoretical value of the elevation angle is 90\u00b0 when it is\njust below the target spacecraft and its gradient is also great at this moment. Adopt\nthe set of initial orbital elements which is shown in Table 2.9 to make simulation\nand the simulation results show that when the two satellites are in the distance\nwithin 150 km, the line-of-sight distance gradient changes gradually from ?2420 to\n2420 m/s and the rendezvous time is 112 s; the azimuth changes from ?73\u00b0 to 71\u00b0\nand the maximum azimuth angular velocity is 2.9 \u00b0/s; elevation angle changes from\n?4.2\u00b0 to 14.2\u00b0 and the maximum elevation angle angular velocity is 0.27 \u00b0/s. The\nline-of-sight distance gradient and azimuth angular velocity are beyond the current\nability of the relative tracking equipments and attitude control system.\n\nFor the problems above, there are two kinds of conditions to optimize the design:\nOne is making the position of the target spacecraft lag a distance behind when the\nactive spacecraft reaches the apogee; another is ahead of a distance. They can\nimprove the azimuth gradient and pitch angle gradient of two satellites to reduce the\npressure on the attitude control system.\n\n2. Target lagging behind method\n\nThe principle of rendezvous process is shown in Fig. 2.15. It can be seen from\nFig. 2.15 that because the active spacecraft reaches the rendezvous point in\nadvance, making the azimuth gradient distributed in the whole rendezvous process,\n\nEquatorial plane\n\nTarget\n\nChaser\n\n?\n\n?\n\n?\n\n?\n\nOrbit plane of the chaserFig. 2.13 Change trend of\nazimuth in the vicinity of the\nrendezvous point\n\n<90\u00ba 90\u00ba <90\u00ba\n\nTarget\n\nChaser? ? ?\n\nFig. 2.14 Change trend of\nelevation angle in the vicinity\nof the rendezvous point\n\n36 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nthe minimum distance between two satellites also relatively increases, and the\nazimuth gradient will be significantly reduced. At the same time, because the target\nspacecraft does not appear above the active spacecraft, the elevation angle range\nwill become smaller and its gradient will be reduced. The method of target\nspacecraft lagging behind is shown in Fig. 2.16.\n\nBy selecting different orbital inclinations, the inclination which meets the\nshortcut point distance and the performance requirements of the tracking equipment\ncan be obtained. The simulation results are listed in Table 2.11.\n\nThe following conclusions can be obtained from Table 2.11:\n\n(1) When the active spacecraft arrives at the apogee and the phase of the target\nspacecraft lags 0.1\u00b0 behind, for the different orbital inclinations of the active\nspacecraft, the shortcut point distance can meet the requirement of 55 km and\nthe line-of-sight distance gradient can also satisfy the range between ?2 and\n2 km/s, but the maximum azimuth gradient is far beyond the performance index\n?2 to +2 \u00b0/s of tracking equipment.\n\nEquatorial plane\n\nTarget\n\nChaser\n\nOrbit plane of the chaser\n\n?\n\n?\n\n?\n\n?\n\nFig. 2.15 Change trend of the azimuth in the vicinity of the rendezvous point with the method of\ntarget spacecraft lagging behind\n\nO\n\nr\n\nGeostationary orbit satellite\n\nLarge elliptical satellite\n\nPerigee P of the chaser\n\nC\n\nPerigee P of the target \n\n?T\n\n?c\n\nIntersection point B \nof the target\n\nIntersection point B\u2019 \nof the chaser\n\nFig. 2.16 Method of target spacecraft lagging behind\n\n2.4 Design of Apogee Rendezvous Orbit 37\n\n\n\n(2) When the active spacecraft arrives at the apogee and the phase of the target\nspacecraft lags 0.2\u00b0 behind, for the different orbital inclinations of the active\nspacecraft, the maximum azimuth gradient is improved, but still cannot meet\nthe performance index of the tracking equipment, at the same time, the shortcut\npoint distance increases greatly, which cannot satisfy the requirement.\n\n(3) When the active spacecraft arrives at the apogee and the phase of the target lags 0.3\u00b0\nbehind, for the different orbital inclinations of the active spacecraft, the maximum\nazimuth gradient and the maximum elevation angle gradient can meet the\nrequirement of the range of the line-of-sight angle gradient. However, the increase\nof the shortcut point distance due to the large phase lagging behind cannot be\nignored, and the altitude of the apogee can be raised to meet the requirements of the\nshortcut point distance. Select the orbital inclination of the active spacecraft as 28.3\u00b0\nto make analysis. The access orbital performance corresponding to different apogee\naltitude of the active spacecraft is shown in Table 2.12.\n\nTable 2.11 Access orbital performance under different lagging behind phases and orbit\ninclinations\n\nPhase\nlagging\nbehind\n(\u00b0)\n\nOrbital\ninclination\nof chaser (\u00b0)\n\nShortcut\npoint\ndistance\n(m)\n\nLine-of-sight\ndistance\ngradient (m/s)\n\nMaximum\nazimuth\ngradient\n(\u00b0/s)\n\nMaximum\nelevation angle\ngradient (\u00b0/s)\n\n0.1 19 55.57 1508.7 11.8 1.3/1.298\n\n28.3 56.24 1660.8 8.3 1.28\n\n37.5 56.83 1864.8 7.58 1.33\n\n40.6 56.99 1941.9 7.55 1.37\n\n0.2 19 60.7 1508.4 3.5 0.81\n\n28.3 67.4 1660 2.47 0.62\n\n37.5 72.8 1863.68 2.25 0.558\n\n40.6 74.28 1940.7 2.24 0.551\n\n0.3 19 70.2 1507.7 2.06 0.52\n\n28.3 86.1 1658.7 1.45 0.33\n\n37.5 98.2 1861.8 1.32 0.27\n\n40.6 101.2 1938.8 1.31 0.26\n\nTable 2.12 Access orbit performance under different apogee altitude of the active spacecraft\n\nSpacecraft apogee\nbelow altitude of\ntarget (km)\n\nShortcut\npoint\ndistance (m)\n\nLine-of-sight\ndistance\ngradient (m/s)\n\nMaximum\nazimuth\ngradient (\u00b0/s)\n\nMaximum\nelevation angle\ngradient (\u00b0/s)\n\n55 86.1 1658.7 1.45 0.33\n\n34 68.3 1662 1.62 0.31\n\n24 60.8 1663.6 1.71 0.26\n\n20 58.1 1664.2 1.76 0.24\n\n15 55.03 1664.9 1.81 0.20\n\n14 54.4 1665 1.82 0.19\n\n38 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nAs can be seen from Table 2.12, the shortcut point distance can be effectively\nimproved by raising the altitude of the apogee. When the apogee altitude of the\nactive spacecraft is 15 km lower than the target spacecraft, the shortcut point dis-\ntance is 55.03 km and the maximum line-of-sight distance gradient is 1664.9 m/s,\nand the maximum azimuth gradient is 1.81 \u00b0/s, the maximum elevation angle\ngradient is 0.20 \u00b0/s, which meet the performance index of the tracker.\n\nIn order to reduce the azimuth gradient, the designed parameter of the elliptical\norbit is modified so that when the active spacecraft arrives at the apogee, the phase\nof the target lags 0.3\u00b0 behind and the nearest distance is still 55 km.\n\nAt this time, when the distance between the two satellites is within 150 km, the\nline-of-sight distance gradient changes from ?1664.9 to 1664.9 m/s and the total\ntime is 168 s. The azimuth changes from 20.3\u00b0 to 63.8\u00b0 and the maximum azi-\nmuthal angular velocity is 1.81 \u00b0/s; the elevation angle changes from 5.6\u00b0 to 16.5\u00b0\nand the maximum elevation angle angular velocity is 0.2 \u00b0/s. Using the rendezvous\npoint lagging behind method, the azimuth angular velocity and angular acceleration\nare small, which is conducive to normal operation of the relative tracking and the\nattitude control system.\n\n3. Target spacecraft forward method\n\nThe forward rendezvous process principle of the target spacecraft is shown in\nFig. 2.17.\n\nSimilarly, it can be seen that because the target spacecraft passes the rendezvous\npoint in advance, making the azimuth gradient distributed in the whole rendezvous\nprocess, the minimum distance between two satellites is also relatively increased\nand the azimuth gradient will be significantly reduced. At the same time, because\nthe target spacecraft does not appear above the active spacecraft, the elevation angle\nrange will become smaller and its gradient will be reduced. The target spacecraft\nforward method is shown in Fig. 2.18.\n\nThe designed method is the same as the method of target spacecraft lagging\nbehind, and the simulation results are listed in Table 2.13.\n\nFollowing conclusions can be drawn from Table 2.13:\n\n(1) When the active spacecraft arrives at the apogee and the phase of the target\nspacecraft is ahead of 0.1\u00b0, for the different orbital inclinations of the active\n\nEquatorial plane\n\nTarget\n\nChaser\n\nOrbit plane of the chaser\n\n?\n?\n\n?\n\n?\n\nFig. 2.17 Change trend of\nthe azimuth in the vicinity of\nthe rendezvous point of the\ntarget spacecraft with the\nforward method\n\n2.4 Design of Apogee Rendezvous Orbit 39\n\n\n\nspacecraft, the line-of-sight distance gradient can satisfy the range between ?2\nand 2 km/s, but the shortcut point distance and the maximum azimuth gradient\nare far beyond the performance index of ?2 to +2 \u00b0/s of a tracking equipment.\n\n(2) When the active spacecraft arrives at the apogee and the phase of the target\nspacecraft is head of 0.2\u00b0, for the different orbital inclinations of the active\nspacecraft, the maximum azimuth gradient is improved to meet the requirement\nof the performance index of the tracking equipment. However, the shortcut\npoint distance increases greatly, which cannot meet the requirements, so the\naltitude of the apogee can be raised to meet the requirements of the shortcut\npoint distance. Select the orbital inclination of the elliptical orbit as 28.3\u00b0 to\nmake analysis. The access orbital performance corresponding to different alti-\ntude apogee of the active spacecraft is shown in Table 2.14.\n\nIt can be seen that by raising the apogee altitude, the shortcut point distance can\nbe effectively improved. When the apogee altitude of the active spacecraft is 21 km\nlower than the target spacecraft, the shortcut point distance is 55.2 km, the\n\nO\n\nr\n\nGeostationary orbit satellite\nLarge elliptical satellite\n\nPerigee P of the\nchaser\n\nC\n\nPerigee P of the target \n\n?T\n\n?cIntersection point B\nof the target\n\nIntersection\npoint B\u2019 of\nthe chaser\n\nFig. 2.18 Target spacecraft forward method\n\nTable 2.13 Access orbital performance under different forward phases and orbit inclinations\n\nOrbital\ninclination\nof chaser (\u00b0)\n\nShortcut\npoint\ndistance\n(m)\n\nLine-of-sight\ndistance\ngradient (m/s)\n\nMaximum\nazimuth\ngradient\n(\u00b0/s)\n\nMaximum\nelevation angle\ngradient (\u00b0/s)\n\nPhase\nforward\n0.1\u00b0\n\n19 61.7 1508 3.16 0.75\n\n28.3 69.8 1659 2.23 0.55\n\n37.5 76.3 1863 2.03 0.48\n\n40.6 77.9 1940 2.02 0.47\n\nPhase\nforward\n0.2\u00b0\n\n19 71.7 1507 1.93 0.47\n\n28.3 89.2 1658.4 1.36 0.29\n\n37.5 102.4 1861.5 1.24 0.24\n\n40.6 105.7 1938 1.23 0.23\n\n40 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nmaximum line-of-sight distance gradient is 1411 m/s, the maximum azimuth gra-\ndient is 1.7 \u00b0/s, and the maximum elevation angle gradient is 0.24 \u00b0/s, which meet\nthe performance index of tracking equipment. The apogee altitude is 35,760 km,\nthe perigee altitude is 596 km, the nearest distance between the two satellites is\n55 km, and when the active spacecraft reaches the apogee, the phase of the target\nspacecraft is ahead of 0.2\u00b0.\n\nIt can be seen from the simulation, when the distance between the two satellites\nis within 150 km, the line-of-sight distance gradient gradually changes from ?1411\nto 1409.8 m/s and the total time is 184 s; the azimuth changes from ?134\u00b0 to 6.1\u00b0\nand the maximum azimuthal angular velocity is 1.7 \u00b0/s; the elevation angle changes\nfrom 9.5\u00b0 to 23.8\u00b0, and the maximum elevation angle angular velocity is 0.24 \u00b0/s.\nUsing the intersection point forward method, the azimuth angular velocity and\nangular acceleration are small, which is conducive to the normal operation of\nrelative tracking and the attitude control system.\n\n(4) Method comparison\n\nIn contrast to the preliminary methods described above, the lagging behind and\nforward optimization methods, the line-of-sight distance gradient, the line-of-sight\nangle gradient, and the rendezvous time are compared, as listed in Table 2.15.\n\nIt can be seen from the Table 2.15 that the maximum line-of-sight angle gradient\nwith the preliminary method is 12.8 \u00b0/s, under which, the relative device cannot\nachieve the line-of-sight tracking for the target spacecraft; by offsetting the ren-\ndezvous point, the lagging behind method and forward method can keep the\n\nTable 2.14 Access orbit performance under different apogee altitude of the active spacecraft\n\nActive spacecraft\napogee below target\norbital height (km)\n\nShortcut\npoint\ndistance\n(m)\n\nLine-of-sight\ndistance\ngradient (m/s)\n\nMaximum\nazimuth\ngradient (\u00b0/s)\n\nMaximum\nelevation angle\ngradient (\u00b0/s)\n\n55 89.2 1658.4 1.36 0.29\n\n21 55.2 1513 1.7 0.27\n\nTable 2.15 Index comparison of rendezvous methods\n\nSystem\nmethod\n\nLine-of-sight\ndistance gradient\n(m/s)\n\nMaximum\nazimuth\ngradient (\u00b0/s)\n\nMaximum\nelevation angle\ngradient (\u00b0/s)\n\nRendezvous\ntime (s)\n\nPreliminary\nmethod\n\n1660 12.8 1.4 167\n\nLagging\nbehind\nmethod\n\n1664.9 1.81 0.2 168\n\nForward\nmethod\n\n1411 1.7 0.24 184\n\n2.4 Design of Apogee Rendezvous Orbit 41\n\n\n\nline-of-sight distance gradient unchanged, and the rendezvous time of target\nspacecraft entering the distance within 150 km only changes a little, even if the\nposition of the target spacecraft lagging behind or advancing a certain distance,\nhowever, the maximum azimuth angle gradient and the elevation angle gradient are\ngreatly reduced, which meets the ?2 to +2 \u00b0/s range of line-of-sight angle gradient\nof the tracking device. Therefore, in the case of stable line-of-sight tracking, the relative\ntracking device can capture the target within the range of attitude control accuracy. By\ncomparing the technical indexes of lagging behind method and forward method, the\nlatter is suitable to be used as the design method of the elliptical orbit.\n\n2.4.3 Design of Little Inclination Elliptical Orbit\n\nIn the design task of the frozen elliptical orbit, when the target spacecraft operates\nfour loops, the active spacecraft operates nine loops and locking access to the\ngeostationary satellite can be achieved. This method can not only ensure locking\naccess to the geostationary satellite, but also locking access to the low-orbit sun\nsynchronous orbit satellite. But achieving rendezvous with the geostationary every\n4 days is difficult to meet the actual task requirements, so one day can be chosen to\nachieve the rendezvous with the geostationary orbit. At this time, the elliptical\norbital period is approximately 12 h and the period ratio is about 2:1.\n\n(1) Initial orbital design\n\nIt is supposed that the semi-major axis of the geostationary orbit r =\n421,65.258 km, the apogee rp of the elliptical orbit is just below the geostationary\norbit, and rp = 42,110.258 km. Because the period ratio of the geostationary orbit to\nthe elliptical orbit is 2:1, then the semi-major axis of the large elliptical orbit is\na = 2?2/3, r = 26,562.448 km and the perigee altitude of the large elliptical orbit is\nabout 4642.38 km, the eccentricity e = (p ? a)/a = 0.58533 can be calculated by\nthe apogee and semi-major axis of the elliptical orbit.\n\nThe orbital inclination of the geostationary orbit satellite is 0\u00b0, so the elliptical\norbit inclination is also selected to be 0\u00b0 for the convenience of the rendezvous with\nthe geostationary orbit.\n\nIn order to ensure that the apogee of the active spacecraft rendezvous with the\ntarget spacecraft in the equatorial plane, the two satellites are taken the same\nlongitude ascending node X and the perigee argument should be 0\u00b0 or 180\u00b0. The\nperigee argument of the elliptical orbit satellite is designed to be 180\u00b0, because the\nperigee argument of the geostationary orbit satellite is usually 180\u00b0.\n\nThe designed initial orbital elements of the two satellites are shown in\nTable 2.16.\n\n42 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\n(2) Drift Characteristics analysis of the Small Inclination Elliptical Orbit\n\nThrough the drift characteristic analysis of the elliptical orbit, it can be seen that the\nelliptical orbit involves a complex spatial environment and is influenced by the\nperturbation factors such as non-spherical gravitational force, atmospheric drag, the\nlunisolar gravitational, and sun radiation pressure. The earth oblateness perturbation\nis the main perturbation factor, which plays a decisive role in the long-term drift and\nshort-period vibration of the orbit.\n\nAtmospheric drag perturbation has effect on the orbital motion only at orbital\naltitude below 1000 km, because the orbital height of the elliptical orbit satellite is\nabout 4642.38 km, which is much larger than 1000 km. At this time, the influence\nof atmospheric drag perturbation can be neglected.\n\nThe order of magnitude of the lunisolar gravitational force perturbation in the\nhigh orbit is close to J2 perturbation, which has a long-term impact on the elliptical\norbit. But the sun radiation pressure perturbation is generally smaller at least one\norder of magnitude than the lunisolar gravitational force perturbation, and the effect\nis far less than J2 perturbation in the elliptical orbit mission. In this case, the\nlunisolar gravitational force perturbation can be considered alone to obtain more\naccurate design results.\n\nIn summary, only the earth oblateness perturbation and the lunisolar gravita-\ntional force perturbation are considered in the design of the access orbit.\n\nUnder the influence of J2 perturbation, the semi-major axis, eccentricity, and\norbital inclination of the elliptical orbit are periodically changed, where the range of\nthe semi-major axis is 26,555\u201326,578 km and the variation range is about 23 km;\nthe range of the eccentricity is 0.58518\u20130.58568, and the variation range is about\n0.0005; the eccentricity changes very small, and its effect on the elliptical orbit can\nbe neglected. The longitude ascending node of the elliptical orbit is reduced from\n63.82\u00b0 to 63.64\u00b0 at 120,000 s (about 9 days); the perigee argument is increased\nfrom 180\u00b0 to 180.33\u00b0.\n\nTherefore, under the influence of J2 perturbation, the semi-major axis, eccentricity\nand orbital inclination of the elliptical orbit show a periodic change. The longitude\nascending node of the small inclination changes largely and will gradually decrease; the\nperigee argument also changes largely and will gradually increase.\n\n(3) The line-of-sight distance and line-of-sight angle curve during the rendezvous\nat the apogee of the small inclination satellite\n\n1. Regardless of the orbit perturbation\n\nIt is assumed that the initial orbital elements of two satellites are listed in\nTable 2.16, the simulation time is 120,000 s, regardless of any perturbation impact,\n\nTable 2.16 Initial orbital elements\n\nOrbital elements a (m) e i (\u00b0) X \u00f0?\u00de x (?) h (?)\nTarget 42,165,258 0.0005224 0 63.8179 285.0568 0\n\nChaser 26,562,448 0.58533 0 63.8179 180 94.4\n\n2.4 Design of Apogee Rendezvous Orbit 43\n\n\n\nand the simulation of the line-of-sight distance and its gradient are shown in\nFigs. 2.19 and 2.20 during the two intersections.\n\nIt can be seen from Figs. 2.19 and 2.20 that when the distance between the two\nsatellites is within 150 km during two rendezvous, the line-of-sight distance gra-\ndient changes from ?1022.6 to 1020.6 m/s and the rendezvous time is 256 s.\nAccording to the orbital parameters of the preliminary design, it can achieve that the\nactive spacecraft rendezvous with the target spacecraft for one time when operates\nevery two loops and the shortcut point distance is 54 km, which satisfies the\ndistance requirements.\n\n2. Consider J2 perturbation\n\nThe initial orbital elements of the two satellites are shown in Table 2.16. The\nsimulation time is 120,000 s (step is 1 s). The J2 item is the main perturbation for\nthe geostationary orbit satellite and the elliptical satellite, so the line-of-sight dis-\ntance and its gradient of two satellites curve under the J2 perturbation during the\nrendezvous are considered.\n\nIt can be seen from Figs. 2.21, 2.22, 2.23, and 2.24 that the line-of-sight gradient\nchanges gradually from ?997 to 994 m/s during the first rendezvous within 150 km\nand the rendezvous time is 250 s. Because of the J2 perturbation, the shortcut point\ndistance is 62 km which has a big difference from the 55 km. During the second\nrendezvous, when the distance between the two satellites is within 150 km, the\nline-of-sight gradient is gradually from ?1007 to 1005 m/s. The rendezvous time is\n252 s, and the shortcut point distance is 58.9 km.\n\n1.76 1.765 1.77 1.775 1.78 1.785 1.79\n\nx 10\n4\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n5\n\n1.76 1.765 1.77 1.775 1.78 1.785 1.79\n\nx 10\n4\n\n-2000\n\n-1000\n\n0\n\n1000\n\n2000\n\nt (s)\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\nLO\n\nS \ndi\n\nst\nan\n\nce\n g\n\nra\ndi\n\nen\nt/(\n\nm\n/s\n\n)\n\nFig. 2.19 Line-of-sight distance and its gradient of two satellites during the first rendezvous\n\n44 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nIt can be seen that J2 perturbation makes the shortcut point distance reduce\n3.1 km in one period of a geostationary orbit from the first rendezvous to the\nsecond rendezvous, so the two satellites will become gradually closer without the\norbital control.\n\n1.0375 1.038 1.0385 1.039 1.0395 1.04 1.0405\n\nx 10\n5\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n5\n\n1.0375 1.038 1.0385 1.039 1.0395 1.04 1.0405\n\nx 10\n5\n\n-2000\n\n-1000\n\n0\n\n1000\n\n2000\n\nt (s)\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n g\nra\n\ndi\nen\n\nt/(\nm\n\n/s\n)\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\n\nFig. 2.20 Line-of-sight distance and its gradient of two satellites during the second rendezvous\n\n1.76 1.765 1.77 1.775 1.78 1.785 1.79\n\nx 10\n4\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n5\n\n1.76 1.765 1.77 1.775 1.78 1.785 1.79\n\nx 10\n4\n\n-1000\n\n-500\n\n0\n\n500\n\n1000\n\nt /s\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n g\nra\n\ndi\nen\n\nt/(\nm\n\n/s\n)\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\n\nFig. 2.21 Line-of-sight distance and its gradient of two satellites during the first rendezvous\n\n2.4 Design of Apogee Rendezvous Orbit 45\n\n\n\nDuring two rendezvous of two satellites, the line-of-sight gradient is less than\n0.1 \u00b0/s, which can meet the requirement of line-of-sight angle gradient. The azimuth\nof the two satellites during the two rendezvous is almost zero, and the elevation\n\n1.76 1.765 1.77 1.775 1.78 1.785 1.79\n\nx 10\n4\n\n-100\n\n-50\n\n0\n\n50\n\n100\n\n(\u00b0\n)\n\n1.76 1.765 1.77 1.775 1.78 1.785 1.79\n\nx 10\n4\n\n-5\n\n0\n\n5\n\n10\nx 10\n\n-3\n\n(\u00b0\n)\n\nt /s\n\nel\nev\n\nat\nio\n\nn \nan\n\ngl\ne/\n\nA\nzi\n\nm\nut\n\nh/\n\nFig. 2.22 Elevation and azimuth change of two satellites during the first rendezvous\n\n1.039 1.0395 1.04 1.0405 1.041 1.0415 1.042\n\nx 10\n5\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n5\n\n1.039 1.0395 1.04 1.0405 1.041 1.0415 1.042\n\nx 10\n5\n\n-2000\n\n-1000\n\n0\n\n1000\n\n2000\n\nt (s)\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n g\nra\n\ndi\nen\n\nt/(\nm\n\n/s\n)\n\nLO\nS \n\ndi\nst\n\nan\nce\n\n/m\n\nFig. 2.23 Line-of-sight distance and its gradient of two satellites during the second rendezvous\n\n46 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nangle is in the range of 50\u00b0 and 90\u00b0, so the orbital prediction is required, so as to\nmake attitude adjustment in advance, making the device track the target spacecraft.\n\nSince the small inclination elliptical orbit is almost coplanar with the geosta-\ntionary orbit, the relative line-of-sight distance gradient of the two satellites during\nrendezvous is in the range of 1000 m/s, which can meet the index requirement of\nthe tracking characteristic. At this time, it is not necessary to adopt the forward\nmethod or the lagging behind method. But the orbital correction is required over\nevery loop to meet the requirement of 55 km shortcut point distance.\n\nCompared with the frozen elliptical orbit, the gradient of line-of-sight distance\nand the relative angular velocity of small inclination elliptical orbit change larger;\nhowever, orbital drift problem also exists, which will change apse line of elliptical\norbit, making locking access to the geostationary orbit difficult. However, the drift\ncharacteristics can be used to achieve the inspection of the high-orbit satellites, and\norbital maneuvering can also be used to achieve the observation and rendezvous\nover the fixed geostationary satellite.\n\n2.5 Elliptical Orbit Rendezvous Method for Inspecting\nGEO Satellites\n\nGenerally, the solution for effectively approach and close observation over multiple\ntarget satellites on the same circular orbit with single elliptical orbit satellite is\nrealizing rendezvous with target spacecraft by adopting multiple large space\nmaneuvers and the relative motion control. This method has the shortcomings such\n\n1.039 1.0395 1.04 1.0405 1.041 1.0415 1.042\n\nx 10\n5\n\n-100\n\n-50\n\n0\n\n50\n\n100\n\n1.039 1.0395 1.04 1.0405 1.041 1.0415 1.042\n\nx 10\n5\n\n-0.02\n\n0\n\n0.02\n\n0.04\n\nt /s\n\n(\u00b0\n)\n\n(\u00b0\n)\n\nel\nev\n\nat\nio\n\nn \nan\n\ngl\ne/\n\nA\nzi\n\nm\nut\n\nh/\n\nFig. 2.24 Elevation and azimuth change of two satellites during the second rendezvous\n\n2.4 Design of Apogee Rendezvous Orbit 47\n\n\n\nas much fuel consumption and the heavy ground monitoring and control system\nburden. By changing the elliptical apse line to achieve the sequential rendezvous of\nmulti-satellite on the same orbital plane, then, fuel consumption of the target\nsatellite will be relatively small.\n\nIn this section, based on the design of single-objective access orbit, the problems\nof the orbital design and control for the different geostationary orbit targets are\nstudied. The single satellite can change the longitude ascending node of the ellip-\ntical orbital satellite, that is the apse line by orbit maneuver and achieve a locking\naccess on multiple targets, which is shown in Fig. 2.25.\n\nThere are two ways to change the apse line: One is to apply the velocity\nincrement, which is perpendicular to the orbital plane to change the longitude\nascending node, the other is to adjust the phase by raising or lowering the orbit.\n\nThe method of applying the velocity increment, which is perpendicular to the\norbital plane to change the longitude ascending node regards the applied velocity\nincrement as the product of the perturbation acceleration f and the time interval Dt,\nthat is Dv \u00bc fDt, so the perturbation differential equations are:\n\nDX \u00bc 1ffiffiffiffilpp sin i r sin\u00f0x\u00fe h\u00de ? Dvh\nDi \u00bc 1ffiffiffiffilpp r cos\u00f0x\u00fe h\u00de ? Dvh\n\n(\n\u00f02:33\u00de\n\nFrom the Formula (2.33), it can be seen that the velocity increment Dvh for\nchanging the longitude ascending node substantially is quite large, which is difficult\nto achieve directly in engineering and also causes the change of the other orbital\nelements such as the orbital inclination.\n\nThe method of phase adjustment by raising or lowering the orbit is realizing\nphase adjustment by applying tangential velocity increment Dvt on the perigee and\napogee respectively to adjust the semi-major axis, which does not change the orbital\ninclination i and the perigee argument x. As shown in Fig. 2.26, orbit 0 is the\ngeostationary orbit, orbit 3 is the working orbit of the access spacecraft. After the\nelapse of time Dt, the satellite moves from point D to point H by the\nphase-adjustment maneuvering, and during the time, the geostationary orbital\n\ndesigned \norbit\n\nGEO orbit\n\nObservation spacecraft \nGEO satellite\n\nFig. 2.25 Change the\nlongitude position of the\napogee\n\n48 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nsatellite operates N loops. Orbit 1 is the transfer orbit of hysteretic adjustment, and\nOrbit 2 is the transfer orbit of advanced adjustment.\n\nVelocity increment (sum of Dv1 and Dv2 in Fig. 2.26) required by semi-major\naxis of elliptical orbit, period of elliptical orbit, rendezvous time, and the whole\nrendezvous process corresponding to different N values under the two\nphase-adjustment transfer strategies when phase difference is 90\u00b0 (the target satellite\nlags behind) is simulated. It is assumed that the orbital radius of the target satellite is\n42165.8 km, and the large elliptical orbital period is half of the target satellite,\nwhich are listed in Table 2.17.\n\nBy comparing the data in Table 2.17, it can be seen that under the same\nmaneuvering time, the velocity increment required by advanced adjustment using\nthe Orbit 2 is lower.\n\nSimilar to the simulation above, the velocity increment (sum of Dv1 and Dv2 in\nFig. 2.26) required by semi-major axis of elliptical orbit, period of elliptical orbit,\nrendezvous time, and the whole rendezvous process corresponding to different\nN value under the two phase-adjustment transfer strategies when phase difference is\n45\u00b0 (the target satellite lags behind) is calculated, which are listed in Table 2.18.\n\nBy comparing the data in Table 2.18, it can be seen that under the same\nmaneuvering time, the velocity increment required by lagging behind adjustment\nusing Orbit 1 is lower.\n\nThe velocity increment (sum of Dv1 and Dv2 in Fig. 2.26) required by the\nsemi-major axis of elliptical orbit, period of elliptical orbit, rendezvous time, and\nthe whole rendezvous process corresponding to different N value under the two\nphase-adjustment transfer strategies when phase difference is ?45\u00b0 (the target\nsatellite is in advance) are listed in Table 2.19.\n\nFig. 2.26 Method of\nchanging longitude location\nof apogee of spacecraft\n\n2.5 Elliptical Orbit Rendezvous Method for Inspecting GEO Satellites 49\n\n\n\nIn Table 2.19, N represents the loop numbers before adjustment and N1 repre-\nsents the ones after adjustment. By comparison, it can be seen that under the same\nmaneuvering time, the velocity increment required by lagging behind adjustment\nusing the Orbit 1 is lower.\n\nBy comparing the simulation of different phase difference, it can be seen that\nunder the condition that target satellite lags behind, the velocity increment required\nby advanced adjustment using the Orbit 2 is lower when the phase difference\nbetween the two spacecrafts is large. The velocity increment required by lagging\nbehind adjustment using Orbit 1 is lower when the phase difference between the\ntwo spacecrafts is small. The conclusion is opposite under the condition that the\ntarget satellite is in advance.\n\nTable 2.17 Raising and lowering orbit adjustment maneuvering simulation results when phase\ndifference is 90\u00b0\n\nHoisting the orbit Lowering the orbit\n\nN a1 (km) T (h) Dt (h) Dv (m/s) a1 (km) N1 (h) Dt (h) Dv (m/s)\n\n1 34,807 17.95 29.92 460.79 21,927 8.98 29.92 423.43\n\n2 29,438 13.96 53.86 191.67 24,300 10.47 53.86 185.00\n\n3 28,305 13.16 77.79 121.10 25,066 10.97 77.79 118.41\n\n4 27,813 12.82 101.73 88.52 25,444 11.22 101.73 87.08\n\n5 27,538 12.63 125.66 69.76 25,670 11.37 125.66 68.86\n\n6 27,362 12.51 149.60 57.56 25,820 11.47 149.60 56.94\n\n7 27,240 12.43 173.54 49.99 25,927 11.54 173.54 48.55\n\n8 27,150 12.37 197.47 42.64 26,006 11.59 197.47 42.31\n\n9 27,081 12.32 221.40 37.75 26,069 11.64 221.41 37.49\n\n10 27,027 12.28 245.34 33.87 26,118 11.67 245.34 33.65\n\nTable 2.18 Raising and lowering adjustment maneuvering simulation results when phase\ndifference is 45\u00b0\n\nHoisting the orbit Lowering the orbit\n\nN a1 (km) N1 (h) Dt (h) Dv (m/s) a1 (km) N1 (h) Dt (h) Dv (m/s)\n\n1 30,823 14.96 26.93 270.58 19,418 7.48 26.93 745.00\n\n2 28,019 12.97 50.86 102.28 23,129 9.72 50.86 296.09\n\n3 27,441 12.57 74.80 63.07 24,300 10.47 74.80 185.00\n\n4 27,192 12.40 98.74 45.60 24,876 10.85 98.74 134.55\n\n5 27,052 12.30 122.67 35.70 25,217 11.07 122.67 105.73\n\n6 26,964 12.24 146.61 29.34 25,444 11.22 146.61 87.08\n\n7 26,902 12.20 170.54 24.90 25,605 11.33 170.54 74.02\n\n8 26,857 12.17 194.48 21.63 25,726 11.41 194.48 64.37\n\n9 26,823 12.14 218.41 19.12 25,820 11.47 218.41 56.94\n\n10 26,795 12.13 242.35 17.13 25,894 11.52 242.35 51.06\n\n50 2 Orbit Design of Spacecraft on Elliptical Orbit\n\n\n\nReferences\n\n1. LU Shan, XU Xu, WU Hai-lei. A High Precision Attitude Tracking Control Method for\nHighly Eccentric Orbit Spacecraft Rendezvous with a HEO Target [C]. The 16th Conference\non Space and Motion Control Technology, 2014: 288\u2013293.\n\n2. Xi Xiaoning, Wang Wei. Near-Earth Spacecraft Orbital Foundation [M]. Changsha: National\nUniversity of Defense Technology Press, 2003.\n\n3. Montenbruck O, Gill E. State Interpolation for on Board Navigation Systems [J]. Aerospace\nScience and Technology, 2001(5): 209\u2013220.\n\n4. Hoots F R, Roehrich R L. Spacetrack Report No.3 [C]. AIAA/AAS Astrodynamics Specialist\nConference, 2006: 1984\u20132071.\n\n5. Meng Bo, Han Chao. Development of Simulation Software for High Precision Spacecraft\nOrbit Prediction [J]. Computer Simulation, 2008, 25 (1): 62\u201365, 73.\n\n6. Meng Zhanfeng. Vinti Multi-conic Prediction Method for the Earth-Moon Transfer\nTrajectories [J]. Science and Technology Review, 2008, 26 (4): 47\u201351.\n\n7. Bettis D G. A Runge-kutta Nystrom Algorithm [C]. Conference on Celestial Mechanics,\n1972: 229\u2013233.\n\n8. Rim H J, Schutz B E, Webb C. Orbit Maintenance and Characteristics for a Sar Satellite [C].\nAIAA/AAS Astrodynamics Specialist Conference and Exhibit, 1998: AIAA\u201398\u20134394.\n\n9. Yang Weilian. Long-term Evolution and Control for Synchronous and Recursive Orbit [J].\nSpacecraft Engineering, 2008, 17 (2): 26\u201330.\n\n10. Soop E M. Handbook of Geostationary orbit [M]. Kluwer Academic, 1994.\n\nTable 2.19 Hoisting and lowering adjustment transfer simulation results when phase difference is\n?45\u00b0\n\nHoisting the orbit Lowering the orbit\n\nN a1 (km) N1 (h) Dt (h) Dv (m/s) N1 a1 (km) N1 (h) Dt (h) Dv (m/s) N1\n1 ? ? ? ? ? 21,927 8.98 20.94 423.43 1\n2 36,715 19.45 50.86 536.62 2 2.5066 10.97 44.88 118.41 3\n\n3 31,842 15.71 74.80 324.00 4 25,670 11.37 68.82 68.86 5\n\n4 30,135 14.46 98.74 232.31 6 25,927 11.54 92.75 48.55 7\n\n5 29,262 13.84 122.67 181.11 8 26,069 11.64 116.69 37.49 9\n\n6 28,733 13.46 146.61 148.42 10 26,159 11.70 140.62 30.53 11\n\n7 28,377 13.21 170.54 125.73 12 26,221 11.74 164.56 25.75 13\n\n8 28,121 13.04 194.48 109.06 14 26,267 11.77 188.49 22.27 15\n\n9 27,929 12.90 218.41 96.29 16 26,302 11.79 212.43 19.62 17\n\n10 27,779 12.80 242.35 86.20 18 26,329 11.81 236.37 17.53 19\n\nReferences 51\n\n\n\nChapter 3\nFormation Configuration Design\nof Elliptical Orbit\n\n3.1 Introduction\n\nIn Chap. 2, we introduced design methods of large elliptical orbit for different\nmission requirements with examples, which are aimed at the orbit of the single\nspacecraft. In this chapter, we will introduce the orbit design method of the\nmulti-spacecraft formation in the elliptical orbit, that is, the relative configuration\ndesign method of the formation flight.\n\nDifferent from the formation on the circle orbit, the orbit angular velocity is\ntime-varying on the elliptical orbit, and the dynamic equation is a time-varying\ndifferential equation. Therefore, the formation configuration on the elliptical orbit is\nmuch more complex than the circular orbit. From the algebraic method, there is no\ntime variable in the C-W equation. Therefore, as long as the initial relative motion\nstate satisfies the formation condition, the state is invariant regardless of the per-\nturbation effect, but time variable exists in the elliptical orbit relative motion\nequation, the relative position and the true anomaly are corresponding one by one,\nso the conditions for forming the formation are more stringent. From the geometric\nanalysis, the spacecraft operating angular velocity is unchanged on the circle orbit,\nand the true anomaly difference between two spacecrafts keeps the same; it is only\nnecessary to adjust the difference of the other orbit elements, but the difference\nbetween the true anomaly of the active spacecraft and the target star on the elliptical\norbit is changing with time, and analyzing by the relative orbit elements is much\nmore complicated. So, it is necessary to study the design problem of formation\nconfiguration on elliptical orbit.\n\nBasing on the basic motion equations described by the absolute position vector\nof two spacecrafts, the algebraic methods establish the relative motion model in the\ncoordinate system with assumption and simplification. The formation configuration\ndesign by geometric method is based on the relative motion equation expressed by\nthe difference of the classical orbit elements. In this chapter, the formation\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_3\n\n53\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_3&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_3&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_3&amp;domain=pdf\n\n\nconfiguration on elliptical orbit is designed according to the algebraic method and\nthe geometric method, respectively.\n\nFirstly, based on the algebraic method, the kinematic equation-based relative\nmotion model, which is suited for any eccentricity reference orbit is deduced, and\nthe initial conditions, under which, the relative motion trajectory of the two\nspacecrafts without perturbation is shown as periodic space closed curve, the for-\nmation configuration design of fly-around and accompanying flying are given.\nThen, based on the geometric method, the accurate relative motion model of\nelliptical orbit and the first-order approximate relative motion model suitable for the\nshort-range formation are given. On this basis, three typical formation configura-\ntions of straight line, circle, and ellipse are designed, respectively.\n\n3.2 Formation Configuration Design Based\non Algebraic Method\n\n3.2.1 Relative Dynamic Equation\n\n1. Coordinate system definition\n\nIt is necessary to describe space relative position and relative velocity vector\ninformation between the target spacecraft and the active spacecraft to establish the\norbit dynamic model. Therefore, it is necessary to select the appropriate reference\ncoordinate system.\n\n(1) J2000 geocentric inertial coordinate system Si\n\nThe origin of the coordinate system is defined in the earth\u2019s center of mass, the\nx-axis points to the J2000.0 mean equinox, and the z-axis points to the J2000.0\nmean celestial pole; the y-axis and the x-axis form the right-hand coordinate system.\n\n(2) Centroid orbit coordinate system So\n\nThe origin is in the spacecraft centroid, the z-axis points to the earth along the radial\ndirection, the x-axis is perpendicular to the z-axis and along the velocity direction,\nand the y-axis complies with the right-hand rule, that is, along the negative normal\ndirection of the orbit plane.\n\n2. Relative orbital dynamics\n\nConsider the absolute orbit dynamic equation in the J2000 geocentric inertial\ncoordinate system as follows:\n\n54 3 Formation Configuration Design of Elliptical Orbit\n\n\n\ndvx\ndt \u00bc ?\n\nl\nr3 x\u00fe fx; dxdt \u00bc vx\n\ndvy\ndt \u00bc ?\n\nl\nr3 y\u00fe fy; dydt \u00bc vy\n\ndvz\ndt \u00bc ?\n\nl\nr3 z\u00fe fz; dzdt \u00bc vz\n\nr \u00bc x2 \u00fe y2 \u00fe z2\u00f0 \u00de1=2\n\n8>>>>><\n>>>>>:\n\n\u00f03:1\u00de\n\nwhere x, y, z are the position component of the spacecraft, vx, vy, vz are the speed\ncomponent of the spacecraft, fx, fy, fz are variety of disturbing force acceleration and\nactive control of acceleration that the spacecraft suffered, and l is the earth\u2019s\ngravitational constant.\n\nIn the target spacecraft orbit coordinate system, the relative motion equation of\nthe two spacecrafts is expressed in the form of vector\n\nd2Dr\ndt2\n\n\u00bc d\n2rc\ndt2\n\n? d\n2rt\ndt2\n\n\u00bc ? l\nr3c\nrc \u00fe l\n\nr3t\nrt \u00fe u \u00f03:2\u00de\n\nwhere rt and rc are the position vector of the target spacecraft and the active\nspacecraft relative to the earth, respectively, Dr is the position vector of the active\nspacecraft relative to the target spacecraft, u is the control acceleration of the active\nspacecraft, and l is the earth\u2019s gravitational constant.\n\nAccurate two spacecrafts\u2019 relative dynamic equation is obtained by expanding\nFormula (3.2) in the target spacecraft orbit coordinate system\n\n\u20acx? 2 _h_z? \u20achz? _h2x \u00bc ? lx\u00bd\u00f0rt?z\u00de2 \u00fe y2 \u00fe x2?3=2 \u00fe ux\n\u20acy \u00bc ? ly\u00bd\u00f0rt?z\u00de2 \u00fe y2 \u00fe x2?3=2 \u00fe uy\n\u20acz\u00fe 2 _h_x\u00fe \u20achx? _h2z \u00bc l\u00f0rt?z\u00de\u00bd\u00f0rt?z\u00de2 \u00fe y2 \u00fe x2?3=2 ?\n\nl\nr2t\n\u00fe uz\n\n8>><\n>>: \u00f03:3\u00de\n\nwhere _h is the true anomaly angular velocity of the target spacecraft, \u20ach is true\nanomaly angular acceleration, and x, y, z are the relative position between the target\nspacecraft and the active spacecraft.\n\nSince the relative distance between the two spacecrafts is much smaller than the\ngeocentric distance of the target spacecraft, the gravitational term can be linearized\nand keep the first-order term, then the Lawden equation can be obtained. The\nconcrete expression is\n\n\u20acx? \u20achz? _h2x? 2 _h_z\u00fe lx=r3t \u00bc ux\n\u20acy\u00fe ly=r3t \u00bc uy\n\u20acz? _h2z\u00fe \u20achx\u00fe 2 _h _x? 2lz=r3t \u00bc uz\n\n8<\n: \u00f03:4\u00de\n\nFormula (3.4) is the Lawden equation. The _h and \u20ach in the equation can be\nobtained according to the orbit eccentricity of the target spacecraft and the geo-\ncentric distance of the target spacecraft\n\n3.2 Formation Configuration Design Based on Algebraic Method 55\n\n\n\n_h \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nl\u00f01\u00fe e cos h\u00de\n\nr3t\n\ns\n; \u20ach \u00bc ?2 _rt\n\n_h\nrt\n\n\u00f03:5\u00de\n\nThe Lawden equation mentioned above is derived from the relative orbit\ndynamic equation in the time domain. Since the relative orbit dynamic equations in\nthe time domain are complex and the target orbit angular velocity and the geo-\ncentric distance are functions of the true anomaly, which is inconvenient for the\ndesign of accompanying flying configuration and control law, it is possible to\nconvert the time-domain state-space expression into the form of true anomaly\ndomain. The conversion equation is shown in the following equation\n\n_?\u00f0 \u00de \u00bc ?\u00f0 \u00de0 _h; \u20ac?\u00f0 \u00de \u00bc ?\u00f0 \u00de00 _h2 \u00fe _h _h0 ?\u00f0 \u00de 0 \u00f03:6\u00de\n\nwhere \u00f0\u00de? is differential coefficient as time variable, and \u00f0\u00de0 is differential coefficient\nas true anomaly variable. The converted expression becomes\n\nv\u00f0h\u00de\na\u00f0h\u00de\n? ?\n\n\u00bc Uvv\u00f0h\u00de Uva\u00f0h\u00de\nUav\u00f0h\u00de Uaa\u00f0h\u00de\n? ?\n\nx\u00f0h\u00de\nv\u00f0h\u00de\n? ?\n\n\u00fe B1\u00f0h\u00de\nB2\u00f0h\u00de\n? ?\n\nu\u00f0h\u00de \u00f03:7\u00de\n\nwhere\n\nUvv\u00f0h\u00de \u00bc\n0 0 0\n0 0 0\n0 0 0\n\n2\n4\n\n3\n5;Uva\u00f0h\u00de \u00bc 1 0 00 1 0\n\n0 0 1\n\n2\n4\n\n3\n5 \u00f03:8\u00de\n\nUav\u00f0h\u00de \u00bc\ne cos h\n\n1\u00fe e cos h 0 ? 2e sin h1\u00fe e cos h\n0 ?11\u00fe e cos h 0\n\n2e sin h\n1\u00fe e cos h 0\n\n3\u00fe e cos h\n1\u00fe e cos h\n\n2\n64\n\n3\n75 \u00f03:9\u00de\n\nUaa\u00f0h\u00de \u00bc\n2e sin h\n\n1\u00fe e cos h 0 2\n0 2e sin h1\u00fe e cos h 0\n?2 0 2e sin h1\u00fe e cos h\n\n2\n64\n\n3\n75 \u00f03:10\u00de\n\nB1\u00f0h\u00de \u00bc\n0 0 0\n0 0 0\n0 0 0\n\n2\n4\n\n3\n5;B2\u00f0h\u00de \u00bc \u00f01? e2\u00de3\u00f01? e cos h\u00de4n2\n\n1 0 0\n0 1 0\n0 0 1\n\n2\n4\n\n3\n5 \u00f03:11\u00de\n\nFormula (3.7) is T-H equation based on the true anomaly domain, which can be\nused to describe the relative orbit dynamic equation for any eccentricity. It can be\nseen that the motion in the orbital plane (x, z) and the motion out of the orbit plane\n(y) are decoupled. The analytical solution of Formula (3.7) is [1].\n\n56 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nx\u00f0h\u00de \u00bc d1 \u00fe d41\u00fe e cos h \u00fe 2d2eH\u00f0h\u00de\n? ?\n\n\u00fe sin h d3\n1\u00fe e cos h \u00fe d3\n? ?\n\n\u00fe cos h d1e\u00fe 2d2e2H\u00f0h\u00de\n? ?\n\ny\u00f0h\u00de \u00bc ? sin\u00f0h\u00de d5\n1\u00fe e cos h? cos\u00f0h\u00de\n\nd6\n1\u00fe e cos h\n\nz\u00f0h\u00de \u00bc ? sin\u00f0h\u00de d1e\u00fe 2d2e2H\u00f0h\u00de\n? ?\u00fe cos h d2e\u00f01\u00fe e cos h\u00de2 \u00fe d3\n\n\" #\n\n8>>>>>>>>>>><\n>>>>>>>>>>>:\n\n\u00f03:12\u00de\n\nDerived from Eq. (3.12)\n\n_x\u00f0h\u00de \u00bc ? d4e sin h\u00f01\u00fe e cos\u00f0h\u00de\u00de2 \u00fe 2d2e\n_H\u00f0h\u00de\n\n\" #\n\u00fe d3 cos h 2\u00fe e cos h1\u00fe e cos h\n\n\u00fe d3e sin\n2 h\n\n\u00f01\u00fe e cos h\u00de2 ? sin h\u00f0ed1 \u00fe 2d2H\u00f0h\u00de\u00de\u00fe 2d2e\n2 cos\u00f0h\u00de _H\u00f0h\u00de\n\n_y\u00f0h\u00de \u00bc ? d5\u00f0e\u00fe cos h\u00de\u00f01\u00fe e cos h\u00de2 \u00fe\nd6 sin h\n\n\u00f01\u00fe e cos h\u00de2\n_z\u00f0h\u00de \u00bc ? cos h\u00f0d1e\u00fe 2d2e2H\u00f0h\u00de\u00de ? 2 sin hd2e2 _H\u00f0h\u00de\n\n? sin h d2e\u00f01\u00fe e cos\u00f0h\u00de\u00de2 \u00fe d3\n\" #\n\n\u00fe cos h 2d2e\n2 sin h\n\n\u00f01\u00fe e cos\u00f0h\u00de\u00de3\n !\n\n8>>>>>>>>>>>>>>>>>><\n>>>>>>>>>>>>>>>>>>:\n\n\u00f03:13\u00de\n\nwhere di is the integral constant and is related to the initial condition, H\u00f0h\u00de is\nnon-periodic term and is the main factor causing aperiodic relative motion. The\nexpression is\n\nH\u00f0h\u00de \u00bc\nZht\nh0\n\ncos h\n\n\u00f01\u00fe e cos h\u00de3dh\n\n\u00bc ?\u00f01? e2\u00de?5=2 3Ee\n2\n\n? \u00f01\u00fe e2\u00de sinE\n?\n\n\u00fe e\n2\nsinE cosE\u00fe dH\n\ni \u00f03:14\u00de\n\ncosE \u00bc E\u00fe cos h\n1\u00fe e cos h \u00f03:15\u00de\n\nwhere E is the eccentric anomaly. Formulas (3.12) and (3.13) are used to describe\nthe natural relative motion trajectory expression and the relative velocity expression\nof the two spacecrafts in the case of any eccentricity. As can be seen from the\nexpression, the expression used to describe the relative motion on the elliptical orbit\nis very complex. In addition to the periodic term, it also contains long term and\nnon-periodic terms, so the relative motion trajectory is also complicated.\n\n3.2 Formation Configuration Design Based on Algebraic Method 57\n\n\n\n3.2.2 Relative Periodic Motion\n\nFrom the derivation analysis of Sect. 3.2.1, if the terms contain H\u00f0h\u00de in Formulas\n(3.12) and (3.13) are not zero, the natural relative motion of the two spacecrafts is\nnot periodic motion, so it is necessary to research the condition that the natural\nrelative motion of the two spacecrafts is periodic motion.\n\nAssume the true anomaly to be zero, the formula below can be obtained from\nFormulas (3.12) and (3.13) [2]\n\nx\u00f00\u00de \u00bc \u00f01\u00fe e\u00ded1 \u00fe 1\u00f01\u00fe e\u00de d4; y\u00f00\u00de \u00bc ? d6\u00f01\u00fe e\u00de ; z\u00f00\u00de \u00bc e\u00f01\u00fe e\u00de2 d2 \u00fe d3\nx0\u00f00\u00de \u00bc 2e\u00f01\u00fe e\u00de2 d2 \u00fe\n\n\u00f02\u00fe e\u00de\n\u00f01\u00fe e\u00de d3; y\n\n0\u00f00\u00de \u00bc ? d5\u00f01\u00fe e\u00de ; z0\u00f00\u00de \u00bc ?ed1\n\n8<\n: \u00f03:16\u00de\nIt can be solved by Formula (3.16)\n\nd1\nd2\nd3\nd4\nd5\nd6\n\n2\n6666664\n\n3\n7777775\n\u00bc\n\n0 0 0 0 0 ? 1e\n0 0 ? \u00f02\u00fe e\u00de\u00f01\u00fe e\u00de2e2 \u00f01\u00fe e\u00de\n\n3\n\ne2 0 0\n\n0 0 2\u00f01\u00fe e\u00dee ? \u00f01\u00fe e\u00dee 0 0\n\u00f01\u00fe e\u00de 0 0 0 0 \u00f01\u00fe e\u00de2e\n\n0 0 0 0 ?\u00f01\u00fe e\u00de 0\n0 ?\u00f01\u00fe e\u00de 0 0 0 0\n\n2\n66666664\n\n3\n77777775\n\nx\u00f00\u00de\ny\u00f00\u00de\nz\u00f00\u00de\nx0\u00f00\u00de\ny0\u00f00\u00de\nz0\u00f00\u00de\n\n2\n6666664\n\n3\n7777775\n\n\u00f03:17\u00de\n\nFor the sake of convenience, Formula (3.17) turns into\n\nd1\nd2\nd3\nd4\nd5\nd6\n\n2\n6666664\n\n3\n7777775\n\u00bc\n\n0 0 0 0 0 x16\n0 0 x23 x24 0 0\n0 0 x33 x34 0 0\nx41 0 0 0 0 x46\n0 0 0 0 x55 0\n0 x62 0 0 0 0\n\n2\n6666664\n\n3\n7777775\n\nx\u00f00\u00de\ny\u00f00\u00de\nz\u00f00\u00de\nx0\u00f00\u00de\ny0\u00f00\u00de\nz0\u00f00\u00de\n\n2\n6666664\n\n3\n7777775\n\n\u00f03:18\u00de\n\nSimilarly, the formula below can be obtained by making true anomaly as 2p of\nFormulas (3.14) and (3.15)\n\n58 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nx\u00f02p\u00de\ny\u00f02p\u00de\nz\u00f02p\u00de\nx0\u00f02p\u00de\ny0\u00f02p\u00de\nz0\u00f02p\u00de\n\n2\n6666666664\n\n3\n7777777775\n\u00bc\n\n\u00f01\u00fe e\u00de ? 6pe2\u00f01\u00fe e\u00de\u00f01?e2\u00de5=2 0\n1\n\n\u00f01\u00fe e\u00de 0 0\n\n0 0 0 0 0 ? 1\u00f01\u00fe e\u00de\n0 e\u00f01\u00fe e\u00de2 1 0 0 0\n\n0 2e\u00f01\u00fe e\u00de2\n\u00f02\u00fe e\u00de\n\u00f01\u00fe e\u00de 0 0 0\n\n0 0 0 0 ? 1\u00f01\u00fe e\u00de 0\n?e ? 6pe3\u00f01\u00fe e\u00de\u00f01?e2\u00de5=2 0 0 0 0\n\n2\n66666666664\n\n3\n77777777775\n\nd1\nd2\nd3\nd4\nd5\nd6\n\n2\n6666666664\n\n3\n7777777775\n\n\u00f03:19\u00de\n\nRecord as\n\nx\u00f02p\u00de\ny\u00f02p\u00de\nz\u00f02p\u00de\nx0\u00f02p\u00de\ny0\u00f02p\u00de\nz0\u00f02p\u00de\n\n2\n6666666664\n\n3\n7777777775\n\u00bc\n\np11 p12 0 p14 0 0\n0 0 0 0 0 p26\n0 p32 p33 0 0 0\n0 p42 p43 0 0 0\n0 0 0 0 p55 0\np61 p62 0 0 0 0\n\n2\n6666664\n\n3\n7777775\n\nd1\nd2\nd3\nd4\nd5\nd6\n\n2\n6666666664\n\n3\n7777777775\n\n\u00f03:20\u00de\n\nPlug Formula (3.18) into Formula (3.20), we get\n\nx\u00f02p\u00de\ny\u00f02p\u00de\nz\u00f02p\u00de\nx0\u00f02p\u00de\ny0\u00f02p\u00de\nz0\u00f02p\u00de\n\n2\n6666666664\n\n3\n7777777775\n\u00bc\n\np14x41 0 p12x23 p12x24 0 p11x16 \u00fe p14x46\n0 p26x62 0 0 0 0\n0 0 p32x23 \u00fe p33x33 p32x24 \u00fe p33x34 0 0\n0 0 p42x23 \u00fe p43x33 p42x24 \u00fe p43x34\n0 0 0 0 p55x55 0\n0 0 p62x23 p62x24 0 p61x16\n\n2\n6666664\n\n3\n7777775\n\nx\u00f00\u00de\ny\u00f00\u00de\nz\u00f00\u00de\nx0\u00f00\u00de\ny\u00f000\u00de\nz0\u00f00\u00de\n\n2\n6666664\n\n3\n7777775\n\n\u00f03:21\u00de\n\nPlug p11\u2013p66 and x11\u2013x66 into formula above, we get\n\nx\u00f02p\u00de\ny\u00f02p\u00de\nz\u00f02p\u00de\nx0\u00f02p\u00de\ny0\u00f02p\u00de\nz0\u00f02p\u00de\n\n2\n6666666664\n\n3\n7777777775\n\u00bc\n\n1 0 p12x23 p12x24 0 0\n0 1 0 0 0 0\n0 0 1 0 0 0\n0 0 0 1 0 0\n0 0 0 0 1 0\n0 0 p62x23 p62x24 0 1\n\n2\n6666664\n\n3\n7777775\n\nx\u00f00\u00de\ny\u00f00\u00de\nz\u00f00\u00de\nx0\u00f00\u00de\ny0\u00f00\u00de\nz0\u00f00\u00de\n\n2\n6666664\n\n3\n7777775\n\n\u00f03:22\u00de\n\nAccording to the analytical equation of the motion equation, it can be concluded\nthat if there is a periodic motion between the two spacecrafts, the condition that the\ntwo spacecrafts keep the closed trajectory is\n\n3.2 Formation Configuration Design Based on Algebraic Method 59\n\n\n\nx\u00f02p\u00de \u00bc x\u00f00\u00de\nz0\u00f02p\u00de \u00bc z0\u00f00\u00de\n\n(\n\u00f03:23\u00de\n\nIt can be get from Formulas (3.19)\u2013(3.23)\n\nx0\u00f00\u00de\nz\u00f00\u00de \u00bc ?\n\nx23\nx24\n\n\u00bc ? 2\u00fe e\n1\u00fe e \u00f03:24\u00de\n\nFormula (3.24) is the necessary condition that the relative motion trajectory of\nthe two spacecrafts is closed curve, x0\u00f00\u00de is the relative velocity of the two\nspacecrafts in the x-direction when the target spacecraft true anomaly is zero, and\nz\u00f00\u00de is the relative position of the two spacecrafts in the z-direction when the target\nspacecraft true anomaly is zero.\n\nd2 = 0 can be derived from plugging Formula (3.24) into Formula (3.17), then\nFormula (3.12) turns into\n\nx\u00f0h\u00de \u00bc d1 \u00fe d41\u00fe e cos h\nh i\n\n\u00fe sin h d31\u00fe e cos h \u00fe d3\nh i\n\n\u00fe ed1 cos h\ny\u00f0h\u00de \u00bc ? sin\u00f0h\u00de d51\u00fe e cos h ? cos\u00f0h\u00de d61\u00fe e cos h\nz\u00f0h\u00de \u00bc ?ed1 sin\u00f0h\u00de\u00fe d3 cos h\n\n8><\n>: \u00f03:25\u00de\n\nFormula (3.13) turns into\n\n_x\u00f0h\u00de \u00bc ? ed4 sin h\u00f01\u00fe e cos h\u00de2 \u00fe d3 cos h 2\u00fe e cos h1\u00fe e cos h \u00fe\nd3e sin2 h\n\n\u00f01\u00fe e cos h\u00de2 ? ed1 sin h\n_y\u00f0h\u00de \u00bc ? d5\u00f0e\u00fe cos h\u00de\u00f01\u00fe e cos h\u00de2 \u00fe\n\nd6 sin h\n\u00f01\u00fe e cos h\u00de2\n\n_z\u00f0h\u00de \u00bc ?ed1 cos h? d3 sin h\n\n8><\n>: \u00f03:26\u00de\n\nWhen e = 0, the above condition is equivalent to _x0 \u00bc 2z0n in the time domain,\nwhich is the same as the periodic motion condition of formation flight on the\ncircular reference orbit based on the C-W equation.\n\nFormulas (3.25) and (3.26) are used to describe the position and velocity\nmathematical expression of the natural accompanying flying on the reference orbit,\nwhich is elliptical orbit. The two expressions satisfy the condition that the relative\nmotion of the two spacecrafts is periodic motion, and the relative motion trajectory\nis closed curve. From these two expressions, it can be seen that the relative motion\ntrajectory on the elliptical orbit is a function of true anomaly of the target spacecraft,\nand the true anomaly and points of relative motion trajectory are corresponding one\nby one. It also shows that in the case of a certain true anomaly of target spacecraft\nwhen goes into natural accompanying flying, the active spacecraft can enter the\nstable natural accompanying fly only when getting the point of the relative motion\ntrajectory, which is corresponding to this true anomaly, and satisfies the relative\nposition and velocity condition corresponding to this true anomaly. It can be seen\nthat the conditions of forming a natural accompanying fly on the elliptical orbit are\nvery harsh. This is one of the differences between the natural accompanying fly\n\n60 3 Formation Configuration Design of Elliptical Orbit\n\n\n\ntrajectory of the elliptical orbit and the circular orbit. Because the true anomaly of\nthe target spacecraft and relative motion trajectory are not corresponding one by one\non the circular orbit, the conditions of the natural accompanying flying formed on\nthe circular orbit are more relaxed.\n\n3.2.3 Characteristics Analysis of Relative Motion Trajectory\n\nUnlike the relative motion trajectory on the circular reference orbit, when formation\nspacecraft on the elliptical reference orbit satisfies the periodic motion conditions,\nthe relative motion trajectory is not a fixed type of space curve, which makes\nformation flight mode on the elliptical reference orbit more complicated than cir-\ncular reference orbit. Under two-body conditions, the relative motion trajectory\nbetween two spacecrafts on the elliptical reference orbit evolves into a space twisted\ncurve, showing a richer shape characteristic, and only in the special case can get the\nplane regular trajectory.\n\nThe motion equation in the y-direction and z-direction can be changed [2]\n\ny\u00f0h\u00de \u00bc ?ry sin\u00f0h\u00fe b\u00de=\u00f01\u00fe e cos h\u00de\nz\u00f0h\u00de \u00bc rz cos\u00f0h\u00fe a\u00de\n\n(\n\u00f03:27\u00de\n\nwhere\n\nry \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nd25 \u00fe d26\n\nq\nsin b \u00bc d6=\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nd25 \u00fe d26\n\nq\ncos b \u00bc d5=\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nd25 \u00fe d26\n\nq\nrz \u00bc\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nd21e\n\n2 \u00fe d23\np\n\nsin a \u00bc d1e=\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nd21e\n\n2 \u00fe d23\np\n\ncos a \u00bc d3=\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nd21e\n\n2 \u00fe d23\np\n\n\u00f03:28\u00de\n\nFrom the above expression, it can be judged that the motion of the active\nspacecraft must pass point z = 0 in the z-direction and pass point y = 0 in the\ny-direction. However, the motion in the x-direction is more complicated. Since there\nis a constant drift term in the x-direction motion, the relative motion in the\nx-direction is not always around the origin and may have a certain amount of\ntranslation. When the amount of translation reaches a certain value, the relative\ntrajectories in the x-direction are all located on one side of the origin, rather than the\npositive and negative alternating oscillations on both sides of the origin, so that the\nlong-term accompanying fly behind the target spacecraft can be achieved.\n\nWhen the integral constant di changes, the change of the space shape of the\nrelative trajectory is \u201crotation,\u201d \u201ctorsion,\u201d and \u201ctranslation,\u201d which is corresponding\n\n3.2 Formation Configuration Design Based on Algebraic Method 61\n\n\n\nto the change of the corresponding initial condition. In the orbital plane, d2 is\nrelated to the periodicity of relative motion, d1 and d4 are related to the center\nposition of relative motion in the x-direction, d1 and d3 are related to the shape of\nthe relative trajectory in the orbit plane, and d5 and d6 are related to motion out of\nthe orbit plane.\n\n3.2.4 Fly-Around Configuration Design\n\n1. Oblique triangular flying-around configuration\n\nIt can be proved from the configuration expression:\n\n(1) When d1 = 0, z(h) = z(2p ? h), and z(0) 6\u00bc 0, z(p) 6\u00bc 0 is the extremum\npoint, [z(0) + z(p)]/2 = 0, z(p/2) = z(3p/2) = 0. The maximum distance of the\nclosed curve in the z-direction is 2|d3|.\n\n(2) When d6 = 0, y(h) = ?y(2p ? h), y(p/2) + y(3p/2) = 0, y(0) + y(p) = 0, there\nis an extreme value at h that can be obtained by satisfying the following\nequation:\n\nd5\u00f0e\u00fe cos h\u00de \u00bc 0 \u00f03:29\u00de\n\nThat is, when h = arccos(?e), the closed curve takes the maximum value in the\n\ny-direction and the maximum distance is 2 d5\nsin\u00f0h\u00de\n\n1\u00fe e cos h\n??? ???.\n\n(3) When d1 = d4 = 0, x(h) = ?x(2p ? h), x(0) = x(p) = 0, there is an extreme\nvalue at h that can be obtained by satisfying the following equation\n\ne2 cos3 h\u00fe 2e cos2 h\u00fe 2 cos h\u00fe e \u00bc 0 \u00f03:30\u00de\n\n(4) When d1 = d2 = d4 = d6 = 0, the relative motion trajectory between two\nspacecrafts is\n\nx\u00f0h\u00de \u00bc d3 sin h 2\u00fe e cos h1\u00fe e cos h\nh i\n\ny\u00f0h\u00de \u00bc ?d5 sin\u00f0h\u00de1\u00fe e cos h\nz\u00f0h\u00de \u00bc d3 cos h\n\n8><\n>: \u00f03:31\u00de\n\nThe velocity expression changed into\n\n_x\u00f0h\u00de \u00bc d3 cos h 2\u00fe e cos h1\u00fe e cos h \u00fe d3e sin\n2 h\n\n\u00f01\u00fe e cos h\u00de2\n\n_y\u00f0h\u00de \u00bc ? d5\u00f0e\u00fe cos h\u00de\u00f01\u00fe e cos h\u00de2\n_z\u00f0h\u00de \u00bc ?d3 sin h\n\n8><\n>: \u00f03:32\u00de\n\n62 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nMaking d3 = 450, d5 = 730, the configuration diagram of the target spacecraft\norbit coordinate system is shown in Fig. 3.1.\n\nIt can be seen from Fig. 3.1 that the space configuration of the relative motion\ntrajectory formed by the two spacecrafts flying around is oblique triangles under the\ncondition that d1 = d2 = d4 = d6 = 0, d3 = 450, d5 = 730. The relative trajectory of\nflying around in the x\u2013z plane and the projection in the y\u2013z plane are irregular\nellipses, and the projection in the x\u2013y plane is oblique 8-shaped.\n\n2. Space 8-shaped fly-around configuration\n\nIt can be proved from the configuration expression:\n\n(1) When d1 = 0, z(h) = z(2p ? h), and z(0) 6\u00bc 0, z(p) 6\u00bc 0 is the extremum point,\nz(0) + z(p) = 0, z(p/2) + z(3p/2) = 0. The maximum distance of the closed\ncurve in the z-direction is 2|d3|.\n\n(2) When d5 = 0, y(h) = y(2p ? h), and y(0) 6\u00bc 0, y(p) 6\u00bc 0 is the extremum point,\ny(p/2) = y(3p/2) = 0. The maximum distance of the closed curve in the\ny-direction is d6/(1 ? e), the maximum distance in the negative direction is\nd6/(1 + e), so the motion trajectory in the y-direction is asymmetric.\n\n(3) When d1 = d4 = 0, x(h) = ?x(2p ? h), x(0) = x(p) = 0, there is an extreme\nvalue at h that can be obtained by satisfying the following equation:\n\ne2 cos3 h\u00fe 2e cos2 h\u00fe 2 cos h\u00fe e \u00bc 0 \u00f03:33\u00de\n\n(4) When d1 = d2 = d4 = d5 = 0, the relative motion trajectory between two\nspacecrafts is\n\nFig. 3.1 Oblique triangular flying-around configuration\n\n3.2 Formation Configuration Design Based on Algebraic Method 63\n\n\n\nx\u00f0h\u00de \u00bc d3 sin h 2\u00fe e cos h1\u00fe e cos h\ny\u00f0h\u00de \u00bc ?d6 cos\u00f0h\u00de1\u00fe e cos h\nz\u00f0h\u00de \u00bc d3 cos h\n\n8>>>>><\n>>>>>:\n\n\u00f03:34\u00de\n\nThe velocity expression changed into\n\n_x\u00f0h\u00de \u00bc d3 cos h 2\u00fe e cos h1\u00fe e cos h \u00fe\nd3e sin2 h\n\n\u00f01\u00fe e cos h\u00de2\n\n_y\u00f0h\u00de \u00bc ? d6 sin h\u00f01\u00fe e cos h\u00de2\n_z\u00f0h\u00de \u00bc ?d3 sin h\n\n8>>>>>><\n>>>>>>:\n\n\u00f03:35\u00de\n\nMaking d3 = 450, d6 = 320, the configuration diagram of the target spacecraft\norbit coordinate system is shown in Fig. 3.2.\n\nIt can be seen from Fig. 3.2 that the space configuration of the relative motion\ntrajectory formed by the two spacecrafts flying around is 8-shaped under the\ncondition that d1 = d2 = d4 = d5 = 0, d3 = 450, d6 = 320. The relative trajectory in\nthe x\u2013z plane and the projection in the x\u2013y plane are irregular ellipses, and the\nprojection in the plane y\u2013z is part of hyperbola.\n\nFig. 3.2 Space 8-shaped fly-around configuration\n\n64 3 Formation Configuration Design of Elliptical Orbit\n\n\n\n3.2.5 Accompanying Flying Configuration Design\n\n1. Oblique triangular accompanying flying configuration\n\nIt can be proved from the configuration expression:\n\n(1) When d3 = 0, z(h) = ?z(2p ? h), and z(p/2) 6\u00bc 0, z(3p/2) 6\u00bc 0 is the extremum\npoint, z(p/2) + z(3p/2) = 0, z(0) + z(p) = 0. The maximum distance of the\nclosed curve in the z-direction is 2|d1e|.\n\n(2) When d6 = 0, y(h) = ?y(2p ? h), y(p/2) + y(3p/2) = 0, y(0) + y(p) = 0, there\nis an extreme value at h that can be obtained by satisfying the following\nequation:\n\nd5\u00f0e\u00fe cos h\u00de \u00bc 0 \u00f03:36\u00de\n\nThat is, when h = arccos(?e), the closed curve takes the maximum value in the\n\ny-direction and the maximum distance is 2 d5\nsin\u00f0h\u00de\n\n1\u00fe e cos h\n??? ???.\n\n(3) When d3 = d4 = 0, x(h) = x(2p ? h), and x(0) = d1 + d1e, x(p) = d1 ? d1e is\nthe extremum point, x(p/2) = x(3p/2) = d1.\n\n(4) When d2 = d3 = d4 = d6 = 0, the relative motion trajectory between two\nspacecrafts is\n\nx\u00f0h\u00de \u00bc d1 \u00fe d1e cos h\n\ny\u00f0h\u00de \u00bc ?d5 sin\u00f0h\u00de1\u00fe e cos h\nz\u00f0h\u00de \u00bc ?d1e sin h\n\n8>>><\n>>>:\n\n\u00f03:37\u00de\n\nThe velocity expression changed into\n\n_x\u00f0h\u00de \u00bc ?d1e sin h\n\n_y\u00f0h\u00de \u00bc ? d5\u00f0e\u00fe cos h\u00de\u00f01\u00fe e cos h\u00de2\n_z\u00f0h\u00de \u00bc ?d1e cos h\n\n8>>><\n>>>:\n\n\u00f03:38\u00de\n\nIn the orbit plane,\n\nx? d1\nd1e\n\n? \t2\n\u00fe z\n\nd1e\n\n? \t2\n\u00bc 1 \u00f03:39\u00de\n\nThe relative motion trajectory is a circle that center is (d1, 0), and radius is ?d1e?.\nMaking d1 = ?1000, d5 = 730, the configuration diagram of the target space-\n\ncraft orbit coordinate system is shown in Fig. 3.3.\nIt can be seen from Fig. 3.3 that the space configuration of the relative motion\n\ntrajectory formed by the two spacecrafts accompanying fly is oblique triangles\n\n3.2 Formation Configuration Design Based on Algebraic Method 65\n\n\n\nunder the condition that d2 = d3 = d4 = d6 = 0, d1 = ?1000, d5 = 730. The pro-\njection of accompanying fly relative trajectory on the y\u2013z plane is oblique 8-shaped,\nand the projection on the x-z plane and the x\u2013y plane is irregular ellipses. The ellipse\nis not closed in the x-direction, which is due to the long-term drift brought by the\nomission of the nonlinear term in the T-H equation.\n\n2. Space 8-shaped accompanying flying configuration\n\nIt can be proved from the configuration expression:\n\n(1) When d3 = 0, z(h) = ?z(2p ? h), and z(p/2) 6\u00bc 0, z(3p/2) 6\u00bc 0 is the extremum\npoint, z(p/2) + z(3p/2) = 0, z(0) + z(p) = 0. The maximum distance of the\nclosed curve in the z-direction is 2|d1e|.\n\n(2) When d5 = 0, y(h) = y(2p ? h), and y(0) 6\u00bc 0, y(p) 6\u00bc 0 is the extremum point,\ny(p/2) = y(3p/2) = 0. The maximum distance of the closed curve in the\ny-direction is d6/(1 ? e), and the maximum distance in the negative direction is\nd6/(1 + e), so the motion trajectory in the y-direction is asymmetric.\n\n(3) When d3 = d4 = 0, x(h) = x(2p ? h), and x(0) = d1 + d1e, x(p) = d1 ? d1e is\nthe extremum point, x(p/2) = x(3p/2) = d1.\n\n(4) When d3 = d4 = d5 = 0, d1 = d6 6\u00bc 0, the relative motion trajectory between\ntwo spacecrafts is\n\nFig. 3.3 Oblique triangular accompanying flying configuration\n\n66 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nx\u00f0h\u00de \u00bc d1 \u00fe d1e cos h\n\ny\u00f0h\u00de \u00bc ?d6 cos\u00f0h\u00de1\u00fe e cos h\nz\u00f0h\u00de \u00bc ?d1e sin h\n\n8>>><\n>>>:\n\n\u00f03:40\u00de\n\nThe velocity expression changed into\n\n_x\u00f0h\u00de \u00bc ?d1e sin h\n_y\u00f0h\u00de \u00bc d6 sin h\u00f01\u00fe e cos h\u00de2\n_z\u00f0h\u00de \u00bc ?d1e cos h\n\n8>>><\n>>>:\n\n\u00f03:41\u00de\n\nIn the orbit plane,\n\nx? d1\nd1e\n\n? \t2\n\u00fe z\n\nd1e\n\n? \t2\n\u00bc 1 \u00f03:42\u00de\n\nThe relative motion trajectory is a circle that center is (d1, 0), and radius is ?d1e?.\nMaking d1 = ?1000, d6 = 320, the configuration diagram of the target space-\n\ncraft orbit coordinate system is shown in Fig. 3.4.\nIt can be seen from Fig. 3.4 that the space configuration of the relative motion\n\ntrajectory formed by the two spacecrafts accompanying flying is 8-shaped under the\ncondition that d2 = d3 = d4 = d5 = 0, d1 = ?1000, d6 = 320. The projection of\nrelative trajectory of accompanying flying on the x\u2013y plane is part of hyperbola, and\nthe projection on the x\u2013z plane and the y\u2013z plane is irregular ellipses. The trajectory\nis not closed in the x-direction.\n\nFrom the results of the accompanying flying, the two kinds of accompanying\nflying configuration have been drifting more than 100 m in the x-axis of tracking\nspacecraft after a period of flying. The reason of the drift is analyzed theoretically,\nmainly because the T-H equation has been linearized, and the high-order term of the\nrelative distance is omitted, and terms of long-term drift, constant offset, and\nperiodic term exist in nonlinear term, so there is a relatively large error.\n\nFly-around or accompanying flying configuration is closely related to the value\nof the integral constant and the integral constant di(i = 1, 2, 3, 4, 5, 6), and these\nintegral constants are dependent on the initial condition, so the fly-around config-\nuration can be changed by adjusting the integral constant. If using the fly-around\nconfiguration, the satellite cannot enter the circular safe area which takes the center\nof the target satellite as origin, and maximum envelope of the target satellite as\nradius in the process of flying around the target satellite, so there are one more\nconstraints in the control law, which increases the complexity of the task. If using\nthe accompanying flying configuration, the relative motion trajectory is not closed\nunder the influence of the nonlinear term, and the curve makes long-term drift along\nthe velocity direction.\n\n3.2 Formation Configuration Design Based on Algebraic Method 67\n\n\n\nThe study shows that the relative motion trajectory has the following\ncharacteristics:\n\n(1) The relative trajectory motion is periodic under certain conditions, and the\nfly-around configuration will not diverge and be stable periodic space closed\ncurve without considering the perturbation; however, the accompanying flying\nconfiguration will be divergent due to the error caused by linearization.\n\n(2) The relative motion in the two directions of the orbit plane is coupled with each\nother, and the relative motion is decoupled out of the orbit plane.\n\n(3) Since the reference orbit is ellipse, there is non-uniformity in the relative\nmotion trajectory with respect to time.\n\n3.3 Formation Configuration Design Based on Geometry\n\n3.3.1 Precise Model of Relative Motion\n\nThe centroid orbit coordinate system of active spacecraft is defined as Soc, and the\norigin O is in the center of the active spacecraft, the x-axis coincides with the geo-\ncentric vector of the active spacecraft, and the z-axis is in the normal direction of the\norbit plane, that is, the same as vector of the momentum moment. The y-axis is in the\norbit plane, which is perpendicular to the x-axis and pointing to the motion direction.\n\nFig. 3.4 Space 8-shaped accompanying flying configuration\n\n68 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nIn Fig. 3.5, the unit sphere, which takes the center of the earth O as the center, is\nthe geocentric celestial sphere, the unit sphere projection of the active spacecraft\nC and the target spacecraft T is the C0 and T 0, rc and rt are the geocentric position\nvector of the active spacecraft and the target spacecraft, respectively, and q and q0\n\nare relative position vector between the two spacecrafts and their projection,\nrespectively. Taking the active spacecraft orbit coordinate system Soc as the ref-\nerence coordinate system, the variation law of the relative position vector of the two\nspacecrafts is studied [3].\n\nAssume the transfer matrix from geocentric equatorial inertia coordinate system\nto the active spacecraft and the target spacecraft orbit coordinate system is MCI and\nMTI , and the form is as follows:\n\nMCI \u00bc RZ\u00f0uc\u00deRX\u00f0ic\u00deRZ\u00f0Xc\u00de \u00f03:43\u00de\n\nMTI \u00bc RZ\u00f0ut\u00deRX\u00f0it\u00deRZ\u00f0Xt\u00de \u00f03:44\u00de\n\nwhere Rm\u00f0h\u00de represents the primary conversion matrix that rotates by angle h\naround the m-axis, and the specific expression is\n\nRX\u00f0h\u00de \u00bc\n1 0 0\n0 cos h sin h\n0 ? sin h cos h\n\n0\n@\n\n1\nA\n\nRZ\u00f0h\u00de \u00bc\ncos h sin h 0\n? sin h cos h 0\n\n0 0 1\n\n0\n@\n\n1\nA \u00f03:45\u00de\n\nwhere the perturbation and active control factors are not taken into account, and the\nprojection relative position vector q0 is expressed as follows:\n\nFig. 3.5 Relative vector\nprojection in the unit sphere\n\n3.3 Formation Configuration Design Based on Geometry 69\n\n\n\nx0\n\ny0\n\nz0\n\n0\n@\n\n1\nA \u00bc MCI \u00f0MTI \u00deT 10\n\n0\n\n0\n@\n\n1\nA? 10\n\n0\n\n0\n@\n\n1\nA \u00f03:46\u00de\n\nwhere x0; y0; z0\u00bd ?T is the component array of the projection vector q0 in the coordinate\nsystem Soc. Under the premise that the relative distance between the two spacecrafts\nis not approximated, the relative motion equation is further derived as [4]\n\nx0 \u00bc ?1\u00fe cos2 ic\n2\ncos2\n\nit\n2\ncos\u00f0Du\u00feDX\u00de\u00fe sin2 ic\n\n2\nsin2\n\nit\n2\ncos\u00f0Du? DX\u00de\n\n\u00fe sin2 ic\n2\ncos2\n\nit\n2\ncos\u00f02uc \u00feDu\u00feDX\u00de\u00fe cos2 ic2 sin\n\n2 it\n2\ncos\u00f02uc \u00feDu? DX\u00de\n\n\u00fe 1\n2\nsin ic sin it\u00bdcosDu? cos\u00f02uc \u00feDu\u00de?\n\ny0 \u00bc cos2 ic\n2\ncos2\n\nit\n2\nsin\u00f0Du\u00feDX\u00de\u00fe sin2 ic\n\n2\nsin2\n\nit\n2\nsin\u00f0Du? DX\u00de\n\n? sin2 ic\n2\ncos2\n\nit\n2\nsin\u00f02uc \u00feDu\u00feDX\u00de ? cos2 ic2 sin\n\n2 it\n2\nsin\u00f02uc \u00feDu? DX\u00de\n\n\u00fe 1\n2\nsin ic sin it\u00bdsinDu + sin\u00f02uc \u00feDu\u00de?\n\nz0 \u00bc ? sin ic sinDX cos\u00f0uc \u00feDu\u00de ? \u00f0sin ic cos it cosDX? cos ic sin it\u00de sin\u00f0uc \u00feDu\u00de\n\n8>>>>>>>>>>>>>>>>>>>>><\n>>>>>>>>>>>>>>>>>>>>>:\n\n\u00f03:47\u00de\n\nFormula (3.47) is the relative motion equation of two spacecrafts without any\napproximate simplification, and the six classical orbit elements, i.e., semimajor axis,\neccentricity, inclination, longitude of ascending node, argument of perigee, true\nanomaly of the active spacecraft and the target spacecraft, are rc\u00f0ac; ec; ic;Xc;xc; fc\u00de\nand rt\u00f0at; et; it;Xt;xt; ft\u00de. uc and ut is argument of perigee, and uc \u00bc xc \u00fe fc,\nut \u00bc xt \u00fe ft. Dr\u00f0Da;De;Di;DX;Dx;Df \u00de is relative orbit elements of two space-\ncrafts, and Da \u00bc at ? ac, De \u00bc et ? ec, Di \u00bc it ? ic, DX \u00bc Xt ? Xc,\nDx \u00bc xt ? xc, Df \u00bc ft ? fc, Du \u00bc ut ? uc \u00bc Dx\u00feDf .\n\nThe actual relative position vector q and projection relative position vector q0\n\nsatisfy q \u00bc rt ? q0 \u00fe \u00f0rt ? rc\u00deI, and I \u00bc 1 0 0\u00bd ?T. The actual relative position\nvector q is\n\nx \u00bc rt\u00f01\u00fe x0\u00de ? rc\ny \u00bc rty0\nz \u00bc rtz0\n\n8><\n>: \u00f03:48\u00de\n\nwhere x y z\u00bd ?T is the component array in the active spacecraft centroid orbit\ncoordinate system of the vector q, and rc and rt are the geocentric distance of the\nactive spacecraft and the target spacecraft.\n\n70 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nIt can be seen from the relative motion equation that different from the relative\nmotion described by the algebraic method, all the sub-items of the equation derived\nfrom the geometric method are periodic and do not contain the non-periodic term,\nbecause the geometric derivation process does not have any simplification, while\nthe algebraic method is derived from the linearized Lawden equation.\n\nThe following describes the relative velocity of the active spacecraft and the\n\ntarget spacecraft. According to the vector formula dqdt \u00bc\nd0q\ndt \u00fex? q of the rotating\n\ncoordinate system, the relative velocity vector t\n*0\n\nof the two spacecrafts units sphere\nprojection in the reference coordinate system is given as follows [3]:\n\n_x0\n\n_y0\n\n_z0\n\n0\n@\n\n1\nA \u00bc tut\n\nrt\n?MCI \u00f0MTI \u00deT\n\n0\n1\n0\n\n0\n@\n\n1\nA? tuc\n\nrc\n?\n\n0\n1\n0\n\n0\n@\n\n1\nA? 0 ?x 0x 0 0\n\n0 0 0\n\n0\n@\n\n1\nA x0y0\n\nz0\n\n0\n@\n\n1\nA \u00f03:49\u00de\n\nwhere tuc and tut are, respectively, velocity vector in the velocity direction of the\nactive spacecraft and the target spacecraft, and the expression is\n\ntuc \u00bc\nffiffiffiffiffi\nl\npc\n\nr\n\u00f01\u00fe ec cos fc\u00de; tut \u00bc\n\nffiffiffiffi\nl\npt\n\nr\n\u00f01\u00fe et cos ft\u00de \u00f03:50\u00de\n\nt is actual relative velocity vector of the active spacecraft and the target\nspacecraft, trc and trt are, respectively, velocity vector in the radial direction of the\nactive spacecraft and the target spacecraft, and the expression is\n\ntrc \u00bc\nffiffiffiffiffi\nl\npc\n\nr\nec sin fc; trt \u00bc\n\nffiffiffiffi\nl\npt\n\nr\net sin ft \u00f03:51\u00de\n\nThe expression of actual relative velocity vector t is as follows:\n\n_x \u00bc rt _x0 \u00fe trtx0 \u00fe trt ? trc\n_y \u00bc rt _y0 \u00fe trty0\n_z \u00bc rt _z0 \u00fe trtz0\n\n8><\n>: \u00f03:52\u00de\n\nFormulas (3.48) and (3.52) are the complete relative motion models of the active\nspacecraft and the target spacecraft on the elliptical orbit under the two-body\ncondition. The model does not have any approximation to the relative distance\nbetween two spacecrafts and reference orbit eccentricity. Theoretically, it is the\naccurate relative motion equation and can be used for the high accuracy simulation\nof the relative motion between the spacecrafts at any relative distance in any\neccentricity reference orbit.\n\n3.3 Formation Configuration Design Based on Geometry 71\n\n\n\n3.3.2 First-Order Approximation Model of Relative Motion\n\nThe high accuracy of the accurate relative motion model makes the expansion of the\nmodel relatively complicated, which is difficult to be used directly in the formation\nconfiguration design. The approximate model, which satisfies the eccentricity\nrequirement of the different tasks, can be obtained by series expansion on the true\nanomaly fc of the active spacecraft in the accurate model according to eccentricity\nec. In addition, keeping the first- or second-order term of the relative distance of two\nspacecrafts, simplifying the exact model, an approximate model that satisfies the\nrelative distance requirements of different tasks is obtained. Since the first-order\napproximation model is mainly used to study the short-range formation flight, while\nthe second-order approximation model is mostly used for long-range formation\nflight, for the key of this book, only the first-order approximation of the relative\ndistance is studied in the following, and the first-order approximate relative motion\nmodel is obtained.\n\nAccording to the basic relation of the elliptical orbit motion [5], the relative\nmotion equation can be simplified as the following first-order approximate relative\nmotion model by preserving the first order of the relative orbit elements [6]\n\nx \u00bc rc\nac\n\nDa? ac cos fcDe\u00fe acecffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\np sin fcDM\ny \u00bc rc sin fc1? e2c\n\n2\u00fe ec cos fc\u00f0 \u00deDe\u00fe cos icDX\u00feDx\u00fe acrc\n\n? \t2 ffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\nq\nDM\n\n\" #\n\nz \u00bc rt sin utDi? sin ic cos utDX\u00bd ?\n\n8>>>>>><\n>>>>>>:\n\n\u00f03:53\u00de\n\nThe velocity component in the three directions from the active spacecraft to the\ntarget spacecraft is\n\n_x \u00bc ? trc\n2ac\n\nDa\u00fe\nffiffiffi\nl\na\n\nr\nac\nrc\n\n? \t2\nsin fc\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\nq\nDe\u00fe ec cos fcDM\n\n? ?\n\n_y \u00bc ? 3tuc\n2ac\n\nDa\u00fe De\n1? e2c\n\ntrt sin fc 2\u00fe ec cos fc\u00f0 \u00de\u00fe tuc 2 cos fc 1\u00fe ec cos fc\u00f0 \u00de ? ec\u00bd ?f g\n\n\u00fe trt cos icDX\u00feDx\u00f0 \u00de\u00fe acrc\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\nq\ntrt\n\nac\nrc\n\n? tuc 2ec sin fc1? e2c\n\n? ?\nDM\n\n_z \u00bc trt sin ut \u00fe tut cos ut\u00bd ?Di\u00fe sin ic ?trt cos ut \u00fe tut sin ut\u00bd ?DX\n\n8>>>>>>>>>><\n>>>>>>>>>>:\n\n\u00f03:54\u00de\n\nwhere at any time t, mean anomaly difference DM(t) of two spacecrafts is expressed\nas\n\n72 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nDM\u00f0t\u00de \u00bc nt Dt\u00fe t0 ? st\u00f0 \u00de ? nc Dt\u00fe t0 ? sc\u00f0 \u00de \u00bc DnDt\u00feDM0 \u00f03:55\u00de\n\nwhere nc and nt are average angle velocity, sc and st are the time passed perigee,\nand DM0 is the mean anomaly difference at start time, Dt = t ? t0, Dn = nt ? nc.\n\n3.3.3 Formation Configuration Design\n\nThe necessary conditions for the periodic relative motion of the two spacecrafts are\nthe equal length of the orbit semimajor axis, i.e., ac = at, Da = 0, then nc = nt,\nDM = DM0, the relative motion equation under this condition can be simplified as\n\nx \u00bc ?ac cos fcDe\u00fe acecffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\np sin fcDM0\ny \u00bc rc sin fc1? e2c\n\n2\u00fe ec cos fc\u00f0 \u00deDe\u00fe cos icDX\u00feDx\u00fe acrc\n\n? \t2 ffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\nq\nDM0\n\n\" #\n\nz \u00bc rt sin utDi? sin ic cos utDX\u00bd ?\n\n8>>>>>><\n>>>>>>:\n\n\u00f03:56\u00de\n\nIn the following, the above equation is used to design the formation configu-\nration, and several special relative motion trajectories of the active spacecraft rel-\native to the target spacecraft, straight line, circle, ellipse [7], are obtained.\n\n1. Straight line configuration\n(1) The amplitude of perigee of two spacecrafts is different, the other orbit elements\n\nare equal, and the equation is simplified\n\ny \u00bc rcDx \u00f03:57\u00de\n\nSince rc is time-varying, the relative motion trajectory is a segment in the y-\ndirection.\n\n(2) The inclination of two spacecrafts is different, the other orbit elements are\nequal, and the equation is simplified\n\nz \u00bc rt sin utDi \u00f03:58\u00de\n\nSince rt and ut is time-varying, the relative motion trajectory is a segment in the\nz-direction.\n\n2. Circle configuration\n\nThe mean anomaly is different, the other orbit elements are equal, and the equation\nis simplified\n\n3.3 Formation Configuration Design Based on Geometry 73\n\n\n\nx \u00bc acecffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\np sin fcDM0\ny \u00bc rc acrc\n\n? \t2 ffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2c\n\nq\nDM0\n\n8>>><\n>>>:\n\n\u00f03:59\u00de\n\nMaking k \u00bc acecffiffiffiffiffiffiffiffi\n1?e2c\n\np DM0, since rc \u00bc ac 1?e\n2\nc\u00f0 \u00de\n\n1\u00fe ec cos fc, it can be derived that\n\nx \u00bc k sin fc\ny \u00bc k cos fc \u00fe ac1? e2c\n\nDM0\n\n8<\n: \u00f03:60\u00de\n\nIt can be seen that when true anomaly changes, the relative motion trajectory is\n\ncircle configuration, and center is 0; ac1?e2c DM0\n\n ?\n\n, and radius is k.\n\n3. Ellipse configuration\n\nWhen the longitude of ascending node and amplitude of perigee of two space-\ncrafts is different, the equation is simplified\n\ny \u00bc rc cos icDX\u00feDx\u00f0 \u00de\nz \u00bc ?rt sin ic cos utDX\n\n(\n\u00f03:61\u00de\n\nMaking k1 \u00bc at\u00f01? e2t \u00de\u00f0Dx\u00fe cos icDX\u00de, k2 \u00bc at\u00f01? e2t \u00de cosxt sin icDX,\nk3 \u00bc at\u00f01? e2t \u00de sinxt sin icDX, since Dr is small amount relative to rc, so rc ? rt,\nthe equation is changed into\n\ny \u00bc k1\n1\u00fe et cos ft\n\nz \u00bc ? k2\n1\u00fe et cos ft cos ft \u00fe\n\nk3\n1\u00fe et cos ft sin ft\n\n8>><\n>>: \u00f03:62\u00de\n\nEliminating ft, it can be obtained\n\nk1z? k1k2et y\u00fe\nk2\net\ny\n\n? ?2\n\u00fe 1\n\ne2t\n? 1\n\n? \t\ny2 ? 2k1\n\ne2t\ny\u00fe k\n\n2\n1\n\ne2t\n\n? ?\nk23 \u00bc 0 \u00f03:63\u00de\n\nSince the equation discriminant D > 0, the relative motion trajectory is an ellipse\nequation perpendicular to the orbit plane.\n\n74 3 Formation Configuration Design of Elliptical Orbit\n\n\n\nReferences\n\n1. Gokhan Inalhan, Jonathan P. H. Relative Dynamics & Control of Spacecraft Formations in\nEccentric Orbits [C]. AIAA Guidance, Navigation, and Control Conference and Exhibit, 2000:\n14\u201317.\n\n2. LU Xiang. Technology research of fly-around in different orbits in Highly Elliptic Orbits [D].\nShanghai: Shanghai Academy of Spaceflight Technology, 2009.\n\n3. AN Xue-ying. Dynamics and Application of Spacecraft Formation Flying in Eccentric Orbits\n[D]. Changsha: National University of Defense Technology, 2006.\n\n4. Vadali S R. An Analytical Solution for relative motion of Satellites [C]. In: 5th International\nConference on Dynamics and Control of Systems and Structures in Space, 2002: 309\u2013316.\n\n5. LIU Lin. Orbit theory of spacecraft [M]. Beijing: National Defense Industry Press, 2000.\n6. AN Xue-ying, YANG Le-ping, ZHANG Wei-hua, XI Xiao-ning. Relative Motion Analysis of\n\nthe Spacecraft Formation Flight in Highly Elliptic Orbits [J]. Journal of National University of\nDefense Technology, 2005, 27(2): 1\u20134.\n\n7. WANG Gong-bo, XI Xiao-ning. Several Relative Formation of Spacecrafts Flight in Highly\nElliptic Orbits Based on Relative Orbit Elements [J]. Journal of National University of Defense\nTechnology, 2009, 31(2): 10\u201314.\n\nReferences 75\n\n\n\nChapter 4\nAutonomous Navigation Technology\nof Whole Space\n\n4.1 Introduction\n\nAutonomous navigation for spacecraft in large elliptical orbit refers to that the\nspacecraft can determine its parameter on orbit in real time, independent on mea-\nsurement and control of ground station. Once in-orbit spacecraft navigate autono-\nmously, it decreases the dependence on ground station and greatly improves the\nviability. Even in such bad situation that the tracking measurement on the ground has\nbeen interrupted over a period of time, the spacecraft could keep the continuity of the\ntasks. Therefore, autonomous navigation for spacecraft in large elliptical orbit is the\nprimary requirement of automatically working and task accomplishing. In the cur-\nrent spacecraft autonomous navigation technology, there are three methods that are\nsuitable to spacecraft in large elliptical orbit: celestial autonomous navigation based\non astronomical observation, autonomous navigation based on inertial navigation\nsystem, and autonomous navigation based on global positioning system. Choosing\ndifferent navigation methods or combining different navigation methods together for\nmission requirements of different orbit segments of large elliptical orbit can meet the\nrequirement of autonomous navigation of spacecraft in large elliptical orbit [1].\n\nCelestial navigation system (CNS), which is based on astronomical observation,\nis a traditional navigation method, with thousands years of history, and is firstly used\nat voyages. With aerospace technology development, CNS is widely used in aero-\nspace and has good effect on navigation. The basic principle of celestial navigation is\nmeasuring azimuth message of celestial to determine its position and attitude by\nsensors of celestial (including star sensor, sun sensor, infrared horizon). With\nadvantages of strong autonomy, non-cumulative error and high attitude measure-\nment accuracy it\u2019s an indispensable autonomous navigation system for the spacecraft\nin large elliptical orbit that have high autonomous requirement [2].\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_4\n\n77\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_4&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_4&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_4&amp;domain=pdf\n\n\nStrapdown inertial navigation system (SINS) is developed according to\nNewton\u2019s dynamics principle and works on the inertia principle, which is the\ninherent property of any object. Therefore, SINS could navigate in all-weather and\nworldwide without information exchange. With advantages such as passive,\nautonomous, hideous, comprehensive, and continuous output of navigation infor-\nmation, it is an ideal autonomous navigation system for military use [3]. As for\nspacecraft in freely fly segment, SINS is not sensitive to the accelerate information\ncaused by gravitation, so it is helpless for navigation calculation. In this situation,\nSINS is only used for the calculation of spacecraft attitude determination, and only\nwhen spacecraft maneuverable accelerating, the whole SINS would be used for\norbit parameter editing and calculating. As for the spacecraft on the synchronous\ntransfer large elliptical orbit, during its process from low orbit to high orbit, it need\nrepeatedly midcourse orbit modification, so equipping the SINS to track and cal-\nculate the orbit parameter changes in real time is indispensable. However, the\nnavigation error will accumulate over time because the navigation and position of\nSINS are based on integrating the measurement of inertial components.\n\nGlobal positioning satellite system (GNSS) includes the existing running\nGPS navigation system, and Russian GLONASS navigation system, European\nGALILEO, and China Beidou second-generation navigation system which is about\nto complete in the near future, the rationale of navigation is calculating the position\nand speed directly based on the received navigation signal, and its error is bounded,\nwhich does not accumulate over time and has well long-term stability. However, the\nauthority of GPS navigation system is not owned by users. Although GLONASS,\nGALILEO, and Beidou second-generation navigation system will be completed in\nthe foreseeable future, users can improve the accuracy and fault tolerance perfor-\nmance by receiving multiple system Navstar signals, but the navigation system of\nnavigation constellation may be damaged or malfunctioned. Therefore, although the\nnavigation method based on GNSS has high precision, it does not have absolute\nautonomy and security; in addition, because of the low navigation calculation, data\nupdating rates based on GNSS cannot meet the requirement of the real-time control;\nGNSS navigation system is only used as an auxiliary navigation equipment for\nspacecraft on large elliptical orbit.\n\nAccording to the advantages and disadvantages of SINS, GNSS, and CNS and\ntheir complementarities of error propagation performance, these systems could be\norganically combined. When spacecraft is non-maneuvering operating on the\nelliptical orbit, combining the GNSS/CNS navigation system with orbital dynamic\nequations could provide spacecraft navigation parameters; when spacecraft is\nmaneuvering on orbit, combination of SINS/CNS/GNSS navigation system could\nnot only improve the precision of spacecraft autonomous navigation on large\nelliptical orbit, but also improve the fault tolerance and reliability greatly at the\nsame time.\n\nThe SINS/CNS/GNSS combination-based autonomous navigation method for\nspacecraft in large elliptical orbit realizes the complementary of advantages of each\n\n78 4 Autonomous Navigation Technology of Whole Space\n\n\n\nsensor and the high-precision autonomous navigation in theory, but the spacecraft\noperating in a large elliptical orbit has its own unique orbit environment, when\nchanging spacecraft orbit altitude from hundreds of kilometers to tens of thousands\nof kilometers, it requires the earth sensor view field ranges from 10\u00b0 to above 100\u00b0,\nand in this process, accurate capture of the geocentric vector is difficult to achieve\nfor horizon sensor. In addition, when spacecraft operating in high orbit segment,\nbecause its orbit altitude is higher than that of GNSS navigation system, it can only\nreceive the GNSS signals from the back of earth. Generally, because of the link loss\nand the shield of earth, the effective visible navigation star is difficult to be more\nthan four and the visible period is not long.\n\nIn this chapter, an autonomous navigation method for large elliptical orbit\nspacecraft has been put forward, which is mainly for the particularity of large\nelliptical orbit spacecraft operating environment. Firstly, two kinds of astronomical\nautonomous navigation methods based on star astronomical observation, which are\nbased on infrared horizon/star sensor and on earth ultraviolet imaging/star sensor,\nrespectively, are introduced; then, the autonomous navigation method based on\nGNSS navigation system for spacecraft in large elliptical orbit is analyzed,\nincluding the number of visible navigation star, visible navigation constellation\nconfiguration, and GNSS autonomous navigation method based on dynamic con-\nstraint; On this basis, an autonomous navigation method based on SINS/star sensor/\nGNSS federal filter combination for spacecraft in large elliptical orbit maneuvering\nsection is proposed, which can effectively solve the autonomous navigation prob-\nlem of spacecraft in the process of a wide range of maneuvering.\n\n4.2 Common Autonomous Navigation Method\nof Elliptical Orbit\n\n4.2.1 Autonomous Navigation Technology of Elliptical\nOrbit Based on Astronomical Observation\n\nCelestial navigation system (CNS) is a passive autonomous navigation method,\nwhich could calculate the position and attitude of motion body with celestial\nposition information measured by celestial sensors. With advantages, such as high\nmeasurement accuracy, comprehensive output navigation information, no\ntime-accumulating error, strong robustness, high reliability, it is an important\nnavigation method. The rationale of CNS is using the kinetic equation as state\nequation to make optimal filtering estimation with celestial measurement infor-\nmation (argument, distance, and refraction of starlight), which are relative to\nposition of operating satellite, so as to estimate the real-time position and velocity\nof satellite accurately [4]. In this section, the celestial navigation methods,\nrespectively, based on infrared horizon/star sensor celestial autonomous navigation\nmethod and earth ultraviolet imaging/star sensor are introduced.\n\n4.1 Introduction 79\n\n\n\n1. Autonomous navigation technology based on infrared horizon/star sensor\n\nThe rationale and process of celestial autonomous navigation based on infrared\nhorizon are: the navigation system recognizes the stellar by star sensor, and mea-\nsures the starlight direction on star sensor measurement coordinate, and obtain its\ndirection on body coordinate by the transforming of install matrix of star sensor; the\nnavigation system calculate the direction of the earth\u2019s core vector on body coor-\ndinate by using the geometrical relationship between spacecraft and earth measured\nby infrared horizon sensor, thus, measurement information of celestial navigation:\nstarlight angular and geometric distance are obtained. Then, the optimal estimated\nvalue of spacecraft orbit parameter can be estimated according to optimal filtering\nalgorithm combined with orbit dynamics.\n\nIn the celestial navigation methods based on infrared horizon sensor, the obser-\nvation generally adopted is star observation angle, distance, and combination of\nthem. The starlight angular distance is the angle between the direction of navigation\nstar vector and geocentric vector, which is observed by spacecraft. Its specific\nmeasurement process requires a star sensor and an infrared horizon instrument.\n\nThe expression and corresponding measurement equation of starlight angle are:\n\na \u00bc arccos ? r ? s\nrj j\n\n? ?\n\u00f04:1\u00de\n\nZ1\u00f0k\u00de \u00bc arccos ? r ? srj j\n? ?\n\n\u00fe va \u00f04:2\u00de\n\nThe expression and corresponding measurement equation of geocentric\ndistance are:\n\nr \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2 \u00fe y2 \u00fe z2\n\np\n\u00f04:3\u00de\n\nZ2\u00f0k\u00de \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2 \u00fe y2 \u00fe z2\n\np\n\u00fe vr \u00f04:4\u00de\n\n1) State equation\n\nIn the celestial autonomous navigation method based on infrared sensitive\nhorizon/star sensor, the satellite orbit dynamics based on rectangular coordinate\nsystem is commonly used for optimal estimative state equation, in epoch (known as\nJ2000) geocentric inertial coordinate, which is specific as follows:\n\n80 4 Autonomous Navigation Technology of Whole Space\n\n\n\ndx\ndt \u00bc vx\ndy\ndt \u00bc vy\ndz\ndt \u00bc vz\ndvx\ndt \u00bc ?l xr3 1? J2 Rer\n\n? ?\n7:5 z\n\n2\n\nr2 ? 1:5\n? ?h i\n\ndvy\ndt \u00bc ?l\n\ny\nr3 1? J2 Rer\n\n? ?\n7:5 z\n\n2\n\nr2 ? 1:5\n? ?h i\n\ndvz\ndt \u00bc ?l zr3 1? J2 Rer\n\n? ?\n7:5 z\n\n2\n\nr2 ? 4:5\n? ?h i\n\n8>>>>>>>>>>>><\n>>>>>>>>>>>>:\n\n\u00f04:5\u00de\n\nAbbreviated as:\n\n_X\u00f0t\u00de \u00bc f \u00f0X; t\u00de\u00few\u00f0t\u00de \u00f04:6\u00de\n\nIn the equation: state X \u00bc \u00bdx; y; z; vx; vy; vz?T, respectively, stand for the positions\nand velocities in three axes of spacecraft in geocentric inertial coordinate; J2 is\ngravity coefficient; DFx;DFy;DFz is the earth\u2019s non-spherical high-order pertur-\nbation term, the accelerated velocity of solar-lunar perturbation, solar radiation\npressure perturbation, and atmosphere perturbation.\n\nDiscretize the Eq. (4.6):\n\nXk\u00fe 1 \u00bc f \u00f0Xk; k\u00de \u00f04:7\u00de\n\nf \u00f0Xk; k\u00de is orbit forecasting function, which is an orbit extrapolating process.\nTaylor expands the (4.7) at previous optimal filtering estimation X?k=k and\n\nregards the item more than two orders as the dynamic noise of system:\n\nXk\u00fe 1 \u00bc f Xk=k; k\n? ?\u00fe @f Xk; k\u00bd ?\n\n@Xk\n\n\t\t\t\t\nXk\u00bcX?k=k\n\nXk ? X?k=k\n? ?\u00feC Xk; k\u00bd ?Wk \u00f04:8\u00de\n\nIn the (4.8), Wk is dynamic noise of system, C Xk; k\u00bd ? is coefficient matrix of\ndynamic noise, and the state-transition matrix could be expressed as:\n\nUk\u00fe 1=k \u00bc @f Xk; k\u00bd ?\n@Xk\n\n\t\t\t\t\nXk\u00bcX?k=k\n\n\u00f04:9\u00de\n\n2) Measurement equation\n\nThe starlight angle distance constituted by star sensor output starlight vector and\nhorizon sensor output geocentric vector is observable for satellite position, and\nspecific measurement equation for single starlight angle distance is:\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 81\n\n\n\nda \u00bc @a@x @a@y @a@z\nh i dx\n\ndy\ndz\n\n2\n4\n\n3\n5\u00feDs \u00f04:10\u00de\n\nwhich\n\n@a\n@x\n\n\u00bc ?\u00f0sx ? x\n2 \u00fe\u00f0sy ? y\u00fe sz ? z\u00de ? x? sx ? r2\u00de\n\nr2 ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr2 ? \u00f0x ? sx \u00fe y ? sy \u00fe z ? sz\u00de2\n\nq ;\n@a\n@y\n\n\u00bc ?\u00f0sy ? y\n2 \u00fe\u00f0sx ? x\u00fe sz ? z\u00de ? y? sy ? r2\u00de\n\nr2 ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr2 ? \u00f0x ? sx \u00fe y ? sy \u00fe z ? sz\u00de2\n\nq\n\n@a\n@y\n\n\u00bc ?\u00f0sz ? z\n2 \u00fe\u00f0sx ? x\u00fe sy ? y\u00de ? z? sz ? r2\u00de\n\nr2 ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr2 ? \u00f0x ? sx \u00fe y ? sy \u00fe z ? sz\u00de2\n\nq ; r \u00bc ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\u00f0x2 \u00fe y2 \u00fe z2\u00dep\n\nDs is the measuring error of starlight angle distance, which mainly considers the\nerror of horizon sensor.\n\nrC is the distance from satellite to earth, which could be calculated directly by\nthe measurement of horizon, and the specific measurement equation is:\n\ndr \u00bc @r@x @r@y @r@z\nh i dx\n\ndy\ndz\n\n2\n4\n\n3\n5\u00feDr \u00f04:11\u00de\n\n2. The autonomous navigation technology based on ultraviolet earth\nimaging/star sensor\n\nBeing composed of a wide-angle imaging plane, static imaging-type ultraviolet\nhorizon sensor can image the ultraviolet edge of earth, so as to measure and output\nthe direction and distance of geocentric vector. Ultraviolet sensors first image earth\nto obtain the ideal image, so as to obtain the coordinate value of the geocenter on\nsensor measurement coordinate, and then transfer it to space vector in the sensor\ncoordinate system. Establish the relationship between measuring camera focal\nlength, the position of focal plane image point, and the radius of the earth and the\ngeocenter according to the principles of triangle similarity, so as to calculate the\ndistance between the satellites and earth.\n\nUltraviolet horizon instrument CCD sensor coordinate system is defined as\nshown in Fig. 4.1, z-axis parallel to the peripheral optical axis of the CCD sensor, x-\naxis and-y axis parallel to two sides of sensitive plane, respectively; the original\npoint is orthocenter on optical axis in CCD sensitive plane. f is the focal length of\n\n82 4 Autonomous Navigation Technology of Whole Space\n\n\n\nthe CCD sensor, the coordinates of the earth\u2019s center on the CCD sensor coordinate\nsystem are (x1, y1, 0), and then, the center vector of the earth P in the sensor\ncoordinate system can be calculated.\n\nThe principle for ultraviolet horizon instrument calculating the center distance is\nas shown in Fig. 4.2. Re is the radius of earth, f is the sensitive focal length, and the\nvalue of m could be defined according to the size of the earth\u2019s image on the CCD.\nAccording to the triangle similarity:\n\nM\nm \u00bc Df\n\nReffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0M=2\u00de2 \u00fe\u00f0D\u00de2\n\np \u00bc M=2D\n\n(\n\u00f04:12\u00de\n\nM, D is unknown, and could be calculated, the distance from satellite to the\ngeocenter is:\n\nr \u00bc D\u00fe\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nR2e ? \u00f0M=2\u00de2\n\nq\n\u00f04:13\u00de\n\nx\n\ny\n\nz\n\nf\n\nO\n\n(x1,y1)\n\nP\n\n(-x1,-y1)\n\nFig. 4.1 Sketch of CCD\nsensor coordinate and\ngeocentric direction vector\n\nf\nm\n\nDM\n\nO\n\nRe\n\nFig. 4.2 Geometrical relationship between the radium and distance from satellite\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 83\n\n\n\nMaking use of the imaging characteristics of ultraviolet earth sensor and com-\nbining the measurement of star sensor, the spacecraft attitude and the radius of earth\ncan be calculated; finally, the center unit vector r/r and distance between the\ngeocenter r can be constructed, and observation equations is:\n\nThe geocentric vector observation equation is as follows:\n\nCib ? P1 \u00bc r= rj j \u00fe vLr \u00f04:14\u00de\n\nThe geocentric distance observation equation is as follows:\n\nr1 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2 \u00fe y2 \u00fe z2\n\np\n\u00fe vr \u00f04:15\u00de\n\nwhere r = (x, y, z) is the position of spacecraft in geocentric inertial coordinate\nsystem; P is the geocentric vector in ultraviolet sensors measuring coordinate sys-\ntem; rj j is the geocentric distance measured by ultraviolet sensor; Cib is the attitude\nmatrix output by star sensor; and vLr is observation noise of geocentric vector.\n\nThe functional block diagram of spacecraft autonomous navigation based on\nstatic imaging horizon instrument and the star sensor is as shown in Fig. 4.3. The\nmeasurement processing and navigation calculation are:\n\n(1) Use measurement of star sensor to output the spacecraft\u2019s inertia attitude\nquaternion, and then, the transformation matrix between inertial system\nspacecraft body coordinate system and inertial coordinate system is obtained.\n\n(2) Make use of ultraviolet earth sensor to measure the image of earth, determine\nthe direction of geocentric vector on body coordinate system, then direction of\ngeocentric vector on inertial system can be obtained with output of star sensor,\nand then, the geocentric distance can be calculated. These two contain the\nposition information of the spacecraft.\n\n(3) Upon repeated measurement of sensor, as well as recursive filtering spacecraft\nof orbital dynamic model, the optimal orbit parameters are estimated, and the\nspacecraft autonomous navigation is realized.\n\nStar sensor\n\nStatic ultraviolet \nhorizon instrument\n\nb\n\nr\nr\n\ni\ni b b= \u00d7\n\nr rC\nr r\n\ni\nr\nr\n\nEKF\n\nOrbit\ndynamics\n\nx y z x y z, , , , ,\n\ni\nbC\n\nr\n\nFig. 4.3 Autonomous navigation principle based on ultraviolet horizon instrument/star sensor\n\n84 4 Autonomous Navigation Technology of Whole Space\n\n\n\n4.2.2 Autonomous Navigation Technology of Elliptical\nOrbit Based on GNSS\n\n1. GNSS navigation star analysis for spacecraft in large elliptical orbit\n\nBecause of its specific operating environment, the spacecraft in medium or high\norbit could receive few navigation star signal compared with users on ground; With\nregard to the spacecraft in large elliptical orbit, when they are operating at low orbit,\nthey could receive much signal from GNSS navigation star, but when they are\noperating at high orbit, the valid star decreased sharply. Therefore, before analyzing\nlarge elliptical spacecraft autonomous navigation based on GNSS system, it should\nbe first to analyze the number of navigation stars whose signal can be received by\nhigh-orbit spacecraft (visible navigation star).\n\n1) The affecting factor of the GNSS navigation star visibility\n\nThe visibility of high earth orbit satellite (HEO) for global navigation satellite\nsystem (GNSS) is mainly depended on the following factors:\n\n(1) Because of earth shielding factors, the spacecraft cannot receive navigation\nsatellite signal; at this time, the navigation satellite on the back of the earth is\ninvisible satellites, as is shown in Fig. 4.4.\n\n(2) Whether the transmitting half-angle a1 of GNSS satellites and receiving\nhalf-angle a2 of user satellite are within the range, where the signal is guar-\nanteed to be received. As is shown in Fig. 4.5, only when a1 is less than the\nbeam angle of antenna transmitting signal, the user is likely to receive the signal\nsatellite from navigation star. Not only receiving of main lobe signal, but also\nside lobe signal is considered, criteria of a1 is if it is no more than 65\u00b0, and it\ncan be received (the beam half-angle of main lobe signal is 21.3\u00b0). Receiving\nhalf-angle a2 refers to the angle between the direction of user satellite receiving\nantenna and the direction of navigation star connection; when a2 is less than\n90\u00b0, the user can receive the signal from navigation stars. Generally, the\ntransmitting antenna of GNSS satellites is toward the ground, in the following\nsimulation, assume the user satellites is in the range of a1 ? 65\u00b0, and then,\nusers can receive satellite navigation signal.\n\nEarth\n\nUser SatelliteFig. 4.4 Satellite sheltered\nfrom earth\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 85\n\n\n\n(3) Whether the signal strength received from GNSS receiver is greater than\nthreshold.\n\nFor HEO satellite, if the margin of signal received by operating satellite from\nnavigation satellite via space link is less than the receiver threshold, the navigation\nsatellite signal cannot be received, and the signal margin power received by\noperating satellite is:\n\nPr\u00f0dBW\u00de \u00bc PEIRP\u00f0dBW\u00de\u00feGr\u00f0dB\u00de ? Ld\u00f0dB\u00de \u00f04:16\u00de\n\nPEIRP\u00f0dBW\u00de is the equivalent omnidirectional radiated power, which is the\nproduct of the satellite antenna power Pt and the antenna gain Gt:\n\nPEIRP\u00f0dBW\u00de \u00bc 10 ? log10\u00f0Pt\u00de\u00feGt \u00f04:17\u00de\n\nGr is the receiving antenna gain, Ld is the loss of space link, and the expression\nis as follows:\n\nLd\u00f0dB\u00de \u00bc 20 lg k4pR \u00f0dB\u00de \u00f04:18\u00de\n\nk is the wavelength of transmitting signal; R is the transmission distance of\nsignal.\n\nOnly when the above three factors are satisfied, HEO satellite could receive\nnavigation satellite signal [5].\n\n2) Simulation analysis of GNSS navigation star in large orbit elliptical orbit\n\nSetting up the original state value of spacecraft in large elliptical orbit:\nX \u00bc \u00bd8;395;156; 43;957:29; 51:14; ?40:389; 8;904:399; 15:541?, the front\n\nthree items of X are initial value of position, and other three are initial values of speed.\nSet up transmitting antenna power of each navigation constellation: 5 W, and\nreceiving antenna gain is: 3 dB. Set up simulation time: t = 10000 s, and the rela-\ntionship between transmitting antenna gain and signal emission angle is as shown in\nFig. 4.6.\n\nEarth\n\nUser Satellite\n\nNavigation Satellite\n\na2\n\na1\n\nFig. 4.5 Half-angle of send\nand receive\n\n86 4 Autonomous Navigation Technology of Whole Space\n\n\n\nSet up the receiver with typical sensitivity and simulate the number of visible star\nbased on GPS, based on GPS + Beidou second generation, based on GPS + Beidou\nsecond-generation + GLONASS, and based on GPS + GLONASS + GALLIEO +\nBeidou second generation, respectively.\n\n(1) When only considering GNSS satellite transmitting signal main lobe, set up the\nreceiver sensitivity as ?140, ?150, and ?160 dBm, respectively; the simulation\nresult of visible stars number is shown in Figs. 4.7, 4.8, and 4.9.\n\nFig. 4.6 Relationship\nbetween transmitting antenna\ngain and signal emission\nangle\n\n0 5 10\nx 104\n\n0\n\n5\n\n10\n\n15\n\n20\n\nt/s\n\nB\nD\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\n40\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\n80\n\nt/sB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n+G\n\nA\nLL\n\nIE\nO\n\nFig. 4.7 Simulation of visible navigation star number with sensitivity of ?140 dBm\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 87\n\n\n\n0 5 10\nx 104\n\n0\n\n5\n\n10\n\n15\n\n20\n\nt/s\n\nB\nD\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\n40\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\n80\n\nt/sB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n+G\n\nA\nLL\n\nIE\nO\n\nFig. 4.8 Simulation of visible navigation star number with sensitivity of ?150 dBm\n\n0 5 10\nx 10 4\n\n0\n\n5\n\n10\n\n15\n\n20\n\nt/s\n\nB\nD\n\n0 5 10\nx 10 4\n\n0\n\n10\n\n20\n\n30\n\n40\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n0 5 10\nx 10 4\n\n0\n\n20\n\n40\n\n60\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n\n0 5 10\nx 10 4\n\n0\n\n20\n\n40\n\n60\n\n80\n\nt/sB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n+G\n\nA\nLL\n\nIE\nO\n\nFig. 4.9 Simulation of visible navigation star number with sensitivity of ?160 dBm\n\n88 4 Autonomous Navigation Technology of Whole Space\n\n\n\n0 5 10\nx 104\n\n0\n\n5\n\n10\n\n15\n\n20\n\nt/s\n\nB\nD\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\n40\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\n80\n\nt/sB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n+G\n\nA\nLL\n\nIE\nO\n\nFig. 4.10 Simulation of visible navigation star number with sensitivity of ?140 dBm\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\nt/s\n\nB\nD\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\n80\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n\n0 5 10\nx 104\n\n0\n\n50\n\n100\n\nt/sB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n+G\n\nA\nLL\n\nIE\nO\n\nFig. 4.11 Simulation of visible navigation star number with sensitivity of ?150 dBm\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 89\n\n\n\n(2) When considering GNSS satellite transmitting side lobe signal, receiver sen-\nsitivity is set up, respectively, as ?40, ?150, and ?160 dBm, and the simulation\nresult is shown in Figs. 4.10, 4.11, and 4.12.\n\nUpon simulation results, following conclusion can be drawn:\n\n(1) When spacecraft in large elliptical orbit operates from low orbit segment to\nhigh orbit segment, visible navigation star number dropped sharply. When the\nspacecraft is at the perigee, the number of visible navigation star becomes the\nmost, and when the spacecraft is at apogee, the number of visible navigation\nstar becomes the smallest;\n\n(2) When the receiver sensitivity is set as ?140 and ?150 dBm, the number of\nnavigation star is the same no matter taking side lobe into consideration or not;\nso when the sensitivity is set to be less than ?150 dBm, receiver cannot take\neffective use of side lobe signal of navigation star transmitting antenna;\n\n(3) When the side lobe signal is not taken into consideration, the number of visible\nsatellite is the most if receiver sensitivity is set to be ?150 dBm; when the side\nlobe signal is considered, the number of visible star is most if the receiver\nsensitivity is set to be ?160 dBm. Therefore, when setting the receiver sensi-\ntivity to be ?160 dBm, receiver could take effective use of side lobe signal of\nnavigation satellite transmitting antenna.\n\nWhen the receiver sensitivity is set to be higher than ?160 dBm, the simulation\nresults of visible star\u2019s number under each condition have no difference with that of\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\n40\n\nt/s\n\nB\nD\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n0 5 10\nx 104\n\n0\n\n20\n\n40\n\n60\n\n80\n\nt/s\n\nB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n\n0 5 10\nx 104\n\n0\n\n50\n\n100\n\n150\n\nt/sB\nD\n\n+G\nLO\n\nN\nA\n\nS\nS\n\n+G\nP\n\nS\n+G\n\nA\nLL\n\nIE\nO\n\nFig. 4.12 Simulation of visible navigation star number with sensitivity of ?160 dBm\n\n90 4 Autonomous Navigation Technology of Whole Space\n\n\n\nsensitivity of?160 dBm. Therefore, when the receiver sensitivity LMD = ?160 dBm,\nthe number of visible star ismost. To receive asmuchnumber of visible navigation stars\nas possible, the sensitivity of receiver could be set to be ?160 dBm.\n\n2. Orbit analysis and determination based on precision factor\n\n1) Configuration analysis of visible satellite of GNSS based on GDOP\n\nWhen using GNSS satellite to make spacecraft geometric dynamic orbit deter-\nmination, the accuracy of orbit determination depends on two factors:?Observation\naccuracy of pseudorange and pseudorange rate, generally, the errors caused by GNSS\nsatellite clock, ephemeris, ionospheric refraction in troposphere in signal transmission\nand receiver noise can be equivalent to the measurement errors of pseudorange and\npseudorange rate; ? The spatial geometric distribution of the observed GNSS\nsatelliteswhich is known as the geometry of the navigation satellites can also affect the\npositioning accuracy. Therefore, the error coefficient of GDOP must be taken into\naccount in dynamic geometric orbit determination to reflect the influence of the\ngeometry distribution of the navigation satellite on the positioning accuracy [6, 7]. For\nthe calculation of position and velocity of spacecraft in inertial coordinate system, the\ndesired GDOPs are as follows.\n\nPDOP: Three-dimensional spatial position accuracy factor;\nPDOPx: Accuracy factor of X-coordinate direction in geocentric inertial coordinate\nsystem;\nPDOPy: Accuracy factor of Y-coordinate direction in geocentric inertial coordinate\nsystem;\nPDOPz: Accuracy factor of Z-coordinate direction in geocentric inertial coordinate\nsystem;\nTDOP: The precision factor of receiver clock difference.\n\nFor multi-satellite constellation navigation system combination, the number of\nvisible navigation satellites at the same epoch has been increased, and the geometric\nconfiguration of satellite constellation has been improved, however, because of the\ndifference of clock error between each navigation system and receiver, a satellite\nnavigation system is added, the clock error of the system must be used as a variable,\nand a navigation satellite must be added to provide the necessary observation\namount. For multi-satellite navigation and position calculation based on GPS,\nGLONASS, GALLIEO, BD, there must be more than seven visible navigation\nsatellites. For multi-satellite constellation navigation system, when using code\npseudorange and Doppler frequency shift pseudorange rate as observed quantity to\nmake dynamic geometric orbit determination, the observation equation matrix that\nconsists of the direction cosine of the user receiver and the visible navigation\nsatellites is as follows\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 91\n\n\n\nH \u00bc\nHGPS 1GPS 0GPS 0GPS 0GPS\nHGLO 0GLO 1GLO 0GLO 0GLO\nHGAL 0GAL 0GAL 1GAL 0GAL\nHBD 0BD 0BD 0BD 1BD\n\n2\n664\n\n3\n775 \u00f04:19\u00de\n\nHS(S = GPS/GLONASS/GALLIEO/BD) is the first three columns of the\nsatellite pseudorange observation matrix of each navigation system, is the k ? 3\ndimensional matrix, and is the number of the visible navigation satellites in one\nnavigation system; 1S; 0S are k ? 1 dimensional constant matrices.\n\nHS \u00bc\n\neS11 e\nS\n12 e\n\nS\n13\n\n..\n\n. ..\n. ..\n\n.\n\neSi1 e\nS\ni2 e\n\nS\ni3\n\n..\n\n. ..\n. ..\n\n.\n\n2\n66664\n\n3\n77775 \u00f04:20\u00de\n\neSi1 \u00bc\nx? xSi\nrSi\n\n; eSi2 \u00bc\ny? ySi\nrSi\n\n; eSi3 \u00bc\nz? zSi\nrSi\n\n; rSi \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? xSi \u00de2 \u00fe\u00f0y? ySi \u00de2 \u00fe\u00f0z? zSi \u00de2\n\nq\n\nx, y, z are the real-time coordinates of high-orbit satellite; xSi ; y\nS\ni ; z\n\nS\ni are navigation\n\nsatellite coordinates of S navigation system.\nSuppose the weighted coefficient matrix\n\nQ \u00bc \u00bdHT ?H??1 \u00bc\nq11 q12 q13 q14\nq21 q22 q23 q24\nq31 q32 q33 q34\nq41 q42 q43 q44\n\n2\n664\n\n3\n775\n\nIf the satellite cannot receive the navigation satellite signal of a navigation\nsystem, matrix singularity can be avoided only by removing the corresponding\nclock error variable and the corresponding rows and columns in the H array.\n\nSet the error of pseudorange observation and pseudorange rate observation of\nreceiver for navigation satellite to be rr, and rv, respectively, and the calculation of\nthe accuracy factor and the corresponding standard deviation of geometric position\nspeed resolution error in the geocentric inertial coordinate system is as follows.\n\n(1) Accuracy factor of X-coordinate direction in geocentric inertial coordinate\nsystem is as follows:\n\nPDOPx \u00bc \u00f0q11\u00de\n1\n2 \u00f04:21\u00de\n\nThe standard deviation of position and velocity error on the X-coordinate axis\nare as follows: Dx \u00bc PDOPx ? rr;Dvx \u00bc PDOPx ? rv;\n\n92 4 Autonomous Navigation Technology of Whole Space\n\n\n\n(2) Accuracy factor of Y-coordinate direction in geocentric inertial coordinate\nsystem is as follows:\n\nPDOPy \u00bc \u00f0q22\u00de\n1\n2 \u00f04:22\u00de\n\nThe standard deviation of position and velocity error on the Y-coordinate axis are\nas follows: Dy \u00bc PDOPy ? rr;Dvy \u00bc PDOPy ? rv;\n(3) Accuracy factor of Z-coordinate direction in geocentric inertial coordinate\n\nsystem is as follows:\n\nPDOPz \u00bc \u00f0q33\u00de\n1\n2 \u00f04:23\u00de\n\nThe standard deviation of position and velocity error on the Z-coordinate axis are\nas follows: Dz \u00bc PDOPz ? rr;Dvz \u00bc PDOPz ? rv;\n(4) 3D position accuracy factor:\n\nPDOP \u00bc \u00f0q11 \u00fe q22 \u00fe q33\u00de\n1\n2 \u00f04:24\u00de\n\n3D position and velocity error are as follows: Dr \u00bc PDOP ? rr;Dv \u00bc PDOP ? rv;\n(5) Receiver clock error accuracy factor is as follows:\n\nTDOP \u00bc \u00f0q44\u00de\n1\n2 \u00f04:25\u00de\n\nClock error and frequency difference accuracy are as follows:\nDrt \u00bc TDOP ? rr;Dvt \u00bc TDOP ? rv;\n(6) Geometric accuracy factor as follows:\n\nGDOP \u00bc PDOP2 \u00feTDOP2\n ?12\u00bc \u00f0q11 \u00fe q22 \u00fe q33 \u00fe q44\u00de12 \u00f04:26\u00de\nGeometric accuracy are as follows: Dr \u00bc GDOP ? rr, Dv \u00bc GDOP ? rv.\nSet the receiver\u2019s sensitivity LMD = ?160 dBm, and the set of orbital elements of\n\na high-orbit satellite is as above. Supposing that the navigation system is based on\nBD + GLONASS + GPS + GALLIEO, in inertial coordinate system, its position\naccuracy factor in X direction is PDOPX, in Y direction is PDOPY, in Z direction is\nPDOPZ, clock error accuracy factor is TDOP, 3D position accuracy factor is PDOP,\ngeometric accuracy factor is GDOP, and the simulation results are shown in Fig. 4.13.\n\nIt can be seen in Fig. 4.13, when the spacecraft in large elliptical orbit flies to the low\nearth orbit, the value of each accuracy factor is low because of the large number of\nvisible GNSS satellites and the good configuration of the visible navigation constel-\nlation; when the spacecraft flies to the high orbit, because of the less quantity of visible\nnavigation satellite, the value of each accuracy factor is low. According to statistics,\nwhen using the visible navigation satellites of GPS, GLONASS, GALLIEO, BD to\nmake simple geometric orbit determination, the average value of the GDOP of the\nnavigation constellation is 8.43. If the measured pseudorange and pseudorange rate of\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 93\n\n\n\nthe navigation signal error are 0.10 m and 2 m/s, respectively, then the high-orbit\nspacecraft\u2019s geometric orbit determination accuracy can be 84.3 m and the speed\naccuracy can be 5.28 m/s, achieving the acceptable accuracy requirements of high-orbit\nspacecraft. Therefore, for high-orbit spacecraft, when the receiver sensitivity is set as\n?160 dBm, andGPS,GLONASS,GALLIEO,BDnavigation satellite constellation are\ntaken into consideration, the configuration of the visible navigation satellites constel-\nlation substantially meets the basic requirements of high orbit.\n\n2) Optimal star selection and orbit determination based on GDOP\n\nFor the satellite autonomous navigation system based on GNSS, it is generally that\nthe more the visible satellites, the better the configuration is, and the positioning\naccuracy will be improved by some degrees at the same time. However, too much\nredundant information cannot improve the positioning accuracy greatly; instead, it\nmakes the calculation volume increases largely, which seriously affects real-time\nperformance of positioning. Therefore, it is important to choose the right navigation\nsatellite constellation. Reducing over redundant observation information under the\ncondition that the geometric configuration of satellites being selected is optimal,\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\nt/s\n\nP\nD\n\nO\nP\n\nx\n\n0 5 10\nx 104\n\n0\n\n2\n\n4\n\n6\n\n8\n\nt/s\n\nP\nD\n\nO\nP\n\ny\n0 5 10\n\nx 104\n\n0\n\n1\n\n2\n\n3\n\nt/s\n\nP\nD\n\nO\nP\n\nz\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\nt/s\nTD\n\nO\nP\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\nt/s\n\nP\nD\n\nO\nP\n\n0 5 10\nx 104\n\n0\n\n10\n\n20\n\n30\n\n40\n\nt/s\n\nG\nD\n\nO\nP\n\nFig. 4.13 Simulation of the number of navigation satellites can be seen in every case when the\nsensitivity is ?160 dBm\n\n94 4 Autonomous Navigation Technology of Whole Space\n\n\n\nand making the balance between the positioning solution and real-time calculation\nis particularly important for high dynamic spacecrafts, such as satellite.\n\nIn the ground receiver applications, the frequently used star selection algorithms\ninclude ergodic method, fuzzy method, maximum tetrahedron volume method and\nmaximum determinant method. If the high-orbit spacecraft positioning is based on\nthe four satellites navigation system, when the sensitivity setting is large enough,\nthe number of visible navigation satellite is about 20\u201330, and the calculation\namounts when using ergodic satellite selection or the maximum determinant\nmethod is very large. In addition, due to the high-orbit satellite\u2019s visible navigation\nsatellites uniform distribution in the visible region, it is not suitable to use fuzzy\nsatellite selection method, so in this section, the use of a satellite selection algorithm\nbased on contribution of satellite to GDOP is mainly discussed.\n\nThe number of satellites being selected to participate navigation calculation from\nvisible stars is different, the values of GDOP are different, and however, there is\ncertain rule for change between the GDOP and the number of satellites. Assume Hm\nto be the observation matrix when selecting m navigation satellite to orbit deter-\nmination, when the number i satellite is removed from the m satellites, the obser-\nvation matrix of the remaining m-i satellites is Him?1, and the following are the\nrelations between the two\n\nHTm ?Hm \u00bc HTm?1 ?Hm?1 \u00fe hTi ? hi \u00f04:27\u00de\n\nType: hi \u00bc \u00bdeix; eiy; eiz; 1? is the observation vector of the satellite i.\nLet Gm \u00bc \u00f0HTm ?Hm\u00de?1, Gim?1 \u00bc \u00f0Him?1T ?Him?1\u00de?1. From the formula of matrix\n\ninversion\n\nGim?1 \u00bc \u00f0HTm ?Hm ? hTi ? hi\u00de?1 \u00bc Gm \u00feGmhTi \u00f01? hiGmhTi \u00de?1hiGm \u00f04:28\u00de\n\nThat is, GDOPim?1\n2 \u00bc GDOP2 \u00fe trace\u00f0GmhTi \u00f01? hiGmhTi \u00de?1hiGm\u00de. From that,\n\nwhen a row is removed from the original observation matrix, the GDOP2 is added by\ntrace\u00f0GmhTi \u00f01? hiGmhTi \u00de?1hiGm\u00de on the original basis, and it can be proved from\nknowledge of matrix theory that the term is positive. Therefore, the contribution of a\nsingle satellite I to GDOP can be recorded as DGi \u00bc trace\u00f0GmhTi \u00f01? hiGmhTi \u00de?1\nhiGm\u00de. The larger the value is, the greater increase in GDOPm-1 when the satellite I is\nremoved, and the geometric distribution becomes worse, indicating that the contri-\nbution of satellite I to the geometric distribution of constellation is greater. On the\ncontrary, if the DGi is smaller, the contribution of satellite I to constellation geometry\ndistribution is smaller and the influence is smaller. Therefore, when choosing the\nsatellites based on the optimumGDOP, the navigation satellites with largeDGi should\nbe chosen. Specific satellites selection algorithm steps are:\n\n(1) Calculate the GDOP contribution value DGi of each visible satellite.\n(2) Sort the navigation satellites from large to small according to the GDOP\n\ncontribution value.\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 95\n\n\n\n(3) Select the r satellites with largest DGi to be the best constellation.\n\nSet the sensitivity of the receiver LMD = ?160 dBm, and the orbit elements of\noperating satellite are as mentioned above, and for the geometric dynamic orbit\ndetermination based on BD + GLONASS + GPS + GALLIEO navigation system,\nselecting satellite before geometric solution, the various precision factors before and\nafter the optimal satellite selection are shown in Figs. 4.14 and 4.15.\n\nIt can be seen that after the application of the optimal satellite selection algorithm,\nthemaximumvalue of PDOP is 24.22, theminimumvalue of PDOP is 1.007, themean\nvalue of PDOP is 9.64, and the difference of PDOP mean value before and after\nsatellite selection is about 1.2. If the navigation signal pseudorange measurement\naccuracy is 10 m, pseudorange rate measurement accuracy is 0.2 m/s, the position\nestimation accuracy loss before and after satellite selection is about 12 m, the speed\nestimation accuracy loss is about 0.24 m/s, which is acceptable for autonomous\nnavigation of spacecraft in large elliptical orbit. However, the number of visible\nsatellites, which are involved in calculation before and after the satellite selection, is\ngreatly reduced, which greatly reduces the computational volume. The real-time\nposition error and velocity error of autonomous navigation based on the simple\ngeometric calculation of visible navigation satellites are shown in Figs. 4.16 and 4.17.\n\nFig. 4.14 Comparison of various precision factors before and after optimum satellite selection\n\n96 4 Autonomous Navigation Technology of Whole Space\n\n\n\nAs is known from the real-time simulation, set the receiver\u2019s sensitivity as\n?160 dBm, when the spacecraft in large elliptical orbit is operating in low orbit,\ndue to the number of visible satellite is large, the calculation precision is high,\nposition estimation accuracy can reach 17.2 m, and speed estimation accuracy can\nreach 0.26 m/s; when the spacecraft is in high orbit, the number of visible navi-\ngation satellite is small, the visible navigation constellation after optimal satellite\n\nFig. 4.15 Comparison of PDOP and GDOP before and after satellite selection\n\n0 1 2 3 4 5 6 7 8 9 10\nx 104\n\n0\n\n100\n\n200\n\n300\n\n400\n\n500\n\n600\n\n700\n\n800\n\n900\n\nPo\nsi\n\ntio\nn \n\n/m\n\nt/s\n\nFig. 4.16 Real-time error of position estimation based on simple geometric solution\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 97\n\n\n\nselection is not as well as that of low orbit, so the position estimation accuracy and\nspeed estimation accuracy are decreased, and the position calculation accuracy is\nabout 120.6 m, the accuracy of speed calculation is about 2.14 m/s, and the esti-\nmation error changes in the solution process is the same as PDOP.\n\n3. Autonomous navigation method based on GNSS/dynamics constraint\n\nIn the autonomous orbit determination based on GNSS simple geometric calcula-\ntion, since the dynamics constraint of spacecraft in the free section of orbit is not\nconsidered, the accuracy cannot reach the ideal value. The principle of autonomous\nnavigation based on GNSS/dynamic constraint method is taking the spacecraft orbit\ndynamic equation as the prediction equation of state information, taking position,\nvelocity or pseudorange and rate measurements which calculated by the GNSS\nreceiver as measurement information, and obtaining the optimal estimation of\nspacecraft orbit parameters by extended Kalman filter. The former is loose com-\nbination, and the latter is a close combination. Compared with the loose combi-\nnation, in close combination navigation system, pseudorange and pseudorange rate\nsignal provided by GNSS receiver are the original information received by receiver,\nthe error of the pseudorange and pseudorange rate signals is independent of each\nother, and positioning calculation error of GNSS receiver is not introduced; in\naddition, for the close combination, even if the number of visible navigation\nsatellites received by it is less than the minimum of orbit determination required, it\ncan still obtain optimal orbit parameters with optimal filtering estimation of orbit\ndynamic equation, so navigation accuracy of close combination is superior to the\nloose combination and has high reliability and strong anti-interference ability,\nwhich is suitable for high dynamic navigation. This book uses closed combination\nnavigation method, and the specific principle is shown in Fig. 4.18.\n\n0 1 2 3 4 5 6 7 8 9 10\nx 104\n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\n14\n\n16\n\nV\nel\n\noc\nity\n\n  /\n(m\n\n/s\n)\n\nt/s\n\nFig. 4.17 Real-time error of velocity estimation based on simple geometric solution\n\n98 4 Autonomous Navigation Technology of Whole Space\n\n\n\nFor the autonomous orbit determination method based on GNSS, signal of\nnavigation satellites tracked by operating satellite at the same moment includes\nGPS, GLONASS, GALLIEO, and BD. Assuming that the number of satellites\nobserved is n1, n2, n3, and n4, the pseudorange observation equations are\n\nq11 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x11\u00de2 \u00fe\u00f0y? y11\u00de2 \u00fe\u00f0z? z11\u00de2\n\nq\n\u00fe delT1 \u00fe dr\n\n..\n\n.\n\nq1n1 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x1n1\u00de2 \u00fe\u00f0y? y1n1\u00de2 \u00fe\u00f0z? z1n1\u00de2\n\nq\n\u00fe delT1 \u00fe dr\n\nq21 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x21\u00de2 \u00fe\u00f0y? y21\u00de2 \u00fe\u00f0z? z21\u00de2\n\nq\n\u00fe delT2 \u00fe dr\n\n..\n\n.\n\nq2n2 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x2n1\u00de2 \u00fe\u00f0y? y2n2\u00de2 \u00fe\u00f0z? z2n2\u00de2\n\nq\n\u00fe delT2 \u00fe dr\n\nq31 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x31\u00de2 \u00fe\u00f0y? y31\u00de2 \u00fe\u00f0z? z31\u00de2\n\nq\n\u00fe delT3 \u00fe dr\n\n..\n\n.\n\nq3n3 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x3n3\u00de2 \u00fe\u00f0y? y3n3\u00de2 \u00fe\u00f0z? z3n3\u00de2\n\nq\n\u00fe delT3 \u00fe dr\n\nq41 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x41\u00de2 \u00fe\u00f0y? y41\u00de2 \u00fe\u00f0z? z41\u00de2\n\nq\n\u00fe delT4 \u00fe dr\n\n..\n\n.\n\nq4n4 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0x? x4n4\u00de2 \u00fe\u00f0y? y4n4\u00de2 \u00fe\u00f0z? z4n4\u00de2\n\nq\n\u00fe delT4 \u00fe dr \u00f04:29\u00de\n\nType: superscript 1, 2, 3, 4 grade represent the GPS, GLONASS, GALLIEO,\nand BD navigation system, respectively; delT1, delT2, delT3, delT4, respectively,\n\nGPS Signal\n\nGLONASS Signal\n\nGALLIEO Signal\n\nBD Signal\n\nOptimal \nestimate\n\nEKF \nfiltering\n\nGNSS \nmulti \n\nsystem \nnavigation \n\nreceiver\n\nOptimum \nsatellite\n\nselection\n\nOrbit \ndynamics\n\nFig. 4.18 Autonomous navigation method based on orbit dynamics/GNSS\n\n4.2 Common Autonomous Navigation Method of Elliptical Orbit 99\n\n\n\nrepresent the clock error between each navigation system and receiver; dr is\npseudorange measurement white noise error.\n\nThe pseudorange observation equation can be obtained by derivation of pseu-\ndorange observation equation.\n\nSet the large elliptical orbit parameters as mentioned above. Set the GNSS\nnavigation system pseudorange measurement error to be 10 m, pseudorange rate\nmeasurement error to be 0.2 m/s, and set equivalent error of each system clock\nconstant to be 10 m, neglecting the equivalent error of frequency difference; the\nspecific simulation results are shown in Fig. 4.19.\n\nIt can be seen from Figs. 4.19 and 4.20 that because autonomous navigation\nmethod of spacecraft in large elliptical orbit based on GNSS/dynamic constraints\ncombines high-precision orbit prediction, under the same simulation conditions, the\nposition estimation accuracy is 13.47 m, the speed estimation accuracy is\n0.0213 m/s, and the precision of autonomous navigation is largely improved.\n\n0 0.5 1 1.5 2 2.5 3\nx 104\n\n0\n\n10\n\n20\n\n30\n\n40\n\n50\n\nt/s\n\nPo\nsi\n\ntio\nn \n\n/m\n\nFig. 4.19 Real-time simulation of position estimation error\n\n0 0.5 1 1.5 2 2.5 3\nx 104\n\n0\n\n0.05\n\n0.1\n\n0.15\n\n0.2\n\n0.25\n\n0.3\n\n0.35\n\n0.4\n\n0.45\n\nt/s\n\nV\nel\n\noc\nity\n\n /(\nm\n\n/s\n)\n\nFig. 4.20 Real-time simulation of speed estimation error\n\n100 4 Autonomous Navigation Technology of Whole Space\n\n\n\n4.3 Merge Autonomous Navigation Based\non SINS/GNSS/CNS\n\nAlthough there are many strategies for autonomous navigation of spacecraft in large\nelliptical orbits, each single navigation system often has its own shortcomings. For\nexample, although the inertial navigation system has the obvious advantages of\npassive, covert, full autonomous, the error is accumulated with time, so it does not\nmeet the requirements of spacecraft operating with long time and high precision. If\nonly considered to improve the precision of inertial navigation system, it is nec-\nessary to improve the precision of initial alignment and inertial devices, which will\ngreatly increase the cost; although the positioning accuracy of GNSS navigation\nsystem is very high, it is not an autonomous navigation device, and satellite signals\nare likely to be interfered. Therefore, it is the development trend of autonomous\nnavigation to combine various navigation systems properly and learn from each\nother to improve the accuracy and stability. The proper combination of navigation\nsystems can not only greatly improve the accuracy of the whole navigation system,\nbut also enhance the fault tolerance of the whole navigation system.\n\nThe inertial navigation system is generally sensitive to acceleration information\ncaused by non-gravitational factors, when vehicles operates on the Kepler orbit, the\nacceleration information being sensed by accelerometer is zero in theory, at this\ntime, the inertial navigation system will not be helpful to navigation solution and\nwill bring in the errors of inertial devices and enlarge the scope of the state esti-\nmation error. When the output of accelerometer is not zero, the navigation calcu-\nlation loop can be introduced to exert the advantage of real time, high precision, and\ncontinuous output of inertial navigation system. Therefore, when the spacecraft is\nnot maneuvering on orbit, navigation information can be provided with only GNSS\nnavigation and astronomical navigation, as well as the orbit dynamic equation;\nwhen the spacecraft is maneuvering, SINS/astronomy/GNSS combination is\nadopted to provide real-time navigation information, so as to eliminate the error\ncaused by orbit maneuvering to the maximum extent.\n\n4.3.1 State Equation of Inertial Navigation\n\n1. Algorithm arrangement of space inertial navigation\n\nDifferent from the strapdown inertial navigation system (SINS) application in\naviation, when SINS is applied in satellite autonomous navigation, it is relative to\nthe inertial space navigation and the navigation solution is conducted directly in the\ninertial system (i). Therefore, the harmful acceleration in the force equation of the\nspaceborne SINS navigation system is only the gravity acceleration, which does not\nneed the Coriolis compensation, and the specific force equation is\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 101\n\n\n\nd2r\ndt2\n\n\t\t\t\t\ni\n\u00bc f i \u00fe gi \u00bc Cibf b \u00fe gi \u00f04:30\u00de\n\nf b is the specific force measured by accelerometer, not the gravitational accel-\neration. gi is the acceleration of local gravity. Cib is the coordinate transformation\nmatrix from body coordinate system to inertial coordinate system.\n\ngi is the acceleration of the earth\u2019s gravity in the geocentric inertial coordinate\nsystem, which is:\n\ngx \u00bc lxR3 1?\n3\n2\nJ2\n\nRe\nR\n\n? ?2 5z2\nR2\n\n? 1\n? ?\" #\n\ngy \u00bc lyR3 1?\n3\n2\nJ2\n\nRe\nR\n\n? ?2 5z2\nR2\n\n? 1\n? ?\" #\n\ngz \u00bc lzR3 1?\n3\n2\nJ2\n\nRe\nR\n\n? ?2\n3? 5z\n\n2\n\nR2\n\n? ?\" #\n\u00f04:31\u00de\n\nl is gravitational constant of earth; x, y, z are the projection of a spacecraft in the\ngeocentric inertial coordinate system; Re is the semi-major axis of the earth; R is the\ninstantaneous position of the center of mass of a spacecraft to the center of the earth.\n\nSINS navigation algorithm is a method of calculating the navigation parameters,\nsuch as attitude angle, position, and velocity from the measurement output of inertial\ninstruments. The algorithm of spaceborne SINS mainly includes two parts: the cal-\nculation of the attitude matrix (that is, the calculation of the mathematical platform)\nand the calculation of navigation (including the calculation of position and velocity).\nIn the navigation solution, first, calculate attitude matrix at the moment according to\nthemeasurement parameters of the gyroscope and the previous navigation parameters\nto build a mathematical reference platform for the navigation solution and realize the\nconversion from the celestial coordinate system to the navigation coordinate system.\nThen, decompose the measured values of accelerometers into navigation coordinate\nsystem to obtain the position and velocity of satellites by integral.\n\n2. Calculation of state parameters of space inertial navigation\n\nAttitude calculation of strapdown inertial navigation system is equivalent to plat-\nform function of platform strapdown inertial navigation system (IMU), that is,\nproviding mathematical platform for strapdown system, and the accuracy of the\nalgorithm will directly affect the calculation accuracy of the navigation parameters\nof the navigation system. Through SINS attitude calculation, the following func-\ntions can be achieved:\n\n(1) The attitude matrix and attitude angle of the body relative inertial coordinate\nsystem can be calculated directly by the gyro angular velocity value.\n\n102 4 Autonomous Navigation Technology of Whole Space\n\n\n\n(2) The specific value output by accelerometer can be converted from the body\ncoordinate system to the inertial coordinate system by using the attitude matrix.\n\nGenerally, the attitude matrix is solved by Euler angle method, directional cosine\nmethod, and quaternion method. Since the quaternion method has the advantages of\nfull attitude, small computation, and little error, the current SINS system basically\nuses the quaternion method. The main steps of solving the attitude matrix by the\nquaternion method are as follows:\n\n(1) Solve differential equations of quaternion and normalize quaternion according\nto the current relative angular rate xbib;\n\n(2) Compute the attitude matrix Cbi by quaternion;\n(3) Extract the actual attitude angle from attitude matrix Cbi .\n\n1) Initialization, normalization of quaternion, and solution for differential equations\nof quaternion\n\nThe initialization of the quaternion is conducted on the attitude angle of the initial\ninput. Since the initial attitude angle c; #;w is known, so using the following\nmethods to initialize quaternion\n\nq0 \u00bc cosw2 cos\nh\n2\ncos\n\nc\n2\n\u00fe sinw\n\n2\nsin\n\nh\n2\nsin\n\nc\n2\n\nq1 \u00bc cosw2 cos\nh\n2\nsin\n\nc\n2\n? sinw\n\n2\nsin\n\nh\n2\ncos\n\nc\n2\n\nq2 \u00bc cosw2 sin\nh\n2\ncos\n\nc\n2\n\u00fe sinw\n\n2\ncos\n\nh\n2\nsin\n\nc\n2\n\nq3 \u00bc sinw2 cos\nh\n2\ncos\n\nc\n2\n? cosw\n\n2\nsin\n\nh\n2\nsin\n\nc\n2\n\n\u00f04:32\u00de\n\nAccording to the algorithm of strapdown inertial navigation system, the attitude\nof quaternion differential equation is in the form of\n\n_Q\u00f0q\u00de \u00bc 1\n2\nM?\u00f0xbib\u00deQ\u00f0q\u00de \u00f04:33\u00de\n\nType : M?\u00f0xbib\u00de \u00bc\n0 ?xbibx ?xbiby ?xbibz\n\nxbibx 0 x\nb\nibz ?xbiby\n\nxbiby ?xbibz 0 xbibx\nxbibz x\n\nb\niby ?xbibx 0\n\n2\n6664\n\n3\n7775\n\nThe discrete analytic solutions of the above differential equations are\n\nQ\u00f0t\u00fe 1\u00de \u00bc I cos a\u00fe sin a\n2a\n\nB\n\n? \nQ\u00f0t\u00de \u00f04:34\u00de\n\nType: I is the unit matrix.\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 103\n\n\n\nQ\u00f0t\u00de \u00bc q0\u00f0t\u00de q1\u00f0t\u00de q2\u00f0t\u00de q3\u00f0t\u00de\u00bd ?T \u00f04:35\u00de\n\ndhx dhy dhz\u00bd ?T is defined as the instantaneous angle of the body coordinate\nsystem in three directions relative to the inertial coordinate system\n\na \u00bc 1\n2\n\n\u00f0dhx\u00de2 \u00fe\u00f0dhy\u00de2 \u00fe\u00f0dhz\u00de2\nh i1=2\n\n\u00f04:36\u00de\n\nB is the antisymmetric matrix of the instantaneous angle of the body coordinate\nsystem to inertial coordinate system\n\nB \u00bc\nZ t\n0\n\nM?\u00f0xbib\u00dedt \u00bc\n0 ?dhx ?dhy ?dhz\ndhx 0 dhz ?dhy\ndhy ?dhz 0 dhx\ndhz dhy ?dhx 0\n\n2\n664\n\n3\n775 \u00f04:37\u00de\n\nIn summary, the new Q\u00f0t\u00fe 1\u00de can be obtained by solving the differential\nequation of quaternion with xbib.\n\nIn order to maintain a good orthogonal performance of quaternion, it is necessary\nto standardize it to keep the orthogonality in the three-dimensional space, and the\nnormalization formula of quaternion is\n\nqi \u00bc q?i\u00f0q20 \u00fe q21 \u00fe q22 \u00fe q23\u00de1=2\n\u00f04:38\u00de\n\nType: qi is quaternion after normalization.\n\n2) Compute the attitude matrix Cbi by quaternion\n\nAfter obtaining the quaternion, according to the relationship between the\nquaternion and the attitude matrix, the attitude matrix Cib between the body coor-\ndinate system and the inertial coordinate system can be obtained\n\nCib \u00bc\nq20 \u00fe q21 ? q22 ? q23 2\u00f0q1q2 ? q0q3\u00de 2\u00f0q1q3 \u00fe q0q2\u00de\n2\u00f0q1q2 \u00fe q0q3\u00de q20 \u00fe q22 ? q21 ? q23 2\u00f0q2q3 \u00fe q0q1\u00de\n2\u00f0q1q3 ? q0q2\u00de 2\u00f0q2q3 ? q0q1\u00de q20 \u00fe q23 ? q21 ? q22\n\n2\n64\n\n3\n75\n\n\u00bc \u00f0Cij\u00de3?3\n\n\u00f04:39\u00de\n\nThen, the Cbi matrix of the attitude angle can be obtained by the orthogonality of\nthe Cib matrix.\n\n104 4 Autonomous Navigation Technology of Whole Space\n\n\n\n3) Extract attitude angle from attitude matrix Cbi\n\nThe attitude matrix that body coordinate system to geocentric inertial coordinate\nsystem is\n\nCbi \u00bc\ncos c cosw\u00fe sin c sin h sinw ? cos c sinw\u00fe sin c sin h cosw ? sin c cos h\n\ncos h sinw cos h cosw sin h\nsin c cosw? cos c sin h sinw ? sin c sinw? cos c sin h cosw cos c cos h\n\n2\n4\n\n3\n5\n\n\u00f04:40\u00de\n\nType: h is pitch angle; c is roll angle; w is azimuth angle.\nAccording to Eq. (4.40), when the equivalent attitude matrix is obtained from\n\nquaternion, with the corresponding relationship between the attitude matrix and the\nattitude angle, three attitude angles of the body can be obtained. Using Tij to\nrepresent elements of Cbi (i, j = 1, 2, 3)\n\nw \u00bc arctan T21T22\n# \u00bc arc sinT23\nc \u00bc ? arctan T13T33\n\n8<\n: \u00f04:41\u00de\n\nSINS system position velocity calculation commonly uses numerical integration\nmethod. The commonly used integral method is the Dragon Berg\u2013Kutta method,\nand according to the accuracy requirements, it can be categorized into first- , two- ,\nand four-order Runge\u2013Berg\u2013Kutta method as follows:\n\n(1) Velocity calculation\n\nSince the accelerometer is connected to the body, its output is the projection of\nspecific force which is the body coordinate system relative to the inertial coordinate\nsystem on the body coordinate system. Therefore, it is necessary to convert the\noriginal output specific force f bib to f\n\ni\nib; when the attitude transfer matrix C\n\ni\nb has been\n\nobtained, the transform relation of the specific force is\n\nf iib \u00bc Cib ? f bib \u00f04:42\u00de\n\nf \u00bc _vei ? g \u00f04:43\u00de\n\nThe velocity differential equation of the body in the geocentric inertial coordi-\nnate system is\n\n_Vx \u00bc f ix \u00fe gx\n_Vy \u00bc f iy \u00fe gy\n_Vz \u00bc f iz \u00fe gz\n\n9=\n; \u00f04:44\u00de\n\nThe acceleration of the satellite in the geocentric inertial coordinate system can\nbe calculated by formula (4.44), and then, the real-time satellite speed can be\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 105\n\n\n\nobtained according to Runge Kutta integral method. In the formula, the local\ngravity coefficients at the satellite position are gx; gy; gz. The velocity differential\nequation is a first-order three-dimensional differential equation. The velocity\nchanges as the specific force changes.\n\n(2) Location calculation\n\nIntegrate the obtained satellite velocity according to the Runge\u2013Kutta method; the\ncoordinate under the geocentric inertial coordinate system at each time can be\nobtained.\n\n4.3.2 Observation Equation of SINS/Star Sensor/GNSS\nNavigation\n\n1. SINS/star sensor integrated navigation observation equation\n\nIn the celestial navigation system, star sensor (SS) can be used to obtain the\ndirection vector of the stellar in spacecraft body coordinate system, so as to cal-\nculate the attitude of the spacecraft body coordinate system relative to the inertial\ncoordinate system [8]. Use the method of double vector attitude determination to\ncalculate the transformation matrix Cib of the spacecraft relative to the inertial\ncoordinate system. If the position and velocity of the spacecraft are known accu-\nrately, the attitude information of the spacecraft relative to the orbital coordinate\nsystem can be obtained directly.\n\nSINS/CNS-based autonomous orbit determination method of satellite uses SINS\nerror equation as the equation of state, taking the difference between attitude\ninformation output by star sensor and attitude angles calculated upon SINS output\nas a quantity measurement to make full information combination, and uses the\noptimal estimation method to make optimal estimation for the position, velocity,\nand attitude error, SINS constant error, and then uses the obtained error to correct\nthe position, velocity, attitude estimated value output by SINS and the output value\nof components, so, the optimum navigation parameters [9, 10] are obtained. Its\nspecific measurement equation is\n\ncC ? cI\nhC ? hI\nwC ? wI\n\n2\n4\n\n3\n5 \u00bc cos\u00f0w\u00de ? sin\u00f0w\u00de 0sin\u00f0w\u00decos\u00f0c\u00de cos\u00f0w\u00decos\u00f0c\u00de 0\n\nsin\u00f0w\u00de tan\u00f0h\u00de cos\u00f0w\u00de tan\u00f0h\u00de ?1\n\n2\n4\n\n3\n5 /x/y\n\n/z\n\n2\n4\n\n3\n5\u00feDv \u00f04:45\u00de\n\nType: cI ; hI ;wI are the roll, pitch, and yaw of the SINS outputs; cC; hC;wC are\nthe attitude angles of the output of celestial navigation system; /x;/y;/z are the\nplatform error angles.\n\nStarlight angular distance constituted by starlight vector output by CCD star\nsensor and the geocentric vector output by horizon sensor has observability to\nsatellite\u2019s position; its expression is as follows [11]\n\n106 4 Autonomous Navigation Technology of Whole Space\n\n\n\na \u00bc a cos ? r ? s\nrj j\n\n? ?\n\u00f04:46\u00de\n\nThe calculated value of starlight angular distance, which is calculated according\nto the position vector output by SINS and ephemeris is set to be aI , and the starlight\nangular distance measured by CCD star sensor and horizon sensor is set to be aC.\nTaking aC ? aI as measurement value, and the specific measurement equation for\nsingle starlight argument is\n\naC ? aI\u00bd ? \u00bc ? @a@x ? @a@y ? @a@z\nh i dx\n\ndy\ndz\n\n2\n4\n\n3\n5\u00feDs \u00f04:47\u00de\n\nType :\n@a\n@x\n\n\u00bc \u00f0sx ? x\n2 \u00fe\u00f0sy ? y\u00fe sz ? z\u00de ? x? sx ? r2\u00de\n\nr2 ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr2 ? \u00f0x ? sx \u00fe y ? sy \u00fe z ? sz\u00de2\n\nq ;\n\n@a\n@y\n\n\u00bc \u00f0sy ? y\n2 \u00fe\u00f0sx ? x\u00fe sz ? z\u00de ? y? sy ? r2\u00de\n\nr2 ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr2 ? \u00f0x ? sx \u00fe y ? sy \u00fe z ? sz\u00de2\n\nq ;\n\n@a\n@y\n\n\u00bc \u00f0sz ? z\n2 \u00fe\u00f0sx ? x\u00fe sy ? y\u00de ? z? sz ? r2\u00de\n\nr2 ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr2 ? \u00f0x ? sx \u00fe y ? sy \u00fe z ? sz\u00de2\n\nq ;\n\nDs is the starlight angular distance measurement error, which mainly considers\nthe horizon sensor.\n\nThe distance rC between the satellite and the geocenter can be calculated directly\nby observation information from the horizon sensor, geocentric distance is calcu-\nlated according to the position output by the SINS system, and the specific mea-\nsurement equation is expressed as follows:\n\nrC ? rI\u00bd ? \u00bc ? @r@x ? @r@y ? @r@z\nh i dx\n\ndy\ndz\n\n2\n4\n\n3\n5\u00feDr \u00f04:48\u00de\n\n2. Observation equation of SINS/GNSS combination navigation\n\nThe measurement quantities adopted by autonomous navigation method based on\nthe close combination of SINS/GNSS are the pseudorange and pseudorange rate\n[12] of visible navigation star upon optimal star selection, and the measurement\nequations include pseudorange measurement equation and pseudorange rate mea-\nsurement equation.\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 107\n\n\n\nIn the combined navigation system, set the output position of spaceborne SINS\nto be \u00f0xI ; yI ; zI\u00de, the position determined by satellite ephemeris is \u00f0x ji ; y ji ; z ji \u00de\n(j = 1,2,3,4, respectively, represents BD, GLONASS, GPS, GALLIEO satellite\nnavigation system, and i represents a satellite number in the same navigation sys-\ntem), and the pseudo distance q jIi corresponding to the SINS can be obtained. Set\npseudorange received by GNSS receiver to be q jGi, the difference between the two\npseudodistance can be used as a filtering observation quantity of the combination\nnavigation system and expanded in the Taylor series as follows:\n\nqJIi \u00bc \u00bd\u00f0xI ? x ji \u00de2 \u00fe\u00f0yI ? y ji \u00de2 \u00fe\u00f0zI ? z ji \u00de2?\n1\n2\n\n\u00bc \u00bd\u00f0x? x ji \u00de2 \u00fe\u00f0y? y ji \u00de2 \u00fe\u00f0z? z ji \u00de2?\n1\n2 \u00fe @q\n\nj\nIi\n\n@x\ndx\u00fe @q\n\nj\nIi\n\n@y\ndy\u00fe @q\n\nj\nIi\n\n@z\ndz\n\n\u00bc r ji \u00fe e jix ? dx\u00fe e jiy ? dy\u00fe e jiz ? dz\n\n\u00f04:49\u00de\n\nq jGi \u00bc r ji \u00feDtj \u00feDq \u00f04:50\u00de\n\nPseudorange measurement equation is as follows:\n\ndq jIi \u00bc q jGi ? q jIi \u00bc ?e jix ? dx? e jiy ? dy? e jiz ? dz\u00feDtj \u00feDq \u00f04:51\u00de\n\nType: e jix \u00bc x?x\nj\ni\n\nr ji\n; e jiy \u00bc y?y\n\nj\ni\n\nr ji\n; e jiz \u00bc z?z\n\nj\ni\n\nr ji\n; Dq is the white noise in pseudorange\n\nmeasurement. In all visible GNSS navigation satellites, select 12 navigation\nsatellites that have optimal configuration, constituting measurement equation\n\ndq \u00bc\n\n?e11x ?e11y ?e11z 1 0 0 0\n..\n. ..\n\n. ..\n. ..\n\n. ..\n. ..\n\n. ..\n.\n\n?e1ix ?e1iy ?e1iz 1 0 0 0\n?e21x ?e21y ?e21z 0 1 0 0\n..\n. ..\n\n. ..\n. ..\n\n. ..\n. ..\n\n. ..\n.\n\n?e2ix ?e2iy ?e2iz 0 1 0 0\n?e31x ?e31y ?e31z 0 0 1 0\n..\n. ..\n\n. ..\n. ..\n\n. ..\n. ..\n\n. ..\n.\n\n?e3ix ?e3iy ?e3iz 0 0 1 0\n?e41x ?e41y ?e41z 0 0 0 1\n..\n. ..\n\n. ..\n. ..\n\n. ..\n. ..\n\n. ..\n.\n\n?e4ix ?e4iy ?e4iz 0 0 0 1\n\n2\n66666666666666666666666664\n\n3\n77777777777777777777777775\n\n?\n\ndx\ndy\ndz\nDt1\nDt2\nDt3\nDt4\n\n2\n666666664\n\n3\n777777775\n\u00feDq \u00f04:52\u00de\n\nThe SINS system has relative motion relative to the GNSS navigation satellites,\nand the relative motion rate of the SINS is as follows:\n\n108 4 Autonomous Navigation Technology of Whole Space\n\n\n\n_q jIi \u00bc e jix ? \u00f0 _xI ? _x ji \u00de\u00fe e jiy ? \u00f0 _yI ? _y ji \u00de\u00fe e jiz ? \u00f0_zI ? _z ji \u00de\n\u00bc e jix ? \u00f0 _x? _x ji \u00de\u00fe e jiy ? \u00f0 _y? _y ji \u00de\u00fe e jiz ? \u00f0_z? _z ji \u00de\u00fe e jix ? d _x\u00fe e jiy ? d_y\u00fe e jiz ? d_z\n\n\u00f04:53\u00de\n\nThe pseudorange rate measured by spaceborne GPS receivers is as follows:\n\n_q jGi \u00bc e jix ? \u00f0 _x? _x ji \u00de\u00fe e jiy ? \u00f0 _y? _y ji \u00de\u00fe e jiz ? \u00f0_z? _z ji \u00de\u00feD _q \u00f04:54\u00de\n\nSubtract the output value of SINS and GPS is the pseudorange rate measurement\nequation\n\n_q jGi ? _q jIi \u00bc ?e jix ? d _x? e jiy ? d _y? e jiz ? d_z\u00feD _q \u00f04:55\u00de\n\nThe GNSS receiver selects the best 12 navigation satellites signals that has\noptimal configuration, constituting the measurement equation\n\nd _q \u00bc\n\n?e11x ?e11y ?e11z\n..\n. ..\n\n. ..\n.\n\n?e1ix ?e1iy ?e1iz\n?e21x ?e21y ?e21z\n..\n. ..\n\n. ..\n.\n\n?e2ix ?e2iy ?e2iz\n?e31x ?e31y ?e31z\n..\n. ..\n\n. ..\n.\n\n?e3ix ?e3iy ?e3iz\n?e41x ?e41y ?e41z\n..\n. ..\n\n. ..\n.\n\n?e4ix ?e4iy ?e4iz\n\n2\n66666666666666666666666664\n\n3\n77777777777777777777777775\n\n?\nd _x\nd _y\nd_z\n\n2\n4\n\n3\n5\u00feD _q \u00f04:56\u00de\n\n4.3.3 Merge Scheme of SINS/Star Sensor/GNSS System\n\n1. Federal filtering algorithm\n\nAs a kind of decentralized filtering, the federal filtering is a filtering algorithm,\nwhich is based on the further improvement of the decentralized filtering technology.\nIt is a filtering algorithm with two-level filtering structures, which consists of a main\nfilter and several subfilters. Its main idea is selecting navigation system with\ncomprehensive, continuous, and reliable output information as a common reference\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 109\n\n\n\nsystem, combining with other subfilters two by two to form multiple subfilters with\neach filter operating simultaneously to get local optimal state estimation, and then\nsending the local optimal estimation output by each subfilter into main filter for\noptimal fusion, and then, the global optimal estimation is obtained [13].\n\n1) Federal filtering method\n\nThis section uses the federal filtering method with fault diagnostic reset subfilters.\nIn the federal filtering method, the primary filter has no information allocation, and\nthe information is equally distributed among the subfilters. The federated filter\nmethod has the highest global filtering accuracy after the information fusion, and\naccuracy of the subfilter is improved because of the resetting of global filter when\ncomparing with that without relative reset. In addition, fault diagnosis method\nbased on measure residual is also used by this federal filtering method, which\ndiagnoses each subsystem\u2019s information to judge whether the subfilter is abnormal.\nOnce the faulty subfilter is detected, the corresponding subsystem can be isolated in\ntime, and the remaining subsystem can be reconstructed, which effectively improve\nthe fault tolerant capability of the system (FDIR).\n\n2) The flow of federal filtering algorithm\n\nAssuming the state equation of the system is\n\nXK \u00bc Uk;k?1Xk?1 \u00feCk?1Wk?1 \u00f04:57\u00de\n\nMeasurement equation of subsystem i:\n\nZi;k \u00bc Hi;kXi;k \u00feV i;k \u00f04:58\u00de\n\nThe global optimal state estimation and covariance are X?g and Pg, and the local\noptimal state estimation and covariance of each subfilter are X?i and Pi. Because the\ninformation distributed to main filter is 0, the main filter does not need filtering, and\nit only need information fusion, and the state of main filter is global optimal\nestimation X?m \u00bc X?g. The specific algorithm flow of the federated filter is as\nfollows:\n\n(1) The initial covariance estimation of each subfilter is set to be bi times of the\ninitial value of the combined system, and bi satisfies the rules of conservation\nof information\n\nP?1i;k?1 \u00bc biP?1g;k?1; \u00f0i \u00bc 1; 2; . . .; n\u00dePn\ni\u00bc1\n\nbi \u00bc 1\n\n8<\n: \u00f04:59\u00de\n\n110 4 Autonomous Navigation Technology of Whole Space\n\n\n\n(2) Distribute the noise and the state information of the public system\n\nQ?1i;k?1 \u00bc biP?1g;k?1; \u00f0i \u00bc 1; 2; . . .; n\u00de\nX?i;k?1 \u00bc X?g;k?1\n\n(\n\u00f04:60\u00de\n\n(3) Update the time of each subfilter\n\nPi;k=k?1 \u00bc Uk;k?1Pi;k?1UTk;k?1 \u00feCk;k?1Qi;k?1CTk;k?1\nX?i;k=k?1 \u00bc Uk;k?1X?i;k?1\n\n(\n\u00f04:61\u00de\n\n(4) Update the measurement value of each subfilter\n\nKi;k \u00bc Pi;k=k?1HTi;k\u00f0Hi;kPi;k=k?1HTi;k \u00feRk\u00de?1\nPi;k \u00bc \u00f0I ? K i;kHi;k\u00dePk=k?1\nX?i;k \u00bc X?i;k=k?1 \u00feKi;k\u00f0Zi;k ?Hi;kX?i;k=k?1\u00de\n\n8<\n: \u00f04:62\u00de\n\n(5) Fault diagnosis and isolation of each subfilter.\n\nSet the fault diagnosis function\n\nki;k \u00bc rTi;kA?1i;k ri;k \u00f04:63\u00de\n\nType: ri;k is residual ri;k \u00bc Zi;k ?Hi;kX?i;k=k?1; Ai;k is variance\nAi;k \u00bc Hi;kPi;k=k?1HTi;k \u00feRi;k. Set the fault diagnosis threshold TD according to the\nfalse alarm rate, and the judge principle is\n\nIf ki;k [ TD, the subsystem is faulty;\nIf ki;k\\TD, the subsystem is right.\nOnce a measurement fault is detected in a subfilter, isolate the subsystem.\n\n(6) Send the local optimal estimation of all the subsystems without fault to main\nfilter to run the global optimum estimate\n\nP?1g;k \u00bc\nPn\ni\u00bc1\n\nP?1i;k=k\n\nP?1g;kX?g;k \u00bc\nPn\n1\u00bc1\n\nP?1i;k=kX?i;k=k\n\n8>><\n>>: \u00f04:64\u00de\n\nIn order to improve the fault tolerant adaptive performance of federated filters,\nthe following methods are used to compute the information allocation coefficients:\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 111\n\n\n\nbi\u00f0k\u00de?1 \u00bc\nPi\u00f0k ? 1\u00dek kFPn\n1 Pi\u00f0k ? 1\u00dek kF\n\n\u00f04:65\u00de\n\nType: ?k kF is Frobenius norm. In the dynamic filtering process, the bi changes in\nreal time with the change of the filter error covariance matrix P of each subsystem\nand achieve the online adaptive adjustment of the distribution coefficients of each\nsensor.\n\n2. Autonomous Navigation subfiltering algorithm\n\nIn the SINS/star sensor/GNSS combination-based autonomous navigation method\nof spacecraft in large elliptic orbit, its subsystem combination filter uses feedback\nclose-loop combination to discretize the system state equation and the measurement\nequation, respectively.\n\nXk \u00bc Uk;k?1Xk?1 \u00feCk?1Wk?1\nZk \u00bc HkXk \u00feVk\n\n?\n\u00f04:66\u00de\n\nType:Uk;k?1 \u00bc\nP1\n\nn\u00bc0 F\u00f0tk\u00deT\u00bd ?n=n! ; Ck?1 \u00bc\nP1\n\nn\u00bc1\n1\nn! \u00f0F\u00f0tk\u00deT\u00den?1\nh in o\n\nG\u00f0 tk\u00deT;\nT is iteration cycle; Xk is the state vector in time k;Uk;k?1 is system one-step transfer\nmatrix from time k ? 1 to time k;Ck?1 is system noise drivingmatrix;Wk?1 is system\nnoise in time k ? 1;Zk is observation vector in time k;Hk is themeasurementmatrix in\ntime k; Vk is the measurement noise in time k. The fundamental equation of discrete\nKalman filter is:\n\nX?k=k?1 \u00bc Uk;k?1X?k?1\nX?k \u00bc X?k=k?1 \u00feKk Zk ?HkX?k=k?1\n\n? ?\nKk \u00bc Pk=k?1HTk HkPk=k?1HTk \u00feRk\n\n? ??1\nPk=k?1 \u00bc Uk;k?1Pk?1UTk=k?1 \u00feCk?1Qk?1CTk?1\nPk \u00bc I ? KkHk\u00bd ?Pk=k?1 I ? KkHk\u00bd ?T \u00feKkRkKTk\n\n8>>>>><\n>>>>>:\n\n\u00f04:67\u00de\n\n3. SINS/CNS/GNSS Large elliptic orbit spacecraft\u2019s autonomous navigation\nmethod based on federal filtering\n\nAlthough Russian GLONASS, European GALLIEO, and Chinese \u201cBeidou\u201d\nsecond-generation navigation system will be deployed in the future to form a multi\nsystem compatible navigation pattern, once error interference occurs in a navigation\nsystem, not only the navigation accuracy will be reduced, but also the combined\nnavigation accuracy of other navigation systems will be disturbed. Even if detecting\nthe fault and removing the navigation system, the error produced by the navigation\nsystem error will need a period of time to be recovered [14]. Therefore, the SINS/\nGNSS combination method in this chapter makes SINS system and every other\nGNSS navigation system form a subfilter to conduct filtering estimation. Once\ndetecting a navigation system error, the system only needs to isolate the subfilter, so\n\n112 4 Autonomous Navigation Technology of Whole Space\n\n\n\nas to improve the system fault tolerance. Meanwhile, the form of decentralized\ncombination filtering makes GNSS not need to select stars before the combination.\nWith high real-time performance, it can make full use of the visible satellite\nmeasurement information of each navigation system.\n\nFor the SINS/CNS combined navigation system, certain error correlation exists\namong starlight angular distance jointly output by CNS star sensor and horizontal\ninstrument, attitude measurement information output by star sensor and geocentric\ndistance output by horizon sensor, which will affect the effect of combined navi-\ngation. In order to avoid measurement error from affecting estimation accuracy,\nSINS/GNSS navigation method in this chapter makes SINS system and attitude\nmeasurement information, starlight angle, and geocentric distance form three sep-\narate subfilters to make local optimal estimation and makes optimal fusion with\neach subfilters of SINS/GNSS system to get the optimal estimation results of SINS/\nCNS/GNSS. The SINS/CNS/GNSS combination autonomous navigation method\nbased on federated filtering introduced in this chapter is shown in Fig. 4.21.\n\nSINS\n\nGPS\n\nBD\n\nGLONASS\n\nGALLIEO\n\nAttitude\nmeasurement\n\nStarlight angle\n\nGeocentric\ndistance\n\nSub filter1\n\nSub filter2\n\nSub filter3\n\nSub filter4\n\nSub filter5\n\nSub filter6\n\nSub filter7\n\nfault diagnosis\n\nfault diagnosis\n\nfault diagnosis\n\nfault diagnosis\n\nfault diagnosis\n\nfault diagnosis\n\nfault diagnosis\n\nOptimal\nfusion\n\nx\n\n1z\n\n2z\n\n3z\n\n4z\n\n5z\n\n6z\n\n7z\n\n\u02c6 ,g gx P\n\nFig. 4.21 SINS/CNS/GNSS integrated navigation method based on federated filtering\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 113\n\n\n\n4. Simulation analysis of SINS/GNSS/CNS combined navigation for\nspacecraft in large elliptical orbit\n\nSet the orbit parameters of spacecraft in large elliptical orbit as before. The\nspacecraft attitude remains stable in the inertial space, at T1 = 1000 s, engine is\nignited, thrust is along X direction of orbit maneuvering spacecraft navigation\ncoordinate (inertial coordinate system), acceleration is 1m=s2, and the action time is\n200 s. The engine shuts down at time T2 = 1200 s. At T3 = 2000 s, the engine\nignites again, thrust is along Z direction of the orbit maneuvering spacecraft nav-\nigation coordinate (inertial coordinate system), acceleration is 2 m/s2, and the action\ntime is 100 s. The engine shuts down at T4 = 2100 s.\n\nSet measurement error of SINS navigation system\u2019s inertial device as listed in\nTable 4.1.\n\nThe setting of GNSS receiver pseudorange, pseudorange rate measurement error,\nand clock frequency difference is as before.\n\nTable 4.1 Correlation drift setting of constant value of SINS system devices\n\nGyroscope Random constant drift (\u00b0/h) 0.1\n\nFirst-order Markov correlation time (s) 3600\n\nWhite noise drift (\u00b0/h) 0.1\n\nScale factor error 0.00005\n\nInstallation angle error (angle per second) 3\n\nAccelerometer Random constant drift (g) 0.0001\n\nFirst-order Markov correlation time (s) 1800\n\nWhite noise drift (g) 0.0001\n\nScale factor error 0.0001\n\nInstallation angle error (angle per second) 5\n\n0 500 1000 1500 2000 2500 3000\n6\n\n8\n\n10\n\n12\n\n14\n\n16\n\n18\n\n20\n\nPo\nsi\n\ntio\nn \n\ner\nro\n\nr \n/m\n\nt/s\n\nFig. 4.22 Error of position estimation based on SINS/CNS/GNSS combination\n\n114 4 Autonomous Navigation Technology of Whole Space\n\n\n\nThe simulation result of large elliptical orbit spacecraft autonomous navigation\nbased on SINS/star sensor/GNSS federal combined is shown in Figs. 4.22, 4.23,\nand 4.24.\n\nThe simulation result shows that the spacecraft autonomous navigationmethod based\non SINS/CNS/GNSS combines the advantages of high-precision position estimation of\nGNSS navigation system and the high-precision attitude estimation of celestial\n\n0 500 1000 1500 2000 2500 3000\n0\n\n0.1\n\n0.2\n\n0.3\n\n0.4\n\n0.5\n\n0.6\n\n0.7\n\nSp\nee\n\nd \n/(\n\nm\n/s\n\n)\n\nt/s\n\nFig. 4.23 Speed estimation error based on SINS/CNS/GNSS combination\n\n0 500 1000 1500 2000 2500 3000\n-2\n\n0\n\n2\nx 10-3\n\n0 500 1000 1500 2000 2500 3000\n-5\n\n0\n\n5\nx 10-3\n\n0 500 1000 1500 2000 2500 3000\n-5\n\n0\n\n5\nx 10-3\n\nt/s\n\nR\nol\n\nl/(\n\u00b0)\n\nPi\ntc\n\nh/\n(\u00b0\n\n)\nY\n\naw\n/(\n\n\u00b0)\n\nt/s\n\nt/s\n\nFig. 4.24 Three-axis attitude estimation error based on SINS/CNS/GNSS combination\n\n4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS 115\n\n\n\nobservation navigation system. Under the simulation condition mentioned above, the\nposition estimation error is 18.56 m, the speed estimation error is 0.0987 m/s, and\nthree-axis attitude estimation error is less than 0.002\u00b0 so it has higher precision.\n\nReferences\n\n1. Li Yong, Wei Chunling. Review on the Development of Autonomous Navigation Techniques\nfor Satellites [J]. Space Control, 2005, 20(2): 70\u201374.\n\n2. Tan Longyu, Kang Guohua, Chen Shaohua. A navigation scheme for high-altitude long\nendurance unmanned aerial vehicle based on magnetic survey [J]. Sichuan ordnance Journal,\n2012, 33(2): 4\u20138.\n\n3. Tan Longyu, Kang Guohua, Zhang Yuchun. Research on INS/GPS integrated navigation\nscheme assist by geomagnetism [C]. The fourth China Information Fusion Conference, 2012.\n\n4. Peng Yang, He Liang, Han Fei. Study on short time data mutation of autonomous celestial\nnavigation sensor [C]. Chinese CCC Control Conference, 2013.\n\n5. Yang Wenbo, He Liang, Han Fei. An improved autonomous navigation filtering algorithm for\nLEO Spacecraft under weak constellation signals[C]. Shanghai inertial society academic\nexchange meeting, 2012.\n\n6. Yang Wenbo. Autonomous navigation method of high orbit spacecraft based on GNSS [C].\nShanghai Institute of Astronautics, 2012.\n\n7. YANG Wenbo. Adaptive Autonomous Navigation Method for HEO Satellite Based on\nMulti-Constellation Information [C]. 14thISCOPS, 2014.\n\n8. Fang Jancheng, Ning Xiaolin, Tian Yulong. Principle and method of autonomous celestial\nnavigation for spacecraft [M]. National Defense Industry Press, 2006.\n\n9. Hicks D K,Wiesel J. Autonomous Orbit Determination System for Earth Satellites [J]. Journal\nof Guidance, Control and Dynamics, 1998, 15(3): 562\u2013566.\n\n10. Robert Gounley, Robert White, Eliezer Gai. Autonomous Satellite Navigation by Stellar\nRefraction. Guidance and Control Conference [C],1983, 359\u2013367.\n\n11. Wang Guangjun. Star sensor and its star map processing technology [D]. Postdoctoral\nstanding out report of Beijing University of Aeronautics and Astronautics, 2005.\n\n12. Zhang Limin, Xiong Zhi, Yu Feng. Orbit determination of microsatellite based on pseudo\nrange of GPS [J]. Chinese Space Science and Technology, 2008, 27(4): 30\u201333.\n\n13. Zhang Limin, Xiong Zhi, Qiao Li. Accuracy analysis on satellite autonomous navigation\nusing radar altimeter and attitude sensors [J]. Transducer and Microsystem Technologies,\n2008, 27(4).\n\n14. Hua Bing, Liu Jianye, Xiong Zhi. Federal Filtering Algorithm in SINS/Beidou/STAR\nIntegrated Navigation System [J]. Journal of Applied Science, 2006, 24(2): 120\u2013124.\n\n116 4 Autonomous Navigation Technology of Whole Space\n\n\n\nChapter 5\nAutonomous Navigation Technology\nof Regional Constellation\n\n5.1 Introduction\n\nAutonomous navigation technology for regional constellation means the whole\nregional constellation uses the inter-satellite mutual measuring communication\nsystem and autonomous measuring equipments onboard to get information without\nrelying on ground station measurement and control and combines it with the orbit\nprediction information of high accuracy; then, long-term high-precision orbit\nparameters of the whole constellation will be obtained by information fusion\noptimal estimation. Large elliptical orbit constellation autonomous navigation\nsystem generally takes a whole constellation as a study object and takes full\nadvantage of the inter-satellite space constraint information to achieve the goal of\nlong-term autonomous orbit determination of high accuracy. The process generally\nis: take the ranging and velocity information in inter-satellite link as autonomous\nnavigation information and combine it with the orbit prediction information of high\naccuracy to obtain high-accuracy estimated value of the orbit parameters of con-\nstellation satellites with the whole network optimal estimation algorithm [1, 2].\n\nFrom the mechanism of autonomous constellation navigation system and the\nprinciple of causing errors, it can be known though autonomous navigation system\nof large elliptical orbit constellation based on the inter-satellite measuring com-\nmunication is more accurate in short-term navigation, the inter-satellite mutual\nmeasuring information only provides the precise relative location and relative\nvelocity information instead of absolute baseline information relative to inertial\nspace, and therefore, with time passing by, the error of the whole constellation\nestimation appears to be a slow and consistent divergence. The constituent rotating\ndivergence trend of the error estimation of the whole constellation can be restrained\nonly by introducing the inertial reference measurement information as the whole\nnetwork filtering measurement information of constellation autonomous navigation\nsystem [3].\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_5\n\n117\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_5&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_5&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_5&amp;domain=pdf\n\n\nThis chapter mainly introduces the ways of orbit determination of large elliptical\norbit regional constellation autonomous navigation system; it firstly introduces the\nmethod of large elliptical orbit constellation autonomous navigation system based\non the inter-satellite measuring communication, including high-accuracy orbit\nprediction technology, inter-satellite link ranging technology, and the whole net-\nwork filtering technology. On this basis, this chapter analyzes the overall rotation\nerrors of large elliptical orbit regional constellation autonomous navigation, intro-\nduces a refraining method of the rotating estimation error of constellation config-\nuration based on inter-satellite orientation observation and carries out the simulation\nanalysis accordingly.\n\n5.2 Regional Constellation Autonomous Navigation\nBased on Inter-satellite Ranging\n\n5.2.1 Constellation Autonomous Navigation System\nScheme of Elliptical Orbit\n\nIn the implementation process of the method of large elliptical orbit constellation\nautonomous navigation system, satellites in the constellation are generally divided\ninto autonomous stars only featuring inter-satellite link measurement communica-\ntions and center star with powerful data processing functions. High-precision orbit\nprediction is commonly distributed in each autonomous satellite of a constellation,\nand meanwhile, satellites in constellation conduct communication ranging with\neach other and send the orbit prediction information and inter-satellite measurement\ninformation to the center star, which will start the whole network information fusion\nto get the optimal orbit parameter estimation of the whole constellation and ulti-\nmately returns the parameters estimation to each operating satellites in constellation\n[4]. Schematic diagram is shown in Fig. 5.1.\n\nFor the reason that the autonomous navigation system large elliptical orbit\nconstellation based on the inter-satellite measurement communication only uses the\ninformation of relative ranging and relative velocity between the constellation\nsatellites, during the process of the whole network filtering orbit determination, the\nsystem is only able to constrain the trend of orbital parameter estimation error of\nwhole constellation diverging along different directions, instead of suppressing the\ntrend of orbit parameter estimation error of satellite diverging in the same direction,\nthat is, rotation divergent trends and drift divergent trends of estimation error.\nTherefore, the constellation autonomous navigation system based on the\ninter-satellite measurement communication is of high accuracy in the whole con-\nstellation error estimation in a short time, but with time passing by, the estimation is\nultimately in a trend of slow divergence, which appears that the estimation error of\n\n118 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nthe orbit parameters in a constellation, which decide the satellites\u2019 orbit positions\n(the right ascension of ascending node, the orbit inclination angle and the perigee\nangle) are slowly diverging. It can be analyzed from mathematical matrix the reason\nis the rank deficiency of constellation network filtering measurement matrix.\n\n5.2.2 High-Precision Orbit Prediction Technology\nof Constellation Autonomous Navigation System\non Elliptical Orbit\n\nIn the large elliptical orbit constellation autonomous navigation system, because the\ninter-satellite mutual ranging communication takes a long time, the measuring\nupdate cycle is generally set to be more than 15 min to avoid the divergent trends of\n\nRa\nng\n\nin\ng,\n\nco\nm\n\nm\nun\n\nic\nat\n\nio\nn\n\nTraj\necto\n\nry p\nredi\n\nction\nvalu\n\ne an\nd th\n\ne\n\nopti\nmal\n\nestim\nate o\n\nf the\nuplo\n\naded\norbi\n\nts\n\nof th\ne int\n\ner-sa\ntelli\n\nte m\neasu\n\nrem\nents\n\nretu\nrn\n\nAutonomous \nStar 5\n\nCenter \nStar\n\nAutonomous \nStar 4\n\nAutonomous\nStar 3\n\nAutonomous \nStar 2\n\nAutonomous \nStar 1\n\nFig. 5.1 Schematic diagram of large elliptical orbit autonomous navigation system\n\n5.2 Regional Constellation Autonomous Navigation \u2026 119\n\n\n\nthe estimation error of the orbit parameters during the autonomous navigation\nprocess, and especially, as the large elliptical orbit environment changes greatly\nfrom high to low, orbit prediction model should be established accurately. When\npredicting the satellite orbital parameters according to the orbit dynamic model,\norbit prediction accuracy is mainly decided by two factors: model linearization error\nand perturbation factors [5]. The former refers to calculation error caused by the\nnonlinear orbit dynamic equation during the process of linearization; generally, the\nlarger the linear step size is or the fewer Taylor orders are taken, the greater the\nnonlinear error is. The orbital perturbation is when satellites are in orbit; they are\nnot only acted upon the gravity force in the geocentric but also upon other con-\nservative forces (like non-spherical perturbation of the earth and lunisolar attrac-\ntion) and non-conservative forces (like the air drag and solar radiation pressure),\nand therefore, to predict the satellites\u2019 orbital parameters accurately, each pertur-\nbation should be taken into fully account while considering the satellites\u2019 specific\ntracks. This section mainly introduces orbit integral algorithms and covariance\nforecasting technique being used in orbit prediction, and each perturbation being\nconsidered during the process of satellite orbit prediction.\n\n1. Satellite orbit numerical integration techniques\n\nBecause the perturbed differential equations of the motion of large elliptical orbit\nsatellites are a complicated nonlinear form and cannot be given rigorous analytic\nsolutions, the numerical integral algorithm of differential equation has a distinct\nadvantage. The numerical integral algorithm can give discrete solutions which can\nmeet certain accuracy requirements on a number of points and is suitable for\ncomputer programming. From the view of mathematical theory, numerical solution\nof a differential equation is an initial value question of differential equation. The\nbasic model is\n\n_x \u00bc f \u00f0x; t\u00de\nx\u00f0a\u00de \u00bc x0\n\n?\n\u00f0a? t? b\u00de \u00f05:1\u00de\n\nIn the formula, x can be seen as a vector (e.g., the position and the speed of a\nsatellite make up a vector.). Getting the numerical solutions is getting the\napproximate value of x\u00f0tn\u00de on a series of discrete points tn\u00f0n \u00bc 1; 2; . . .;m\u00de in\nclosed interval of a, b ([a, b]). Generally, take tn into equal intervals, that is,\n\ntn \u00bc t0 \u00fe nh n \u00bc 1; 2; . . .;m \u00f05:2\u00de\n\nIn the formula t0 \u00bc a, h is the step size.\nThe calculation steps are get x1 from the initial value x0 \u00bc x\u00f0t0\u00de \u00bc x\u00f0a\u00de and get\n\nx2 from x1, until getting xm from xm?1.\nWhen calculating xn\u00fe 1 of the corresponding time tn\u00fe 1 for each step, only xn of\n\nthe previous time tn needs to be known, which is called single-step method; if value\n\n120 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nof multiple times ahead = need to be known by each step, it is called the multistep\nmethod. These two methods are both adopted in the manmade satellite orbit\ncalculation.\n\nBecause numerical integral algorithm is essentially an approximate calculation\nmethod truncating higher-order terms which takes h as step size, there is an error\nbetween the calculated approximate value xn\u00fe 1 and the actual value xn\u00fe 1, which is\ncalled the truncation error; meanwhile, the computer can only adopt finite word\nlength of floating point numbers and it will also cause errors between actual num-\nbers, which is called the rounding error. As errors caused by each step (including\ntruncation errors and rounding errors) will spread to the next phase of the calculation,\ngenerally speaking, with time passing by, the accuracy of the numerical integrals will\ngradually decrease (as for orbital numerical integral, the inaccuracy of the orbital\ndynamic model also leads to the decrease of the accuracy of orbit prediction); the\naccumulated errors brought by the numerical calculation method itself should be\nstrictly controlled to guarantee the accuracy of orbital numerical integral.\n\nThe numerical integral algorithm with superior performance can improve the\nefficiency of operation and guarantee the accuracy of the orbit prediction [6].\nAdopting the numerical integral algorithm can realize the real-time propagation of\norbit information of each satellite in the constellation, and the calculated result is the\none-step state prediction value in Kalman filter. Several frequently used methods of\norbit numerical integral are introduced as follows.\n\n1) Runge\u2013Kutta, RK\n\nRK is a single-step algorithm, and its basic principle is quoting Taylor series\nexpansion indirectly, that is, using linear combinations of the right functions f of\nseveral points on the integrating range to take the place of derivatives of f and then\nusing the Taylor expansion to determine the corresponding coefficients. Different\ncoefficient selections produce different numerical formulas, and the following is a\nfrequently used classic calculation\n\nxn\u00fe 1 \u00bc xn \u00fe 16 k1 \u00fe 2k2 \u00fe 2k3 \u00fe k4\u00bd ? \u00f05:3\u00de\n\nIn the formula,\n\nk1 \u00bc hf tn; xn\u00f0 \u00de\nk2 \u00bc hf tn \u00fe 12 h; xn \u00fe 12 k1\n\n? ?\nk3 \u00bc hf tn \u00fe 12 h; xn \u00fe 12 k2\n\n? ?\nk4 \u00bc hf tn \u00fe h; xn \u00fe k3\u00f0 \u00de\n\n8>><\n>>:\n\nFrom the formula, it can be seen that the order of method is consistent with the\ntimes of the function value f calculated for each step. The formula is widely used,\nbut estimating local truncation error is difficult. However, for general calculation,\nespecially orbit prediction calculations of small step size, its calculation accuracy is\nenough.\n\n5.2 Regional Constellation Autonomous Navigation \u2026 121\n\n\n\n2) Runge\u2013Kutta\u2013Fehlberg (RKF)\n\nBecause it is difficult for RK method itself to estimate the local truncation error, a\nmethod is proposed, that is, adopting two sets of RK formulas of m order and m\u00fe 1\norder and using the difference of the results of the two sets of formulas to estimate\nthe local truncation error and consequently determine the calculation step size of the\nnext step, which means if the truncation error is too large, reduce the calculation\nstep to improve accuracy; if the precision is higher in a certain calculation step, it\ncan automatically increase the length of the steps in the iteration and speed up the\noperation. This method is called RKF, and there are many different forms of the\nformula according to different orders. The following is one kind of computational\nformulas of RKF:\n\nxn\u00fe 1 \u00bc xn \u00fe h\nP5\nk\u00bc0\n\nckf k \u00feO\u00f0h6\u00de\n\nx_n\u00fe 1 \u00bc xn \u00fe h\nP7\nk\u00bc0\n\nc_kf k \u00feO\u00f0h7\u00de\n\n8>><\n>>: \u00f05:4\u00de\n\nIn the formula,\n\nf 0 \u00bc f \u00f0tn; xn\u00de\nf k \u00bc f \u00f0tn \u00fe akh; xn \u00fe h\n\nPk?1\nk\u00bc0\n\nbkkf k\u00de\n\n8<\n: ; k \u00bc 1; 2; . . .; 7\n\nIn the formula, ck; c\n_\n\nk; ak; bkk are coefficients in the formula which can be\nobtained by referring to relevant documents. The method can obtain fast operation\nspeed and has good numerical stability in the case of keeping high-expectation\naccuracy.\n\n3) Cowell\u2013Adams\n\nCowell\u2013Adams is a multistep numerical integral method with high-accuracy.\nCowell formula often provides state vectors, while Adams formula is used to cal-\nculate x. The method often combines implicit formulas with display formulas, that\nis, using the display to provide estimated values and then using the implicit to revise\nit, which is generally called PECE algorithm. But Cowell\u2013Adams algorithm needs a\nprocess of initialization.\n\nForecast formulas:\n\n_yn\u00fe 1 \u00bc h ~Sn \u00fe\nPk\ni\u00bc0\n\nbi\u20acyn?i\n\n? ?\n\nyn\u00fe 1 \u00bc h2 ~S?n \u00fe\nPk\ni\u00bc0\n\nai\u20acyn?i\n\n? ?\n8>><\n>>: \u00f05:5\u00de\n\n122 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nIn the formulas,\n\n~Sn \u00bc r?1\u20acyn\n~S?n \u00bc r?2\u20acyn\n\n?\n\nbi \u00bc \u00f0?1\u00dei\nPk\nm\u00bci\n\nm\ni\n\n? ?\nr0\u00f01\u00dem\u00fe 1\n\nai \u00bc \u00f0?1\u00dei\nPk\nm\u00bci\n\nm\ni\n\n? ?\nr00\u00f01\u00dem\u00fe 2\n\n8>><\n>>:\n\nCorrection formulas:\n\n_yn\u00fe 1 \u00bc h ~Sn\u00fe 1 \u00fe\nPk\ni\u00bc0\n\nb?i \u20acyn\u00fe 1?i\n\n? ?\n\nyn\u00fe 1 \u00bc h2 ~S?n\u00fe 1 ? ~Sn\u00fe 1 \u00fe\nPk\ni\u00bc0\n\na?i \u20acyn\u00fe 1?i\n\n? ?\n8>><\n>>: \u00f05:6\u00de\n\nIn the formulas,\n\nb?i \u00bc \u00f0?1\u00dei\nPk\nm\u00bci\n\nm\ni\n\n? ?\nr0\u00f00\u00dem\u00fe 1\n\na?i \u00bc \u00f0?1\u00dei\nPk\nm\u00bci\n\nm\ni\n\n? ?\nr00\u00f00\u00dem\u00fe 2\n\n8>><\n>>:\n\nThe coefficients in the integral can be obtained by recursive calculation.\n\nr0\u00f0s\u00de \u00bc r00\u00f0s\u00de \u00bc r000\u00f0s\u00de \u00bc 1\nr0i\u00f0s\u00de \u00bc\n\nPi\nj\u00bc0\n\nr0j\u00f00\u00de ? ri?j\u00f0s\u00de\n\nr00i \u00f0s\u00de \u00bc\nPi\nj\u00bc0\n\nr00j \u00f00\u00de ? ri?j\u00f0s\u00de\n\n8>>>>><\n>>>>>:\n\nri\u00f0s\u00de \u00bc s\u00fe i?1i ri?1\u00f0s\u00de\nr0i\u00f00\u00de \u00bc ?\n\nPi?1\nj\u00bc0\n\n1\ni?j\u00fe 1 r\n\n0\nj\u00f00\u00de\n\nr00i \u00f00\u00de \u00bc\nPi\nj\u00bc0\n\nr0j\u00f00\u00der0i?j\u00f00\u00de\n\n8>>>>><\n>>>>>:\n\nThe orbital numerical integral algorithm is a little more accurate than RK andRKF,\nbut because it is amultistep algorithm andKalman filtering is a sequential approach on\nthe time line, every time it can only update the current orbital parameters. Therefore,\nthe multistep algorithm needs to be initialized again after the update of the Kalman\nfiltering measurement, making the whole algorithm redundant and trivial.\n\n5.2 Regional Constellation Autonomous Navigation \u2026 123\n\n\n\n2. The perturbation considered in the orbit forecast\n\nWhen a satellite moves around the earth, its forces mainly include gravity of the\nearth\u2019s mass center F0, the earth\u2019s non-mass gravity Fe, the three-body gravity of\nthe sun and the moon Fn, and solar radiation pressure Fs, etc. The magnitude of\neach satellite is associated with the satellite\u2019s orbital height. The perturbing forces\nof a satellite can be represented as a mathematical formula:\n\nF \u00bc F0 \u00feFe \u00feFn \u00feFs \u00f05:7\u00de\n\n1) Non-spherical gravitational perturbations of the earth\n\nAssuming the earth is a rigid body and the equatorial plane overlaps with the\nfundamentals [7] of the epoch gravity inertial coordinate system, thus gravitational\npotential function expansions in the geocentric coordinates can be written as\n\nF \u00bc F0 \u00feFe \u00f05:8\u00de\n\nF0 \u00bc 1r \u00f05:9\u00de\n\nFe \u00bc ?\nX\nn? 2\n\nJn\nrn\u00fe 1\n\nPn\u00f0sinu\u00de ?\nX\nn? 2\n\nXn\nm\u00bc1\n\nJn;m\nrn\u00fe 1\n\nPmn \u00f0sinu\u00de ? cosm?k \u00f05:10\u00de\n\n?k \u00bc k? aG \u00f05:11\u00de\n\nIn the formula, F0 is the part of gravity of the earth\u2019s mass center, which is\nequivalent to the gravitational bit of a uniform density sphere or the particle force\nthat the mass is all concentrated on the core of the earth, which is the main part of\nthe gravity of the earth and is also the model of gravity used in the two physical\nmodels; Fe is the earth\u2019s non-mass gravitational perturbation term and is the\nmodification of uniform spheres in the gravity of the earth, including zonal and\ntesseral harmonic terms, and the corresponding coefficients of the zonal harmonic\nterm and tesseral harmonic term are written as Jn, Jn;m. The sizes reflect the uneven\ndistribution of the earth\u2019s mass and in then, J2 \u00bc O\u00f010?3\u00de, which is called partial\nrate term, is the main perturbation of the earth and the magnitude of other coeffi-\ncients Jn, Jn;m, are under 10?6. Different values of the coefficients make up different\ngravity models facilitating computer programming; k, and u are geocentric longi-\ntude and latitude; aG is Greenwich apparent sidereal time; Pn\u00f0sinu\u00de, and Pmn \u00f0sinu\u00de\nare Legendre and association Legendre polynomials. To know the numerical cal-\nculation methods of Legendre and association Legendre polynomials, see the rel-\nevant reference books.\n\n124 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\n2) Sun\u2013moon gravitational perturbations\n\nWhen satellites moves around the earth, sun\u2013moon gravitation is a typical\nthree-body perturbation force and the corresponding perturbation acceleration is\n\nFn \u00bc\nP2\nJ\u00bc1\n\n\u00f0?mj\u00de Rj\nRjj j3 \u00fe\n\nD3\nDjj j\n\n? ?\nDj \u00bc r? Rj j \u00bc 1; 2\n\n8<\n: \u00f05:12\u00de\n\nIn the formula, r and Rj are the earth trail of spacecraft and Sun\u2013Moon and Rj is\na known function of time, which is determined by the model of Sun\u2013Earth\u2013Moon\nthree-body system and has no relationship with the movement of the spacecraft; the\nmagnitude of the perturbation is\n\nFnj j\nF0j j \u00bc\n\nmj\nM\n\nr\nD\n\n\t \n3\n\u00f05:13\u00de\n\nFor near-earth spacecrafts (the ratio of the spacecraft geocentric distance and the\nradius of the earth r? 1:5), the magnitude of the sun perturbation is 0:6? 10?7, and\nthe counterpart of the Moon is 1:2? 10?7; for geosynchronous satellites (c \t 6.6),\nthe magnitude of the sun perturbation is 10?5, and the counterpart of the moon is\n2? 10?5. It can be seen that high-orbit satellites in the constellation are more easily\ninfluenced by sun and moon perturbations.\n\n3) Sunlight pressure perturbation\n\nThe solar radiation pressure directly acting on the surface of spacecrafts is not\nlarge, but it also influences spacecrafts\u2019 orbit motion, especially spacecrafts with\nlarge solar panels [7]. The corresponding perturbation acceleration is\n\nFs \u00bc c cr Sm\n? ?\n\nqH\na2u\nD2\n\nD\nDj j\n\n? ?\n\u00f05:14\u00de\n\nIn the formula, qH is the solar radiation pressure acting at a distance of one\nastronomical unit; cr is the effective area-mass ratio of a spacecraft for light pres-\nsure; D is the radius vector from the sun to the spacecrafts; c is the shadow factor\nand is defined by the following formula:\n\nc \u00bc 1? DS=SH \u00f05:15\u00de\n\nIn the formula, SH is the sun apparent area; DS is the eroded area. To make it\nmore convenient to simulate, there is no need to consider penumbra field, because\nthe satellites are either in the light area or in the shadow area. The magnitude of the\nperturbation of the light pressure is\n\n5.2 Regional Constellation Autonomous Navigation \u2026 125\n\n\n\nFs\nF0\n\n\u00bc cr Sm\n? ?\n\nqHr\n2 \u00f05:16\u00de\n\nWhen satellites of general area-mass ratio are flying near the earth r \t 1:1, the\nmagnitude of perturbation is 0:5? 10?8; when satellites are flying in the geosyn-\nchronous orbit c \t 6.6, the magnitude of perturbation is 2? 10?7. If the area-mass\nratio is large, the magnitude of perturbation should be analyzed specifically and\nthen be considered whether or not to add into the forecasting model.\n\n4) Atmospheric drag perturbation\n\nWhen the orbit of a satellite is low, atmospheric drag perturbation will have great\ninfluence on the satellite:\n\nD \u00bc ? 1\n2\n\nCDS\nm\n\n? ?\nqVV \u00f05:17\u00de\n\nIn the formula, D is the acceleration caused by the atmospheric drag of the\nsatellite; CD is the coefficient of the drag; S=m is the area-mass ratio; q is the\natmospheric density of the space where the spacecraft is in. When flying at an\naltitude of 200 km above, the magnitude of the perturbation is not more than 10?6;\ntherefore, when the satellites in the constellation are operating in high orbits, the\ninfluence of the atmospheric drag can be ignored [8].\n\n5.2.3 Technology of Inter-satellite Link Ranging\n\nEstablishing inter-satellite link among each satellite in the constellation can not only\nprovide ranging function, but also build up channels for information change among\nthe satellites [9]. Ranging and communication of ISL usually adopts bidirectional\nand dual-frequency modes. Bidirectional mode can get the satellite clock offset and\neliminate most system errors and correlation errors of inter-satellite ranging, while\nthe dual-frequency mode can eliminate the impact of ionospheric delay on ranging.\nThis section provides a brief analysis of satellite visibility and the establishment of\nobservation model of distance between the satellites in the constellation.\n\n1. Constellation satellites visible conditions\n\nAchieving mutual measurement and communication among satellites in large\nelliptical orbit constellation is relevant to the constellation configuration, the radi-\nation pattern of antennas, radio signal strength, and other factors. Because the\nradiation pattern of antennas can be met by antenna design and with the develop-\nment of technology, smart antennas can control the antenna radiation pattern by\ncontrolling phased arrays, so as to keep the antenna always in the best working\n\n126 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nstate. Therefore, in the analysis of the book, it mainly considers two conditions: the\nmaximum distance of the radio work and the earth block.\n\nIf two satellites can communicate with each other, firstly the distance of the two\nshould be less than the farthest distance of the radio system.\n\nri ? rj\n?? ???Range \u00f05:18\u00de\n\nFigure 5.2 describes a diagram of the communication between the two stars\nbeing blocked by the earth, and it can be seen that if the angle of the position\nvectors of two satellites, ri and rj are an acute angle, the two satellites are on the\nsame side of the earth, and are visible to each other; if the angle is an obtuse angle,\nit means the two satellites are on two sides of the earth and are only visible when\nh is larger than the earth radius. Generally, the transmission between two satellites\nalso needs to consider the ionosphere and troposphere on the surface of the earth,\nand in this book, the inter-satellite links influenced more greatly by the ionosphere\nand troposphere would not be considered. Therefore, the link tangential height\nbetween the two satellites must be greater than certain height of the earth (generally\nis taken as 1000 km); thus, the two satellites can communicate with each other. So\ncommunicating between two satellites also needs to meet\n\nri ? rj ? 0\nri ? rj\\0; h \u00bc ri?rjj jri?rjj j ? k ? RE\n\n(\n\u00f05:19\u00de\n\nIn the formula, RE is the radius of the earth; k is the coefficient of the ratio.\n\nRe\n\nIonospheric \nboundary\n\nFig. 5.2 Earth occlusion\nschematic\n\n5.2 Regional Constellation Autonomous Navigation \u2026 127\n\n\n\n2. The model of inter-satellite link ranging\n\nSupposing there are two co-vision navigation satellites i, j, do pseudorange mea-\nsurements in dual-frequency and bidirectional through inter-satellite link and get\nfour P code pseudorange measurements. Considering the influence of clock offset\nand ionosphere, and ignoring other random errors and systematic errors,\ninter-satellite pseudorange measurement equations can be written as\n\nPRijf1\u00f0t1\u00de \u00bc qij\u00f0t1\u00de\u00fe I\nij\nf1\u00f0t1\u00de\u00fe cdij\u00f0t1\u00de\u00feD\n\nij\nf1\u00f0t1\u00de \u00f05:20\u00de\n\nPRijf2\u00f0t1\u00de \u00bc qij\u00f0t1\u00de\u00fe I\nij\nf2\u00f0t1\u00de\u00fe cdij\u00f0t1\u00de\u00feD\n\nij\nf2\u00f0t1\u00de \u00f05:21\u00de\n\nPRjif1\u00f0t2\u00de \u00bc qji\u00f0t2\u00de\u00fe I\nji\nf1\n\u00f0t2\u00de\u00fe cdji\u00f0t2\u00de\u00feDjif1\u00f0t2\u00de \u00f05:22\u00de\n\nPRjif2\u00f0t2\u00de \u00bc qji\u00f0t2\u00de\u00fe I\nji\nf2\u00f0t2\u00de\u00fe cdji\u00f0t2\u00de\u00feD\n\nji\nf2\u00f0t2\u00de \u00f05:23\u00de\n\nIn the formula, subscripts f1; f2 are frequency points; t1; t2 are observation time;\nPRij is the pseudorange between two satellites; qij is the distance from the place\nwhere the satellite i transmits signal to the place where the satellite j receives the\nsignal (also called the geometric distance between the satellites), qji is the distance\nfrom the place where the satellite i, j transmits signal to the place where the satellite\ni receives the signal; Iij is the ionospheric time delay of the signal transmitted from\nthe satellite i, j to the satellite j; Iji is the ionospheric time delay of the signal\ntransmitted from the satellite j to the satellite i; c is the speed of light; dij is the time\ncorrection between the satellite i and j; Dij is the observation noise.\n\nBecause of the adoption of TMDA method for inter-satellite measurement, the\nmeasurement from the satellite i to the satellite j is different from the measurement\nfrom the satellite j to the satellite i; for orbit calculation, the measurements must be\nconverted to the same time tk and meet the formula\n\nqij\u00f0tk\u00de \u00bc qji\u00f0tk\u00de; cdij\u00f0tk\u00de \u00bc ?cdji\u00f0tk\u00de \u00f05:24\u00de\n\nSubtract and add Eqs. (5.20), (5.21), (5.22), (5.23) (the following lines omits the\ntime tk); here gets the two measurements:\n\nPR \u00bc PR\nij\nfn\n\u00fePRjifn\n2\n\n\u00bc qij \u00fe I\nij\nfn\n\u00fe Ijifn\n2\n\n\u00fe D\nij\nfn\n\u00feDjifn\n2\n\n; n \u00bc 1; 2 \u00f05:25\u00de\n\ndij \u00bc\nPRijfn ? PR\n\nji\nfn\n\n2\n\u00bc cdij \u00fe I\n\nij\nfn ? I\n\nji\nfn\n\n2\n\u00fe D\n\nij\nfn ? D\n\nji\nfn\n\n2\n; n \u00bc 1; 2 \u00f05:26\u00de\n\nEq. (5.25) is the inter-satellite distance observation model, which can be used in\nthe satellite autonomous orbit determination; Eq. (5.26) is the inter-satellite time\ncorrection observation model, which can be used in onboard autonomous\ntimekeeping.\n\n128 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nSupposing it is in the epoch times tk , the inertial Cartesian position vectors of the\nsatellite i, j in the Cartesian coordinate system, respectively, are\n\nr*i\u00f0tk\u00de \u00bc xi\u00f0tk\u00de yi\u00f0tk\u00de zi\u00f0tk\u00de\u00bd ?T\n\nr*j\u00f0tk\u00de \u00bc xj\u00f0tk\u00de yj\u00f0tk\u00de zj\u00f0tk\u00de\u00bd ?T\n\nand suppose\n\nI 0\u00f0tk; fn\u00de \u00bc\nIijfn\u00f0tk\u00de\u00fe I\n\nji\nfn\u00f0tk\u00de\n\n2\n\nD0\u00f0tk; fn\u00de \u00bc\nDijfn\u00f0tk\u00de\u00feD\n\nji\nfn\u00f0tk\u00de\n\n2\n\nThen measurements of the distance between the satellites are\n\nPR\u00f0tk; fn\u00de \u00bc r*i\u00f0tk\u00de ? r*j\u00f0tk\u00de\n?? ??\u00fe I 0\u00f0tk; fn\u00de\u00feD0\u00f0tk; fn\u00de; n \u00bc 1; 2 \u00f05:27\u00de\n\nIn the formula,\n\nr*i\u00f0tk\u00de ? r*j\u00f0tk\u00de\n?? ?? \u00bc ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffixi\u00f0tk\u00de ? xj\u00f0tk\u00de\n ?2 \u00fe yi\u00f0tk\u00de ? yj\u00f0tk\u00de\n ?2 \u00fe zi\u00f0tk\u00de ? zj\u00f0tk\u00de\n ?2q\n\n\u00f05:28\u00de\n\nEq. (5.27) includes the relative position information of two common visible\nsatellites. Therefore, observing the distance between satellites can determine the\nrelative position between the navigation satellites.\n\n5.2.4 Whole Net Filter Scheme of Constellation\nAutonomous Navigation\n\n1. System state equation\n\nBesides the gravity of the earth\u2019s mass center FTB, a satellite in orbit is also under\nthe influence of other perturbation forces, which mainly includes non-spherical\ngravity of the earth FNS, third-body (the sun and the moon) gravity FNB, and\nsunlight pressure perturbation force FSR. That is\n\nF \u00bc FTB \u00feFNS \u00feFNB \u00feFSR \u00f05:29\u00de\n\nThe state variables meet the following initial value problem of ordinary differ-\nential equations\n\n5.2 Regional Constellation Autonomous Navigation \u2026 129\n\n\n\n_X \u00bc F X; t\u00f0 \u00de\nX t0\u00f0 \u00de \u00bc X0\n\n?\n\u00f05:30\u00de\n\nThe solutions to this problem is the state equation\n\nX t\u00f0 \u00de \u00bc G X t0\u00f0 \u00de; t\u00f0 \u00de \u00f05:31\u00de\n\nand discretize it\n\nXk\u00fe 1 \u00bc f Xk; k\u00f0 \u00de \u00f05:32\u00de\n\nIn the formula, f \u00f0?\u00de is the orbital prediction function and this is a process of\nextrapolation of orbits.\n\nDerive Eq. (5.32) by Taylor expansion based on the previous step of estimated\nvalue of optimal filtering and view the over-quadratic term as the system dynamic\nnoise. We get\n\nXk\u00fe 1 \u00bc f X?k=k; k\n\n ?\u00fe @f Xk; k\u00bd ?\n\n@Xk\n\n????\nXk\u00bcX?k=k\n\nXk ? X?k=k\n\n ?\u00feC Xk; k\u00bd ?Wk \u00f05:33\u00de\n\nIn the formula, Wk is the system dynamic noise; C Xk; k\u00bd ? is the system dynamic\nnoise matrix, and the state transition matrix can be expressed as\n\nUk\u00fe 1=k \u00bc\n@f Xk; k\u00bd ?\n@Xk\n\n????\nXk\u00bcX?k=k\n\n\u00f05:34\u00de\n\n2. The system measurement equation\n\nSuppose inter-satellite distance observation in the constellation can be conducted\nover the satellites i and j and suppose the position vectors of two satellites in the\ngeocentric inertial system are ri and rj, respectively, then inter-satellite observation\nmeasurement equation can be expressed as\n\nqij \u00bc ri ? rj\n?? ??\u00feV \u00f05:35\u00de\n\nIn the formula, V is the measurement noise.\nSuppose the orbital elements of the satellite i and the satellite j in the\n\ngeocentric inertial system, respectively, are ri \u00bc xi yi zi vxi vyi vzi\u00bd ?T and\nrj \u00bc xj yj zj vxj vyj vzj\u00bd ?T, and introduce state variables X \u00bc ri rj\u00bd ?T and\ndiscretize Eq. (5.35) getting\n\nqk\u00fe 1 \u00bc q Xk\u00fe 1; k\u00fe 1\u00f0 \u00de\u00feVk\u00fe 1 \u00f05:36\u00de\n\n130 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nDo the Taylor expansion on Eq. (5.36) of the forecast estimated value X?k\u00fe 1=k,\nomitting over-quadratic terms and the linearized inter-satellite distance measure-\nment equation can be obtained\n\nqk\u00fe 1 \u00bc q X?k\u00fe 1=k; k\u00fe 1\n? ?\u00fe @q\n\n@XTk\u00fe 1\n\n?????\nXk\u00fe 1\u00bcX?k\u00fe 1=k\n\nXk\u00fe 1 ? X?k\u00fe 1=k\n? ?\u00feDk\u00fe 1 \u00f05:37\u00de\n\nIn the formula, q\u00f0X?k\u00fe 1=k; k\u00fe 1\u00de is the approximate distance, and suppose the\nobservation coefficient matrix is Hk\u00fe 1, then the expression is as follows:\n\nHk\u00fe 1 \u00bc\n@qij\n\n@ ri\u00f0 \u00deTk\u00fe 1; rj\n? ?T\n\nk\u00fe 1\nh i\n\n??????\nXk\u00fe 1\u00bcX?k\u00fe 1=k\n\n\u00f05:38\u00de\n\nIn the formula,\n\n@qij\n@~rTi\n\n\u00bc 1qij xi ? xj yi ? yj zi ? zj\u00bd ?\n@qij\n@~rTj\n\n\u00bc ? 1qij xi ? xj yi ? yj zi ? zj\u00bd ?\n\n8<\n: \u00f05:39\u00de\n\n3. The whole network filtering method\n\nIn the process of constellation autonomous navigation, the whole network filtering\nmethod is adopted in the filtering algorithm, that is, including all the satellites\u2019\norbital elements in the constellation into the same process of Kalman filtering and\nusing the observations provided by each satellite to revise all orbital elements of the\nsatellites; thus, all the satellites take part in the same filtering process. In the\nprocess, certain steps (like single-satellite track forecast) are dispersed and com-\npleted independently in each satellite, so as to reduce calculation burden of the\nprimary satellite, while other steps (like measurement update of the orbital\nparameters) are completed in the same primary satellite. The whole network fil-\ntering method is shown in Fig. 5.3.\n\nIn the process of the whole network orbit determination, the time update process\nof each satellite is dispersed in the satellite, while the measurement update process\nof orbit determination is completed in the primary satellite; thus, each satellite in the\nconstellation sends the one-step state prediction value of state variables, the state\nestimation for covariance, the state transition matrix, the measurement matrix, and\nsystem dynamic noise to the primary satellite, and then, the whole constellation\nmeasurement update begins. Ultimately, the primary satellite sends the optimal\nestimation of the values of orbit parameters of each satellite after measurement\nupdate to each satellite in the constellation.\n\nBecause the ranging observation information constructed by an inter-satellite\nmeasurement is large and the corresponding state dimensions in the process of a\n\n5.2 Regional Constellation Autonomous Navigation \u2026 131\n\n\n\nfiltering measurement update by primary satellite is more gigantic, the computing\nwork of centralized filtering directly will be quite heavy. Therefore, sequential\nprocessing in measurement update of the primary satellite is necessary.\n\nBecause the information of inter-satellite link is independent, that is, the\nobservation noises Vi in m observation equations are not related to each other, the\nobservation noise square difference is a diagonal matrix. The corresponding\nobservation equations can be expressed as\n\nz1k\nz2k\n..\n.\n\nzmk\n\n2\n6664\n\n3\n7775 \u00bc\n\nH1k\nH2k\n..\n.\n\nHmk\n\n2\n6664\n\n3\n7775Xk \u00fe\n\nV1k\nV2k\n..\n.\n\nVmk\n\n2\n6664\n\n3\n7775 \u00f05:40\u00de\n\nAccording to Kalman orthogonal projection properties, we get\n\nX?k;k \u00bc E XkjZk?1;Zk\u00bd ? \u00f05:41\u00de\n\nAnd according to the sequential processing of the measured values, compute the\nKalman filtering value X?k=k for m times. That is to say, get the valuation X?1k=k from\n\nthe observation component value z1k at the first time and take X?\n1\nk=k as a predictive\n\nvalue, getting the valuation X?2k=k from the observation component value z\n2\nk , etc. The\n\nprojection formulas are used to describe the process of the above\n\nsingle track \nforecast\n\nsingle track \nforecast\n\nsingle track \nforecast\n\nWhole Network \nMeasurement Update\n\nAutonomous \nStar\n\nAutonomous \nStar\n\nAutonomous \nStar\n\nCenter \nStar\n\norbital prediction value\n\nand ranging information\n\noptimal orbit estimation value\n\nFig. 5.3 Whole network orbit determination method\n\n132 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nX?1k=k \u00bc E XkjZk?1; z1k\n\n ?\n\nX?2k=k \u00bc E XkjZk?1; z1k ; z2k\n\n ?\n\n..\n\n.\n\nX?mk=k \u00bc E XkjZk?1; z1k ; . . .; zmk\n\n ?\n\n8>>>><\n>>>>:\n\n\u00f05:42\u00de\n\nMeanwhile, according to Kalman filtering orthogonal projection theorem, the\nfollowing formula is clearly established\n\nX?mk=k \u00bc X?k;k \u00f05:43\u00de\n\nTherefore, the algorithm of sequential Kalman filtering is\n\nX?k=k?1 \u00bc X?k?1=k?1 \u00fe f \u00f0X?k?1=k?1\u00deT\nPk=k?1 \u00bc Uk;k?1Pk?1=k?1UTk;k?1 \u00feCk;k?1Qk?1CTk;k?1\nX?ik=k \u00bc X?i?1k=k?1 \u00fe dX?ik=k\ndX?ik=k \u00bc Kkfzik ? h\u00f0X?i?1k=k?1\u00deg\nKik \u00bc Pi?1k=k?1HTk \u00bdHkPi?1k=k?1HTk \u00feRik??1\nPik=k \u00bc \u00f0I ? K ikHk\u00dePi?1k=k \u00f0I ? KikHk\u00deT \u00feK ikRikKiTk\n\n8>>>>>>>><\n>>>>>>>>:\n\n\u00f05:44\u00de\n\nIn the formula, i \u00bc 1; . . .;m; when i \u00bc 1, X?i?1k=k \u00bc X?0k=k \u00bc X?k=k?1,\nPi?1k=k \u00bc P0k=k\u00bc Pk=k?1; when i \u00bc m, X?mk=k \u00bc X?k=k, Pmk=k \u00bc Pk=k.\n\nAfter the sequential processing of the whole network filtering measurement\nupdate, the measurement update process of the primary satellite is divided into\nm times of successive sub-process of measurement update (supposing there are\nm inter-satellite ranging measurements), and each update process is updating orbit\nprediction value of two satellites which corresponds pseudorange measurement\ninformation with a pseudorange measurement, so the measurement update on the\nprimary satellite equals to dividing a measurement update process of 6n state\ndimensions (supposing the number of the constellation satellites is n) and m mea-\nsurement dimensions into m-time successive submeasurement update process of 12\nstate dimensions and 1 measurement dimension .Because there is matrix inversion\nduring the update process, sequential processing will greatly reduce the amount of\noperations on the primary satellite.\n\n5.2 Regional Constellation Autonomous Navigation \u2026 133\n\n\n\n5.3 Rotation Error Estimation of Constellation\nConfiguration Based on Inter-satellite Observation\n\nAt present, the autonomous orbit determination of navigation constellation is\ngenerally conducted with observation value of the distance between the stars;\nhowever, inter-satellite ranging information can only constrain the accuracy of the\nrelative position of the satellites in the navigation constellation, and cannot over-\ncome the rotation and drift of the whole estimation error of the constellation, the\nlonger the time, the greater the orbit error. This chapter mainly analyzes the source\nof the total rotation error of navigation constellation, the rank loss analysis and the\nintegral rotation error of constellation based on inter-satellite link ranging and\nintroduces the method of the rotation error suppression of constellation autonomous\nnavigation based on inter-satellite orientation.\n\n5.3.1 Rotation Error Analysis of Region Constellation\nAutonomous Navigation on Elliptical Orbit\n\n1. Intuitive analysis of autonomous navigation error of large ellipse region\nconstellation\n\nIn the process of constellation integrated navigation, due to the error of initial value\nof track prediction and the inaccuracy of the orbital prediction model caused by\nvarious perturbations, the estimation error of the orbit parameters of each star in the\nconstellation is continuously divergent [10], and the divergence trend of the esti-\nmation error of the orbit parameters in the constellation is decomposed into\nthe divergence trend of each satellite rotated drifting along the same direction and\nthe divergence trend of each satellite diverging along disorderly directions. For the\nconstellation autonomous navigation method based on the inter-satellite link\nranging, the pseudorange measurement information only constrains the relative\nposition configuration between star and star in the constellation, so it can effectively\neliminate the tendency of the estimation error of the orbit parameters of each\nsatellite in constellation diverging along different directions. However, it is\nimpossible to estimate the estimation error of the orbit parameter of each satellite in\nthe constellation rotated drifting along the same direction (mainly the rotational\nerror), so rotation error always exists in the method of constellation navigation\nbased on the inter-satellite link ranging.\n\nIn addition, it is easier to understand the inadequacy of star distance observation\nfor constellation orbit determination from the geometrical relation of constellation\nspace. Suppose that at a given time, the estimated position and true position of any\nsatellite i in the constellation are Xiest \u00bc \u00bdxie; yie; zie?T, Xitrue \u00bc \u00bdxit; yit; zit?T. If the\nestimated orbital position is a rotational transformation of the true orbital position,\nthat is,\n\n134 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nXiest \u00bc Rz\u00f0hz\u00deRy\u00f0hy\u00deRx\u00f0hx\u00deXitrue \u00f05:45\u00de\n\nIn this formula, Rx;Ry;Rz represents the rotation matrix, which is the orthogonal\nmatrix, and hx; hy; hz means the rotation angle. Then, it is estimated that the distance\nbetween the star and the real star distance has the following relationship:\n\nRijest \u00bc X jest ? Xiest\n?? ??\n\n2\n\n\u00bc Rz\u00f0hz\u00deRy\u00f0hy\u00deRx\u00f0hx\u00de\u00f0X jtrue ? Xitrue\u00de\n?? ??\n\n2\n\n\u00bc X jtrue ? Xitrue\n?? ??\n\n2\n\n\u00bc Rijtrue\n\n\u00f05:46\u00de\n\nIf the orbital position A given by the star estimator equals to the rotational\ntransformation of the orbital true Value B, then the corresponding star distance\ncaused by the two constellations (real and estimated constellations) is equal, and the\nobservation distance between the stars cannot differentiate constellation A and\nconstellation B, and it cannot improve the estimated state of the constellation; that\nis, it cannot eliminate the orbital error caused by the rotation of the constellation,\nbut only determine the relationship of relative position between the stars.\n\n2. Loss rank analysis of constellation autonomous navigation measurement\ninformation in large elliptic region\n\nThis section mainly analyzes the correlation of the satellite orbit element in different\nsituations by the research on the conditional equation coefficient matrix of the\ninter-satellite ranging measurement information of constellation navigation system,\nso as to numerically prove that the constellation navigation will inevitably produce\nthe rotating error. Since various orbital perturbations are small compared to the\ncenter gravity of the earth, the analysis of observability can be assumed to be a\ntwo-body model of the research object, and the analysis results can be obtained by\nthe simplified method.\n\nIn the question of orbit determination, the @r=@q, @ _r=@q, two groups of basic\npartial derivatives are commonly used, where r represents the position vector of the\nsatellite, _r indicates the speed vector, q is 6 orbital element; then, there are two\ngroups of partial derivatives as follows:\n\n@r\n@a \u00bc 1a r; @r@e \u00bc Hr\u00feK _r; @r@M \u00bc 1n _r;\n@r\n@i \u00bc JN ? r \u00bc zsin iR; @r@X \u00bc Jz ? r \u00bc ?y x 0\u00bd ?T;\n@r\n@x \u00bc R? r \u00bc zRy ? yRz xRz ? zRx yRx ? xRy\u00bd ?T\n\n8><\n>: \u00f05:47\u00de\n\n@ _r\n@a \u00bc ? 12a _r; @ _r@e \u00bc H0r\u00feK 0 _r; @ _r@M \u00bc ? ln rr3\n\n? ?\n;\n\n@ _r\n@i \u00bc JN ? _r \u00bc _zsin iR; @ _r@X \u00bc Jz ? _r \u00bc ? _y _x 0\u00bd ?T\n@ _r\n@x \u00bc R? _r \u00bc _zRy ? _yRz _xRz ? _zRx _yRx ? _xRy\u00bd ?T\n\n8><\n>: \u00f05:48\u00de\n\n5.3 Rotation Error Estimation of Constellation \u2026 135\n\n\n\nIn the formula, l is the earth gravitational constant; n is the average angular\nvelocity of motion; Jz \u00bc 0 0 1\u00bd ?T; JN \u00bc cosX sinX 0\u00bd ?T; R is the Orbital\nmethod to the unit vector, and the expressions are\n\nR \u00bc 1ffiffiffiffiffiffi\nlp\n\np r? _r\u00f0 \u00de\n\nH \u00bc ? 1\n1? e2 cosE\u00fe e\u00f0 \u00de K \u00bc\n\nsinE\nn\n\n1\u00fe r\np\n\n? ?\n\nH0 \u00bc\nffiffiffiffiffiffi\nla\n\np\nsinE\nrp\n\n1? a\nr\n\n1\u00fe p\nr\n\n\t \nh i\nK 0 \u00bc a\n\np\ncosE\n\nIn the formula, p is track half path. The following is the analysis of the\nobservability of the orbital root number by the inter-satellite ranging information.\n\nAny of two satellites that can be observed by one another, with Formula (5.49)\nestablished\n\nrij \u00bc rj ? ri \u00f05:49\u00de\n\nThe differential form of Formula (5.50) can be\n\ndrij \u00bc\nX @rj\n\n@qj\ndqj ?\n\nX @ri\n@qi\n\ndqi \u00f05:50\u00de\n\nAt the same time, the direction vector to the satellite, the available Formula\n(5.51) describes\n\neij \u00bc rj ? ri\n? ??\n\nL \u00f05:51\u00de\n\nIn the formula, L is the distance between two stars. Formulas (5.50) and (5.51)\nare used to obtain the inner product, thus obtaining the condition equation of\nautonomous orbit determination by using the inter-star ranging data in the con-\nstellation as.\n\ndrij \u00bc\nX\n\neij ? @rj\n@qj\n\ndqj ?\nX\n\neij ? @ri\n@qi\n\ndqi \u00f05:52\u00de\n\nAnalyze the correlation of each coefficient to be estimated in the expression\n(5.52); it can be known whether the system is observable. At the same time, in the\ntwo-body model, @qt=@q0 \u00bc I6?6. So the derivative at the moment is equal to the\nderivative of a reference time. The derivation can be greatly simplified. Besides, the\ncoefficients of different orbital element are generally irrelevant. So the analysis\nprocess mainly considers the same orbital element between different satellites, and\nthe relationship of coefficients can be derived.\n\n136 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\n(1) observability analysis of the semimajor axis of orbit a:\n\neij ? @rj\n@aj0\n\n\u00bc rj ? ri\n? ? ? rj\n\nLaj0\neij ? @ri\n\n@ai0\n\u00bc rj ? ri\n\n? ? ? ri\nLai0\n\n\u00f05:53\u00de\n\nFrom the expression (5.53), it can be seen that if satellite i and satellite j are on\ncircle orbits with the same altitude, and then, the condition equation of a will be\nsingular; As a matter of fact, the orbit of a satellite always has an eccentricity, and\nthe value of the orbit altitude is very high, so the value of a is easy to be observed.\n\n(2) observability analysis of the orbital eccentricity e:\n\neij ? @rj\n@ej0\n\n\u00bc rj ? ri\n? ? ? Hjrj \u00feKj _rj? ?\n\nL\neij ? @ri\n\n@ei0\n\u00bc rj ? ri\n\n? ? ? Hiri \u00feKi _ri\u00f0 \u00de\nL\n\n\u00f05:54\u00de\n\nTherefore, the coefficient of dei0 is irrelevant to the coefficient of dej0, and the\nerror of the eccentricity error can be corrected effectively by the ranging between\nstars which are on the same orbit, or on the different orbits.\n\n(3) observability analysis of the orbital inclination i:\n\neij ? @rj\n@ij0\n\n\u00bc ? rj ? ri\n? ? ? JNj\n\nL\neij ? @ri\n\n@ii0\n\u00bc ? rj ? ri\n\n? ? ? JNi\nL\n\n\u00f05:55\u00de\n\nFrom expression (5.55), it can be seen that when right ascension of ascending\nnode (RAAN) of the two satellites is the same or is of 180\u00b0 phase difference, the\ncoefficient of dei0 is relevant to the coefficient of dej0, and both dei0 and dej0 are\nunobservable, which means that inter-satellite ranging information of same orbit has\nno correcting effect on orbit inclination.\n\n(4) observability analysis of the right ascension of ascending node (RAAN) X:\n\neij ? @rj\n@Xj0\n\n\u00bc 1\nL\n\nxiyj ? xjyi\n? ?\n\neij ? @rj\n@Xi0\n\n\u00bc 1\nL\n\nxiyj ? xjyi\n? ? \u00f05:56\u00de\n\nFrom expression (5.56), it can be seen that no matter what kind of orbits the two\nsatellites are on, the coefficient of dXi0 and that of dxj0 are strictly equal, so X is\nunobservable.\n\n5.3 Rotation Error Estimation of Constellation \u2026 137\n\n\n\n(5) observability analysis of the argument of perigee x:\n\neij ? @rj\n@xj0\n\n\u00bc 1\nL\n\nri ? rj\n? ? ? Rj eij ? @rj\n\n@xi0\n\u00bc 1\n\nL\nri ? rj\n? ? ? Ri \u00f05:57\u00de\n\nFrom expression (5.57), it can be seen that when normal vector of two satellites\u2019\norbits are same or opposite, the coefficient of dei0 is relevant to the coefficient of\ndej0, and both dei0 and dej0 are unobservable, which means that eccentricity cannot\nbe corrected effectively to the distance between stars.\n\n(6) observability analysis of the mean anomaly M:\n\neij ? @rj\n@Mj0\n\n\u00bc rj ? ri\n? ? ? _rj\n\nLnj\neij ? @ri\n\n@Mi0\n\u00bc rj ? ri\n\n? ? ? _ri\nLni\n\n\u00f05:58\u00de\n\nFrom expression (5.58), it can be seen that, as _rj and _ri are certainly not the same\nat most time, the condition equation of M would not be singular at most time\nneither; but if both the two satellites are on the same circular orbit, it will be\nsingular. Therefore, the observability of inter-satellite ranging for mean anomaly\nusually depends on the satellite orbital eccentricity, and the observability is low\nwhen it comes to the near circular orbits, and the corresponding correction effect to\nthe mean anomaly is poor neither. While when it comes to the high elliptical orbit,\nthe observability is high and the corresponding correction effect to the mean\nanomaly t is good.\n\nFrom what has been discussed above, for the three orbital elements a, e, M,\ngenerally, the coefficient matrix is irrelevant, and for i, w, inter-satellite observa-\ntions conducting on the same orbital plane will cause their coefficients related,\nwhich will lead to an ill-conditioned equation. And when the inter-satellite obser-\nvations are on the different orbital plane, their coefficients are less relevant; as for\nthe right ascension of ascending node (RAAN) X, generally, it is seriously\nill-conditioned related. Therefore, the inter-satellite observations on the same orbital\nplane can only effectively correct the estimate error of track parameter a, e, M, and\nthe inter-satellite ranging information on the different orbital plane can effectively\ncorrect the estimate error of track parameter a, e, M, i, w, while for estimate error of\nX, neither inter-satellite ranging observation on the same orbit nor on different\norbits can make complete correction.\n\nIn the constellation navigation method based on the inter-satellite link ranging,\nas the condition coefficient of the ascension intersection point is in rank loss, the\ninformation of inter-satellite ranging cannot eliminate the estimate error of the right\nascension of ascending node completely, which leads the overall estimation error to\nshow the rotation divergence trend. It is also proved that the overall rotation error of\nconstellation based on information of inter-satellite ranging cannot be eliminated in\nmathematics. Apart from it, the information of inter-satellite ranging can only partly\ncorrect the perigee argument and the orbit inclination is also a reason for the\nrotation error of constellation estimation.\n\n138 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\n5.3.2 Rotation Error Mitigation Method Based\non Inter-satellite Observation of Constellation\nAutonomous Navigation on Elliptical Orbit\n\n1. Modeling of Inter-satellite orientation observation information\n\nIn the process of the satellites\u2019 operating, its astronomical background represents\nthe direction of the inertial system. The direction of the constellation relative to the\ninertial system can be determined by an optical observation of the constellations\nand their background fixed stellar, so the effect of the constellation rotation error on\nautonomous orbit determination can be controlled, which is called inter-satellite\nabsolute orientation. What is more important, the inter-satellite orientation has\nnothing to do with the arc length of the autonomous operation of the constellation;\ntherefore, making use of inter-satellite orientation observation is an important\nmethod to make sure the autonomous orbit determination would not be affected by\nthe overall rotation error of the constellation.\n\nThe inter-satellite orientation observation schematic is shown in Fig. 5.4. The\nbasic principle is using a camera observation device to take photographic obser-\nvation over another satellite and its background stellar from a satellite. The angular\ndistance information between the direction of the connection line of observing\nsatellite and observed satellite and the view direction of the background stellar can\nbe obtained by processing the stars\u2019 image. In this case, the direction of the satellite\nconnection represents the spatial orientation of the constellation, the direction of the\nstellar represents the information of the inertial system, and the observed angular\ndistance information can connect these two. Therefore, the introduction of the\n\nearth\n\nObservation satellite\n\nAngular distance\n\nFig. 5.4 Schematic of\ninter-satellite orientation\nobservation\n\n5.3 Rotation Error Estimation of Constellation \u2026 139\n\n\n\nangular distance information is equivalent to bringing external inertial reference\ninformation into navigation constellation. The overall rotation of the navigation\nconstellation in the inertial space must lead to changes in the direction of the\nsatellite i and the satellite j connection line in the space of inertia, which in turn\nleads to the change of angular distance information. So it is easy to understand\nphysically that the argument information to the whole constellation rotation is\nobservable, and increasing the inter-satellite direction finding information on the\nbasis of inter-satellite ranging (the angular distance information) can accurately\ndetermine and eliminate accumulated error impact brought by whole constellation\nrotating.\n\nThe inter-satellite orientation angular distance model is as follows.\nDefine observation satellites as the center of celestial sphere coordinate system.\n\nThe coordinate origin is the satellite observation satellite (satellite i), and the rest of\nthe system has the same definition of J2000.0 geocentric equatorial inertial coor-\ndinate system. Position of the north celestial pole, satellite j and the stellar A on the\ncelestial sphere (the projection points) are A, B, and C, as shown in Fig. 5.5.\n\nSuppose \u00f0aA; dA\u00de is the right ascension and declination of stellar A, which can be\nobtained from the stellar catalog.\n\nSuppose \u00f0aij; dij\u00de is the ascension and declination of the connection between\nsatellite i and satellite j, and they can be obtained by the following expression:\n\naij \u00bc arctan yj?yixj?xi\ndij \u00bc arctan zj?ziffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\u00f0xj?xi\u00de2?\u00f0yj?yi\u00de2p\n\n(\n\u00f05:59\u00de\n\nIn this expression, ri \u00bc \u00bdxi; yi; zi?T and rj \u00bc \u00bdxj; yj; zj?T are the position vectors of\nthe satellite i and the satellite j in the inertial coordinate system.\n\nAccording to the spherical triangle DABC shown in the mathematical model of\ninter-satellite orientation observation, the following expressions can be obtained\n\nZ\n\nX\n\nYO\n\nNorth \nPole\n\nSatellite i\n\nSatelli\nte j\n\nFixed \nstarA\n\nA\n\nB C\n\nl\n\nFig. 5.5 Mathematical\nmodel of inter-satellite\norientation observation\n\n140 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nAB \u00bc p\n2\n? dij \u00f05:60\u00de\n\nAC \u00bc p\n2\n? dA \u00f05:61\u00de\n\nBC \u00bc l \u00f05:62\u00de\n\n\\BAC \u00bc aA ? aij \u00f05:63\u00de\n\nBased on the cosine theorem of a spherical triangle, the angular distance\nexpression is as follow:\n\nl \u00bc arccos[sindAsindij + cosdAcosdijcos(aA ? aij\u00de? \u00f05:64\u00de\n\nFrom this expression,\n\nl \u00bc arccos sindAsin arctan zj ? ziffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\u00f0xj ? xi\u00de2 ? \u00f0yj ? yi\u00de2\n\nq\n0\nB@\n\n1\nCA\n\n2\n64\n\n+ cosdAcos arctan\nzj ? ziffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\n\u00f0xj ? xi\u00de2 ? \u00f0yj ? yi\u00de2\nq\n\n0\nB@\n\n1\nCAcos aA ? arctan yj ? yixj ? xi\n\n? ?375 \u00f05:65\u00de\n\nIt is not hard to see how the equation above relates angular distance observations\nto the location of the satellite. Therefore, angular distance observations can be used\nto determine the orbit of the navigation satellite.\n\n2 The observability analysis of the inter-satellite orientation observation\ninformation.\n\nSuppose the basic equation (condition equation) after linearization of the mea-\nsurement equation is as follows:\n\ny \u00bc Bx\u00feV \u00f05:66\u00de\n\nSo here, the V is the measurement of random difference, the y is the residual, and\nthe x is the correction value of the state-argument (which is wait to be estimated) X0.\n\ny \u00bc lo ? lc \u00f05:67\u00de\n\nx \u00bc X0 ? X?0 \u00f05:68\u00de\n\nlo and lc are the observed and calculated values of the angular distance obser-\nvations (which corresponds to the reference track X0\n\n*), and the state variables take\nthe Kepler\u2019s orbital element.\n\n5.3 Rotation Error Estimation of Constellation \u2026 141\n\n\n\nJudging whether the orbit determination is in rank loss only by using\ninter-satellite orientation observation depends on the properties of matrix B (also be\ncalled as the normal matrix), the matrix B can be get from the following\nexpressions:\n\nB \u00bc @l\n@ rTi ; r\n\nT\nj\n\n\t \n\n0\n@\n\n1\nA @ ri; rj? ?\n\n@XT\n\n? ?\n@X\n@XT0\n\n? ?\n\u00f05:69\u00de\n\nThe three classes of partial derivative matrices of the right end of the matrix are\n(1 ? 6) dimensions, (6 ? 12), and (12 ? 12) dimensional matrices, and the matrix\nis (1 ? 12) dimensions. Once a sample is sampled, the characteristics of the matrix\ncan be understood, thus, whether there is in rank loss can be judged. Variables in\nthe following equations have been normalized:\n\nFor the first class of partial derivatives:\n\n@l\n@rTk\n\n\u00bc @l\n@aij\n\n@aij\n@rTk\n\n\u00fe @l\n@dij\n\n@dij\n@rTk\n\n\u00f05:70\u00de\n\nIn the expression, k \u00bc i; j both @l@aij and @l@dij are scalars. And @l@rTk ,\n@aij\n@rTk\n\nand @dij\n@rTk\n\nare the\n\n(1 ? 3) dimensional matrix.\nAnd then we take the partial derivative of expression (5.56):\n\n@l\n@aij\n\n\u00bc ? cos dA cos dij sin aA ? aij\n? ?\n\nT1\n@l\n@dij\n\n\u00bc ? sin dA cos dij \u00fe cos dA sin dij cos aA ? aij\n? ?\n\nT1\n\n8>>><\n>>>:\n\n\u00f05:71\u00de\n\nIn this expression:\n\nT1 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? sin dA sin dij \u00fe cos dA cos dij cos aA ? aij\n\n? ?\n ?2q \u00f05:72\u00de\n@aij\n@rTi\n\n\u00bc yj ? yi\nT2\n\n? xj ? xi\nT2\n\n0\n? ?\n\n@aij\n@rTj\n\n\u00bc ? @aij\n@rTi\n\n8>><\n>>: \u00f05:73\u00de\n\n@dij\n@rTi\n\n\u00bc xj ? xi\n? ?\n\nzj ? zi\n? ?\n\nT3\nffiffiffiffiffi\nT2\n\np yj ? yi\n? ?\n\nzj ? zi\n? ?\n\nT3\nffiffiffiffiffi\nT2\n\np ?\nffiffiffiffiffi\nT2\n\np\nT3\n\n? ?\n@dij\n@rTj\n\n\u00bc ? @dij\n@rTi\n\n8>><\n>>: \u00f05:74\u00de\n\n142 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nIn this expression:\n\nT2 \u00bc xj ? xi\n? ?2 \u00fe yj ? yi? ?2 \u00f05:75\u00de\n\nT3 \u00bc T2 \u00fe zj ? zi\n? ?2 \u00f05:76\u00de\n\nSubstituting expression (5.73) and (5.74) for expression (5.70)\n\n@l\n@rTj\n\n\u00bc ? @l\n@rTi\n\n\u00f05:77\u00de\n\nThen:\n\n@l\n\n@ rTi ; r\nT\nj\n\n\t \n\n0\n@\n\n1\nA \u00bc @l@rTi @l@rTj\n\nh i\n\u00bc @l@rTi ?\n\n@l\n@rTi\n\nh i\n\u00f05:78\u00de\n\nThe expression (5.78) is shown that in the first type of partial derivative matrix.\nThe first three columns are the opposites of each other in the first three columns:\n\n@ ri; rj\n? ?\n@XT\n\n? ?\n\u00bc\n\n@ri\n@rTi\n\n03?6\n\n03?6\n@rj\n@rTj\n\n2\n4\n\n3\n5 \u00f05:79\u00de\n\nAs @ri\n@rTi\n\nhas a totally same quantic with @rj\n@rTj\n\n, so in the following analysis process is\n\nthe subscripts are omitted. Generally:\n\n@r\n@rT\n\n\u00bc @r@a @r@e @r@i @r@X @r@x @r@M\n\n ? \u00f05:80\u00de\n\nIn this expressions, matrix and @r@a ;\n@r\n@e ;\n\n@r\n@i ;\n\n@r\n@X ;\n\n@r\n@x and\n\n@r\n@M are (3 * 1) dimensions,\n\nwhile matrix @r@rT is (3 * 6) dimension.\nSuppose the position vector of the satellite and the velocity vector are r and _r,\n\nand r \u00bc x y z\u00bd ?T, r \u00bc rj j, among them.\n@r\n@a \u00bc 1a r\n@r\n@e \u00bc Hr\u00feK _r\n@r\n@i \u00bc I\n\n*\n\n@r\n@X \u00bc X\n\n*\n\n@r\n@x \u00bc x\n\n*\n\n@r\n@M \u00bc 1n _r\n\n8>>>>>>>><\n>>>>>>>>:\n\n\u00f05:81\u00de\n\n5.3 Rotation Error Estimation of Constellation \u2026 143\n\n\n\nIn this expression:\n\nH \u00bc ? ap \u00f0cosE\u00fe e\u00de\nK \u00bc sinEn \u00f01\u00fe rp\u00de\n\n(\n\u00f05:82\u00de\n\nI \u00bc\nz sinX\n?z cosX\n\n?x sinX\u00fe y cosX\n\n2\n4\n\n3\n5 \u00f05:83\u00de\n\nX \u00bc\n?y\nx\n0\n\n2\n4\n\n3\n5 \u00f05:84\u00de\n\nx \u00bc R? r \u00bc\nzRy ? yRz\nxRz ? zRx\nyRx ? xRy\n\n2\n4\n\n3\n5 \u00f05:85\u00de\n\nThe rest parameter:\nThe eccentric anomaly E, which can be calculated from the Kepler\u2019s equation\n\nE \u00bc M\u00fe e sinE;\np is the semi-latus rectum of elliptical orbit, p \u00bc a\u00f01? e2\u00de;\nn is the average angular velocity of the satellite movement, n \u00bc ffiffiffiffiffilep a?32 \u00bc a?32,\n\nle \u00bc GMe is the constant of geocentric gravity, because of normalized unit, le \u00bc 1.\nR is the normal unit vector of orbital plane in Eq. 5.85:\n\nR \u00bc\nRx\nRy\nRz\n\n2\n4\n\n3\n5 \u00bc sin i sinX? sin i cosX\n\ncos i\n\n2\n4\n\n3\n5 \u00f05:86\u00de\n\nFor the third type of partial derivative matrix (the state transition matrix):\n\n@X\n@XT0\n\n? ?\n\u00bc\n\n@ri\n@rTi0\n\n06?6\n\n06?6\n@rj\n@rTj0\n\n2\n4\n\n3\n5\u00feO e\u00f0 \u00de \u00f05:87\u00de\n\nTaking the non-perturbation part of the state transition matrix is enough. Where\nO\u00f0e\u00de represents the small amount of the perturbation, because the length of track\nsegment is usually not long, it is rounded during the process of orbit determination.\nIt has no essential influence over this problem, so it is not specifically given, and\nwill no longer be mentioned in the following.\n\n@ri\n@rTi0\n\nand @rj\n@rTj0\n\nhave the same format, so the subscript would be ignored in the\n\nfollowing analysis process. In general, given by:\n\n144 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\n@r\n\n@rT0\n\u00bc\n\n1 0 0 0 0 0\n0 1 0 0 0 0\n0 0 1 0 0 0\n0 0 0 1 0 0\n0 0 0 0 1 0\n\n? 3n2aDt 0 0 0 0 1\n\n2\n6666664\n\n3\n7777775\n\n\u00f05:88\u00de\n\nwhere Dt \u00bc t ? t0, and @r@rT0 is a (6 ? 6) matrix.\n\nSet the position and the velocity vector of satellite i and satellite j are ri \u00bc\nxi yi zi\u00bd ?T and _ri \u00bc _xi _yi _zi\u00bd ?T, rj \u00bc xj yj zj\u00bd ?T and _rj \u00bc _xj _yj _zj\u00bd ?T,\nbased on the analysis of the above three parts, we obtain the B matrix:\n\nB \u00bc @l@rTi\n@l\n@rTj\n\nh i @ri\n@rTi\n\n03?6\n\n03?6\n@rj\n@rTj\n\n2\n4\n\n3\n5 @ri@rTi0 06?6\n\n06?6\n@rj\n@rTj0\n\n2\n4\n\n3\n5 \u00f05:89\u00de\n\nof which:\n\n@ri\n@rTi\n\n\u00bc riai Hiri \u00feKi _ri Ii Xi xi\n_ri\nni\n\nh i\n@ri\n@rTi\n\n\u00bc rjaj Hjrj \u00feKj _rj Ij Xj xj\n_rj\nnj\n\nh i \u00f05:90\u00de\n\n@ri\n@rTi0\n\n\u00bc\n\n1 0 0 0 0 0\n0 1 0 0 0 0\n0 0 1 0 0 0\n0 0 0 1 0 0\n0 0 0 0 1 0\n\n? 3ni2ai Dti 0 0 0 0 1\n\n2\n6666664\n\n3\n7777775\n;\n\n@rj\n@rTj0\n\n\u00bc\n\n1 0 0 0 0 0\n0 1 0 0 0 0\n0 0 1 0 0 0\n0 0 0 1 0 0\n0 0 0 0 1 0\n\n? 3nj2aj Dtj 0 0 0 0 1\n\n2\n6666664\n\n3\n7777775\n\n\u00f05:91\u00de\n\nAccording to what mentioned above, in order to facilitate the implementation of\ninter-satellite orientation observation, usually select the observing satellite i and the\nmeasured satellite j as two adjacent satellites in the same orbital plane. For two\nsatellites in the same orbital plane, the classical orbit elements have the following\nrelationship:\n\nai \u00bc aj; ei \u00bc ej; ii \u00bc ij; Xi \u00bc Xj; xi \u00bc xj; Mi 6\u00bc Mj Ei 6\u00bc Ej\n? ?\n\n5.3 Rotation Error Estimation of Constellation \u2026 145\n\n\n\nFollowing relationship can be derived:\n\nri 6\u00bc rj; _ri 6\u00bc _rj; Hi 6\u00bc Hj; Ki 6\u00bc Kj; ni \u00bc nj\n\nAs the angular distance observation can correct the orbit elements of two\nsatellites at the same time, the epoch times to be estimated t0 of two satellites are\nconsistent, thus, Dti \u00bc Dtj.\n\nIn order to highlight the analysis result, for two satellites with the same elements,\nthe subscript will be omitted in the following to show the same, B matrix can be\nsimplified as:\n\nB \u00bc @l@rTi ?\n@l\n@rTi\n\nh i Bi 03?6\n03?6 Bj\n\n? ?\n\u00f05:92\u00de\n\nwith:\n\nBi \u00bc ria \u00fe _rin ? 3n2aDt\n? ?\n\nHiri \u00feKi _ri Ii Xi xi _rni\nh i\n\nBj \u00bc rjaj \u00fe\n_rj\nn ? 3n2aDt\n? ?\n\nHjrj \u00feKj _rj Ij Xj xj _rjnj\nh i \u00f05:93\u00de\n\nHere is 12 elements of one row and 12 columns of a sample of the corresponding\nmatrix B:\n\nB \u00bc b1 b2 . . . b11 b12\u00bd ?\n\nwhere each element is:\n\nb1 \u00bc @l@rTi\n1\na ri ? 3Dt2a _ri\n? ?\n\nb2 \u00bc @l@rTi Hiri \u00feKi _ri\u00f0 \u00de\nb3 \u00bc @l@rTi Ii\nb4 \u00bc @l@rTi Xi\nb5 \u00bc @l@rTi xi\nb6 \u00bc @l@rTi\n\n_ri\nn\n\n8>>>>>>>>>><\n>>>>>>>>>>:\n\nb7 \u00bc @l@rTj\n1\na rj ? 3Dt2a _rj\n? ?\n\nb8 \u00bc @l@rTj Hjrj \u00feKj _rj\n? ?\n\nb9 \u00bc @l@rTj Ij\nb10 \u00bc @l@rTj Xj\nb11 \u00bc @l@rTj xj\nb12 \u00bc @l@rTj\n\n_rj\nn\n\n8>>>>>>>>>>><\n>>>>>>>>>>>:\n\n\u00f05:94\u00de\n\nComparing the expression of the corresponding element in each group, it can be\nseen that elements in each column of B matrix are neither equal nor opposite to each\nother, so the matrix B is full rank, which proved that the introduction of\ninter-satellite orientation information is observable to the right ascension of\nascending node. Hence, bringing in inter-satellite angle measurement information\ncan eliminate rotation of overall estimation error of constellation, which caused by\nthe rank loss of inter-satellite ranging information to the right ascension of\nascending node observation information. From the analysis, it can be known that\n\n146 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\ntwo reference satellites in the constellation can completely suppress the overall\nrotating drift of the constellation, however, one inter-satellite orientation informa-\ntion can just fix the reference of observing satellite and the observed satellite in the\ninertial space, so, theoretically, only a pair of inter-satellite orientation information\ncan completely suppress the overall rotation drift of constellation error estimation.\n\n5.4 High-Precision Orbit Determination Technology\nBased on Inter-satellite Orientation Determination\nof Elliptical Orbit\n\n5.4.1 Constellation Autonomous Navigation Scheme Based\non Inter-satellite Orientation Determination/Ranging\n\nThe autonomous navigation system based on inter-satellite links mainly takes\ninter-satellite ranging link to achieve constellation autonomous navigation, in\nwhich, every satellite achieves prediction of satellite orbit elements on the basis of\ninitial orbital value combined with the orbital dynamic model, however,\ninter-satellite measurement only constrains the accuracy of relative position of the\nsatellites in the constellation, while the overall rotation and drift of estimation error\nof the entire constellation relative to the inertial coordinate system is not measurable\n[11], thus, as time goes on, the accuracy of the orbit prediction will gradually\ndecline. This phenomenon is mathematically expressed as the rank loss phe-\nnomenon of corresponding right ascension of the ascending node coefficient and the\norbital inclination coefficient in conditional equation, that is, the inter-satellite\nmeasurement is not observable for the orbital parameters that cause the rotating drift\nof the whole constellation.\n\nIn order to solve the rotation drift of the overall constellation estimation error\ncaused by rank loss, the method of overall autonomous navigation of constellation\nbased on inter-satellite link ranging + orientation angular distance has been pro-\nposed has been proposed, and the inter-satellite angular distance observation based\non the inter-satellite link navigation has been introduced, and the observability of\nthe method has been proved. In this section, this method is described in detail.\n\nIn Fig. 5.6, it can be seen the inter-satellite pseudorange observation information\ncan be obtained by constructing bidirectional and dual-frequency inter-satellite\nlinks to complete the communication ranging between each other. Inter-satellite\norientation angular distance information takes photographic observation over\nobserved satellite and stellar in the field of view through a photographic observation\nequipment (CCD star sensor) installed on the observing satellite, then makes image\nprocessing and image recognition on the photographed star image to determine the\nsatellite being measured and stellar meeting the conditions, so as to obtain the\nangular distance information between background stars of observed satellite and\nobserved satellite. Using the joint observation orbit determination of inter-satellite\n\n5.3 Rotation Error Estimation of Constellation \u2026 147\n\n\n\norientation angular distance information and inter-satellite ranging measurement\ninformation, the rotating drift trend of the whole estimation error of the constel-\nlation can be completely eliminated.\n\nIn the process of constellation autonomous navigation based on inter-satellite\norientation/ranging, firstly, each satellite of the constellation obtains the orbit pre-\ndiction value at the next moment [12] according to the orbit initial value at initial\ntime combined with the orbital dynamic recursive model, and then sends the\ninter-satellite ranging information measured by the inter-satellite ranging commu-\nnication link, the angular distance information obtained from the inter-satellite\norientation observation and the orbit prediction information of each star in the\nconstellation to the master star. Then, the master satellite conducts the whole net\nfilter measurement update according to the orbit prediction information and mea-\nsurement information of each satellite, that is, put all satellite orbit status infor-\nmation and measurement information in the constellation which need orbit\nparameters update into the same filter for filtering updates, and then the optimal\n\nRa\nng\n\nin\ng \n\nco\nm\n\nm\nun\n\nic\nat\n\nio\nn\n\nTraj\necto\n\nry p\nredi\n\nction\n valu\n\ne an\nd th\n\ne\n\n opt\nimal\n\n esti\nmate\n\n of t\nhe u\n\nploa\nded \n\norbi\nts\n\n of t\nhe in\n\nter-s\natell\n\nite m\neasu\n\nrem\nents\n\n retu\nrn\n\nAutonomous\nSatellite1\n\nAutonomous\nSatellite2\n\nAutonomous\nSatellite3\n\nAutonomous\nSatellite4\n\nAutonomous\nSatellite5\n\nCenter \nSatellite\n\nStarli\nght V\n\nector\n\nBackground\nStar\n\nSt\nar\n\nlig\nht\n\n V\nec\n\nto\nr\n\nBackground\nStar\n\nInter-star \ndirectional \n\nangular \ndistance\n\nInter-star \ndirectional \n\nangular \ndistance\n\nObservation\nSatellite\n\nObservation\nSatellite\n\nBenchmark \nSatellite\n\nFig. 5.6 A constellation navigation method based on inter-satellite absolute orientation/links\nranging\n\n148 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nestimate of satellite status at the time is obtained. Finally, the master satellite returns\nthe optimal estimate value of the orbital parameters of each satellite obtained by the\nfilter update to the satellites via inter-satellite links.\n\n5.4.2 Constellation Autonomous Navigation Scheme Based\non Inter-satellite Orientation Determination/Ranging\nof Elliptical Orbit\n\n1. The sate equation of autonomous navigation system based on inter-satellite\norientation/ranging\n\nBesides the geocentric gravity FTB, the satellite motion in orbit also is influenced by\nother perturbation forces, including earth non-spherical gravitation perturbation\nFNS, third-body perturbation (sun, moon) FNB, and solar radiation perturbation FSR\n\nF \u00bc FTB \u00feFNS \u00feFNB \u00feFSR \u00f05:95\u00de\n\nstate X satisfies the initial value problem of ordinary differential equation as\nfollows:\n\n_X \u00bc F X; t\u00f0 \u00de\nX t0\u00f0 \u00de \u00bc X0\n\n?\n\u00f05:96\u00de\n\nThe solution is the equation of state:\n\nX t\u00f0 \u00de \u00bc G X t0\u00f0 \u00de; t\u00f0 \u00de \u00f05:97\u00de\n\nDiscretize\n\nXk\u00fe 1 \u00bc f Xk; k\u00f0 \u00de \u00f05:98\u00de\n\nwhere f ?\u00f0 \u00de is the orbit prediction function; this is a process of orbit extrapolation.\nMaking Taylor expansion on Eq. (5.98) according to the optimal filtering esti-\n\nmate X?k=k and taking two or more items as the system dynamic noise, the following\ncan be obtained:\n\nXk\u00fe 1 \u00bc f X?k=k; k\n\n ?\u00fe @f Xk; k\u00bd ?\n\n@Xk\n\n????\nXk\u00bcX?k=k\n\nXk ? X?k=k\n\n ?\u00feC Xk; k\u00bd ?Wk \u00f05:99\u00de\n\nIn Eq. (5.99), Wk is coefficient matrix of the dynamic noise, and then the state\ntransition matrix is expressed as:\n\n5.4 High-Precision Orbit Determination Technology \u2026 149\n\n\n\nUk\u00fe 1=k \u00bc\n@f Xk; k\u00bd ?\n@Xk\n\n????\nXk\u00bcX?k=k\n\n\u00f05:100\u00de\n\n2. Measurement Equation of Autonomous Navigation System Based on\nInter-Satellite Orientation/Ranging\n\nMeasurement information of constellation autonomous navigation system based on\ninter-satellite orientation/ranging includes inter-satellite ranging measurement\ninformation and orientation angular distance information.\n\n1) observation equation of inter-satellite ranging\n\nSuppose that inter-satellite distance observation can be done with satellite i and\nsatellite j, mark\n\nri and rj as position vector of the two satellites in geocentric inertial coordinate\nsystem, then the measurement equation of inter-satellite distance observation is:\n\nqij \u00bc ri ? rj\n?? ??\u00feV \u00f05:101\u00de\n\nwhere V is the observation noise.\n\nSuppose that the position and the velocity of satellite i and satellite j in geo-\ncentric inertial coordinate system are ri \u00bc xi yi zi vxi vyi vzi\u00bd ?T and\nrj \u00bc xj yj zj vxj vyj vzj\u00bd ?T.\n\nIntroducing the state variables X \u00bc ri rj\u00bd ?T, marking q X; t\u00f0 \u00de \u00bc ri t\u00f0 \u00de ? rj t\u00f0 \u00de\n?? ??,\n\ndiscretizing Eq. (5.101), the following can be obtained:\n\nqk\u00fe 1 \u00bc q Xk\u00fe 1; k\u00fe 1\u00f0 \u00de\u00feVk\u00fe 1 \u00f05:102\u00de\n\nMaking Taylor expansion of Eq. (5.102) at the predicted value X?k\u00fe 1:k , and\nomitting the second order above items, equation of inter-satellite distance obser-\nvation after linearization is obtained:\n\nqk\u00fe 1 \u00bc q X?k\u00fe 1=k; k\u00fe 1\n? ?\u00fe @q\n\n@XTk\u00fe 1\n\n?????\nXk\u00fe 1\u00bcX?k\u00fe 1=k\n\nXk\u00fe 1 ? X?k\u00fe 1=k\n? ?\u00feDk\u00fe 1 \u00f05:103\u00de\n\nIn which, q X?k\u00fe 1=k; k\u00fe 1\n? ?\n\nis the coarse distance, mark Hk\u00fe 1 as the observation\ncoefficient matrix, so\n\nHk\u00fe 1 \u00bc\n@qij\n\n@ ri\u00f0 \u00deTk\u00fe 1; rj\n? ?T\n\nk\u00fe 1\nh i\n\n??????\nXk\u00fe 1\u00bcX?k\u00fe 1=k\n\n\u00f05:104\u00de\n\n150 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nwith:\n\n@qij\n@~rTi\n\n\u00bc 1qij xi ? xj yi ? yj zi ? zj\u00bd ?\n@qij\n@~rTj\n\n\u00bc ? 1qij xi ? xj yi ? yj zi ? zj\u00bd ?\n\n8<\n: \u00f05:105\u00de\n\n2) Inter-satellite orientation angular distance observation equation\n\nSuppose that inter-satellite orientation observation is taken between satellite i, j,\nsatellite i is the observation satellite, satellite j is observed satellite, stellar A is the\nbackground star, mark aij dij\u00f0 \u00de as the ascension and declination of two satellites\nin connection direction, mark aA dA\u00f0 \u00de as the ascension and declination of the\nbackground star, then the angular distance of connection direction and background\nstellar direction is l; according to inter-satellite orientation observation principle\nmentioned above, there is a relationship as follows:\n\nl \u00bc ar cos sin dA sin dij \u00fe cos dA cos dij cos\u00f0aA ? aij\u00de\n\n ? \u00f05:106\u00de\n\nSuppose that the position vector of satellite i, j in geocentric inertial coordinate\nsystem, respectively, is ri \u00bc xi yi zi\u00bd ?T; rj \u00bc xj yj zj\u00bd ?T, aij dij\u00f0 \u00de can be\nexpressed as:\n\naij \u00bc arctan yj?yixj?xi\ndij \u00bc arctan zj?ziffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\nxj?xi\u00f0 \u00de2 \u00fe yj?yi\u00f0 \u00de2\nq\n\n8<\n: \u00f05:107\u00de\n\nFrom Eqs. 5.106 and 5.107, the function relationship between position vector\nand angular distance ranging of satellite i, j can be established.\n\nAssume the vector in connection direction is rij \u00bc rj ? ri, rA is the vector in\nstellar A direction; hence, the measurement equation of inter-satellite orientation\nobservation can be expressed as:\n\nl \u00bc rij; rA\n? ?\u00feV \u00f05:108\u00de\n\nin which rij; rA\n? ?\n\nis the angle of the vector rij in connection direction and the vector\nrA in stellar A direction;V is the observation noise.\n\nSuppose the position and the velocity of satellite i and satellite j in geocentric\ninertial coordinate system are ri \u00bc xi yi zi vxi vyi vzi\u00bd ?T and\nrj \u00bc xj yj zj vxj vyj vzj\u00bd ?T.\n\nIntroduce the state variable X \u00bc ri rj\u00bd ?T, make l X; t\u00f0 \u00de \u00bc rij; rA\n? ?\n\n, after\nEq. 5.108 discretization, it can be obtained:\n\n5.4 High-Precision Orbit Determination Technology \u2026 151\n\n\n\nlk\u00fe 1 \u00bc l Xk\u00fe 1; k\u00fe 1\u00f0 \u00de\u00feVk\u00fe 1 \u00f05:109\u00de\n\nMaking Taylor expansion of Eq. 5.109 in the predicted value X?k\u00fe 1=k, and\nomitting the second order above items, the measurement equation of inter-satellite\norientation observation after linearization is:\n\nlk\u00fe 1 \u00bc l X?k\u00fe 1=k; k\u00fe 1\n? ?\u00fe @l\n\n@XTk\u00fe 1\n\n?????\nXk\u00fe 1\u00bcX?k\u00fe 1=k\n\nXk\u00fe 1 ? X?k\u00fe 1=k\n? ?\u00feVk\u00fe 1 \u00f05:110\u00de\n\nin which l X?k\u00fe 1=k; k\u00fe 1\n? ?\n\nis the coarse value of angular distance, mark Hk\u00fe 1 as the\nobservation coefficient matrix, so the expression is as follows:\n\nHk\u00fe 1 \u00bc @l\n@ ri\u00f0 \u00deTk\u00fe 1; rj\n\n? ?T\nk\u00fe 1\n\nh i\n??????\nXk\u00fe 1\u00bcX?k\u00fe 1=k\n\n\u00f05:111\u00de\n\nIn general,\n@l\n@rTi\n\n\u00bc @l\n@rTi\n\n\u00bc @l@aij\n@aij\n@rTi\n\n\u00fe @l@dij\n@dij\n@rTi\n\n\t \n\n@l\n@rTj\n\n\u00bc @l\n@rTj\n\n\u00bc @l@aij\n@aij\n@rTj\n\n\u00fe @l@dij\n@dij\n@rTj\n\n? ?\n8><\n>: \u00f05:112\u00de\n\nWith:\n\n@l\n@aij\n\n\u00bc ? cos dA cos dij sin aA?aij\u00f0 \u00deT1\n@l\n@dij\n\n\u00bc ? sin dA cos dij \u00fe cos dA sin dij cos aA?aij\u00f0 \u00deT1\n\n8<\n: \u00f05:113\u00de\n\nT1 \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? sin dA sin dij \u00fe cos dA cos dij cos aA ? aij\n\n? ?\n ?2q \u00f05:114\u00de\n@aij\n@rTi\n\n\u00bc yj?yiT2 ?\nxj?xi\nT2\n\n0\nh i\n\n@aij\n@rTj\n\n\u00bc ? @aij\n@rTi\n\n8<\n: \u00f05:115\u00de\n\n@dij\n@rTi\n\n\u00bc xj?xi\u00f0 \u00de zj?zi\u00f0 \u00de\nT3\n\nffiffiffiffi\nT2\n\np yj?yi\u00f0 \u00de zj?zi\u00f0 \u00de\nT3\n\nffiffiffiffi\nT2\n\np ?\nffiffiffiffi\nT2\n\np\nT3\n\nh i\n@dij\n@rTj\n\n\u00bc ? @dij\n@rTi\n\n8<\n: \u00f05:116\u00de\n\nT2 \u00bc xj ? xi\n? ?2 \u00fe yj ? yi? ?2 \u00f05:117\u00de\n\nT3 \u00bc T2 \u00fe zj ? zi\n? ?2 \u00f05:118\u00de\n\n152 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\n3. The simulation analysis of inter-satellite ranging autonomous navigation\nsystem\n\nThe block diagram of autonomous navigation of high elliptical orbit constellation\nbased on inter-satellite ranging is shown in Fig. 5.7.\n\nThe simulation conditions are set as follows:\n\n(1) constellation configuration: large elliptical orbit region constellation generated\nby STK\n\n(2) coordinate system: geocentric inertial coordinate system\n(3) inter-satellite ranging accuracy: 10 m. Suppose that the farthest transmission\n\ndistance of the link signal is 1.5 times of the radius of the earth, and the\ntangential height of the signal must be more than critical radius of the earth,\nwhich is 6 ? 106 m.\n\n(4) the simulation time is 365 days, and the measurement cycle of the inter-satellite\npseudorange is 60 min.\n\n(5) 10 m position error (1r, uni-axial) and 0.01 m/s velocity error (1r, uni-axial) is\nadded to initial value of iteration on the basis of STK data.\n\n(6) noise variance matrix of the model: Q \u00bc q1I3?3 03?3\n03?3 q2I3?3\n\n? ?\n, with\n\nq1 \u00bc 1? 10?4; q2 \u00bc 1? 10?6\n\nThe simulation results are as follows:\n\n1) The simulation results of the six classical orbit elements\n\nThe simulation results of the six classical orbit elements are shown in Fig. 5.8.\n\nPseudo-distance \nmeasurement \nbetween the \nstructures\n\nNavigation \nPerformance \n\nAnalysis\n\nWhole Network \nFilter\n\nTrack forecast\nInitial value of \nconstellation \n\norbit\n\nNominal value \nof constellation \n\norbit\n\nVisibility \nanalysis\n\nConstellation \nOptimal \n\nValuation\n\nFilter \nmodule\n\nActual\nmodule\n\nFig. 5.7 Simulation system block of autonomous navigation of large elliptical orbit constellation\n\n5.4 High-Precision Orbit Determination Technology \u2026 153\n\n\n\n0 500 1000 1500 2000\n-2\n\n-1.5\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n-3\n\nx 10\n-4\n\nx 10\n-5\n\nx 10\n-7\n\n0 500 1000 1500 2000\n-2\n\n-1.5\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\nx 10\n\n-3\n\nTr\nue\n\n n\nea\n\nr-\npo\n\nin\nt e\n\nst\nim\n\nat\nio\n\nn \ner\n\nro\nr/(\n\n\u00b0)\n\nt/h t/h\n\nEs\ntim\n\nat\nio\n\nn \ner\n\nro\nr o\n\nf p\ner\n\nig\nee\n\n \nam\n\npl\nitu\n\nde\n a\n\nng\nle\n\n/(\u00b0\n)\n\nTh\ne \n\nes\ntim\n\nat\nio\n\nn \ner\n\nro\nr o\n\nf a\nsc\n\nen\ndi\n\nng\n \n\nin\nte\n\nrs\nec\n\ntio\nn/\n\n(\u00b0\n)\n\nSe\nm\n\ni-l\non\n\ng \nax\n\nis\n e\n\nst\nim\n\nat\nio\n\nn \ner\n\nro\nr/M\n\n0\n\n0\n\n1\n\n2\n\n3\n\n4\n\n5\n\n-1\n500 1000 1500 2000 0 500 1000 1500 2000\n\nt/h t/h\n\n-2\n\n-1.5\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\n1.5\n\n2\n\n0 500 1000 1500 2000 0 500 1000 1500 2000\n\nt/h t/h\n\n-2\n\n-2.5\n\n-1.5\n\n-1\n\n-0.5\n\n0\n\n0.5\n\n1\n\n-2\n\n0\n\n2\n\n4\n\n6\n\n8\n\n10\n\n12\n\nO\nrb\n\nita\nl i\n\nnc\nlin\n\nat\nio\n\nn \nes\n\ntim\nat\n\nio\nn \n\ner\nro\n\nr/(\n\u00b0)\n\nEs\ntim\n\nat\nio\n\nn \ner\n\nro\nr o\n\nf \nec\n\nce\nnt\n\nric\nity\n\n ra\nte\n\n(a) (b)\n\n(c) (d)\n\n(e) (f)\n\nFig. 5.8 Real-time estimation error of the six classical orbit parameters. a Estimation error of the\nright ascension of the ascending node; b estimation error of the semimajor axis; c estimation error\nof the orbit inclination; d estimation error of the eccentricity; e estimation error of the true\nanomaly; f estimation error of the argument of perigee\n\n154 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\n2) The simulation results of the constellation position and velocity error\n\nThe simulation results of constellation satellite position and velocity error (take the\ntrack surface 1satellite MEO11 as an example) are shown in Figs. 5.9 and 5.10,\nrespectively.\n\n3) The relative position and relative velocity error of constellation\n\nThe relative position and relative velocity error of the constellation are shown in\nFig. 5.11.\n\nStatistics of various error of constellation satellite is shown in Table 5.1.\nThe position and velocity estimation accuracy of each satellite in one orbital\n\nplane is almost same.\nFollowing conclusion can be obtained from the simulation results:\n\n(1) The inter-satellite ranging observation information of constellation navigation\nsystem based on inter-satellite link ranging can effectively eliminate the whole\nsatellite orbit determination error of the constellation, and the accuracy of\nautonomous navigation is high in a short time, but its orbit accuracy decreases\ngradually with time and tends to be a slow divergence. This is because\ninter-satellite ranging information cannot effectively eliminate the right ascen-\nsion of ascending node error, orbit inclination estimation error, and the argu-\nment of perigee error which make the error estimation of constellation rotating\n\nX\n p\n\nos\niti\n\non\ner\n\nro\nr/m\n\nt/h\n\nt/h\n\nt/h\n\nY\n p\n\nos\niti\n\non\ner\n\nro\nr/m\n\nZ \npo\n\nsi\ntio\n\nn\ner\n\nro\nr/m\n\nFig. 5.9 Real-time estimation error of MEO11 satellite\u2019s 3-axis position\n\n5.4 High-Precision Orbit Determination Technology \u2026 155\n\n\n\nand divergent; hence, the long-term error of the constellation autonomous\nnavigation based on inter-satellite observation ranging is still divergent; then\nfrom the simulation results, it can be seen after 8000 h, three-axis position\nerrors were divergent to 100 m level, respectively.\n\nX\n-S\n\npe\ned\n\n E\nrr\n\nor\n/\n\n(m\n/s\n\n)\n\nt/h\n\nt/h\n\nt/h\n\nY\n-S\n\npe\ned\n\n \nEr\n\nro\nr/\n\n(m\n/s\n\n)\nZ-\n\nSp\nee\n\nd \nEr\n\nro\nr/\n\n(m\n/s\n\n)\n\nFig. 5.10 Real-time estimation error of MEO11 satellite\u2019s three-axis velocity\n\nR\nel\n\nat\niv\n\ne \npo\n\nsi\ntio\n\nn \nes\n\ntim\nat\n\nio\nn \n\ner\nro\n\nr/m\n\nt/h\n\nR\nel\n\nat\niv\n\ne \nV\n\nel\noc\n\nity\n \n\nes\ntim\n\nat\nio\n\nn \ner\n\nro\nr/(\n\nm\n/s\n\n)\n\nt/h\n\nFig. 5.11 Relative position error and the relative velocity error of constellation satellite\n\n156 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\n(2) From the results of the autonomous navigation simulation of satellite on each\norbital plane, it can be known that the constellation autonomous navigation\nsystem based on inter-satellite link ranging, the six elements of the orbit whose\nestimation error are in the divergent trend are mainly the right ascension of\nascending node; thus, the position and velocity error in the X, Y directions\nestimation are in divergent trend for a long time.\n\n(3) constellation autonomous navigation system based on inter-satellite link ranging\nhas a high accuracy of relative position and relative velocity, that is, 11.2 m and\n0.008 m/s, respectively, and does not diverge over time, which is shown that the\nconstellation autonomous navigation system based on inter-satellite link ranging\ncan effectively estimate the relative configuration between spacecraft.\n\n4. Simulation analysis of autonomous navigation system based on\ninter-satellite orientation/ranging\n\nThe block diagram of autonomous navigation of constellation based on\ninter-satellite orientation/ranging is shown in Fig. 5.12.\n\nThe constellation used in simulation is as mentioned above; that is, two groups\nof inter-satellite orientation satellites are set in each track surface, and each group\nincludes two orientation observation satellites and one observed reference satellite\ncarrying orientation photograph equipment. The angular distance accuracy of\nconstellation orientation is 0.1?, selecting 10 starlight angular distance for each\ntime, and the sampling period of constellation orientation is 60 min, and other\nsimulation parameters are set as above.\n\nThe simulation results are as follows:\n\n1) The six classical orbit parameters of the constellation\n\nThe simulation results of the six classical orbit parameters are shown in Fig. 5.13.\n\nTable 5.1 Estimation error of satellite constellation after 8000 h\n\nSatellite number MEO11 MEO21 MEO31\n\nPosition error (m) X direction 198 230 197\n\nY direction 230 197 230\n\nZ direction 5 4 5\n\nVelocity error (m/s) X direction 0.14 0.17 0.15\n\nY direction 0.17 0.14 0.17\n\nZ direction 0.003 0.003 0.003\n\nRelative position error (m) 2.1\n\nRelation velocity error (m/s) 0.0015\n\n5.4 High-Precision Orbit Determination Technology \u2026 157\n\n\n\n2) The position and velocity error of the constellation\n\nThe simulation results of constellation satellite position and velocity error (take\nthe track surface 1satellite MEO11 as an example) are shown in Figs. 5.14 and\n5.15.\n\n3) The relative position and relative velocity error\n\nThe relative position and relative velocity error of the constellation are shown in\nFig. 5.16.\n\nStatistics of various error of constellation satellite is shown in Table 5.2.\nConclusion can be obtained from the simulation results as follows:\n\n(1) Because the inter-satellite orientation observation information provides abso-\nlute orientation information for the entire constellation by making avail of\nbackground stars (ephemeris is known), the inter-satellite orientation angular\ndistance information can reflect the whole rotation drift changes of the con-\nstellation; that is, the inter-satellite orientation angular distance observation\ninformation can effectively eliminate the estimation error of the right ascension\nof the ascending node, the estimation error of the orbital inclination, and the\nestimation of the perimeter angle of the intersection, which can cause the whole\nrotation of the constellation, so as to restrain the divergence trend of the\n\nPseudo-distance\nmeasurement\nbetween the \nstructures\n\nNavigation\nPerformance\n\nAnalysis\n\nWhole Network \nFilter\n\nTrack forecast\nInitial value of \nconstellation\n\norbit\n\nNominal value \nof constellation \n\norbit\n\nVisibility\nanalysis\n\nConstellation\nOptimal\n\nValuation\n\nFilter\nmodule\n\nActual\nmodule\n\nFig. 5.12 Simulation system block of constellation autonomous navigation based on\ninter-satellite orientation/ranging\n\n158 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nFig. 5.13 Real-time simulation of the six classical orbit parameters error. a Error of the right\nascension of the ascending node; b error of the semimajor axis; c error of the orbit inclination;\nd error of the eccentricity; e estimation error of the true anomaly; f estimation error of the argument\nof perigee\n\n5.4 High-Precision Orbit Determination Technology \u2026 159\n\n\n\nestimation error of the constellation satellite autonomous navigation. It can be\nseen from the simulation results that the inter-satellite absolute orientation\nangular distance measurement information can effectively eliminate the esti-\nmation error of the right ascension of the ascending node and the estimation\nerror of the orbit inclination which cause the rotating divergence of estimation\nerror of the whole constellation, and finally makes the estimation error of the\nsatellite autonomous navigation in the constellation in convergence trend for a\nlong time. The estimation accuracy of position is listed in Table 5.2.\n\n(2) The estimation accuracy of the relative position and the relative velocity of the\nconstellation autonomous navigation system based on inter-satellite orientation/\nranging is similar to that of constellation autonomous navigation system based\non inter-satellite ranging.\n\nX\n p\n\nos\niti\n\non\n \n\ner\nro\n\nr/m\n\nt/h\n\nY\n p\n\nos\niti\n\non\n \n\ner\nro\n\nr/m\nZ \n\npo\nsi\n\ntio\nn \n\ner\nro\n\nr/m\n\nt/h\n\nt/h\n\nFig. 5.14 Real-time estimation error of MEO11 satellite\u2019s three-axis position\n\n160 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nX\n-s\n\npe\ned\n\n e\nrro\n\nr/(\nm\n\n/s\n)\n\nt/h\n\nY\n-s\n\npe\ned\n\n e\nrro\n\nr/(\nm\n\n/s\n)\n\nZ-\nsp\n\nee\nd \n\ner\nro\n\nr/(\nm\n\n/s\n)\n\nt/h\n\nt/h\n\nFig. 5.15 Real-time estimation error of MEO11 satellite\u2019s three-axis velocity\n\n0 2000 4000 6000 8000\n-10\n\n-5\n\n0\n\n5\n\n10\n\n0 2000 4000 6000 8000\n-8\n\n-6\n\n-4\n\n-2\n\n0\n\n2\n\n4\n\n6\n\n8\nx 10\n\n-3\n\nR\nel\n\nat\niv\n\ne \nPo\n\nsi\ntio\n\nn \nes\n\ntim\nat\n\nio\nn \n\ner\nro\n\nr/m\n\nt/h\n\nR\nel\n\nat\niv\n\ne \nV\n\nel\noc\n\nity\n \n\nes\ntim\n\nat\nio\n\nn \nEr\n\nro\nr/(\n\nm\n/s\n\n)\n\nt/h\n\nFig. 5.16 Real-time estimation error of constellation satellite\u2019s relative position and relative\nvelocity\n\n5.4 High-Precision Orbit Determination Technology \u2026 161\n\n\n\nReferences\n\n1. YANG Wenbo, Li S, Li N. A switch-mode information fusion filter based on ISRUKF for\nautonomous navigation of spacecraft [J]. Information Fusion, 2014, vol.18: 33\u201342.\n\n2. YANG Wenbo, LI Shaoyuan. Autonomous navigation filtering algorithm for spacecraft based\non strong tracking UKF [J]. Systems Engineering and Electronics, 2011, 11(33): 2485\u20132491.\n\n3. YAN Ye, ZHOU Bozhao, REN Xuan. A discussion on satellite-network autonomous orbit\ndetermination [J]. Journal of Astronautics, 2002, 23(2): 80\u201383.\n\n4. YAN Wenbo, etc. Simulation and validation technology of generalized autonomous\nnavigation [C]. information technology professional group of Shanghai academy of\nspaceflight technology, 2012.\n\n5. CHEN Jinping, YOU Zheng, JIAO Wenhai. Research on Autonav of Navigation Satellite\nConstellation Based on Crosslink Range and Inter-satellite Orientation Observation [J].\nJournal of Astronautics, 2002, 23(2): 80\u201383.\n\n6. Psiaki M L. Global magnetometer-based spacecraft attitude and rate estimation [J]. Journal of\nGuidance, Control and Dynamics, 2004, 27(2): 240\u2013250.\n\n7. Alonso R, Shuster M D. TWOSTEP: a fast robust algorithm for attitude-independent\nmagnetometer-biased determination [J]. Journal of Astronautical Sciences, 2002, 50(4): 433\u2013\n451.\n\n8. Crassidis J L, Lightsey E G. Attitude determination using combined GPS and three-axis\nmagnetometer data [J]. Space Technology, 2001, 20(4): 147\u2013156.\n\n9. HU Songjie. Research on the dynamics of satellite constellation [M]. Nanjing University,\n2004.\n\n10. XIANG Junhua, ZHANG Yulin. Design and Realization on System of Design, Analysis,\nSimulation for Satellite Networking and Constellation Control [J]. Journal of System\nSimulation, 2006, Vol. 18(Suppl2): 691\u2013695.\n\n11. Feng L, Gong C, He A C. A sliding mode controller of attitude tracking system of vehicle\nbased on error-quaternion [J]. Journal of Astronautics, 2000, 21(1): 17\u201322.\n\n12. XIONG Kai, WEI Chunling, LIU Liangdong. An Autonomous Navigation Method for\nSpacecrafts during Orbit Maneuver [J]. Aerospace Control and Application, 2009, 35(2): 7\u201312.\n\nTable 5.2 Estimation error of satellite constellation after 7000 h\n\nSatellite number MEO11 MEO21 MEO31\n\nPosition error (m) X direction 10.3 13.1 10.5\n\nY direction 12.5 10.7 13.6\n\nZ direction 6.1 6.0 5.8\n\nVelocity error (m/s) X direction 0.008 0.009 0.008\n\nY direction 0.01 0.008 0.01\n\nZ direction 0.005 0.005 0.005\n\nRelative position error (m) 2.0\n\nRelative velocity error (m/s) 0.0016\n\n162 5 Autonomous Navigation Technology of Regional Constellation\n\n\n\nChapter 6\nRelative Navigation Technology\n\n6.1 Introduction\n\nRelative navigation of spacecraft refers to determine the relative position and rel-\native velocity between the two spacecraft [1\u20133] by using spaceborne measuring\nequipment and combining with the relative motion equation and state estimation\nmethod of spacecraft. Relative navigation is the premise of achieving the spacecraft\nrendezvous, accompanying flying and formation flying, which impacts the accuracy\nof guidance and control [4] directly. The spacecraft operating on a circular or\nnear-circular orbit can determine the relative position and relative velocity between\nthe spacecrafts by measuring the azimuth and distance of the target spacecraft\nrelative to the active spacecraft with the optical sensors and radars mounted on the\nactive spacecraft and by making use of Clohessy\u2013Wiltshire (C-W) equation and\nExtended Kalman Filter (EKF) algorithm [5\u20137].\n\nThe tracking equipments adopted by relative navigation in the elliptical orbit are\nsimilar to those on near-circular orbit, which are mainly microwave radar and pho-\ntoelectric combination, can measure the azimuth and distance of the target spacecraft.\nSince the relative motion equation and measurement equation of the spacecraft\noperating on the elliptical orbit are nonlinear, the relative navigation of the elliptical\norbital spacecraft is essentially a question of nonlinear state estimation, and the\nappropriate filtering algorithm is needed for relative navigation in the elliptical orbit.\nAt present, the widely used nonlinear filtering algorithm is Extended Kalman Filter\n(EKF), which is realized by conducting the first-order linearization truncation on\nTaylor expansion of nonlinear function, while neglecting high-order term. EKF is\nsimple and easy. Compared with UKF, Particle filter, and other nonlinear filtering, the\ncomputational complexity of EKF is much smaller. Related scholars [8] have estab-\nlished the relative motion equation without the circular orbit hypothesis in spacecraft\norbit coordinate system and have researched the method of relative navigation, which\nis based on visual sensor measuring and makes use of state observer. However, this\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_6\n\n163\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_6&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_6&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_6&amp;domain=pdf\n\n\nrelative motion equation is complex and is not conducive to engineering implement,\nand the state observer cannot achieve high accuracy relative positioning.\n\nThis chapter mainly analyzes the relative navigation system models for orbit\ncoordinate system and the inertial coordinate system of elliptical orbit, and carries\non the corresponding mathematical simulation. The simulation results show that the\ntwo relative navigation system models have high relative navigation accuracy and\nfast filtering convergence rate. The two methods use Lawden equation and the\nrelative motion equation in the inertial coordinate system, respectively, and both of\nthem contain the orbital parameters of active spacecraft. The main difference is that\nin order to obtain the angular velocity and angular acceleration of its true anomaly,\nLawden equation needs to be calculated according to the orbit elements of active\nspacecraft; the relative motion equation in the inertial coordinate system uses the\nabsolute position of active spacecraft as parameters, and these parameters can\nbe obtained directly by the autonomous navigation method of spacecraft. Thus, the\ncomplexity of relative navigation system model in the inertial coordinate system is\nless than that in the orbit coordinate system of active spacecraft, which can reduce\nthe computational complexity in a certain extent.\n\n6.2 Relative Navigation Technology in the Orbit\nCoordinate System\n\n6.2.1 Coordinate System Definition\n\nThe active spacecraft orbit coordinate system Sc is shown in Fig. 6.1: coordinate\nsystem origin o is defined as the active spacecraft centroid; xc axis is along the\nvelocity direction, zc axis is along the radial pointing to the earth center, and yc axis\nand xc, zc axis constitute the right-handed coordinate system.\n\nIn this coordinate system, the relative positional relationship between the active\nspacecraft and the target spacecraft is as shown in Fig. 6.2.\n\nEarth center\n\nFig. 6.1 Active spacecraft\norbit coordinate system\n\n164 6 Relative Navigation Technology\n\n\n\n6.2.2 Relative Navigation System Modeling in the Orbit\nCoordinate System\n\nIn the active spacecraft orbit coordinate system, the spacecraft relative motion\nequation has the following form:\n\nd2 rct\u00f0 \u00dec\ndt2\n\n\u00fe _xc\u00f0 \u00de?c rct\u00f0 \u00dec \u00fe 2 xc\u00f0 \u00de?c\nd rct\u00f0 \u00dec\ndt\n\n\u00fe xc\u00f0 \u00de?c xc\u00f0 \u00de?c rct\u00f0 \u00dec\n\n\u00bc ? l\nr3c\n\nrct\u00f0 \u00dec?3\nrct ? rc\nr2c\n\nrc\u00f0 \u00dec\n? ?\n\n? f c\u00f0 \u00dec\n\u00f06:1\u00de\n\nwhere:\n\nrct\u00f0 \u00dec\u00bc x y z\u00bd ?T\n\nrc\u00f0 \u00dec\u00bc 0 0 ?rc\u00bd ?T\n\nf c\u00f0 \u00dec\u00bc fx fy fz\u00bd ?T\n\nwhere xc\u00f0 \u00dec is the active spacecraft orbit angular velocity in the active spacecraft\norbit coordinate system; _xc\u00f0 \u00dec is the derivative of this rotation angular velocity\ncomponent array in the orbit coordinate system; xc\u00f0 \u00de?c is the antisymmetric matrix\nof array xc\u00f0 \u00dec, if set xc\u00f0 \u00dec\u00bc xcx xcy xcz\u00bd ?T, then:\n\nxc\u00f0 \u00de?c \u00bc\n0 ?xcz xcy\nxcz 0 ?xcx\n?xcy xcx 0\n\n2\n4\n\n3\n5\n\nConsidering the spacecraft relative motion in the elliptical orbit, the relative\nmotion equation of the elliptical orbit described in the active spacecraft orbit\ncoordinate system is given by Formula (6.1) [9]:\n\nActive spacecraft\n\nTarget\nspacecraft\n\nFig. 6.2 Relative positional\nrelationship\n\n6.2 Relative Navigation Technology in the Orbit Coordinate System 165\n\n\n\n\u20acx? 2 _hc _z? \u20achcz? _h2cx\u00fe ?x2cx \u00bc ?fx\n\u20acy\u00fe ?x2cy \u00bc ?fy\n\u20acz\u00fe 2 _hc _x\u00fe \u20achcx? _h2cz? 2?x2cz \u00bc ?fz\n\n8<\n: \u00f06:2\u00de\n\nFormula (6.2) is Lawden equation describing the spacecraft relative motion in\nthe elliptical orbit, where _hc and \u20achc are the angular velocity and angular acceleration\nof the true anomaly, respectively, and can be expressed by the orbital semi-major\naxis ac, eccentricity ec, and true anomaly hc of the active spacecraft, as follows:\n\n_hc \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n\nl\n\na3c 1? e2c\n? ?3\n\ns\n1\u00fe ec cos hc\u00f0 \u00de2 \u00f06:3\u00de\n\n\u20achc \u00bc ? 2lec sin hc\na3c 1? e2c\n? ?3 \u00f06:4\u00de\n\n?xc \u00bc\nffiffiffiffiffiffiffiffiffiffi\nl\n?\nr3c\n\nq\n\u00f06:5\u00de\n\nThe state parameters of relative navigation are selected as the relative position\ncoordinates and the relative velocity coordinates in the active spacecraft orbit\ncoordinate system, namely\n\nX \u00bc x y z _x _y _z\u00bd ?T \u00f06:6\u00de\n\nThe following state equation of the relative navigation system with linear\ntime-varying form is obtained according to Lawden equation:\n\n_X t\u00f0 \u00de \u00bc F t\u00f0 \u00deX t\u00f0 \u00de\u00feG t\u00f0 \u00deW t\u00f0 \u00de \u00f06:7\u00de\n\nwhere\n\nF t\u00f0 \u00de \u00bc F1 t\u00f0 \u00de\nF2 t\u00f0 \u00de\n\n\" #\n; G t\u00f0 \u00de \u00bc 03?3?I3?3\n\n\" #\n\nF1 t\u00f0 \u00de \u00bc 03?3 I3?3\u00bd ?\n\nF2 t\u00f0 \u00de \u00bc\n_h2c ? ?x2c 0 \u20achc 0 0 2 _h2c\n\n0 ??x2c 0 0 0 0\n?\u20achc 0 _h2c \u00fe 2?x2c ?2 _h2c 0 0\n\n2\n4\n\n3\n5\n\nSimilar to the relative navigation problem in the circular orbit, the measurement of\nthe relative navigation in the elliptical orbit is usually the relative distance and relative\nazimuth between the spacecrafts, using the observation model shown in Fig. 6.3.\n\n166 6 Relative Navigation Technology\n\n\n\nSetting the relative distance observation value to be qm, the observation value of\nthe elevation angle and the azimuth angle to be am, bm, respectively, and the\nmeasurement equation of the relative navigation system can be expressed as:\n\nZ \u00bc\nqm\n\nam\n\nbm\n\n2\n64\n\n3\n75 \u00bc\n\nq\n\na\n\nb\n\n2\n64\n\n3\n75\u00fe\n\nvq\nva\nvb\n\n2\n64\n\n3\n75 \u00f06:8\u00de\n\nwhere vq; va; vb is unrelated zero-mean Gaussian white noise; the variance is\nr2q; r\n\n2\na; r\n\n2\nb, respectively.\n\nThe relative navigation in the elliptical orbit is mainly based on the relative\ndynamics modeling. According to the measurement principle of microwave radar,\nlaser radar, or photoelectric combination, the relative navigation algorithm is\ndesigned and simulated.\n\nFrom the relative navigation process, it can be seen that in order to improve the\nrelative navigation accuracy, on the one hand the relative dynamics model, namely\nthe state equation, needs to be improved; on the other hand, the relative navigation\nalgorithm needs to be studied and the relative navigation algorithm which can\nachieve higher accuracy needs to be put forward.\n\nIn this case, the state parameters selected in the relative navigation system model\nare the relative position and the relative velocity of the two spacecrafts in the active\nspacecraft orbit coordinate system, namely X \u00bc x y z _x _y _z\u00bd ?T. The fol-\nlowing state equation of the relative navigation system with linear time-varying\nform is obtained according to Lawden equation:\n\n_X t\u00f0 \u00de \u00bc F t\u00f0 \u00deX t\u00f0 \u00de\u00feG t\u00f0 \u00de\naxc\nayc\nazc\n\n2\n64\n\n3\n75 \u00f06:9\u00de\n\nwhere axc; ayc; azc are projections of relative perturbation acceleration difference of\ntwo-satellite and three-axis orbit in the active spacecraft orbit coordinate system,\nbeing considered as part of the system error in the relative navigation calculation,\nand the magnitude changes with the orbital proximity degree of the active space-\ncraft and the target spacecraft. And there are:\n\nActive\nspacecraft\n\nTarget spacecraft\nFig. 6.3 Observation model\nof the relative navigation\n\n6.2 Relative Navigation Technology in the Orbit Coordinate System 167\n\n\n\nF t\u00f0 \u00de \u00bc\n\n0 0 0 1 0 0\n0 0 0 0 1 0\n0 0 0 0 0 1\n\n_h2c ? ?x2c 0 \u20achc 0 0 2 _h2c\n0 ??x2c 0 0 0 0\n\n?\u20achc 0 _h2c \u00fe 2?x2c ?2 _h2c 0 0\n\n2\n6666664\n\n3\n7777775\n; G t\u00f0 \u00de \u00bc\n\n0 0 0\n0 0 0\n0 0 0\n1 0 0\n0 1 0\n0 0 1\n\n2\n6666664\n\n3\n7777775\n\n\u00f06:10\u00de\n\nThe relative measurement equation is the output of the spaceborne measuring\nequipment. Here it mainly considers the relative distance qm, the relative azimuth\nangle am, and the relative azimuth angle bm measured by the microwave radar. The\nmeasurement equation can be obtained according to Formula (6.8):\n\nZ \u00bc\nqm\n\nam\n\nbm\n\n2\n64\n\n3\n75 \u00bc\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2 \u00fe y2 \u00fe z2\n\np\narcsin z\n\n. ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2 \u00fe y2 \u00fe z2\n\np? \t\narcsin y\n\n. ffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2 \u00fe y2\n\np? \t\n2\n6664\n\n3\n7775\u00fe\n\nvq\nva\nvb\n\n2\n64\n\n3\n75 \u00f06:11\u00de\n\nwhere vq; va; vb are the system measurement noises.\nIt can be seen that the relative navigation system model is the nonlinear model,\n\nand the classical Kalman Filter cannot be constructed. For this purpose, Extended\nKalman Filter (EKF) is used to solve the problem. In order to meet the need of EKF\nalgorithm, it needs to linearize the nonlinear model at first. The system state\nequation is linearized at the optimal estimation point by using the mature method\n\n_X t\u00f0 \u00de ? f X? t\u00f0 \u00de; t\n ?\u00fe @f X t\u00f0 \u00de; t\u00bd ?\n@X\n\n????\nX\u00bcX? t\u00f0 \u00de\n\n? X t\u00f0 \u00de ? X? t\u00f0 \u00de\n ?\u00feGW \u00f06:12\u00de\nThe optimal estimate of the system state is\n\n_?X \u00bc f X? t\u00f0 \u00de; t\n ? \u00f06:13\u00de\nThus, it can be obtained\n\nd _?X t\u00f0 \u00de \u00bc F t\u00f0 \u00dedX? t\u00f0 \u00de\u00feGW \u00f06:14\u00de\n\nSimilarly, the system measurement equation is linearized at the optimal estimate\npoint\n\nZ t\u00f0 \u00de \u00bc h X? t\u00f0 \u00de; t\n ?\u00fe @h X t\u00f0 \u00de; t\u00bd ?\n@X\n\n????\nX\u00bcX? t\u00f0 \u00de\n\n? X t\u00f0 \u00de ? X? t\u00f0 \u00de\n ?\u00feV \u00f06:15\u00de\n\n168 6 Relative Navigation Technology\n\n\n\nIt can be obtained\n\ndZ t\u00f0 \u00de \u00bc H t\u00f0 \u00dedX? t\u00f0 \u00de\u00feV \u00f06:16\u00de\n\nThus, the linearized system linear interference equation can be obtained as\nfollows:\n\nd _?X t\u00f0 \u00de \u00bc F t\u00f0 \u00dedX? t\u00f0 \u00de\u00feGW\ndZ t\u00f0 \u00de \u00bc H t\u00f0 \u00dedX? t\u00f0 \u00de\u00feV\n\n(\n\u00f06:17\u00de\n\nwhere F t\u00f0 \u00de \u00bc @f X t\u00f0 \u00de;t\u00bd ?@X\n???\nX\u00bcX? t\u00f0 \u00de\n\n;H t\u00f0 \u00de \u00bc @h X t\u00f0 \u00de;t\u00bd ?@X\n???\nX\u00bcX? t\u00f0 \u00de\n\nDiscretization of Formula (6.17) can be expressed as follows:\n\nd _?Xk \u00bc Uk;k?1dX?k?1 \u00feCk?1W\ndZk \u00bc HkdX?k \u00feV\n\n(\n\u00f06:18\u00de\n\nwhere\n\nUk;k?1 \u00bc I\u00feF tk?1\u00f0 \u00deDT \u00f06:19\u00de\n\nCk?1 \u00bc DT I\u00fe 12!F tk?1\u00f0 \u00deDT\n\n ?\n\n\u00f06:20\u00de\n\nThus, according to Extended Kalman Filter theory:\n\nX?k=k?1 \u00bc Uk;k?1X?k?1 \u00f06:21\u00de\n\nX?k \u00bc X?k=k?1 \u00fe dX?k \u00f06:22\u00de\n\ndX?k \u00bc Kk Zk ? h X?k=k?1\n? ?\n ? \u00f06:23\u00de\n\nPk=k?1 \u00bc Uk;k?1Pk?1UTk;k?1 \u00feCk?1QCTk?1 \u00f06:24\u00de\n\nKk \u00bc Pk=k?1HTk HkPk=k?1HTk \u00feR\n? ??1 \u00f06:25\u00de\n\nPk \u00bc I ? KkHk\u00f0 \u00dePk=k?1 \u00f06:26\u00de\n\nwhere Q and R are the covariance matrices of system noise and measurement noise,\nrespectively.\n\nThe relative navigation filter is constructed by the above EKF equations. The\nmathematical simulation structure based on MATLAB is shown in Fig. 6.4.\n\nThe operation flow chart of the navigation filter in Fig. 6.4 is shown in Fig. 6.5.\n\n6.2 Relative Navigation Technology in the Orbit Coordinate System 169\n\n\n\n6.2.3 Simulation Example\n\nIn order to verify the above-mentioned relative navigation system model, the\nmathematical simulation is carried out for the corresponding relative navigation in\nthe elliptical orbit; the simulation parameters are set as follows.\n\nThe simulation step size: 1 s; the simulation duration: 7000 s; the accuracy of\ntracking equipment: both elevation angle and azimuth angle are 0.2\u00b0 (3r), the\nrelative distance is 11 m (3r) (these errors satisfy the Gaussian white noise dis-\ntribution). The nominal value of the relative state is calculated according to the\n\nNavigation\nFiter\n\n(EKF)\n\nActive Spacecraft \nOrbit Elements \n\nState Propagator \nBased on Lawden \n\nEquation\n\nRelative\nNavigation\n\nSensor\nMeasurement\n\nNavigation\nInformationTarget Spacecraft \n\nOrbit Elements \n\nFig. 6.4 Mathematical simulation model of relative navigation in the active spacecraft orbit\ncoordinate system\n\nFig. 6.5 Algorithm flow of the navigation filter\n\n170 6 Relative Navigation Technology\n\n\n\nabsolute orbit dynamics of the two spacecraft. J2, J3 and J4 items of earth oblateness\nperturbation, the sunlight pressure perturbation, and the atmospheric drag pertur-\nbation are considered in the spacecraft absolute orbit dynamics.\n\nThe relevant perturbation parameters are listed in Table 6.1.\nThe initial orbit elements of the two spacecraft are shown in Table 6.2.\nThe relative position and relative velocity between the two spacecrafts in the\n\ntarget spacecraft orbit coordinate system are\n\n?10;000m ?10;000m ?1000m ?1m/s ?1m/s ?1m/s\u00bd ?\n\nThe initial orbit elements of the active spacecraft are determined by the initial\norbit elements of the target spacecraft and the relative relationship between the two\nspacecrafts.\n\nAccording to the relative navigation algorithm proposed in this section, the\nrelative navigation results in the active spacecraft orbit coordinate system are shown\nin Figs. 6.6 and 6.7.\n\nFrom Figs. 6.6 and 6.7, it can be seen that under the above simulation condi-\ntions, all the three-axis position accuracy, which is achieved by relative navigation\nbased on Lawden equation in the active spacecraft orbit coordinate system, is better\nthan 10 m, and all the three-axis velocity accuracy is better than 0.1 m/s, indicating\nthat the relative navigation method described in this chapter is applicable to the\nelliptical orbit.\n\nTable 6.1 Parameters of sunlight pressure perturbation and the atmospheric drag perturbation\n\nTarget spacecraft Active spacecraft\n\nMass (kg) 2400 1441\n\nAtmospheric drag effective area (m2) 4 9.35\n\nSunlight pressure effective area (m2) 50 50\n\nSunlight pressure radiation coefficient (Cr) 1.2 1.2\n\nAtmospheric drag coefficient (CD) 2.1 2.1\n\nTable 6.2 Initial orbit elements of the target spacecraft\n\nParameters Semi-major\naxis (m)\n\nEccentricity Inclination\n(\u00b0)\n\nRight\nascension\nof the\nascending\nnode\n(RAAN) (\u00b0)\n\nArgument\nof perigee\n(\u00b0)\n\nTrue\nanomaly\n(\u00b0)\n\nTarget\nspacecraft\n\n22,175,000 0.7 60 60 30 180\n\n6.2 Relative Navigation Technology in the Orbit Coordinate System 171\n\n\n\n6.3 Relative Navigation Technology in the Inertial\nCoordinate System\n\n6.3.1 Relative Navigation System Modeling in the Inertial\nCoordinate System\n\nThe spacecraft relative motion equation established in the inertial coordinate system\nhas no constraint of the circular orbit hypothesis and is also suitable for the relative\nnavigation in the elliptical orbit, and this navigation method can obtain the relative\nposition and relative velocity in the inertial coordinate system directly.\n\nWhen the two spacecraft make short-range relative movement, the spacecraft\nrelative motion equation in the inertial coordinate system is as follows:\n\nFig. 6.6 Relative navigation\nposition error in the active\nspacecraft orbit coordinate\nsystem\n\nFig. 6.7 Relative navigation\nvelocity error in the active\nspacecraft orbit coordinate\nsystem\n\n172 6 Relative Navigation Technology\n\n\n\nd2\n\ndt2\nrct \u00bc ? lr3c\n\nrct ? 3 rct ? rcr2c\nrc\n\n? ?\n? f c \u00f06:27\u00de\n\nThe relative motion equation expressed in the geocentric equatorial inertial\ncoordinate system can be obtained. The scalar form of the equation is [10]\n\ndxi\ndt\n\n\u00bc _xi\ndyi\ndt\n\n\u00bc _yi\ndzi\ndt\n\n\u00bc _zi\nd_xi\ndt\n\n\u00bc ? l\nr3c\n\nxi ? 3 xixci \u00fe yiyci \u00fe zizcir2c\nxci\n\n? ?\n? fxi\n\nd_yi\ndt\n\n\u00bc ? l\nr3c\n\nyi ? 3 xixci \u00fe yiyci \u00fe zizcir2c\nyci\n\n? ?\n? fyi\n\nd_zi\ndt\n\n\u00bc ? l\nr3c\n\nzi ? 3 xixci \u00fe yiyci \u00fe zizcir2c\nzci\n\n? ?\n? fzi\n\n8>>>>>>>>>>>>>>>>>>>><\n>>>>>>>>>>>>>>>>>>>>:\n\n\u00f06:28\u00de\n\nwhere: xi; yi; zi and _xi; _yi; _zi are the relative position coordinates and the relative\nvelocity coordinates of the spacecraft in the inertial coordinate system, respectively;\nxci; yci; zci and fxi; yyi; zzi are the three-axis position coordinates and the three-axis\ncomponent of the control acceleration acting on the active spacecraft in the inertial\ncoordinate system, respectively.\n\nAssuming that the external control force is not taken into account, the state\nparameters are\n\nX \u00bc xi yi zi _xi _yi _zi\u00bd ?T\n\nSystem noise is\n\nW \u00bc 0 0 0 axi ayi azi\u00bd ?T\n\nThe system state equation can be expressed as\n\n_X t\u00f0 \u00de \u00bc f X t\u00f0 \u00de; t\u00bd ? \u00feW \u00f06:29\u00de\n\nThe measurement of the relative navigation is taken as the relative distance q and\nthe elevation angle a and the azimuth angle b of the target spacecraft in the mea-\nsurement sensor coordinate system. However, since the system state equation is\nestablished in the inertial system, the measurement obtained in the measurement\ncoordinate system cannot be directly applied, and it must be transformed to the inertial\n\n6.3 Relative Navigation Technology in the Inertial Coordinate System 173\n\n\n\ncoordinate system. If the azimuth of the target spacecraft in the measurement coor-\ndinate system is expressed by (q)m, then there is the following formula:\n\nq\u00f0 \u00dem\u00bc\nxm\nym\nzm\n\n2\n64\n\n3\n75 \u00bc\n\ncos a cos b\n\ncos a sin b\n\nsin a\n\n2\n64\n\n3\n75 \u00f06:30\u00de\n\nwhere xm, ym, zm are the direction cosine of the direction vector of the target\nspacecraft relative to the active spacecraft in the active spacecraft measurement\nsensor coordinate system.\n\nAssume Lbm to be the transformation matrix from the measurement coordinate\nsystem to the active spacecraft body-fixed coordinate system, Lib is the transfor-\nmation matrix from the body-fixed coordinate system to the inertial coordinate\nsystem, then the observation in the inertial coordinate system, that is, the projection\nof the direction vector of the target spacecraft relative to the active spacecraft in the\ninertial coordinate system, can be expressed as\n\nq\u00f0 \u00dei\u00bc LibLbm q\u00f0 \u00dem \u00f06:31\u00de\n\nLib contains the attitude determination error of the active spacecraft body-fixed\ncoordinate system relative to the inertial space, which will affect the navigation\naccuracy when being introduced into the measurement model.\n\nUsing the measurement information of the spacecraft relative distance and rel-\native azimuth, the observation model established in the inertial coordinate system\ncan be expressed as\n\nZ \u00bc q\nq\u00f0 \u00dei\n\n\" #\n\u00bc\n\nq\n\nxi=q\n\nyi=q\n\nzi=q\n\n2\n6664\n\n3\n7775\u00fe\n\nvq\nvx\nvy\nvz\n\n2\n6664\n\n3\n7775 \u00f06:32\u00de\n\nwhere the relative distance is q \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2i \u00fe y2i \u00fe z2i\n\np\n; vq is the relative distance mea-\n\nsurement noise; vx, vy, vz are the azimuth model errors, including the measurement\nnoise and the attitude determine error of the active spacecraft body-fixed coordinate\nsystem relative to the inertial coordinate system.\n\nSetting V = [vq vx vy vz], then the observation model can be expressed as\n\nZ t\u00f0 \u00de \u00bc h X t\u00f0 \u00de; t\u00bd ? \u00feV \u00f06:33\u00de\n\nThe state equation and the observation equation above are nonlinear. Such rel-\native navigation belongs to the typical nonlinear state estimation problem, which\nalso adopts EKF algorithm to construct relative navigation filter. The mathematical\nsimulation structure based on MATLAB is shown in Fig. 6.8.\n\n174 6 Relative Navigation Technology\n\n\n\nThe operation flow of the navigation filter in Fig. 6.8 is the same as that in\nFig. 6.5.\n\n6.3.2 Simulation Example\n\nThe mathematical simulation of the relative navigation in the inertial coordinate\nsystem is carried out with the same parameter settings as those in orbital coordinate\nsystem. The results are shown in Fig. 6.9 (relative navigation position error in\ninertial system) and Fig. 6.10 (relative navigation velocity error in inertial system).\n\nFrom Figs. 6.9 and 6.10, it can be seen that under the above simulation con-\nditions, all the three-axis position accuracy of the relative navigation based on the\nrelative motion equation in the inertial system is better than 10 m, and all the\nthree-axis velocity accuracy is better than 0.1 m/s, which indicates that the relative\nnavigation method in the inertial coordinate system described in this section is also\napplicable to the elliptical orbit.\n\nNavigation\nFiter\n\n(EKF)\n\nActive Spacecraft \nOrbit Elements \n\nRelative\nNavigation\n\nSensor\nMeasurement\n\nNavigation\nInformationTarget Spacecraft \n\nOrbit Elements \n\nState Propagator Based \non Relative Motion \nEquation in Inertia \nCoordinate System \n\nFig. 6.8 Mathematical simulation model of relative navigation in the inertial coordinate system\n\nFig. 6.9 Relative navigation\nposition error in the inertial\ncoordinate system\n\n6.3 Relative Navigation Technology in the Inertial Coordinate System 175\n\n\n\n6.4 Comparison of Methods\n\nIn this chapter, two kinds of the relative navigation method which are suitable for\nthe elliptical orbit are introduced in detail. Through theoretical derivation and\nsimulation analysis, it can be found that both methods can effectively solve the\nnonlinear problem of relative navigation, and the navigation accuracy is also in the\nsame order of magnitude.\n\nFrom the formula derivation, it is not difficult to find that the relative navigation\nmethod based on the orbit coordinate system needs to be calculated according to the\norbital elements of the active spacecraft, so as to obtain the angular velocity and\nangular acceleration of its true anomaly, which will increase the computational\ncomplexity of the spaceborne computer. The relative navigation method based on\nthe inertial coordinate system needs to transform the measurement to the inertial\ncoordinate system; however, the attitude determination error will be introduced\nduring this transform process, which will affect the relative navigation accuracy.\n\nTherefore, in practical engineering applications, it is necessary to decide which\nkind of the relative navigation method to be adopted according to the factors such\nas the practical spaceborne computing capacity of the active spacecraft, the accu-\nracy of attitude measurement sensor.\n\nReferences\n\n1. Yang Wenbo, Li Yingbo, Zhang Xiaowei, etc. A Filtering Method for Flying Around Satellite\nAutonomous Relative Navigation Based on Unscented Kalman Filter [J]. Aerospace\nShanghai, 2009, (02): 45\u201354.\n\n2. Yang Wenbo, Li Yingbo, Shi Changyong, etc. An Orbit Determination Method Based on\nGPS for Autonomous Navigation of Fly-around Satellite [J]. Aerospace Shanghai, 2010, 27\n(2): 38\u201345.\n\nFig. 6.10 Relative\nnavigation velocity error in\nthe inertial coordinate system\n\n176 6 Relative Navigation Technology\n\n\n\n3. Shi Li, Zhang Shijie, Ye Song. The On board Orbit Propagation System Design of Large\nElliptical Orbit [J]. Aerospace Control, 2010, 28 (6): 43\u201348.\n\n4. Hari B H, Myron T, David D B. Guidance algorithms for autonomous rendezvous of\nspacecraft with a target vehicle in circular orbit [C]. AIAA Guidance, Navigation, and Control\nConference and Exhibit, 2001: 6\u20139.\n\n5. Hari B H. Autonomous relative navigation, attitude Determination, pointing and tracking for\nspacecraft rendezvous [C]. AIAA Guidance, Navigation, and Control Conference and Exhibit,\n2003: 11\u201313.\n\n6. Zhang Honghua, Lin Laixing. The determination of relative orbit for satellites formation\nflying [J]. Journal of Astronautics, 2002, 23 (6): 77\u201381.\n\n7. Wei Chunling, Zhang Honghua. Autonomous Determination of Relative Orbit for Formation\nFlying Satellites [J]. Aerospace Control, 2003, 21(3): 41\u201347.\n\n8. Alonso R, Crassidis J L, Junkins J L. Vision-based relative navigation for formation flying of\nspacecraft [C]. AIAAGuidance, Navigation, andControl Conference and Exhibit, 2000: 14\u201317.\n\n9. Liu Yong. A Study of Spacecraft Autonomous Navigation Based on Nonlinear filtering [D].\nBeijing: Beijing University, 2007.\n\n10. Xiao Yelun. Theory of Spacecraft Flight Dynamics [M]. Beijing: Astronautic Press, 1995.\n\nReferences 177\n\n\n\nChapter 7\nTechnology of Formation Configuration\nMaintenance on Elliptical Orbit\n\n7.1 Introduction\n\nAutonomous formation flight has gradually become hot spot of aerospace tech-\nnology research, with design of accompanying flying configuration and control of\naccompanying flying keeping as the necessary technical foundation. In order to\nreduce the control frequency and save fuel consumption, it is necessary to rely on\nnatural accompanying flying, that is, achieve long-term stable accompanying flying\nfor the target by configuration design. In order to complete the task of accompa-\nnying flying for the target, task analysis will be made first, and determine the\nconstraints of accompanying flying configuration according to the relative motion\nconstraints which required to be kept by the two stars. Then analyze the relative\norbit dynamics under the elliptical orbit and design accompanying flying configu-\nration according to the requirements of the task and constraint conditions. This part\nof content has been already introduced in the Chap. 3.\n\nUnder the effect ofmulti-perturbation forces in space, therewill be a long-term drift\nin the accompanying flying configuration, and the position of the active spacecraft\ncannot stay within a certain range near the target spacecraft for a long time, so it is\nnecessary to use appropriate control method to keep stable and long-time accompa-\nnying flying on the premise of saving fuel. Currently, the research of accompanying\nflying on elliptical orbit mainly focuses on the relative dynamic modeling and con-\nfiguration design, but few studies of accompanying flying control. Some scholars put\nforward an accompanying flying control envisage using difference of atmospheric\ndrag without any fuel consumption and carry on further study with this method [1].\nSome [2, 3] scholars studied the control strategy of long-distance accompanying\nflying; however, these methods only apply to accompanying flying on circular orbit,\nwhose configuration is center-drifted and undivergent. When conducting long-term\naccompanying flying on elliptical orbit, the configuration will be not only\ncenter-drifted, but also gradually diverged. If the active spacecraft has not been\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_7\n\n179\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_7&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_7&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_7&amp;domain=pdf\n\n\ncontrolled, it will drift beyond prescribed flying range, so it is necessary to seek other\ncontrol methods for keeping configuration of accompanying flying on elliptical orbit.\n\nAlso some scholars put forward a control method of formation flight configu-\nration keeping based on the phase plane method [4], or taking method of double\npulse to control flying-around trajectory [5]. These methods mainly aim at\nflying-around configuration keeping, that is, the target spacecraft is in the center of\nthe configuration. The difference between accompanying flying keeping and\nflying-around keeping comes from linearization error in relative dynamic equation,\nwhich makes the accompanying flying trajectory deduced from it is not completely\nclosed. Thus, some scholars studied the control method of fixed-point accompa-\nnying flying under the condition of target maneuvering [6], and the optimal control\nstrategy of space circular configuration of controlled formation [7], which is based\non the nonlinear relative motion equation of elliptical orbit. Aiming at requirement\nof keeping accompanying flying configuration of long-term stable natural formation\non elliptical orbit, this chapter puts forward two control methods of keeping con-\nfiguration on the basis of analyzing the motion characteristic of accompanying\nflying configuration. Real-time closed-loop feedback control based on the linear\nquadratic optimal control is introduced first. Since realizing control in each orbit\ncontrol period consumes large quantity of fuel, an error limit is designed. Only\nwhen the error exceeds the error limit, the control can be exerted, so as to reduce\nfuel consumption. Configuration keeping strategy based on relative orbit elements\nis introduced second, that is, adjusting orbit semi-major axis of active spacecraft\nnear apogee only once, accompanying flying trajectory can be controlled within the\nrequired range. This method is simple and fuel saving; however, it sets stricter\ninitial condition for entering accompanying flying.\n\n7.2 Characteristic Analysis of Relative Motion\n\n7.2.1 Relative Motion Equation Based on Relative Orbit\nElement\n\nThe derivation process of the relative motion equation of elliptical orbit, being\ndescribed with relative orbit elements, can be seen in document [8], with the\nfollowing important conclusions.\n\nClose relative motion equation for direction x\n\nx \u00bc r Dx\u00feDX cos i\u00feDh\u00f0 \u00de \u00bc 1\u00fe r\na\n? 1\n1? e2\n\n? ?\na Dex sin u? Dey cos u\n? ?\n\n\u00fe\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np r\na\n\n? ?\naDM0 t\u00f0 \u00de\u00feD1\n\n\u00f07:1\u00de\n\n180 7 Technology of Formation Configuration Maintenance \u2026\n\n\n\nwhere\n\nD1 \u00bc ra\n? ? 1? ffiffiffiffiffiffiffiffiffiffiffiffiffi1? e2p\n\ne\n? e\n\n !\na\nr\n\n? ?2\n? e\n1? e2\n\n\" #\n? a Dey cosx? Dex sinx\n? ?\n\n\u00f07:2\u00de\n\nClose relative motion equation for direction z\n\nz \u00bc a Dex cos u\u00feDey sin u\n? ?\u00fe r\n\na\n\n? ?\na\n2D\n3n\n\n\u00feD2 \u00f07:3\u00de\n\nwhere\n\nD2 \u00bc ? a sin hffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np eDM0\u00f0t\u00de\u00fe\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\n? 1\n\n? ?\nDey cosx? Dex sinx\n? ?h i \u00f07:4\u00de\n\nClose relative motion equation for direction y out of the orbit plane\n\ny \u00bc r DX sin i cos u? Di sin u\u00f0 \u00de \u00bc r\na\n\n? ?\na Dix cos u\u00feDiy sin u\n? ? \u00f07:5\u00de\n\nFormulas (7.1)\u2013(7.5) are short distance relative motion equation when active\nspacecraft is under the target spacecraft centroid orbit coordinate system, which is\nexpressed by the relative orbit elements, being summarized as the following\nformula\n\nx \u00bc 1\u00fe ra ? 11?e2\n? ?\n\na Dex sin u? Dey cos u\n? ?\u00fe ffiffiffiffiffiffiffiffiffiffiffiffiffi1? e2p ra? ?aDM0\u00f0t\u00de\u00feD1\n\ny \u00bc ra\n? ?\n\na Dix cos u\u00feDiy sin u\n? ?\n\nz \u00bc a Dex cos u\u00feDey sin u\n? ?\u00fe ra? ?a 2D3n \u00feD2\n\n8<\n: \u00f07:6\u00de\nTake the derivative of the Formula (7.6), and use the following formula\n\ndu\ndt \u00bc dhdt \u00bc n\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\na\nr\n\n? ?2\nd\ndt\n\nr\na\n\n? ? \u00bc ffiffiffiffiffiffiffiffiffiffiffiffiffila3 1?e2\u00f0 \u00deq e sin h \u00bc n e sin hffiffiffiffiffiffiffiffi1?e2p\nd\ndt\n\na\nr\n\n? ? \u00bc ? ar? ?2 ddt ra? ? \u00bc ?n ar? ?2 e sin hffiffiffiffiffiffiffiffi1?e2p\n\n8>><\n>>: \u00f07:7\u00de\n\n7.2 Characteristic Analysis of Relative Motion 181\n\n\n\nThe relations between relative velocity of two spacecraft are as follows\n\ndx\ndt \u00bc an\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\na\nr\n\n? ?2 1\u00fe ra ? 11?e2? ?? Dex cos u\u00feDey sin u? ?\n\u00fe an1?e2 ? e sin hffiffiffiffiffiffiffiffi1?e2p Dex sin u? Dey cos u? ?? ane sin h\u00f0 \u00de ar? ?2DM0\u00f0t\u00de\n\u00fe a\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\na\nr\n\n? ?\nD\u00fe dD1dt\n\ndy\ndt \u00bc an\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\na\nr\n\n? ? ?Dix sin u\u00feDiy cos u? ?\u00fe an e sin hffiffiffiffiffiffiffiffi1?e2p Dix cos u\u00feDiy sin u? ?\ndz\ndt \u00bc an\n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\na\nr\n\n? ?2 ?Dex sin u\u00feDey cos u? ?\u00fe an e sin hffiffiffiffiffiffiffiffi1?e2p ? 2D3n \u00fe dD2dt\n\n8>>>>>>>><\n>>>>>>>>:\n\n\u00f07:8\u00de\n\nwhere\n\ndD1\ndt \u00bc ?an e sin hffiffiffiffiffiffiffiffi1?e2p 1? ffiffiffiffiffiffiffiffi1?e2pe ? e\n\n? ?\n? ar\n? ?2 \u00fe e1?e2h i Dey cosx? Dex sinx? ?\n\ndD2\ndt \u00bc ? ae sin hffiffiffiffiffiffiffiffi1?e2p D? ane cos h\u00f0 \u00de ar? ?2\n\n? DM0\u00f0t\u00de ? 1?\nffiffiffiffiffiffiffiffi\n1?e2\n\np\ne ? Dey cosx? Dex sinx\n\n? ?h i\n8>>><\n>>>:\n\n\u00f07:9\u00de\n\n7.2.2 Relative Motion Analysis Based on Orbit Element\n\nThe simulation results without considering the influence of perturbation force are\nshown in Fig. 7.1.\n\nIt can be seen from the diagram that the accompanying flying trajectory is not\nclosed completely. Using relative motion model, it is easy to analyze drift char-\nacteristics of relative motion without considering perturbation.\n\n(1) Direction x: Long-term drift item in the relative motion equation isffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\nr\na\n\n? ?\naDM0\u00f0t\u00de\n\nh i\n\u00bc 1\u00fe e cos hffiffiffiffiffiffiffiffi\n\n1?e2\np aDM0\u00f0t\u00de\n\nh i\n. If the relative drift rate D 6\u00bc 0,\n\nthat is, the two spacecrafts\u2019 semi-major axes are not strictly equal, the active\nspacecraft will gradually drift. According to the simulation parameters, it can be\ncalculated that aa is the target spacecrafts\u2019 semi-major axis and ab is the active\nspacecrafts\u2019 semi-major axis. When ab [ aa; DM0\u00f0t\u00de\\0, the active spacecraft\nwill gradually drift backward. When the active spacecraft moves to the perigee,\n\ni.e., h = 0\u00b0, the value of drift item is maximum as 1\u00fe effiffiffiffiffiffiffiffi\n1?e2\n\np aDM0\u00f0t\u00de\nh i\n\n. When the\n\nactive spacecraft moves to the position that is perpendicular to the orbit arch of\nthe target spacecraft, i.e., h = 90\u00b0 and h = 270\u00b0 (semi-latus rectum), the value\n\nof drift item is 1ffiffiffiffiffiffiffiffi\n1?e2\n\np aDM0\u00f0t\u00de\nh i\n\n. When h = 180\u00b0, the value of drift item is\n\nminimum as 1?effiffiffiffiffiffiffiffi\n1?e2\n\np aDM0\u00f0t\u00de\nh i\n\n.\n\n182 7 Technology of Formation Configuration Maintenance \u2026\n\n\n\n(2) Direction z: D2, the additional item in the relative motion equation which\n\ncontains ? aeffiffiffiffiffiffiffiffi\n1?e2\n\np sin hDM0\u00f0t\u00de\nh i\n\nis long-term drift item. If the relative drift rate\n\nD 6\u00bc 0, that is, the two spacecrafts\u2019 semi-major axis are not strictly equal. With\nthe increase of DM?(t), the influence of additional item D2 would stand out.\nBesides the influence of h, the rest elements are just further translation cor-\nrection on the basis of mean anomaly angular displacement. When the active\nspacecraft moves to the perigee, i.e., h = 0\u00b0 and apogee h = 180\u00b0, D2 = 0.\nWhen the active spacecraft moves to the position that is perpendicular to the\norbit arch of target spacecraft, i.e., h = 90\u00b0 and h = 270\u00b0 (semi-latus rectum),\n|D2| is maximum. It can be calculated according to the simulation parameters,\nab [ aa; DM0\u00f0t\u00de\\0 so the drift item >0 if true anomaly between 0\u00b0 and 180\u00b0,\nand the spacecraft drifts in forward direction by each circle; the drift item <0 if\ntrue anomaly between 180\u00b0 and 360\u00b0, and the spacecraft drifts backward by\neach circle.\n\n(3) Direction y: There is no long-term drift item in direction out of the orbit plane.\n\nSo, the drift characteristics analyzed above are completely coincident with what\npresented by the curve diagram in Fig. 7.1.\n\nActually, ab \u00bc aa being strictly equal is the condition of periodic solution\nexisting in relative motion. This is obvious, because when two spacecrafts\u2019\nsemi-major axes are strictly equal (i.e., the orbital period are equal), no matter\n\nFig. 7.1 Accompanying flying configuration in ideal case\n\n7.2 Characteristic Analysis of Relative Motion 183\n\n\n\nwhich orbit are the two spacecrafts in, after one period, two spacecrafts will return\nto the same position, respectively, and their relative positions are also returned to\nthe same position after a period of change. Semi-major axis of orbits of two\nspacecrafts are equal can be considered as the precise condition of periodic solution\nexisting in relative motion.\n\n7.3 Control Method of Formation Configuration\nMaintenance\n\nAccording to the analysis in Sect. 3.2.2, when d2 = d3 = d4 = d6 = 0, the trajectory\nof two spacecrafts\u2019 relative motion turns into\n\nx\u00f0f \u00de \u00bc d1 \u00fe d1e cos f\n\ny\u00f0f \u00de \u00bc ?d5 sin\u00f0f \u00de1\u00fe e cos f\nz\u00f0f \u00de \u00bc ?d1e sin f\n\n\u00f07:10\u00de\n\nFormula of relative velocity turns into\n\n_x\u00f0f \u00de \u00bc ?d1e sin f\n\n_y\u00f0f \u00de \u00bc ? d5 e\u00fe cos f\u00f0 \u00de\n1\u00fe e cos f\u00f0 \u00de2\n\n_z\u00f0f \u00de \u00bc ?d1e cos f\n\n\u00f07:11\u00de\n\nIn the orbit plane\n\nx? d1\nd1e\n\n? ?2\n\u00fe z\n\nd1e\n\n? ?2\n\u00bc 1 \u00f07:12\u00de\n\nSo the trajectory of relative motion is a circle whose center is (d1, 0), and radius\nis ?d1e?. Taking configuration parameter d1 = ?2000, d5 = 1000 and keeping\nsimulating for 10 days under the condition of perturbation, configuration diagram\ncan be obtained, which is shown in Fig. 7.2.\n\nIt can be seen from the figure above, only the direction y changes little, direc-\ntions x and z have already run out of accompanying flying range seriously, and the\ndivergent trend is obvious. So, in order to maintain the formation configuration, it is\nnecessary to exert control.\n\n184 7 Technology of Formation Configuration Maintenance \u2026\n\n\n\n7.3.1 Configuration Maintenance Based on LQR\n\nThe key of control algorithm of configuration keeping is trying to save fuel while\nkeeping control accuracy. Methods of closed-loop configuration keeping are as\nfollows.\n\nMethod 1.\nTaking active spacecrafts\u2019 orbital center as control object, forecast the change\n\ntrend of drift according to the current position of the center and long-term drift rate.\nExert control at the right moment, so as to limit accompanying flying center within\nthe specified range, and form stable accompanying flying. As shown in Fig. 7.3, the\ndotted line shows ideal accompanying flying trajectory; taking 1 km behind target\nspacecraft as accompanying flying center, the solid line shows the actual accom-\npanying flying trajectory, and there is error between the actual trajectory and ideal\ntrajectory; ABCD is a rectangular area for limiting the drift of actual accompanying\nflying center, which achieve the goal of long-term accompanying flying by con-\ntrolling the position of accompanying flying center.\n\nBeing different from accompanying flying on circle orbit, accompanying flying\ntrajectory on elliptical orbit will not only drift with time, but also diverge in radial\ndirection and velocity direction, that is, semi-major axis and semi-minor axis of\naccompanying flying ellipse will be extended. Method 1 can always ensure\naccompanying flying center to be within the limited region, but cannot control the\n\nFig. 7.2 Accompanying flying without control\n\n7.3 Control Method of Formation Configuration Maintenance 185\n\n\n\nwhole accompanying flying trajectory within a certain range. Even if the configu-\nration is very compact, relative trajectory will eventually diverge beyond the pre-\nscribed range if the task endures long enough.\n\nMethod 2.\nSetting different sizes of error limits for different accompanying flying distances\n\nand task requirements, if the deviation between true accompanying flying trajectory\nand ideal accompanying flying trajectory run out of the limit, control must be\nexecuted on accompanying flying trajectory.\n\nAssume the acquisition of initial configuration has made the relative position of\nthe active spacecraft in the allowed error range. The task of configuration keeping\ncontrol is to keep the relative position error of active spacecraft within a\nthree-dimensional space error box. The error box is a three-dimensional closed area\nalong three directions of the target spacecraft orbital coordinate system and is\ndefined as Box = {|xe| ? lx, |ye| ? ly, |ze| ? lz}. Among them, l is the position\nerror upper bound of the corresponding direction, which depends on the precision\nrequirements of the task; xe, ye, ze are error of active spacecraft\u2019s actual position vs.\nideal position. Specific control method is shown in Fig. 7.4.\n\nThis method is equivalent to achieve precise accompanying flying by using\nphased forced control method, and get high-precision relative motion trajectory by\nclosed-loop control [9].\n\nThis section uses the idea of Method 2, defining Box = {|xe| ? 100, |ye| ? 100,\n|ze| ? 100}. When the deviation between actual relative position and ideal relative\nposition enter into the box, control can be stopped; when the deviation goes beyond\nthe box, the linear quadratic optimal control should be executed.\n\nVelocity direction\n\nRadial direction\n\nCompanying \nflying center\n\nActual companying \nflying trajectoryActive spacecraft\n\nA B\n\nC D\n\nIdeal companying \nflying trajectory\n\nTarget spacecraft\n\nFig. 7.3 Accompanying flying trajectory\n\n186 7 Technology of Formation Configuration Maintenance \u2026\n\n\n\nA state-space description for linear time-varying systems\n\n_x\u00f0t\u00de \u00bc A\u00f0t\u00dex\u00f0t\u00de\u00feB\u00f0t\u00deu\u00f0t\u00de \u00f07:13\u00de\n\nwhere x is n dimension state vector; u is r dimension input vector; A(t), B(t) are,\nrespectively, n? n dimension and n? r dimension system state matrix.\n\nMake the terminal state of the control system to satisfy the constraint condition\nby seeking the optimal control input u(t), so problem of terminal control is usually\nconverted into problem of quadratic performance optimization [10], i.e.\n\nJ \u00bc 1\n2\n\nZtf\nt0\n\nxT\u00f0t\u00deQx\u00f0t\u00de\u00fe uT\u00f0t\u00deRu\u00f0t\u00de? ?dt \u00fe 12 xT tf? ?Q0x tf? ? minu J \u00f07:14\u00de\nwhere Q, R, Q0 is performance index weighting matrix; Q is n ? n dimension\npositive semi-definite state weighting matrix; R is r ? r dimension positive definite\ncontrol weighting matrix; Q0(N) is n ? n dimension positive semi-definite terminal\nstate weighting matrix.\n\nAccording to the principle of minimum, the control input makes the performance\nindex function J minimum is as follows\n\nu\u00f0t\u00de \u00bc ?K\u00f0t\u00dex\u00f0t\u00de \u00f07:15\u00de\n\nK\u00f0t\u00de \u00bc R?1B\u00f0t\u00deTP\u00f0t\u00de \u00f07:16\u00de\n\nP(t) is symmetric nonnegative definite matrix, and satisfy the following Riccati\nmatrix differential equation, i.e.,\n\nIdeal relative \nmotion equation\n\nRelative position +\n\n+\n\nMeasure error\n\n-\n\nController\n\n+\n\nActive spacecraft \nmotion equation\n\nConvert to inertial \ncoordinate system from \norbit coordinate system \n\n+\n\n-\nTarget spacecraft \nmotion equation\n\nConvert to orbit \ncoordinate system from \n\ninertial coordinate system\n\nVelocity pulse\n\nTarget spacecraft orbit coordinate system \n\nInertial coordinate system \n\nRelative velocity\n\nError\n\nControl command\n\nControl error\n\nRelative position\n\nRelative velocity\n\nFig. 7.4 Control principle diagram\n\n7.3 Control Method of Formation Configuration Maintenance 187\n\n\n\n? _P\u00f0t\u00de \u00bc P\u00f0t\u00deA\u00f0t\u00de\u00feAT\u00f0t\u00deP\u00f0t\u00de ? P\u00f0t\u00deB\u00f0t\u00deR?1BT\u00f0t\u00deP\u00f0t\u00de\u00feQ \u00f07:17\u00de\n\nThere are three parameters needed to be designed in the LQR control: Q, R, and\nQ0, then feedback gain matrix K of the optimal control input can be obtained. The\nvalues of matrix K depends on A, B of the state equation and Q, R, Q0 of the\nobjective function. A and B are determined by the relative orbit dynamic equations,\nand the weighted matrix Q and R can be determined selectively; the state weighted\nmatrix Q reflects the system dynamic tracking error accumulation in the process of\ncontrol; control weighted matrix R reflects the control energy consumed during the\nwhole control process. Different Q and R determines the different K matrix, also\ndetermines different control performance, so it is necessary to choose the matrix\nQ and R, so as to get K matrix which satisfy the requirement of time and accuracy.\n\nBy adjusting parameters, simulating for many times, and comprehensively\nconsidering fuel consumption and control effect, etc., get the optimal LQR control\nparameter combination as follows:\n\nQ \u00bc\n\n1? 10?3 0 0 0 0 0\n0 1? 10?3 0 0 0 0\n0 0 1? 10?3 0 0 0\n0 0 0 0:1 0 0\n\n0 0 0 0 0:1 0\n\n0 0 0 0 0 0:1\n\n2\n666666664\n\n3\n777777775\n;\n\nR \u00bc 109 ?\n1 0 0\n\n0 1 0\n\n0 0 1\n\n2\n64\n\n3\n75\n\nConsidering influence of various space perturbations, the simulation results are\nshown in Fig. 7.5.\n\nIt can be seen from the figure that the method can control accompanying flying\ntrajectory within \u00b11.5 km. The linear quadratic optimal control is real-time\nclosed-loop feedback control, which executes control in each orbit control period,\nleading to large fuel consumption. An error limit can be designed to solve this\nproblem. It can achieve the purpose of reducing fuel consumption by executing\ncontrol only when the error goes beyond the error limit. Upon simulation, it can be\ncalculated that a total velocity increment of 5.69 m/s is needed for a 10-day\naccompanying flying task.\n\n188 7 Technology of Formation Configuration Maintenance \u2026\n\n\n\n7.3.2 Companying Flying Control Based on Relative Orbit\nElement [11]\n\nAccording to the analysis of relative motion characteristic above, make long-term\ndrift item of direction x as xex, long-term drift item of direction z as zex, and define\nxex \u00bc 1\u00fe e cos hffiffiffiffiffiffiffiffi1?e2p aDM0\u00f0t\u00de, zex \u00bc ? aeffiffiffiffiffiffiffiffi1?e2p sin hDM0\u00f0t\u00de.\n\nSince DM0\u00f0t\u00de \u00bc DM0 t0\u00f0 \u00de\u00feD t ? t0\u00f0 \u00de, so the long-time drift item in DM0\u00f0t\u00de is\nDt \u00bc nb ? n\u00f0 \u00det \u00bc\n\nffiffiffiffi\nl\na3b\n\nq\n? ffiffiffiffila3p\n\n? ?\nt. The drift item in direction x and direction z can\n\nbe simplified as follows\n\nxex \u00bc 1\u00fe e cos hffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np a\nffiffiffiffiffi\nl\n\na3b\n\nr\n?\n\nffiffiffiffiffi\nl\na3\n\nr? ?\nt \u00f07:18\u00de\n\nzex \u00bc ? aeffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np sin h\nffiffiffiffiffi\nl\n\na3b\n\nr\n?\n\nffiffiffiffiffi\nl\na3\n\nr? ?\nt \u00f07:19\u00de\n\nIn an orbital period Tb, the drift item in direction x and direction z is calculated as\nfollows\n\nFig. 7.5 Control method based on LQR\n\n7.3 Control Method of Formation Configuration Maintenance 189\n\n\n\nDxT \u00bc 1\u00fe e cos hffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np a\nffiffiffiffiffi\nl\n\na3b\n\nr\n?\n\nffiffiffiffiffi\nl\na3\n\nr? ?\n2p\nn\n\n\u00bc 1\u00fe e cos hffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np 2p a?\nffiffiffiffiffi\na3b\na\n\nr !\n? ? 1\u00fe e cos hffiffiffiffiffiffiffiffiffiffiffiffiffi\n\n1? e2\np 3pDa\n\n\u00f07:20\u00de\n\nDzT \u00bc ae sin hffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np 3pDa \u00f07:21\u00de\n\nIt can be drawn\n\nDxTae sin h \u00bc DzT 1\u00fe e cos h\u00f0 \u00de \u00f07:22\u00de\n\nIt can be seen from the formula above that only when h = 0\u00b0 and 180\u00b0, adjusting\nthe drift indirection x will not affect the z-axis; however, adjusting the drift in\ndirection z at any time will affect the x direction. Besides, since true anomaly\nchanges quickly near perigee, the direction z will be affected during executing thrust\ncontrol, so the relative motion trajectory diverges easily; however, when h = 180\u00b0,\nsince true anomaly changes slowly near apogee, it can be approximately regarded\nthat the drift in direction z will be little affected during the orbit maneuvering. Thus,\nthe semi-major axis will be adjusted near apogee, with adjusting value in each orbit\nperiod as follows:\n\nDa \u00bc ?\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\nDxT\n\n3p\u00f01? e\u00de \u00f07:23\u00de\n\nBased on the Gauss perturbation equations\n\nda\ndt\n\n\u00bc 2\nn\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np aTe sin h\u00fe aS 1\u00fe e cos h\u00f0 \u00de\u00bd ? \u00f07:24\u00de\n\nwhere aT is radial control acceleration in active spacecraft orbit coordinate system,\naS is control acceleration in velocity direction.\n\nIt can be derived that the velocity increment Dv required by adjusting the\nsemi-major axis Da is.\n\nDvS \u00bc Da n\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\n\n2\u00f01? e\u00de \u00f07:25\u00de\n\nPlug Formula (7.23) into Formula (7.25), the result is as follows.\n\nDvS \u00bc ? n\u00f01\u00fe e\u00de6p\u00f01? e\u00deDxT \u00bc ?\n\u00f01\u00fe e\u00de\n\n3T\u00f01? e\u00deDxT \u00f07:26\u00de\n\n190 7 Technology of Formation Configuration Maintenance \u2026\n\n\n\nAccording to the results of the simulation above, set DxT 100 m in a period, then\nDvS ? 0:00398m/s. Simulation for 10 days, the result is shown in Fig. 7.6.\n\nIt can be seen from the figure that only one semi-major axis adjustment can\ncompensate the model error and control the accompanying flying trajectory within\n\u00b11.7 km with only 0.00398 m/s velocity increment. This control method which\nconducts long-term accompanying flying upon relative orbit elements costs is fuel\nsaving, simple, and easy for engineering application. But compared with the\nclosed-loop control method, this method is stricter for the initial condition of\nentering accompanying flying.\n\nReferences\n\n1. Palmerin G B. Low Altitude Formation Control Using Air Drag [C]. Proceedings of the 3rd\nInternational Workshop on Satellite Constellations and Formation Flying, 2003: 257\u2013262.\n\n2. Lu Shan, Xu Shijie. Satellite Formation Flying Keeping Based on Lyapunov Min-Max\nApproach [J]. Aerospace Control, 2009, 27 (2): 30\u201335.\n\n3. Lu Shan, Xu Shijie. Variable Structure Control of Remote Companying for Satellites [J].\nAerospace Control, 2007, 25 (6): 56\u201361.\n\n4. Yu Ping, Zhang Honghua. Representative Formation-keeping Mode and Control for\nSpacecraft in Eccentric Orbits [J]. Journal of Astronautics, 2005, 1 (26): 7\u201312.\n\nFig. 7.6 Control method based on relative orbit elements\n\n7.3 Control Method of Formation Configuration Maintenance 191\n\n\n\n5. Zhou Wenyong, Yuan Jianping, Luo Jianjun. Design and Control of Long-term Fly around\nTrajectory for Target Spacecraft in Non-coplanar Elliptical Orbit [J]. Chinese Space Science\nand Technology, 2006, 26 (4): 20\u201325.\n\n6. Yang Qinli, Lu Shan, Zhu Sili. Control Law for Station Keeping with Maneuver Target [J].\nAerospace Shanghai, 2014, 31 (3): 11\u201315.\n\n7. Lu Shan, Xu Shijie. Optimal Control Method for Satellite Formation in Elliptical Orbit [J].\nChinese Space Science and Technology, 2008, 28 (1): 18\u201326.\n\n8. Han Chao, Yin Jianfeng. Study of Satellite Relative Motion in Elliptical Orbit Using Relative\nOrbit Elements [J]. Acta Aeronautica et Astronautica Sinica, 2011, 32 (12): 2244\u20132258.\n\n9. Xu Wei, Wu Hailei, Lu Shan, etc. Fly-around, Research on Coupled Control of Spacecraft\nAttitude and Orbit for Final Approach Phase [C]. The 23rd the Chinese Control Conference,\n2013: 2792\u20132799.\n\n10. Duan Guangren. Linear System Theory [M]. Harbin: Harbin Institute of Technology Press,\n2004.\n\n11. Sun Yue, Tian Shaoxiong, Lu Shan, etc. Design and Control Technique for Long-Term Stable\nCompanying Flying on Elliptical Orbit [J]. Aerospace Shanghai, 2016, 33 (1): 42\u201349.\n\n192 7 Technology of Formation Configuration Maintenance \u2026\n\n\n\nChapter 8\nAutonomous Rendezvous Technology\nof Elliptical Orbit\n\n8.1 Introduction\n\nThe orbit rendezvous includes the remote guidance phase, the short-range guidance\nphase, and the final approximation phase. The remote guidance phase is from active\nspacecraft injection to target spacecraft being captured by the relative measurement\nsensor [1], and itmainly adoptsHohmann orbital transfer or Lambert orbital transfer to\nthe vicinity of the target orbit [2, 3]. The short-range guide phase refers to guiding the\nactive spacecraft to the place, which is near the keeping position outside the ren-\ndezvous corridor. The final approximation phase includes the fly-around phase and\nthe translation approximation phase, which provides conditions for spacecraft for\ncompleting the follow-up maneuver and other tasks on orbit [4\u20136]. This chapter\nmainly introduces the short-range guidance phase of elliptical orbit rendezvous.\n\nConventional short-range rendezvous on circular orbit often uses C-W guidance,\nwhich is based on the relative state-transition matrix derived by C-W equation.\nGiving the start time, the rendezvous time and the terminal state, the velocity\nincrement required for the two orbital transfers can be obtained, so proximity\nguidance can be achieved. However, when the spacecraft is operating on the\nelliptical orbit, the angular velocity, angular acceleration, and geocentric distance of\nthe spacecraft are time-varying, which makes the dynamic equation has charac-\nteristics of time-varying and nonlinear, C-W guidance fails, and other guidance law\nbeing frequently used for circular orbit rendezvous is no longer applicable, which\nbrings difficulty to the relative motion control. Therefore, it is necessary to study\nfast rendezvous guidance law that applies to the large elliptical orbit [7].\n\nIn the second section of this chapter, the control method of time-varying non-\nlinear autonomous rendezvous on elliptical orbit will be emphatically introduced.\nFirstly, being based on the orbit control algorithm of linear quadratic Gaussian\n(LQR) optimal control law, aiming at feedback linearized relative orbit dynamic\nmodel of elliptical orbit being derived, LQR control law of autonomous rendezvous\nunder the condition that the absolute orbit information of target spacecraft is known\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7_8\n\n193\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_8&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_8&amp;domain=pdf\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-981-10-7959-7_8&amp;domain=pdf\n\n\nis introduced; that is, using the real-time orbit navigation data to autonomously\ncalculate orbit control amount onboard and make high-precision real-time\nclosed-loop control, thus, independent rendezvous is achieved. Although the\nmethod is of high robustness and high control precision, the control gain will be\ncalculated for each orbit control period, and the requirement of performance of\nspaceborne computer is high. Taking into account the project feasibility, according\nto the large elliptical orbit state-transition matrix, an orbit rendezvous method of\ntwo impulses is introduced. The method which is similar to the C-W guidance of\nthe circular orbit gives the true anomaly that target spacecraft rotates during the\nrendezvous process, and implements the calculated velocity increment at the\nbeginning and the end position; thus, the orbit rendezvous is achieved.\n\nOn the other hand, for most of the relative motion guidance laws of the elliptical\norbit, the absolute orbit information of the active spacecraft itself needs to be\nknown. However, in the engineering practical application, the apogee of satellite on\nthe large elliptical orbit is beyond the GPS coverage, so the GPS navigation fails,\nand when the satellite operating orbit exceeds the monitoring range of the ground\nmonitoring station, the accurate absolute orbit information is not easy to be\nobtained. In order to make HEO spacecraft has rendezvous ability within all air\ndomain, relative navigation can be adopted to obtain the relative position and\nvelocity information between the target spacecraft and the active spacecraft, and\nthen, these relative information can be used to design the autonomous rendezvous\ncontrol law which does not depend on absolute orbit parameters, so as to enhance\nthe applicability of elliptical orbit rendezvous. The large elliptical orbit rendezvous\ncontrol technology lacking absolute orbit information can be used as a backup to\nenhance the redundancy reliability of the GNC system. It can also reduce the\nburden of the ground monitoring station and reduce the dependence on the navi-\ngation star and improve the autonomy of the onboard operation.\n\nIn Sect. 8.3 of this chapter, control method in the case of lacking orbit infor-\nmation for all-sky autonomous rendezvous requirements on the elliptical orbit will\nbe introduced emphatically. Firstly, the fuzzy PD control method is introduced.\nBecause the fuzzy PD controller can continuously adjust the PD control parameters\naccording to the deviation of the system in the dynamic process, it has the\nadvantages of fast response and robustness and can be applied to the design of\nrendezvous control law under the condition that the absolute orbit information is\nuncertain. Then, according to the slow time-varying characteristics of the Lawden\nequation, the relative motion model with uncertain items, which is based on the\ncircular orbit, is established. The spacecraft autonomous rendezvous method based\non the robust sliding mode control under the condition that the large elliptical orbit\nlacks absolute orbit information is introduced. The sliding mode control itself is\nrobust and is not sensitive to the disturbance of unknown parameters, and the\ncontrol law in this book has been added the disturbance parameters into the design\nprocess in advance, so that the robustness is to be stronger. However, the cost is that\nthe method requires the boundaries of the unknown parameters to be known.\nBecause the three unknown parameters of the geocentric distance, the angular\nvelocity, and the angular acceleration on the large elliptical orbit are indeed\n\n194 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nbounded, the boundaries are easily derived. So it does not influence the control law\ndesign, and how the parameters change in the boundary does not influence the\ncontrol effect. The simulation results show that the control law can make the system\nasymptotically stable to the given reference signal.\n\n8.2 Autonomous Rendezvous Optimization Method\n\n8.2.1 Feedback Linearized Dynamic Model of Elliptical\nOrbit\n\nThe relative dynamic model is the basis of the autonomous rendezvous control, and\nimproving the accuracy of the dynamic model is one of the means to improve the\naccuracy of the control method. The exact relative dynamic model of the elliptical\norbit is nonlinear and complex in form, which is difficult to be used to design the\ncontrol law directly. Linear error exists in the simplified Lawden equation, espe-\ncially when the distance between two spacecrafts is long, the error is larger, and the\ncontrol accuracy will be affected.\n\nIn order to solve this problem, the feedback linearization method in the modern\ncontrol theory is adopted to put the nonlinear term of the relative orbit dynamic\nequation into the control input, and the relative orbit dynamics is transformed into\nlinear state equation without any simplification, which facilitates control system\ndesign. In this section, feedback linearization is considered, and then, the process of\nderiving the orbit relative dynamic equation for control is given.\n\nRelative motion equation of two spacecrafts in the inertial coordinate system is\nas follows [8]:\n\nd2\u00f0rc ? rt\u00de\ndt2\n\n\u00bc d\n2Dr\ndt2\n\n\u00bc ? l\nrck k3\n\nrc \u00fe l\nrtk k3\n\nrt \u00fe uc ? ut \u00fe dc ? dt \u00f08:1\u00de\n\nwhere rc is the active spacecraft geocentric distance vector, rt is the target spacecraft\ngeocentric distance vector, uc is the active spacecraft control acceleration vector, ut\nis the target spacecraft control acceleration vector, that is, the target maneuvering\nacceleration, dc is the perturbation acceleration of the active spacecraft, dt is the\nperturbation acceleration of the target spacecraft, and l is the gravitational constant\nof the earth.\n\nThe vector Eq. (8.1) is projected in the target orbit coordinate system So\n\n8.1 Introduction 195\n\n\n\nD\u20acr\u00f0 \u00deSo?\n_h2t\n\n\u20acht 0\n\n?\u20acht _h2t 0\n0 0 0\n\n264\n375 Dr\u00f0 \u00deSo?2 0\n\n_ht 0\n\n? _ht 0 0\n0 0 0\n\n264\n375 D_r\u00f0 \u00deSo\n\n\u00bc ? l\nrck k3\n\nrc\u00f0 \u00deSo \u00fe\nl\n\nrtk k3\nrt\u00f0 \u00deSo \u00fe uc\u00f0 \u00deSo? ut\u00f0 \u00deSo \u00fe dc\u00f0 \u00deSo? dt\u00f0 \u00deSo \u00f08:2\u00de\n\nDefiniens\n\nug \u00bc l\nrck k3\n\nrc\u00f0 \u00deSo?\nl\n\nrtk k3\nrt\u00f0 \u00deSo \u00f08:3\u00de\n\nThen, Formula (8.2) is changed into\n\nD\u20acr\u00f0 \u00deSo?\n_h2t\n\n\u20acht 0\n\n?\u20acht _h2t 0\n0 0 0\n\n264\n375 Dr\u00f0 \u00deSo?2 0\n\n_ht 0\n\n? _ht 0 0\n0 0 0\n\n264\n375 D_r\u00f0 \u00deSo\n\n\u00bc ?ug \u00fe uc\u00f0 \u00deSo? ut\u00f0 \u00deSo \u00fe dc\u00f0 \u00deSo? dt\u00f0 \u00deSo \u00f08:4\u00de\n\nFormula (8.4) is the relative orbit dynamic equation without any simplification.\nIn order to facilitate the design of the orbit control algorithm, it is transformed into a\nstate-space form.\n\nAdd and subtract the following term on the right side of the equation\n\nuG \u00bc\n2l\nr3t\n\n0 0\n\n0 ?lr3t 0\n0 0 ?lr3t\n\n264\n375 Dr\u00f0 \u00deSo \u00f08:5\u00de\n\nGet the following form:\n\nD\u20acr\u00f0 \u00deSo \u00bc\n\n_h2t \u00fe 2lr3t\n\u20acht 0\n\n?\u20acht _h2t ? lr3t 0\n0 0 ? lr3t\n\n26664\n37775 Dr\u00f0 \u00deSo \u00fe 2\n\n0 _ht 0\n\n? _ht 0 0\n0 0 0\n\n264\n375 D_r\u00f0 \u00deSo\n\n? ug ? uG \u00fe uc\u00f0 \u00deSo? ut\u00f0 \u00deSo \u00fe dc\u00f0 \u00deSo? dt\u00f0 \u00deSo \u00f08:6\u00de\n\n196 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nRecord the state variable as\n\nX \u00bc Dr\nD_r\n\n !\nSo\n\n\u00bc\n\nx\n\ny\n\nx\n\nvx\nvy\nvz\n\n26666666664\n\n37777777775\n\u00f08:7\u00de\n\nAnd\n\nu \u00bc ?ug ? uG \u00fe uc\u00f0 \u00deSo? ut\u00f0 \u00deSo \u00fe dc\u00f0 \u00deSo? dt\u00f0 \u00deSo \u00f08:8\u00de\n\nwhere x, y, z are the components of the relative position of the two spacecrafts in the\ntarget orbit coordinate system, and vx, vy, vz are the components of the relative\nvelocity of the two spacecrafts in the target orbit coordinate system.\n\nThen, the Formula (8.6) can be transformed into the form of state space as\nfollows:\n\n_X \u00bc A\u00f0t\u00deX\u00feBu \u00f08:9\u00de\n\nwhere\n\nA\u00f0t\u00de \u00bc\n\n0 0 0 1 0 0\n0 0 0 0 1 0\n0 0 0 0 0 1\n\n2l\nr3t\n\n\u00fe _h2 \u20ach 0 0 2 _h 0\n?\u20ach ? lr3t \u00fe\n\n_h2 0 ?2 _h 0 0\n0 0 ? lr3t 0 0 0\n\n266666664\n\n377777775\n\u00f08:10\u00de\n\nB \u00bc\n\n0 0 0\n0 0 0\n0 0 0\n1 0 0\n0 1 0\n0 0 1\n\n26666664\n\n37777775 \u00f08:11\u00de\n\nIt can be seen that the state-space equation is a linear time-varying system and is\nexactly the same as the form of the Lawden equation. This is due to the addition and\nsubtraction of uG term on the right side of the equation. In fact, this equation is the\nresult of first-order linearization of the difference uG between two spacecrafts\u2019\ncenter gravitational acceleration in the Lawden equation.\n\n8.2 Autonomous Rendezvous Optimization Method 197\n\n\n\nIn this way, the final relative orbit dynamics can be transformed into a linear\nequation, which can be designed according to the conventional linear system reg-\nulator theory. At the same time, the control system precision can be improved\nbecause the equation is derived without any simplification.\n\n8.2.2 Optimal Control of Linear Quadratic Regulator\n\n1. LQR control law design\n\nSeveral principles are mainly considered in the design of the orbit control law:\nFirst, autonomy, that is, control can be realized autonomously onboard. Second,\nreal time, requires control law to be simple and the calculation volume to be small.\nThird, the propellant consumption must be small to achieve the optimal or sub-\noptimal control. Based on the above principles, the orbit control law based on linear\nquadratic Gaussian optimal control is adopted.\n\nLinear quadratic optimal control is a real-time closed-loop control method,\nwhich feeds back error to the system input in real time, so as to achieve the purpose\nof improving the control accuracy. It has a certain degree of robustness. It can be\nseen from the performance index function that it is a control method based on\nprocess state optimal and fuel optimal. Since linear quadratic optimal control has\nmany advantages, it can be used in orbit control.\n\nFor the linear time-varying system in Formula (8.9), the optimal control input\nu(t) is sought so that the terminal state of the control system satisfies the constraint\ncondition. The terminal control problem is usually transformed into the optimiza-\ntion problem of the following quadratic performance index [9], which is\n\nJ \u00bc 1\n2\n\nZtf\nt0\n\nxT\u00f0t\u00deQx\u00f0t\u00de\u00fe uT\u00f0t\u00deRu\u00f0t\u00de? ?dt\u00fe 1\n2\nxT\u00f0tf\u00deQ0x\u00f0tf\u00de minu J \u00f08:12\u00de\n\nwhere Q, R, Q0 is the performance index weight matrix, Q is n ? n-dimensional\npositive semi-definite state weighting matrix, R is r ? r-dimensional positive\ndefinite control weight matrix, and Q0 is n ? n-dimensional semi-definite terminal\nstate weight matrix.\n\nThe quadratic optimal state regulator of the linear system is\n\nu\u00f0t\u00de \u00bc K\u00f0t\u00deX\u00f0t\u00de \u00f08:13\u00de\n\nK\u00f0t\u00de \u00bc ?R?1B\u00f0t\u00deTP\u00f0t\u00de \u00f08:14\u00de\n\nwhere P\u00f0t\u00de is a symmetric nonnegative matrix that satisfies the following Riccati\nmatrix differential equation, i.e.,\n\n198 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\n? _P\u00f0t\u00de \u00bc P\u00f0t\u00deA\u00f0t\u00de\u00feAT\u00f0t\u00deP\u00f0t\u00de ? P\u00f0t\u00deB\u00f0t\u00deR?1BT\u00f0t\u00deP\u00f0t\u00de\u00feQ \u00f08:15\u00de\n\nThe geocentric distance and the angular velocity of the elliptical orbit have the\ncharacteristic of time-varying. The system matrix A of the state equation is a\nfunction of the geocentric distance, angular velocity, and angular acceleration, and\nhence, A is time-varying, so the feedback gain matrix K is also time-varying.\nA orbit control period T can be designed, and K can be calculated once for each\nperiod. In order to ensure the control accuracy, T cannot be too big, so the simu-\nlation example in this book selected T = 0.4 s. Therefore, according to the above\nformula, state feedback gain matrix K(t) corresponding to each orbit control time\ncan be obtained.\n\n2. The linear quadratic control realization\n\nThe calculated control amount is on the target spacecraft orbit coordinate system,\nwhich needs to be converted to the active spacecraft body coordinate system. Since\nthe control force is provided by the thruster, it is necessary to convert the calculated\ncontrol acceleration into the thruster\u2019s jet time as follows:\n\nt \u00bc maT\nF\n\n\u00f08:16\u00de\n\nwhere m is the mass of active spacecraft, a is the calculated acceleration, T is the\norbit control period, and F is the thrust of the thruster. The jet time cannot be longer\nthan one orbit control period, so the output of the jet time must be limited, and the\njet time must not be less than the minimum pulse width of the engine.\n\nDue to the large change of the perigee velocity, the active spacecraft has a\ntendency to be far away from the target without control, the rendezvous time is\nlong, and the fuel consumption is large. At the apogee, spacecraft operating velocity\nchanges slowly, so rendezvous time is short and fuel consumption is small. It\nshould be selected to start short-range rendezvous when the remote guidance is just\nended; i.e., the target spacecraft is near the apogee.\n\n3. LQR control parameters\u2019 design\n\nThree parameters Q, R, and Q0 need to be designed in LQR control, and then,\nthe optimal control input feedback gain matrix K can be obtained.\n\nIt can be seen from the derivation of the previous section that the value of the\nmatrix K depends on the A, B of the state equation and the Q, R, and Q0 of the\nobjective function, where A, B is determined by the relative orbit dynamic equation,\nand the weighting matrix Q, R is determined by selection. The state-weighted\nmatrix Q reflects the accumulation of dynamic tracking errors in the control pro-\ncess, and the control weighted matrix R reflects the control energy consumed\nthroughout the control process. Different Q, R determine the different matrix K and\nalso determine the different control performance, so it is necessary to select the\narray matrix Q, R to get the matrix K that satisfies the time and accuracy\nrequirements.\n\n8.2 Autonomous Rendezvous Optimization Method 199\n\n\n\nIn the process of adjusting Q, R, there exists the following relationship:\n\n(1) Q unchanges, R increases, then in the control process, the control input\nbecomes smaller, and the control error is relatively larger. R unchanges,\nR increases, then in the control process, the control error becomes smaller, and\nthe control input becomes larger.\n\n(2) If Q, R increase at the same rate, K keep the same.\n\n4. Simulation analysis\n\nChoose the target spacecraft\u2019s orbit initial value given in Table 8.1.\nInitial relative distance and velocity of target spacecraft and active spacecraft in\n\nthe second orbit coordinate system of the active spacecraft are as follows\n\nR0 \u00bc 10 ?1 ?1 0\u00bd ?T km\nV0 \u00bc 1 ?1 ?1\u00bd ?T m/s\n\n?\nTerminal relative position and velocity required are\n\nRf \u00bc 100 0 0\u00bd ?T m\nVf \u00bc 0 0 0\u00bd ?T m/s\n\n?\nAssuming that the absolute navigation position theory accuracy is 1500 m,\n\nengineering application actual accuracy is about 3000 m, relative navigation\nposition accuracy is 15 m, and relative velocity measurement accuracy is 0.2 m/s.\nIn the simulation, 10% of the engine theory thrust is added as random noise into the\nactual thrust magnitude, and the minimum engine start time is set to 0.03 s.\n\nBy adjusting the parameters many times for simulations, the LQR control\noptimal parameter combination is as follows:\n\nQ \u00bc\n\n1? 10?4 0 0 0 0 0\n0 1? 10?4 0 0 0 0\n0 0 1? 10?4 0 0 0\n0 0 0 30 0 0\n0 0 0 0 20 0\n0 0 0 0 0 20\n\n26666664\n\n37777775\nR \u00bc 106 ?\n\n1 0 0\n0 0:5 0\n0 0 1\n\n24 35\nThe simulation step is 0.2 s, and the orbit control period is 0.4 s. The simulation\n\nresults are shown in Fig. 8.1 (Table 8.2).\n\nTable 8.1 Orbit initial value\nof target spacecraft\n\na (km) e i (\u00b0) X (\u00b0) x (\u00b0) h (\u00b0)\n\n22,175 0.7 60 60 30 180\n\n200 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nFig. 8.1 Relative position and velocity\n\nTable 8.2 Rendezvous result analysis of LQR control\n\nAxis x y z\n\nStability time (s) 2500 1500 3000\n\nFuel consumption (m/s) 22.0 3.4 20.7\n\n8.2 Autonomous Rendezvous Optimization Method 201\n\n\n\nIt can be seen from the table that short-range rendezvous can be completed in\n3000 s, and total fuel consumption is 46.1 m/s.\n\nIn order to further analyze the control precision of the algorithm, after the active\nspacecraft reaches the designated rendezvous position, the real-time closed-loop\norbit control will be carried out to realize the fixed-point flight. Begin rendezvous at\nthe apogee, and analyze the change of control accuracy after arriving rendezvous\ntime. Simulation results are shown in Fig. 8.2.\n\nFig. 8.2 Zoom in of relative position and velocity\n\n202 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nThe relative position error of the three axes after the apogee rendezvous is 4, 20,\nand 12 m. When operating for half orbit period, in the vicinity of the perigee, the\nrelative motion trend changes drastically and the position error reaches 13, 20, and\n45 m. After about 5000 s, it resumes stable state, and error is controlled in the\nallowed range.\n\n5. Linear quadratic control method conclusion\n\nBy using the feedback linearized relative orbit dynamic model, the LQR control law\nof the autonomous rendezvous can be used in the case that the absolute orbit\ninformation of the target spacecraft is known. After the mathematical simulation of\nthe LQR closed-loop orbit control law, it is proved that it has the advantages of\nsimple algorithm, strong robustness, high control precision, low fuel consumption,\nand so on. In addition, by inputting different simulation conditions, the following\nconclusions can be drawn:\n\n(1) Taking two indexes of the rendezvous time and fuel consumption into account,\nit should be selected to start short-range rendezvous when the remote guidance\nis just ended; i.e., the target spacecraft is near the apogee.\n\n(2) When the target spacecraft operates near the perigee, the relative position error\nof the two directions in the orbit plane increases sharply and the normal\ndirection variation of the orbit is small, which shows it is difficult for active\nspacecraft to make rendezvous with the target spacecraft near the perigee, and it\nis also advisable to rendezvous with the target spacecraft at the apogee from the\npoint of control accuracy.\n\n8.2.3 Double-Pulse Control Based on T-H Equation\n\n1. T-H equation of elliptical orbit\n\nThe T-H equation in the spacecraft orbit coordinate system is deduced in Sect. 3.2.1,\nwhich can be used to describe the relative orbit motion under any eccentricity.\nHowever, the double-pulse control method of autonomous rendezvous introduced in\nthis section needs to be established in the spacecraft body coordinate system, which\nis easy to solve the velocity increment. After the coordinate transformation, the T-H\nequation expression becomes\n\nX0\u00f0h\u00de \u00bc Urr\u00f0h\u00de Urv\u00f0h\u00de\nUvr\u00f0h\u00de Uvv\u00f0h\u00de\n? ?\n\nX\u00f0h\u00de\u00feBu\u00f0h\u00de \u00f08:17\u00de\n\n8.2 Autonomous Rendezvous Optimization Method 203\n\n\n\nwhere\n\nUrr\u00f0h\u00de \u00bc\n0 0 0\n\n0 0 0\n\n0 0 0\n\n264\n375; Urv\u00f0h\u00de \u00bc 1 0 00 1 0\n\n0 0 1\n\n264\n375; Uvr\u00f0h\u00de \u00bc\n\n3\u00fe e cos h\n1\u00fe e cos h\n\n?2e sin h\n1\u00fe e cos h 0\n\n2e sin h\n1\u00fe e cos h\n\ne cos h\n1\u00fe e cos h 0\n\n0 0 ?11\u00fe e cos h\n\n264\n375\n\nUvv\u00f0h\u00de \u00bc\n2e cos h\n\n1\u00fe e cos h 2 0\n\n?2 2e sin h1\u00fe e cos h 0\n0 0 2e sin h1\u00fe e cos h\n\n2664\n3775; B\u00f0h\u00de \u00bc \u00f01? e2\u00de3\u00f01? e cos h\u00de4n2\n\n0 0 0\n\n0 0 0\n\n0 0 0\n\n1 0 0\n\n0 1 0\n\n0 0 1\n\n2666666664\n\n3777777775\n\nFormula (8.17) is T-H equation based on the true anomaly domain [10], which\ncan be used to describe the relative orbit dynamic equation for any eccentricity.\n\n2. Relative state-transition matrix of elliptical orbit\n\nFor easy writing, record s = sin(h), c = cos(h), q = q(h) = (1 + ecos(h)),\ns0 = sin(h0), c0 = cos(h0), q0 = q(h0) = (1 + ecos(h0)). Analytic solution of\nFormula (8.17) is [11]\n\nx\u00f0h\u00de \u00bc s\u00f0d1e\u00fe 2d2e2H\u00f0h\u00de\u00de ? c\u00f0d2eq2 \u00fe d3\u00de\ny\u00f0h\u00de \u00bc \u00f0d1 \u00fe d4q \u00fe 2d2eH\u00f0h\u00de\u00de\u00fe s\u00f0d3q \u00fe d3\u00de\u00fe c\u00f0d1e\u00fe 2d2e2H\u00f0h\u00de\u00de\nz\u00f0h\u00de \u00bc s d5q \u00fe c d6q\n\n8><>: \u00f08:18\u00de\nTake a derivative to the above formula\n\n_x\u00f0h\u00de \u00bc c\u00f0d1e\u00fe 2d2e2H\u00f0h\u00de\u00de\u00fe 2sd2e2 _H\u00f0h\u00de\u00fe s\u00f0d2eq2 \u00fe d3\u00de ? c d2e\n2s\n\nq3\n\n_y\u00f0h\u00de \u00bc \u00f0d4esq2 \u00fe 2d2e _H\u00f0h\u00de\u00de\u00fe d3c 1\u00fe qq \u00fe d3es\n2\n\nq2 ? s\u00f0d1e\u00fe 2d2e2H\u00f0h\u00de\u00de\u00fe 2d2e2c _H\u00f0h\u00de\n_z\u00f0h\u00de \u00bc d5\u00f0e\u00fe c\u00deq2 ? d6sq2\n\n8>><>>:\n\u00f08:19\u00de\n\nwhere di is the integral constant and is related to the initial condition. H\u00f0h\u00de is the\nnon-periodic term and is the main factor causing non-periodic relative motion. The\nexpression is as follows:\n\nH\u00f0h\u00de \u00bc\nZh\nh0\n\nc\nq3\ndf\n\n\u00bc ?\u00f01? e2\u00de?5=2 3Ee\n2\n\n? \u00f01\u00fe e2\u00de sinE\u00fe e\n2\nsinE cosE\u00fe dH\n\n? ?\n\u00f08:20\u00de\n\n204 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nwhere E is the mean anomaly. dH is the integral constant calculated by H\u00f0h0\u00de \u00bc 0:\nFormulas (8.18) and (8.19) are used to describe the natural relative motion tra-\njectory and the relative velocity expression of the two spacecrafts in the case of any\neccentricity.\n\nThe relationship between X(h) = [x(h), y(h), z(h), x?(h), y?(h), z?(h)]T and\nD = [d1, d2, d3, d4, d5, d6]\n\nT can be obtained from the Formulas (8.18) and (8.19) as\nX(h) = U(h)D. Since the basic solution matrix U(h) is reversible, then\nD = U(h0)\n\n?1X(h0). The state-transition equation X(h) = U(h)U(h0)\n?1X(h0) is\n\nobtained, and the state-transition matrix is U(h0, h) = U(h)U(h0)\n?1. The expression\n\nof U(h) and U(h0) are as follows [12], but U(h0, h) are not listed below.\n\nU\u00f0h\u00de \u00bc\n\nes 2se2H ? ce=q2 ?c 0 0 0\nq 2eH\u00fe 2e2cH s=q\u00fe s 1=q 0 0\n0 0 0 0 s=q c=q\n\nec 2e2cH\u00fe 2se2 _H ? ce2s=q3 \u00fe se=q2 s 0 0 0\n?se 2e _H ? 2e2sH\u00fe 2e2c _H c\u00f01\u00fe q\u00de=q\u00fe es2=q2 es=q2 0 0\n0 0 0 0 \u00f0e\u00fe c\u00de=q2 ?s=q2\n\n2666666664\n\n3777777775\n\nU h0\u00f0 \u00de \u00bc\n\nes0 ?c0e=q20 ?c0 0 0 0\nq0 0 s0=q0 \u00fe s0 1=q0 0 0\n0 0 0 0 s0=q0 c0=q0\nec0 2s0e2 _H0 ? c0e2s0=q30 \u00fe s0e=q20 s0 0 0 0\n?es0 2e _H0\u00fe 2e2c0 _H0 c0\u00f01\u00fe q0\u00de=q0 \u00fe es20=q20 es0=q20 0 0\n0 0 0 0 \u00f0e\u00fe c0\u00de=q20 ?s0=q20\n\n2666666664\n\n3777777775\n\nAccording to the solution U(h0, h), we can get the relative motion state of the\ntwo spacecrafts when the target spacecraft is at any true anomaly:\n\nr\u00f0h\u00de\nv\u00f0h\u00de\n? ?\n\n\u00bc U\u00f0h0; h\u00de \u00bc Urr UrvUvr Uvv\n? ?\n\nr\u00f0h0\u00de\nv\u00f0h0\u00de\n? ?\n\n\u00f08:21\u00de\n\n3. Double-pulse rendezvous for any eccentricity orbit\n\nC-W guidance is double-pulse rendezvous method applied to the near-circular\norbit, which is achieved as follows:\n\nThe initial relative state quantity r0; v0 , and the terminal state quantity rf ; vf are\ngiven. The terminal position deviation is eliminated by applying a pulse Dv1 at the\ninitial point, after the time Dt to reach the terminal position, and the terminal\nvelocity deviation is eliminated by applying a second pulse Dv2 at the terminal. The\ntwo velocity increments are solved as follows [13]\n\nrf\nvf?\n\n? ?\n\u00bc rf\n\nvf ? Dv2\n\n? ?\n\u00bc Urr Urv\n\nUvr Uvv\n\n? ?\nr0\n\nv0 \u00feDv1\n\n? ?\n\u00f08:22\u00de\n\n8.2 Autonomous Rendezvous Optimization Method 205\n\n\n\nTwo-impulse rendezvous solution can be obtained by solving the above equation\n\nDv1 \u00bc U?1rv \u00f0rf ?Urrr0\u00de ? v0\nDv2 \u00bc vf ?Uvrr0 ?Uvv\u00f0v0 \u00feDv1\u00de\n\n?\n\u00f08:23\u00de\n\nC-W guidance is no longer applicable to the target spacecraft operating on the\nlarge-eccentricity orbit, but a method similar to C-W guidance can be obtained\naccording to the relative state-transition formula derived in the true anomaly\ndomain in the above section. Since the coordinate system is established on the orbit\ncoordinate system of the active spacecraft, the solution of the velocity increment\nbecomes as\n\nrf\nvf?\n\n? ?\n\u00bc rf\n\nvf \u00feDv2\n? ?\n\n\u00bc Urr Urv\nUvr Uvv\n\n? ?\nr0\n\nv0 ? Dv1\n? ?\n\n\u00f08:24\u00de\n\nThe two impulses are (v0; vf is the relative position differential to the true\nanomaly, paying attention to the conversion of the differential to the time)\n\nDv1 \u00bc ?U?1rv \u00f0rf ?Urrr0\u00de ? _h0 \u00fe v0\nDv2 \u00bc ?vf \u00fe\u00f0Uvrr0 \u00feUvv\u00f0v0 ? Dv1\u00de= _h0\u00de ? _hf\n\n?\n\u00f08:25\u00de\n\n4. Simulation analysis\n\nThe rendezvous position is chosen at the apogee, which is due to the approximation\nof the gravitational force in the establishment of the linear differential equation,\nwhich leads to linearization errors. In the same time process, the angles rotated by\nthe two spacecrafts during perigee rendezvous are large, and the accumulation error\nis even larger.\n\nThe initial values of the selected target orbit are listed in Table 8.3.\nThe initial distance and velocity of the target spacecraft relative to the active\n\nspacecraft are in the second orbit coordinate system of the active spacecraft\n\nR0 \u00bc 1 ?1 ?1\u00bd ?T km\nV0 \u00bc 1 ?1 ?1\u00bd ?T m=s\n\nTerminal relative position and velocity required are\n\nRf \u00bc 100 0 0\u00bd ?T m\nVf \u00bc 0 0 0\u00bd ?T m=s\n\nTable 8.3 Orbit initial value of target spacecraft\n\na/km e i/(\u00b0) X/(\u00b0) x/(\u00b0) h/(\u00b0)\n\n22175 0.7 60 60 30 180\n\n206 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nAssume that relative navigation position accuracy is 15 m, and relative velocity\nmeasurement accuracy is 0.2 m/s. Output thrust is 490 N, and active spacecraft\u2019s\nmass is 2800 kg. Set the rendezvous time to be 812 s, because the orbit angular\nvelocity near the apogee is very low, and the active spacecraft only rotates by 2.2\u00b0\nof the true anomaly; that is, when the rendezvous happened, the active spacecraft\u2019s\ntrue anomaly is 182.2\u00b0. The simulation result of the relative position and velocity\ncurve is shown in Fig. 8.3.\n\nFig. 8.3 Relative position and velocity\n\n8.2 Autonomous Rendezvous Optimization Method 207\n\n\n\nThe first velocity increment is [2.1 ?2.17 ?2.14]T m/s at the starting point, the\nsecond velocity increment at the terminal is [?1.01 1.18 1.25]T m/s, and the total\nfuel consumption is 5.7 m/s. The terminal position error is [?10 7 8]T m.\n\nThe fuel consumption of the double-pulse control method is significantly\nreduced compared to real-time closed-loop control. If it needs to further improve\nthe accuracy, middle or terminal correction method can be used, but the corre-\nsponding fuel consumption will increase. Therefore, in practical application, it is\nnecessary to take a variety of engineering constraints into consideration, and select\nthe corresponding rendezvous and docking method according to the optimization\nrequirements of comprehensive indexes.\n\n8.3 Autonomous Rendezvous Method in Case\nof Lacking Orbit Information\n\nThe elliptical orbit rendezvous and docking method introduced in the previous\nsection requires the active spacecraft to know its own orbit information in real time,\nand solve the control law by calculating the corresponding orbit parameters.\nConsidering when the spacecraft on the large elliptical orbit operating at the middle\nand high orbit, being affected by visibility constraints of navigation star, constraints\nof ground station, and long-term orbit recursive error, the orbit parameters may not\nbe known in real time precisely. Therefore, an autonomous rendezvous control law\nthat is suitable for elliptical orbit and not relied on the orbital parameters needs to be\nfound as an effective complement to the existing rendezvous method.\n\n8.3.1 Fuzzy PD Control\n\n1. PD controller parameters\u2019 design\n\nWith advantages, such as simple structure, good stability, reliable work, and easy\nadjustment, PD controller becomes one of the main technologies in industrial\ncontrol. When the structure and parameters of the controlled object cannot be fully\ngrasped and the precise mathematical model cannot be obtained, it is most con-\nvenient to adopt PD control technology. PD control is the earliest and most widely\nused control method in the field of automatic control.\n\nSimplified design of the satellite orbit PD controller schematic diagram is shown\nin Fig. 8.4.\n\nIts open-loop transfer function can be derived from the above figure\n\nG\u00f0s\u00de \u00bc KP \u00feKDs\ns2\n\n\u00f08:26\u00de\n\n208 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nThe characteristic equation of the second-order system can be obtained from\nFormula (8.26) as follows\n\ns2 \u00feKDs\u00feKP \u00bc 0 \u00f08:27\u00de\n\nThe characteristic equation of the standard second-order system is given as\n\ns2 \u00fe 2nxns\u00fex2n \u00bc 0 \u00f08:28\u00de\n\nComparing the characteristic equation of the standard second-order system with\nFormula (8.27), the resulting values KP KD are\n\nKP \u00bc x2n; KD \u00bc 2? n? xn \u00f08:29\u00de\n\nwhere xn is system bandwidth.\n\n2. Fuzzy control principle\n\nFuzzy control has the following characteristics:\n\n(1) It is a nonlinear control method of wide operating range and wide application\nfield, which is especially suitable for nonlinear system control.\n\n(2) It does not depend on the mathematical model of the object. For the complex\nobjects that cannot be modeled or are difficult to be modeled, it can use human\nexperience or other methods to design fuzzy controller to complete the control\ntask; however, the traditional control method can design the controller only by\nknowing the mathematical model of the controlled object.\n\n(3) It has a strong robustness and is not sensitive to the characteristics\u2019 change of\nthe controlled object.\n\n(4) The algorithm is simple, fast to be implemented, and easy to be realized.\n\nWith these advantages, fuzzy control is considered to be used to achieve\nautonomous rendezvous in the case of lacking absolute orbit information; that is,\nthe controlled object cannot be properly modeled.\n\na\npK\n\nv\n\n1\ns\n\nDK\n? ?\n\nea\n1\ns\n\nsa\n\nFig. 8.4 PD control principle\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 209\n\n\n\nThe deterministic mathematical model is often used to describe things with clear\ncertainty, distinct boundaries, and clear relationships. Such things can be described\nwith precise mathematical functions, and the typical representative of the discipline\nis \u201cmathematical analysis,\u201d \u201cdifferential equation,\u201d \u201cmatrix analysis,\u201d and other\ncommonly used important branches of mathematics. The ambiguity mathematical\nmodel is suitable for describing things of unclear meaning and unclear concept\nboundaries, and its denotation is unclear and is not clear in the ascription of the\nconcept [14].\n\nWe know that set are the ones that have some common attributes and can be\ndistinguished from each other. The things that make up a collection are called\nelements, and the relationship between the elements of the classical set and the set is\nwhether it belongs to or not. The fuzzy set is the extension of the classical\ncollection, whether the thing that belongs to the concept it describes cannot be\ndistinguished by \u201cyes\u201d or \u201cno.\u201d There is no obvious boundary between belongings\nand not belonging. Belonging means \u201cbelonging\u201d in a certain extent, which cannot\nbe described by a classical set, but can only be described by a fuzzy set.\n\nThe mapping of classical set and fuzzy set on the number axis, that is, their\neigenfunctions or membership functions, can be visually drawn in Fig. 8.5. The A of\nthe left-side figure is a fuzzy set, and the A of the right-side figure is a classic set.\n\nGiving universe U (for all objects discussed), any of the mapping from U to\n[0, 1] is\n\nlA : U ! \u00bd0; 1?; u ! lA\u00f0u\u00de\n\nFuzzy subset A of U is determined, where lA(u) is called the membership\nfunction of the fuzzy subset, called membership of u for U. In other words, the\nfuzzy subset A on the universe u is characterized by the membership function lA(u).\nlA(u) is the range of [0, 1], and the size of lA(u) reflects the subordinate level of\nu for the A. Correctly determining membership function is the basis of using fuzzy\nset to solve practical problems.\n\nU\n\nA\n\nU\n\nA\nA(x)\n\n(a) Fuzzy set (b) Classic set0\n\n1\n\nFig. 8.5 Comparison of mapping of fuzzy set and classic set\n\n210 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nThe fuzzy controller is the core of the fuzzy control system, which generally\ntakes error and the error change rate of the system as the input, and control quantity\nof the controlled object as the output. The specific design method is as follows.\n\n1) The fuzzification of exact amount\n\nSelect (E, EC) as the fuzzy language variable of deviation e and the rate of devi-\nation change ec, and transform precise quantity (such as the deviation e and the rate\nof deviation change ec) into the corresponding fuzzy quantity (E, EC). The actual\nchange range of deviation and deviation change rate is called the basic universe of\nthese variables, which are recorded as [?xe, xe] and [?xec, xec]. According to the\nbasic universe of e, ec, we set the universe of E and EC to determine the quanti-\nzation factors Ke and Kc. Set the universe of deviation is\n\nx \u00bc \u00bd?n;?n\u00fe 1; . . .; 0; . . .; n? 1; n?\n\nwhere x is the exact amount of the error, generally taking n = 6 or 7. The quan-\ntization factor Ke is defined by the quantization factor universe transition\n\nKe \u00bc n=xe\nThe same for the error change rate, if its universe is\n\nx \u00bc \u00bd?m;?m\u00fe 1; . . .; 0; . . .;m? 1;m?\n\nThen, the quantization factor of the error change rate is\n\nKc \u00bc m=xec\n\n2) Fuzzy division of input and output spaces\n\nThe premised linguistic variables in the fuzzy control rules constitute the fuzzy\ninput space, and the linguistic variables of the conclusion constitute the fuzzy\noutput space. The value of each language variable is a set of fuzzy language names,\nwhich constitute the set of language names. Each language name corresponds to a\nfuzzy set, and for each language name, the fuzzy set of its values has the same\nuniverse. The values of each language variable of E, EC, and U are positive large\nPL, positive middle PM, positive small PS, zero Z, negative small NS, negative\nmiddle NM, negative large NL, and set membership function their respective fuzzy\nsubsets on the universe. The more fuzzy state variables are defined, the better the\ncontrol effect is, but the fuzzier rules that need to be defined, the more complex the\ndesign and calculation are.\n\n3) Control rules for fuzzy controllers\n\nAccording to the two kinds of fuzzy models described above, the rules are estab-\nlished separately.\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 211\n\n\n\n(1) Mamdani fuzzy model\n\nThe Mamdani fuzzy model is a linguistic model. The fuzzy logic system con-\nstructed by the Mamdani model is essentially a set of IF-THEN rules. In this set of\nrules, the front variable and the latter variable are fuzzy sets, and this form is used in\nthe most of the existing fuzzy control systems. The expression of its fuzzy rule is as\nfollows:\n\nIf A \u00bc PB and B \u00bc PB and C \u00bc PM thenD \u00bc PS\nIf A \u00bc PB and B \u00bc PM and C \u00bc PM thenD \u00bc PS\n..\n.\n\n(2) Takagi\u2013Sugeno fuzzy model\n\nThis model is also based on the IF-THEN rule, where the front variable contains\nfuzzy language values and the latter is a function of the front variable, which is used\nfor identification and is rarely used for control. The expression of the fuzzy rule is:\n\nIf A \u00bc PB and B \u00bc PB and C \u00bc PM then D \u00bc f\u00f0A; B; C\u00de\n\nMamdani fuzzy model is used to set control rules in this book.\n\n4) Fuzzy reasoning\n\nFuzzy reasoning is also called fuzzy decision, whose process is conducting the\nfuzzy reasoning by the fuzzy control strategy table (fuzzy control rule table), which\nis designed according to the summarized artificial operation strategy, and obtaining\nthe output fuzzy variable via input fuzzy variable. There are two kinds of com-\nmonly used fuzzy reasoning methods, maximum\u2013minimum reasoning and maxi-\nmum product reasoning.\n\n5) The defuzzification of output\n\nThe progress of transforming the reasoning result (U) from fuzzy mount to the exact\namount (u) that can be used for actual control is called \u201cdefuzzification.\u201d The main\ndefuzzifiers have the following three methods:\n\n(1) The maximum value defuzzifier: Select the universe elements of the largest\nmembership as the fuzzy results.\nThe advantage of this method is simple, and the disadvantage is that the amount\nof summarized information is very small, because this method ruled out the\ninfluence and role of other members of the smaller membership.\n\n(2) The gravity center defuzzifier: The output is the center of the area covered by\nthe membership function. The advantage of the gravity center defuzzifier is that\nit is intuitive and reasonable. The disadvantage is that its computational\nrequirements are high.\n\n212 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\n(3) Center mean defuzzifier: The output is the weighted average of all fuzzy sets,\nand its weight is equal to the height of the corresponding fuzzy set. Its exe-\ncution amount u is determined by:\n\nu \u00bc Rl\u00f0ui\u00deui\nRl\u00f0ui\u00de\n\nThe central mean defuzzifier is the most commonly used defuzzifier in fuzzy\nsystems and fuzzy control. It is simple to calculate, intuitive, and reasonable, and\nthe book focuses on the \u201ccentral mean defuzzifier.\u201d Obtain the fuzzy controller\noutput by solving fuzzy formula, and complete the fuzzy control.\n\nFinally, the amount of control added to the controlled process should be the\nproduct of the defuzzification result u and the scale factor Ku.\n\nFuzzy controller schematic diagram is shown in Fig. 8.6.\n\n3. Fuzzy PD controller design\n\nThe advantage of fuzzy control is that it does not need the precise mathematical\nmodel of the controlled object; the second is the fast control speed and good\nrobustness. Fuzzy control itself has the forecast function, which is the most valuable\ncompared to other control methods. However, the control accuracy of fuzzy control\nis not high, which is mainly due to the steady-state error of fuzzy control and the\nproblem of zero limit ring oscillation. This defect directly restricts its application in\nhigh-precision control field.\n\nThe main problem of traditional PD control is the parameter adjusting problem.\nOnce the calculation is completed, it is fixed in the whole control process. In the\nactual system, because uncertainty occurs in state and parameter when the system\nstate and parameters change, the system is difficult to achieve the best control effect.\n\nFuzzy PD control is the combination of fuzzy control and traditional PD control.\nMaking use of the current control deviation, combining with the change of dynamic\n\nr e\nde/dt ec\n\nke\n\nFuzzification\n\nEC\n\nE\n\nkec Fuzzy\ncontrol\n\nrule\n\nU Fuzzy\nsentence\n\nku\n\nu Control\nobject\n\ny\n\nFuzzy controller\n\n+\n-\n\nFig. 8.6 Fuzzy control principle\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 213\n\n\n\ncharacteristics of the controlled process and the practical experience of the specific\nprocess, we can adjust and optimize the two parameters of the PD controller in real\ntime by fuzzy reasoning rules according to certain control requirements or objective\nfunction, so as to achieve the ideal control effect, which has good adaptability to the\nsystem parameter change.\n\nPD controller can achieve precise control effect, but the adjustment speed is not\nfast. Fuzzy controller is on the contrary that it can do a quick adjustment, but the\ncontrol accuracy is poor. Fuzzy PD controller can not only achieve faster adjust-\nment speed, but also achieve the effect of precise control.\n\nFuzzy PD control includes a number of important components, such as\nparameter fuzzification, fuzzy rule reasoning, parameter defuzzification, PD con-\ntroller. The computer calculates the deviation e between the actual position and the\ntheoretical position, and the current deviation change ec according to the input and\nthe feedback signal, carries out the fuzzy reasoning according to the fuzzy rule,\nfinally solves the fuzzy parameter and outputs the proportion and differential\ncoefficient of the PD controller. The schematic structure of the fuzzy PD control is\nshown in Fig. 8.7 [15].\n\nPD controller control law is: u(k) = KP ? e(k) + KD ? ec(k). The PD parame-\nters of the fuzzy synthesis reasoning design are calculated as follows\n\nKP \u00bc KP0 \u00fe\u00f0E;EC\u00dep\nKD \u00bc KD0 \u00fe\u00f0E;EC\u00ded\n\nwhere KP0, KD0 is the initial value of the fuzzy controller design based on tradi-\ntional PD controller. (E, EC)p, (E, EC)d, i.e., (DKP, DKD), is output of fuzzy control\nand can adjust the two parameters\u2019 values of PD control according to the state of the\ncontrolled object automatically.\n\nParameter fuzzy self-tuning is to find the fuzzy relationship between DKP, DKD\nand e and ec, to make online modification on parameters by continuously detecting\ne and ec during running, and according to the fuzzy control principle, to satisfy the\ndifferent control parameters requirements of the different e and ec, so that the\ncontrolled object has a good dynamic and static performance. Considering from the\nsystem stability, response speed, overshoot, steady-state accuracy, and other\n\nde/dt\nPD\n\ncontroller object\ne\n\nec\n\nFuzzy \nreasoning\n\nKP KD\n\n+\n\n-\n\nFig. 8.7 Fuzzy PD control principle\n\n214 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\naspects, parameters KP, KD self-tuning in the case of different e and ec need to meet\nthe following adjustment principles:\n\n(1) When e is large, in order to speed up the response speed of the system and\nprevent the differential overflow caused by sharp increase in e , larger KP and\nsmaller KD should be taken.\n\n(2) When e is medium size, in order to reduce the system overshoot and ensure a\ncertain response speed, KP should be reduced appropriately, and at the same\ntime, the value of KD should be moderate.\n\n(3) When e is small, in order to reduce the steady-state error, KP should be made\nlarger. In order to avoid the output response oscillating in the vicinity of the set\nvalue, and take the system anti-interference performance into account, KD value\nshould be selected based on |ec|. If |ec| is large, KD takes a smaller value, and\nusually KD is medium (Tables 8.4 and 8.5).\n\n4. Simulation analysis\n\nLacking absolute orbit information means the absolute position information of both\nthe target spacecraft and the active spacecraft is unknown, only the line-of-sight\nangle, line-of-sight angle change rate, relative distance, and change rate measured\nby relative tracking device. The relative position and velocity of the two spacecrafts\nunder the active spacecraft body coordinate system can be calculated by these\nmeasurements; then, the coordinate system transformation is made by the current\n\nTable 8.4 DKP fuzzy rule\n\nNL NM NS Z0 PS PM PL\n\nNL PL PL PM PM PS Z0 Z0\nNM PL PL PM PS PS Z0 NS\nNS PM PM PM PS Z0 NS NS\nZ0 PM PM PS Z0 NS NM NM\nPS PS PS Z0 NS NS NM NM\nPM PS Z0 NS NM NM NM NL\nPL Z0 Z0 NM NM NM NL NL\n\nec\n\ne\n\n?KP\n\nTable 8.5 DKD fuzzy rule\n\nNL NM NS Z0 PS PM PL\n\nNL PS NS NL NL NL NM PS\nNM PS NS NL NM NM NS Z0\nNS Z0 NS NM NM NS NS Z0\nZ0 Z0 NS NS NS NS NS Z0\nPS Z0 Z0 Z0 Z0 Z0 Z0 Z0\nPM PL NS PS PS PS PS PL\nPL PL PM PM PM PS PS PL\n\nec\n\ne\n\n?KD\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 215\n\n\n\nattitude angle of the active spacecraft, and the relative position and velocity under\nthe active spacecraft orbit coordinate system are obtained; thus, the orbit control is\ncarried out according to these relative quantities.\n\nThe absolute reference orbit of autonomous rendezvous under the condition of\nlacking absolute orbit information should not be established on the target spacecraft\norbit coordinate system, because if the reference coordinate system is the target\nspacecraft orbit coordinate system, the six orbit elements of the active spacecraft\nand the target spacecraft need to be known when the relative position and velocity\nneed to be switched to the active spacecraft orbit coordinate system, but information\nof the orbit elements is unknown when lacking absolute orbit information. Besides,\nthe control acceleration calculated by the guidance also needs to be conversed to the\nactive spacecraft orbit coordinate system via coordinate conversion, and orbit ele-\nments\u2019 information is also required. Therefore, when designing guidance law for\nthe absence of absolute orbit information, the active spacecraft orbit coordinate\nsystem should be chosen for absolute reference orbit, for the consideration of\nmeasurement and control [16, 17].\n\nThe initial values of the selected target orbit are listed in Table 8.6.\nThe initial distance and velocity of the target spacecraft relative to the active\n\nspacecraft are in the second orbit coordinate system of the active spacecraft\n\nR0 \u00bc 10 ?1 ?1 0\u00bd ?T km\nV0 \u00bc 1 ?1 ?1\u00bd ?T m=s\n\nTerminal relative position and velocity required are\n\nRf \u00bc 100 0 0\u00bd ?T m\nVf \u00bc 0 0 0\u00bd ?T m=s\n\nRelative navigation uses microwave radar with ranging accuracy of 11 m and\nelevation and azimuth angle accuracy of 0.2\u00b0 (3r). In the simulation, 10% of the\ntheoretical thrust of the thruster is added as random noise to the actual thrust\nmagnitude, the orbit period is 0.2 s, and the minimum starting time of the thruster is\nset to 0.03 s.\n\n1) PD control simulation\n\nUsing the traditional PD control, select the PD parameters after several simulations\n\nKP \u00bc diag 0:0001 0:0001 0:0001\u00bd ?; KD \u00bc diag 0:03 0:03 0:03\u00bd ?\n\nSimulation result of autonomous rendezvous is shown in Fig. 8.8. Autonomous\nrendezvous result analysis of PD control is given in Table 8.7.\n\nTable 8.6 Orbit initial value\nof target spacecraft\n\na (km) e i (\u00b0) X (\u00b0) x (\u00b0) h (\u00b0)\n\n22,175 0.7 60 60 30 180\n\n216 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nFig. 8.8 Relative position and velocity\n\nTable 8.7 Rendezvous result analysis of PD control\n\nAxis x y z\n\nStability time (s) 1500 800 1350\n\nSteady-state error (m) 45 46 47\n\nFuel consumption (m/s) (in an orbit periods) 35.2 8.1 37.7\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 217\n\n\n\n2) Fuzzy PD control simulation\n\nUsing fuzzy PD control, KP0, KD0 is selected based on PD controller parameter, i.e.,\n\nKP0 \u00bc diag 0:0001 0:0001 0:0001\u00bd ?; KD0 \u00bc diag 0:03 0:03 0:03\u00bd ?\n\nAfter several simulations, KP, KD scale factors of the three-axis direction are\nselected as 0.00015, 0.008; 0.00015, 0.003; 0.0001, 0.008, respectively. DKP and\nDKD are calculated by fuzzy control rule table.\n\nThe membership function of the relative position velocity and the output control\nis shown in Figs. 8.9, 8.10, and 8.11.\n\nSimulation parameters are given in Table 8.8, and simulation results are shown\nin Fig. 8.12.\n\n-1000 -800 -600 -400 -200 0 200 400 600 800 1000\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\ne\n\nD\neg\n\nre\ne \n\nof\n m\n\nem\nbe\n\nrs\nhi\n\np\n\nNSZPSNM PMNL PLFig. 8.9 Degree of\nmembership of relative\nposition e\n\n-15 -10 -5 0 5 10 15\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nec\n\nD\neg\n\nre\ne \n\nof\n m\n\nem\nbe\n\nrs\nhi\n\np\n\nNS PSNM PMNL PLZFig. 8.10 Degree of\nmembership of relative\nvelocity ec\n\n218 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nThe difference between PD control and fuzzy PD control is explained below\n(Fig. 8.13; Table 8.9).\n\n3) Simulation conclusion\n\nBy comparing the simulation results, it can be seen:\n\n(1) PD control and fuzzy PD control are almost the same of fuel consumption.\n(2) Compared with PD control, fuzzy PD control can significantly reduce the\n\nresponse time and speed up the convergence speed.\n(3) PD control and fuzzy PD control almost have no overshoot. This is because the\n\ndifferential term takes the relative movement trend into account that can change\nthe control strategy in advance to prevent the overshoot caused by excessive\ncontrol.\n\n(4) Fuzzy PD control accuracy is higher than PD control.\n\nIt can be seen that the fuzzy PD control effect is better than the PD control alone\nfrom the comparison of the stable time and the control precision.\n\n-6 -4 -2 0 2 4 6\n\n0\n\n0.2\n\n0.4\n\n0.6\n\n0.8\n\n1\n\nkp\n\nD\neg\n\nre\ne \n\nof\n m\n\ne m\nbe\n\nr s\nhi\n\np\n\nNL Z PLNS PSNM PM\n\nFig. 8.11 Degree of membership of DKP, DKD\n\nTable 8.8 Rendezvous result analysis of fuzzy PD control\n\nAxis x y z\n\nStability time (s) 1350 550 1100\n\nSteady-state error (m) 20 20 24\n\nFuel consumption (m/s) (in an orbit periods) 36.8 9.9 38.8\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 219\n\n\n\n8.3.2 Robust Sliding Mode Control\n\nSliding mode variable structure control is a widely used robust control method,\nwhich has been successfully applied in many engineering fields. The advantage of\nthis method is that it has strong robustness for the parameters of the system and the\ndisturbance uncertainty and can realize the total irrelevance between external\n\nFig. 8.12 Relative position\n\n220 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\ndisturbance and parameter change of the sliding mode and system. This property is\ncalled the invariance of the sliding mode. This is also the main reason for sliding\nmode control being paid attention. This book puts the terms which contain\ntime-varying absolute orbit information in the dynamic equation together as per-\nturbation and then introduces the design method of the guidance law for this\nuncertain system model, so as to realize the autonomous rendezvous with unknown\nparameters.\n\n1. Basic principle of robust sliding mode control\n\nThe sliding mode control theory is the main part of the variable structure control\ntheory. The sliding mode controller design process consists of two parts, namely the\ndesign of the motion controller and the design of the sliding surface and the switch\nsurface.\n\nFig. 8.13 Comparison of relative position under PD and fuzzy PD control\n\nTable 8.9 Rendezvous result comparison of PD and fuzzy PD control\n\nPD control Fuzzy PD control\n\nx-axis stability time (s) 1500 1350\n\ny-axis stability time (s) 800 550\n\nz-axis stability time (s) 1350 1100\n\nSteady-state error (m) 45 20\n\nSteady-state error (m) 46 20\n\nSteady-state error (m) 47 24\n\nFuel consumption (m/s) (in an orbit periods) 81.3 85.5\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 221\n\n\n\nFirst, consider a system\n\n\u20acx\u00fe a2 _x\u00fe a1x \u00bc 0 \u00f08:30\u00de\n\nAssume that k1; k2 are two roots of the system characteristic equation, and\nk1 [ 0; k2\\0:\n\nIt can be seen from the phase trajectory figure that there is a straight line\ns \u00bc _x\u00fe k1x \u00bc 0; which divides the phase space into two regions s[ 0 and s\\0:\nWhere the origin is the saddle point, except that the phase trajectory which takes the\npoint on the s = 0 as the starting point, the others are unstable. But we can see that\nif a controller can be designed, so that the phase trajectories starting from any point\nin the state space can reach the line s = 0, then the phase trajectory of the system\nwill return to 0, so s is called sliding surface. The movement along the sliding\nsurface is called sliding motion or sliding mode, and the movement to the sliding\nsurface is called the reach movement. The purpose of the sliding mode controller\ndesign is to make the state trajectory from any point in the state space reach the\nsliding surface within a finite time and slide along the sliding surface to the equi-\nlibrium point (Fig. 8.14).\n\nSliding mode control is a comprehensive control method, and the current widely\nrecognized sliding mode control is defined as follows:\n\nDetermine the switching function vector (whose dimension is generally taken as\nthe dimension of the control):\n\nS\u00f0X\u00de\n\nSeeking a control law:\n\nui\u00f0X\u00de \u00bc u\n\u00fe\ni \u00f0X\u00de si\u00f0X\u00de[ 0\n\nu?i \u00f0X\u00de si\u00f0X\u00de\\0\n?\n\nwhere u\u00fei \u00f0X\u00de 6\u00bc u?i \u00f0X\u00de; make the system meet the following three conditions:\n\nFig. 8.14 Phase trajectory of\nthe system\n\n222 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\n(1) The sliding mode exists.\n(2) Meet the accessibility conditions. In the switching surface, except X = 0, the\n\nother movement points will reach the switch surface in a limited time.\n(3) Ensure the stability of sliding mode movement, and dynamic quality is good.\n\nThe sliding mode is actually moving along the switching surface, which is also\nknown as sliding motion. If the design of the control law satisfies the above con-\ndition, the closed-loop system is globally asymptotically stable.\n\nFor general linear systems, the establishment of variable structure sliding mode\ncontrol invariance is conditional and needs to satisfy the matching condition of\nsliding mode. The following three cases are discussed.\n\n1) When the system is disturbed by external disturbance\n\n_X \u00bc AX\u00feBU\u00feDf\n\nwhere Df indicates external disturbance to the system.\nThe necessary and sufficient condition for the sliding mode to be not affected by\n\nthe disturbance f is\n\nrank\u00bdB;D? \u00bc rankB \u00f08:31\u00de\n\nThe system is changed into\n\n_X \u00bc AX\u00feB\u00f0U\u00fe eDf \u00de\nwhere eD \u00bc B?1D; by designing control law, can achieve complete compensation\nfor disturbance. Formula (8.31) is called the exact match condition of the distur-\nbance system.\n\n2) When there is uncertainty in the system\n\n_X \u00bc AX\u00feDAX\u00feBU\n\nThe necessary and sufficient condition for the sliding mode to be independent of\nthe uncertainty DA is\n\nrank B; DA\u00bd ? \u00bc rankB \u00f08:32\u00de\n\nThe system is changed into\n\n_X \u00bc AX\u00feB\u00f0U\u00feDeAX\u00de\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 223\n\n\n\nwhere DeA \u00bc B?1DA; by designing control law, can achieve complete compensa-\ntion for uncertain system. Formula (8.32) is called the exact match condition of the\nuncertain system.\n\n3) For systems that both external disturbance and parameter perturbation exist\nsimultaneously\n\n_X \u00bc AX\u00feDAX\u00feBU\u00feDf\n\nIf system satisfies the match condition of Formulas (8.31) and (8.32), the system\nis changed into\n\n_X \u00bc AX\u00feB\u00f0U\u00feDeAX\u00fe eDf \u00de\nThe design problem of variable structure sliding mode control is generally\n\ndivided into two independent steps [18, 19]:\n\n(1) Choose the ideal sliding surface.\n(2) Design a control law to drive the state of the system to the sliding surface, and\n\nkeep the state on the sliding surface, to make it asymptotical toward the system\nbalance point.\n\nAccording to the definition and design steps of variable structure sliding mode\ncontrol, the motion of the system state consists of two parts [20]:\n\n(1) The first part is under the influence of variable structure control law, driving the\nstate of the system from a point in the state space to the sliding surface s = 0,\nwhich is the sliding mode accessibility problem.\n\n(2) The second part is the sliding motion of the system near the sliding surface and\nalong s = 0, which is the stability problem of the sliding mode motion.\n\nIt can be seen that the dynamic quality of the system is determined by these two\nparts. In order to improve the dynamic quality of the system, a certain control law\ncan be designed in the first part to make the state of the system move to sliding\nsurface at a limited velocity. The design problem of the control law is studied\nbelow.\n\n2. Robust Sliding Mode Controller design\n\nThe three slow time-varying parameters whose real-time information cannot be\nobtained in the state equation: The angular velocity _h and angular acceleration \u20ach of\nthe true anomaly of the target spacecraft and the distance rt of the target spacecraft\nrelative to the earth are regarded as uncertain quantities and attributed to be a\nparameter perturbation separately to form an uncertain, relative motion system. The\nrobust sliding mode control theory of uncertain systems can be used to realize\nautonomous rendezvous in the case of unknown parameters [21].\n\n224 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nFirst, the Lawden equation is written in the form of state equation\n\n_X \u00bc \u00f0A\u00feDA\u00deX\u00feBU \u00f08:33\u00de\n\nwhere DA is not certain, but limited.\n\nA \u00bc\n\n0 0 0 1 0 0\n\n0 0 0 0 1 0\n\n0 0 0 0 0 1\n\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n\n2666666664\n\n3777777775\n;\n\nDA \u00bc\n\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n\n0 0 0 0 0 0\n2l\nr3t\n\u00fe _h2 \u20ach 0 0 2 _h 0\n?\u20ach ? lr3t \u00fe\n\n_h2 0 ?2 _h 0 0\n0 0 ? lr3t 0 0 0\n\n266666666664\n\n377777777775\n;\n\nB \u00bc\n\n0 0 0\n\n0 0 0\n\n0 0 0\n\n1 0 0\n\n0 1 0\n\n0 0 1\n\n2666666664\n\n3777777775\nIt is easy to see that the uncertain system satisfies the exact match condition, and\n\nthe complete compensation of the uncertain system can be achieved by designing\nthe control law.\n\nMake DA \u00bc BD1 , so it can be obtained after further arranging Formula (8.33)\n\n_X \u00bc AX\u00feB\u00f0U\u00feD1X\u00de \u00f08:34\u00de\n\nHere\n\nD1 \u00bc\n2l\nr3t\n\n\u00fe _h2 \u20ach 0 0 2 _h 0\n? _x ? lr3t \u00fe\n\n_h2 0 ?2 _h 0 0\n0 0 ? lr3t 0 0 0\n\n2664\n3775\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 225\n\n\n\n3. The design and stability of sliding surface\n\nWhen sliding the surface s[ 0; u \u00bc u\u00fe ; when s\\0; u \u00bc u?. So the sliding sur-\nface is like a switch and sometimes called the switch surface. The number of sliding\nsurfaces can be arbitrarily selected. If the state vector is n-dimensional and the\ncontrol vector is m-dimensional, then each sliding surface is n\u2013m-dimensional. For\nthis system, the state vector is composed of relative position and relative velocity\nand of 6 dimensions, and control vector is the output of the three-axis thruster and\nof 3 dimensions, and then the sliding surface is 6 ? 3 = 3-dimensional.\n\nThe sliding surface is selected as\n\ns \u00bc BTPX \u00bc 0 \u00f08:35\u00de\n\nAssuming A is stability, then there is positive definite matrix P that satisfies\n\nATP\u00fePA \u00bc ?Q \u00f08:36\u00de\n\nwhere Q is chosen as the positive diagonal matrix, and the stability of the sliding\nsurface is proved below.\n\nChoosing V \u00bc XTPX as Lyapunov function, and\n\n_V \u00bc _XTPX\u00feXTP _X\n\u00bc XT ATP\u00fePA? ?X\u00feXTPB\u00f0U\u00feD1X\u00de\u00fe \u00f0U\u00feD1X\u00deTBTPX \u00f08:37\u00de\n\nPut Formulas (8.35) and (8.36) into (8.37), and we can get\n\n_V \u00bc ?XTQX\\0 \u00f08:38\u00de\n\nIt can be seen that the system has asymptotically stable sliding motion on the\nsliding surface.\n\n4. Arrival conditions\n\nThe state space is divided into two parts s[ 0 and s\\0 by s \u00bc 0: The inequality\narrival condition is generally expressed as:\n\n_s\\0; if s[ 0\n_s[ 0; if s\\0\n\n?\n\u00f08:39\u00de\n\nOr\n\ns_s\\0 \u00f08:40\u00de\n\n226 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nFor multivariate situations, it can be written as:\n\n_si\\0; if si [ 0\n_si [ 0; if si\\0\n\n?\n\u00f08:41\u00de\n\nOr\n\nsi _si\\0 \u00f0i \u00bc 1; 2; . . .\u00de \u00f08:42\u00de\n\nIf the arrival condition is satisfied, it is possible to ensure that the state trajectory\nfrom any point in the state space reaches the sliding surface in a limited period of\ntime. There is an arrival condition being given by the Lyapunov method; that is,\nselect the positive definite function V:\n\nV \u00bc 1\n2\nsTPs[ 0 \u00f08:43\u00de\n\nCall for\n\n_V \u00bc _sTPs\\0 \u00f08:44\u00de\n\nThere is also an equality-type arrival condition, arrival law, which generally has\nthe following two forms:\n\n_s \u00bc ?e ? sign\u00f0s\u00de \u00f08:45\u00de\n\nOr\n\n_s \u00bc ?Ks? e ? sign\u00f0s\u00de \u00f08:46\u00de\n\nIt is easy to check that if Formula (8.45) or (8.46) is satisfied, Formula (8.42) is\nsatisfied too. Take single-input system as example, using arrival condition for\nFormula (8.45)\n\ns_s \u00bc ?se ? sign\u00f0s\u00de \u00bc ?e sj j\\0\n\nUse arrival condition for Formula (8.46)\n\ns_s \u00bc ?Ks2 ? e sj j\\0\n\nThe multiple-input situations can be similarly checked.\nThe approach law can not only ensure that the state trajectory reaches the sliding\n\nsurface, but also ensure the quality of the response to the movement by selecting\nK and e. In general, K determines the rate of convergence to the sliding surface, and\ne determines the state of the state trajectory near the sliding surface. For example,\nfrom Formula (8.46), when the absolute value of s is large, the first term on the right\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 227\n\n\n\nside plays a major role, and the large K value can increase the convergence rate of\ns. When s ! 0; the first term on the right side of Formula (8.46) tends to 0, and\nFormula (8.46) degenerates to Formula (8.45), at this time\n\nWhen s ! 0\u00fe ; _s \u00bc ?e\nWhen s ! 0?; _s \u00bc e\n\nBecause the velocity is not 0, the state trajectory will pass through the sliding\nsurface s \u00bc 0 repeatedly which produces chattering phenomenon, and the amplitude\nand frequency of vibration are related with e, so e should be taken a smaller value.\n\n5. Arrival motion control law\n\nChoosing arrival law _s \u00bc ?Ks? e ? sign\u00f0s\u00de\nSliding surface is s \u00bc BTPX \u00bc 0; then\n\n_s \u00bc BTP _X \u00bc BTPAX\u00feBTPB\u00f0U\u00feD1X\u00de \u00f08:47\u00de\n\nCompare Formulas (8.46) and (8.47), and it can be obtained\n\n?Ks? e ? sign\u00f0s\u00de \u00bc BTPAX\u00feBTPB\u00f0U\u00feD1X\u00de\n\nThen, it can be derived\n\nU \u00bc ?\u00f0BTPB\u00de?1\u00bdKs\u00fe e ? sign\u00f0s\u00de\u00feBTPAX\u00feBTPBD1X?\n\nSince there is uncertain term in the U, it is impossible to realize. U can be\ndesigned as\n\nU \u00bc ?\u00f0BTPB\u00de?1\u00bdKs\u00fe e ? sign\u00f0s\u00de\u00feBTPAX\u00feZ? \u00f08:48\u00de\n\nwhere Z is yet to be set, and Z can be determined by arrival conditions. Put Formula\n(8.48) into (8.47)\n\n_s \u00bc ?Ks? e ? sign\u00f0s\u00de ? Z\u00feBTPBD1X\n\nIts component form is\n\n_si \u00bc ?Kisi ? ei ? sign si\u00f0 \u00de ? zi \u00fe viD1X (i \u00bc 1; 2; 3) \u00f08:49\u00de\n\nwhere vi is row i of matrix BTPB: D1 determined by system model is expressed as\nfollow\n\n228 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nD1 \u00bc\n2l\nr3t\n\n\u00fe _h2 \u20ach 0 0 2 _h 0\n?\u20ach ? lr3t \u00fe\n\n_h2 0 ?2 _h 0 0\n0 0 ? lr3t 0 0 0\n\n2664\n3775\n\nConsidering in one orbit period, according to the simulation input conditions of\nthe previous section, it can be calculated that the order of magnitude of 2lr3t\n\nis 10?6,\n\nthe order of magnitude of \u20ach is 10?6, and the order of magnitude of _h is 10?3. If the\nrendezvous occurs at the apogee, the order of magnitude of 2lr3t\n\nis 10?9, the order of\n\nmagnitude of \u20ach is 10?9, and the order of magnitude of _h is 10?5 from the start point\nat the apogee to 3000 s of the target spacecraft. The disturbance effects brought by\n2l\nr3t\n\nand _h2 is small compared with _h; and thus, the two can be ignored. This\n\nexpression of D1 is simplified as:\n\nD1 \u00bc\n0 0 0 0 2 _h 0\n0 0 0 ?2 _h 0 0\n0 0 0 0 0 0\n\n24 35 \u00f08:50\u00de\n\n_h includes _h0 and D _h: _h0 is the mean value of the orbit angular velocity, D _h is the\ndifference between the actual orbit angular velocity and the mean value.\nThe maximum value of D _h is the fluctuation range of the angular velocity. From the\napogee to a period of rendezvous time, _h0 \u00bc 4:7? 10?5 and D _h\\3? 10?6 . Join\n_h0 in the system matrix A, so there is\n\nA \u00bc\n\n0 0 0 1 0 0\n0 0 0 0 1 0\n0 0 0 0 0 1\n0 0 0 0 2? 4:7? 10?5 0\n0 0 0 ?2? 4:7? 10?5 0 0\n0 0 0 0 0 0\n\n26666664\n\n37777775\nAnd D1 is changed into\n\nD1 \u00bc\n0 0 0 0 2D _h 0\n0 0 0 ?2D _h 0 0\n0 0 0 0 0 0\n\n24 35\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 229\n\n\n\nMake D1 \u00bc EDF; where\n\nE \u00bc diag 0:002 0:002 0:002\u00bd ?\u00f0 \u00de\nF \u00bc diag 0:003 0:003 0:003 0:003 0:003 0:003\u00bd ?\u00f0 \u00de\n\nD \u00bc\n0 0 0 0 13D\n\n_h? 106 0\n0 0 0 ? 13D _h? 106 0 0\n0 0 0 0 0 0\n\n264\n375\n\nFor the case of rendezvous at the apogee, there is\n\nDTD \u00bc\n\n0 0 0 0 0 0\n0 0 0 0 0 0\n0 0 0 0 0 0\n0 0 0 19D\n\n_h2 ? 1012 0 0\n0 0 0 0 19D\n\n_h2 ? 1012 0\n0 0 0 0 0 0\n\n26666664\n\n37777775\\I \u00f08:51\u00de\n\nFor any parameter _h[ 0; there is\n\n1\n2\n_h\n1\n2DFX\u00fe _h?12ETvTi\n\n\t \nT 1\n2\n_h\n1\n2DFX\u00fe _h?12ETvTi\n\n\t \n\n? 0\n\n1\n2\n_h\n1\n2DFX ? _h?12ETvTi\n\n\t \nT 1\n2\n_h\n1\n2DFX ? _h?12ETvTi\n\n\t \n\n? 0\n\nExpand the formula given above\n\n1\n4\n_hXTFTDTDFX\u00fe _h?1viEETvTi \u00fe viEDFX? 0 \u00f08:52\u00de\n\n1\n4\n_hXTFTDTDFX\u00fe _h?1viEETvTi ? viEDFX? 0 \u00f08:53\u00de\n\nwhere _h is positive constant.\nChoose control law as follows\n\nzi \u00bc 14\n_hXTFTFX\u00fe _h?1viEETvTi\n\n? ?\nsign si\u00f0 \u00de \u00f08:54\u00de\n\nPut Formula (8.54) into Formula (8.49)\n\n_si \u00bc ?Kisi ? eisign si\u00f0 \u00de ? 14\n_hXTFTFX\u00fe _h?1viEETvTi\n\n? ?\nsign si\u00f0 \u00de\u00fe viEDFX\n\n230 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nIt can be derived from Formula (8.49) to Formula (8.51)\n\nsi _si \u00bc ?Kis2i ? ei sij j ? sij j\n1\n4\n_hXTFTFX\u00fe _h?1viEETvTi\n\n? ?\n\u00fe siviEDFX\n\n\\? Kis2i ? ei sij j ? sij j\n1\n4\n_hXTFTDTDFX\u00fe _h?1viEETvTi\n\n? ?\n\u00fe siviEDFX\n\n? ? Kis2i ? ei sij j\n\\0\n\n\u00f08:55\u00de\n\nThat is to meet the arrival conditions. Then, the combination of (8.48) and (8.54)\nconstitute the arrival motion controller.\n\n6. Simulation analysis\n\nThe simulation conditions are the same as in 8.3.1. Guidance law involves a total\nof four parameters to be determined: Q, K, e, and _h: where Q is the sliding surface\nparameters; K, e, _h are the arrival motion parameters.\n\nK determines the rate of convergence to the sliding surface, and e determines the\nstate of the state trajectory near the sliding surface. When the absolute value of s is\nvery large, Ks in Formula (8.46) plays a major role, and the large K value can\nincrease the convergence rate. When s ! 0; Ks tends to be 0. Since the velocity is\nnot 0, the state trajectory will pass through the sliding surface s \u00bc 0 repeatedly,\nwhich produces chattering phenomenon, and the amplitude and frequency of\nvibration are related with e, so e should be taken a smaller value, so as to have\nadvantages of both dithering small and short transition process. However, if K is too\nlarge, it will be easy to exceed acceleration range provided by the control parts\u2014\nthruster and fuel consumption will be larger, so it need to compromise. After\nsimulation, the values of K and e are determined as follows:\n\nK \u00bc diag 0:001 0:001 0:001\u00bd ?\u00f0 \u00de e \u00bc 0:01\n\nGive a set of Q and _h: Simulation result of autonomous rendezvous is shown in\nFig. 8.15, and rendezvous result analysis is in Table 8.10.\n\nQ \u00bc diag 2e?3 0:5e?4 2e?3 1 1 1\u00bd ?\u00f0 \u00de _h \u00bc 1? 10?4\n\nDue to the consideration of the disturbance, the control amount is large, and the\nthruster still switches on and off repeatedly after reaching steady state, which leads to\na larger fuel consumption and large fluctuation rate of the relative position. To solve\nthis problem, the error box with control error limit being selected from the simulation\nexamples as [50 m 50 m 50 m 0.1 m/s 0.1 m/s 0.1 m/s] can be used. After adopting\nthe error box, the fuel consumption significantly reduces; however, the dynamic\nperformance of the control system remains unchanged, as given in Table 8.10.\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 231\n\n\n\nFig. 8.15 Relative position and velocity\n\nTable 8.10 Analysis of\nrendezvous result\n\nAxis x y z\n\nStability time (s) 2500 600 2500\n\nFuel consumption (m/s) (6000 s) 79.7 107.1 81.0\n\nFuel consumption (m/s) (add error\nbox)\n\n25.0 52.4 26.3\n\n232 8 Autonomous Rendezvous Technology of Elliptical Orbit\n\n\n\nUsing this set of parameters Q and _h; the control results will not be overshot, the\nrelative position after the rendezvous will be stable, and the error will not be\nincreased due to the near perigee. The system is robust and can be used as a\nreference for the readers who are in a similar design process.\n\nReferences\n\n1. Zhang Bonan. Mission Analysis and Design of spacecraft rendezvous and docking [M].\nBeijing: Science Press, 2011.\n\n2. Lu Shan, Chen Tong, Xu Shijie. Optimal Lambert transfer based on adaptive simulated\nannealing genetic algorithm [J]. Journal of Beijing University of Aeronautics and\nAstronautics, 2007, 33(10): 1191\u20131195.\n\n3. LU Shan, DUAN Jia-jia, XU Shi-jie. Study on Midcourse Correction of Orbital Transfer\nUsing Ant Colony Algorithm [J]. Journal of System Simulation, 2009, 21(14): 4400\u20134404.\n\n4. LU Shan, XU Wei, LIU Zong-ming, GUO Wen-ting, LIANG Yan. On-Orbit Manipulation\nTechnique for Spacecraft in HEO [J]. Journal of Astronautics, 2014, 35(4): 425\u2013431.\n\n5. LU Shan, XU Shi-jie. Active Collision Avoidance Design of Space Rendezvous Under the\nThruster Failure [J]. Journal of Astronautics, 2009, 30(3): 1265\u20131270.\n\n6. Guo Wenting, Lu Shan. Research on Coupled Control of Relative Attitude and Orbit for Final\nApproach Phase of On-Orbit Servicing [J]. Aerospace Shanghai, 2015, 32(6): 17\u201323.\n\n7. Shan Lu, Shijie Xu. Adaptive Control for Autonomous Rendezvous of Spacecraft on\nElliptical Orbit [J]. Acta Mechanica Sinica, 2009, 25(4): 539\u2013545.\n\n8. Lu Shan, Xu Shijie. Adaptive Learning Control Strategy for Autonomous Rendezvous of\nSpacecrafts on Elliptical Orbit [J]. ACTA AERONAUTICA ET ASTRONAUTICA SINICA,\n2009, 30(1): 127\u2013131.\n\n9. DuanGuangren.Linear SystemTheory [M].Harbin:Harbin Institute ofTechnologyPress, 2004.\n10. Carter T E. Closed-Form Solution of an Idealized, Optimal, Highly Eccentric Hyperbolic\n\nRendezvous Problem [J]. Dynamics and Control, 1996, 6: 293\u2013307.\n11. Inalhan G, Tillerson M, How J P. Relative Dynamics and Control of Spacecraft Formations in\n\nEccentric Orbits [J]. Journal of Guidance, Control, and Dynamics, 2002, 25(1): 48\u201359.\n12. Yue Xiaokui, Yuan Yunxia. Transfer Matrix for Relative Dynamics in Elliptic Orbit [J].\n\nChinese Space Science and Technology, 2011, 2(1): 42\u201346.\n13. Yue Sun, ShanLu, ChaozhenLiu. Research ofAutonomousRendezvous Technology onHighly\n\nElliptical Orbit [C]. The 5th CSA-IAA Conference on Advanced Space Technology, 2013.\n14. Li Shiyong. Fuzzy Control NeuroControl and Intelligent Cybernetics [M]. Harbin: Harbin\n\nInstitute of Technology Press, 1998.\n15. Li Jian, Wang Dongqing, Wang Limei. Design of Fuzzy PID Controller and its Simulation\n\nBased on MATLAB [J]. Industrial Control Computer, 2011, 24(5): 56\u201360.\n16. Lu Shan, Xu Shijie. Control Laws for Autonomous Proximity with Non-cooperative Target\n\n[J]. Chinese Space Science and Technology, 2008, 28(5): 7\u201312.\n17. Shan Lu, Shijie Xu. Satellites Formation Keeping Using Lyapunov Min-Max Approach [C].\n\nProceedings of the 11th International Space Conference of Pacific-basin Societies, 2007: 248\u2013\n254.\n\n18. POLITES M E. An assessment of the technology of automated rendezvous and capture in\nspace [R]. NASA TP-1998-208528, 1998.\n\n19. Yang Yansheng, Jia Xinle. Robust Control and Application of Uncertain systems [M]. Dalian:\nDalian Maritime University Press, 2003.\n\n20. LU Shan, XIA Yong-jiang. Robust Sliding Mode Control for Autonomous Rendezvous of\nSpacecraft on Elliptical Orbit [J]. Aerospace Shanghai, 2012, 29(4): 14\u201318.\n\n21. LU Shan. A Study on Relative Orbital Dynamics and Control of Spacecraft Autonomous\nRendezvous [D]. Beijing: Beihang University, 2009.\n\n8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information 233\n\n\n\nMain Symbol Meaning Table\n\nSymbol Main Meaning\na Orbit semi-major axis\nax; ay; az Orbit perturbation acceleration\nCD Atmospheric drag coefficient\nCR Surface reflection coefficient\nCr Solar radiation coefficient\ne Orbit eccentricity\nFo Earth gravity\nFe Non-centroid gravity\nFn Three-body perturbation of sun and earth\nFs Solar radiation pressure\nfbx; fby; fbz Accelerometer specific force\nf b Specific force information\nfx; fy; fz Control acceleration on tracking satellite\nGEO Geo-stationary earth orbit\nHEO High earth orbit\ni Orbit inclination\nJ2 Two-order zonal harmonic coefficient of earth gravity potential\n\nfunction\nL Coordinate transformation matrix\nLEO Low earth orbit\nMEO Middle earth orbit\nM Orbit mean anomaly\nn Average orbit angular velocity, n2a3 \u00bc l\nnE Earth inertia angular velocity\nQ System noise covariance matrix\nq1; q2; q3; q4 Elements of attitude quaternion\n\n\u00a9 Springer Nature Singapore Pte Ltd. and National Defense Industry Press 2019\nF. Liu et al., Guidance and Control Technology of Spacecraft on Elliptical Orbit,\nNavigation: Science and Technology, https://doi.org/10.1007/978-981-10-7959-7\n\n235\n\n\n\nR Measurement noise covariance matrix\nRE Radius of earth equator\nr Geocentric distance\nra Apogee\nrp Perigee\nSi J2000 geocentric inertia coordinate system\nSe Earth-fixed coordinate system\nSo Orbit coordinate system\nSb Body coordinate system\nSn Navigation coordinate system\nT Orbit period\nU Earth gravity potential function\nu Argument latitude, u \u00bc x\u00fe h\nDv Velocity increment\nvx; vy; vz Satellite velocity\nx Satellite position\ny Satellite position\nz Satellite position\nam Elevation observation\nbm Azimuth observation\nc Roll\nec Gyro constant drift\ner Gyro drift of first-order markoff process\nh Pitch\nh Orbit true anomaly\n_h Angular velocity of true anomaly\n\u20ach Angular acceleration of true anomaly\nhI; cI;wI Attitude angle of strapdown inertial navigation system\nhC; cC;wC Attitude angle of celestial navigation system\nk Geocentric longitude\nl Gravitational constant\nqm Relative distance observation\nqi;jt Pseudorange between satellite i and satellite j in time t\nq Atmospheric density\n/x;/y;/z Platform error angle\nu Geocentric latitude\nU State transition matrix\nw Yaw\nX Longitude of ascending node\nxbx;xby;xbz Angular velocity of attitude\nxg Gyro random white noise\n\n236 Main Symbol Meaning Table\n\n\n\nxa Accelerometer random white noise\nxbib Angular velocity information measured by gyro, i.e., angular\n\nvelocity of body coordinate system compared with inertial coor-\ndinate system projection in body coordinate system\n\nx Argument of perigee\nrr Accelerometer drift of first-order markoff process\n\nMain Symbol Meaning Table 237\n\n\n\tPreface\n\tCompilation Committee\n\tContents\n\t1 Introduction\n\t1.1 Characteristics of Elliptical Orbit\n\t1.2 Development of Elliptical Orbit Satellite Application\n\t1.3 Key Problems in Control System of Elliptical Orbit Spacecraft\n\t1.4 Structure of This Book\n\tReferences\n\n\t2 Orbit Design of Spacecraft on Elliptical Orbit\n\t2.1 Introduction\n\t2.2 Absolute Dynamics Analysis of Elliptical Orbit\n\t2.2.1 Basic Features of Elliptical Orbit\n\t2.2.2 Elliptical Orbit Perturbation\n\n\t2.3 Autonomous Orbit Prediction of Elliptical Orbit\n\t2.3.1 Autonomous Orbit Prediction\n\t2.3.2 Onboard Orbit Prediction Algorithm of Elliptical Orbit\n\t2.3.3 Analysis and Predigestion of Elliptical Orbit Dynamics Model\n\n\t2.4 Design of Apogee Rendezvous Orbit\n\t2.4.1 Drift Characteristics Analysis of Elliptical Orbit\n\t2.4.2 Design of Frozen Elliptical Orbit\n\t2.4.3 Design of Little Inclination Elliptical Orbit\n\n\t2.5 Elliptical Orbit Rendezvous Method for Inspecting GEO Satellites\n\tReferences\n\n\t3 Formation Configuration Design of Elliptical Orbit\n\t3.1 Introduction\n\t3.2 Formation Configuration Design Based \ton Algebraic Method\n\t3.2.1 Relative Dynamic Equation\n\t3.2.2 Relative Periodic Motion\n\t3.2.3 Characteristics Analysis of Relative Motion Trajectory\n\t3.2.4 Fly-Around Configuration Design\n\t3.2.5 Accompanying Flying Configuration Design\n\n\t3.3 Formation Configuration Design Based on Geometry\n\t3.3.1 Precise Model of Relative Motion\n\t3.3.2 First-Order Approximation Model of Relative Motion\n\t3.3.3 Formation Configuration Design\n\n\tReferences\n\n\t4 Autonomous Navigation Technology of Whole Space\n\t4.1 Introduction\n\t4.2 Common Autonomous Navigation Method of Elliptical Orbit\n\t4.2.1 Autonomous Navigation Technology of Elliptical Orbit Based on Astronomical Observation\n\t4.2.2 Autonomous Navigation Technology of Elliptical Orbit Based on GNSS\n\n\t4.3 Merge Autonomous Navigation Based on SINS/GNSS/CNS\n\t4.3.1 State Equation of Inertial Navigation\n\t4.3.2 Observation Equation of SINS/Star Sensor/GNSS Navigation\n\t4.3.3 Merge Scheme of SINS/Star Sensor/GNSS System\n\n\tReferences\n\n\t5 Autonomous Navigation Technology of Regional Constellation\n\t5.1 Introduction\n\t5.2 Regional Constellation Autonomous Navigation Based on Inter-satellite Ranging\n\t5.2.1 Constellation Autonomous Navigation System Scheme of Elliptical Orbit\n\t5.2.2 High-Precision Orbit Prediction Technology of Constellation Autonomous Navigation System on Elliptical Orbit\n\t5.2.3 Technology of Inter-satellite Link Ranging\n\t5.2.4 Whole Net Filter Scheme of Constellation Autonomous Navigation\n\n\t5.3 Rotation Error Estimation of Constellation Configuration Based on Inter-satellite Observation\n\t5.3.1 Rotation Error Analysis of Region Constellation Autonomous Navigation on Elliptical Orbit\n\t5.3.2 Rotation Error Mitigation Method Based on Inter-satellite Observation of Constellation Autonomous Navigation on Elliptical Orbit\n\n\t5.4 High-Precision Orbit Determination Technology Based on Inter-satellite Orientation Determination of Elliptical Orbit\n\t5.4.1 Constellation Autonomous Navigation Scheme Based on Inter-satellite Orientation Determination/Ranging\n\t5.4.2 Constellation Autonomous Navigation Scheme Based on Inter-satellite Orientation Determination/Ranging of Elliptical Orbit\n\n\tReferences\n\n\t6 Relative Navigation Technology\n\t6.1 Introduction\n\t6.2 Relative Navigation Technology in the Orbit Coordinate System\n\t6.2.1 Coordinate System Definition\n\t6.2.2 Relative Navigation System Modeling in the Orbit Coordinate System\n\t6.2.3 Simulation Example\n\n\t6.3 Relative Navigation Technology in the Inertial Coordinate System\n\t6.3.1 Relative Navigation System Modeling in the Inertial Coordinate System\n\t6.3.2 Simulation Example\n\n\t6.4 Comparison of Methods\n\tReferences\n\n\t7 Technology of Formation Configuration Maintenance on Elliptical Orbit\n\t7.1 Introduction\n\t7.2 Characteristic Analysis of Relative Motion\n\t7.2.1 Relative Motion Equation Based on Relative Orbit Element\n\t7.2.2 Relative Motion Analysis Based on Orbit Element\n\n\t7.3 Control Method of Formation Configuration Maintenance\n\t7.3.1 Configuration Maintenance Based on LQR\n\t7.3.2 Companying Flying Control Based on Relative Orbit Element [11]\n\n\tReferences\n\n\t8 Autonomous Rendezvous Technology of Elliptical Orbit\n\t8.1 Introduction\n\t8.2 Autonomous Rendezvous Optimization Method\n\t8.2.1 Feedback Linearized Dynamic Model of Elliptical Orbit\n\t8.2.2 Optimal Control of Linear Quadratic Regulator\n\t8.2.3 Double-Pulse Control Based on T-H Equation\n\n\t8.3 Autonomous Rendezvous Method in Case of Lacking Orbit Information\n\t8.3.1 Fuzzy PD Control\n\t8.3.2 Robust Sliding Mode Control\n\n\tReferences\n\n\tMain Symbol Meaning Table\n\n\n\n"}