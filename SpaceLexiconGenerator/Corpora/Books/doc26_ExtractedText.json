{"content": "\nIntelligent Systems, Control and Automation: \nScience and Engineering\n\nDanwei\u00a0Wang\nBaolin\u00a0Wu\nEng\u00a0Kee\u00a0Poh\n\nSatellite \nFormation \nFlying\nRelative Dynamics, Formation Design, \nFuel Optimal Maneuvers and Formation \nMaintenance\n\n\n\nIntelligent Systems, Control and Automation:\nScience and Engineering\n\nVolume 87\n\nSeries editor\n\nProfessor S.G. Tzafestas, Athens, Greece\n\nEditorial Advisory Board\n\nProfessor P. Antsaklis, Notre Dame, IN, USA\nProfessor P. Borne, Lille, France\nProfessor R. Carelli, San Juan, Argentina\nProfessor T. Fukuda, Nagoya, Japan\nProfessor N.R. Gans, Richardson, TX, USA\nProfessor F. Harashima, Tokyo, Japan\nProfessor P. Martinet, Nantes, France\nProfessor S. Monaco, Rome, Italy\nProfessor R.R. Negenborn, Delft, The Netherlands\nProfessor A.M. Pascoal, Lisbon, Portugal\nProfessor G. Schmidt, Munich, Germany\nProfessor T.M. Sobh, Bridgeport, CT, USA\nProfessor C. Tzafestas, Athens, Greece\nProfessor K. Valavanis, Denver, CO, USA\n\n\n\nMore information about this series at http://www.springer.com/series/6259\n\n\n\nDanwei Wang \u2022 Baolin Wu\nEng Kee Poh\n\nSatellite Formation Flying\nRelative Dynamics, Formation Design,\nFuel Optimal Maneuvers and Formation\nMaintenance\n\n123\n\n\n\nDanwei Wang\nSchool of Electrical and Electronic\nEngineering\n\nNanyang Technological University\nSingapore\nSingapore\n\nBaolin Wu\nResearch Center of Satellite Technology\nHarbin Institute of Technology\nHarbin\nChina\n\nEng Kee Poh\nSchool of Electrical and Electronic\nEngineering\n\nNanyang Technological University\nSingapore\nSingapore\n\nISSN 2213-8986 ISSN 2213-8994 (electronic)\nIntelligent Systems, Control and Automation: Science and Engineering\nISBN 978-981-10-2382-8 ISBN 978-981-10-2383-5 (eBook)\nDOI 10.1007/978-981-10-2383-5\n\nLibrary of Congress Control Number: 2016947763\n\n\u00a9 Springer Science+Business Media Singapore 2017\nThis work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part\nof the material is concerned, specifically the rights of translation, reprinting, reuse of illustrations,\nrecitation, broadcasting, reproduction on microfilms or in any other physical way, and transmission\nor information storage and retrieval, electronic adaptation, computer software, or by similar or dissimilar\nmethodology now known or hereafter developed.\nThe use of general descriptive names, registered names, trademarks, service marks, etc. in this\npublication does not imply, even in the absence of a specific statement, that such names are exempt from\nthe relevant protective laws and regulations and therefore free for general use.\nThe publisher, the authors and the editors are safe to assume that the advice and information in this\nbook are believed to be true and accurate at the date of publication. Neither the publisher nor the\nauthors or the editors give a warranty, express or implied, with respect to the material contained herein or\nfor any errors or omissions that may have been made.\n\nPrinted on acid-free paper\n\nThis Springer imprint is published by Springer Nature\nThe registered company is Springer Science+Business Media Singapore Pte Ltd.\n\n\n\nThis work is dedicated to\n\nMy wife, Ming Luo, and Our children, Anmin,\nAndai and Anyu\n\n\u2014Danwei Wang\n\nMy wife, Zhe Jing, and My son, Lihang\n\n\u2014Baolin Wu\n\nMy wife, Poh Ling, and Our children\nClarinda, Emelia and Sherwin\n\n\u2014Eng Kee Poh\n\n\n\nContents\n\n1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.1 Background . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n\n1.1.1 Motivations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.1.2 Applications . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 2\n1.1.3 Challenges. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3\n\n1.2 Objectives of This Book. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n1.3 Preview of Chapters . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 5\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n\n2 Dynamic Models of Satellite Relative Motion Around\nan Oblate Earth. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n2.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9\n2.2 Nonlinear Dynamic Model of Relative Motion. . . . . . . . . . . . . . . . 11\n\n2.2.1 J2 Reference Satellite Dynamics in LVLH Frame . . . . . . . . 11\n2.2.2 Derivation of Exact J2 Nonlinear Relative Dynamics . . . . . 15\n\n2.3 Linearized Dynamic Models of Relative Motion . . . . . . . . . . . . . . 20\n2.4 Validation of Proposed Dynamic Models by Simulation . . . . . . . . 23\n2.5 Comparison Study of Relative Dynamic Models . . . . . . . . . . . . . . 28\n\n2.5.1 Comparison Method with Model Error Index . . . . . . . . . . . 28\n2.5.2 Selected Dynamic Models for Comparison Study . . . . . . . . 30\n2.5.3 Case Studies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 34\n\n2.6 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 40\n\n3 Passive and Periodic Satellite Formation Design Around\nan Oblate Earth. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n3.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n3.2 Passive and Periodic Relative Motion Under J2 Perturbation . . . . . 45\n3.3 Periodic and Quasi-periodic Relative Orbits\n\nat Critical Inclination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n3.3.1 Periodic Relative Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n3.3.2 Quasi-periodic Relative Orbit . . . . . . . . . . . . . . . . . . . . . . . 50\n\nvii\n\n\n\n3.3.3 Quasi-periodic Relative Orbit Conditions in Terms\nof Actual Orbit Variables . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n\n3.3.4 Numerical Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n3.4 In-Plane Satellite Formation in Eccentric Orbits . . . . . . . . . . . . . . . 61\n\n3.4.1 Identical Anomaly In-Plane Formation . . . . . . . . . . . . . . . . 62\n3.4.2 Differential Anomaly In-Plane Formation . . . . . . . . . . . . . . 63\n3.4.3 Almost Constant Separation Formation . . . . . . . . . . . . . . . . 69\n\n3.5 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 71\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 72\n\n4 Nonlinear Optimization of Low-Thrust Trajectory\nfor Satellite Formation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n4.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n4.2 Nonlinear Relative Motion Dynamics . . . . . . . . . . . . . . . . . . . . . . . 76\n4.3 Problem Formulation of Trajectory Optimization\n\nfor Satellite Formation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n4.3.1 Initial Condition Constraints . . . . . . . . . . . . . . . . . . . . . . . . 78\n4.3.2 Final Condition Constraints. . . . . . . . . . . . . . . . . . . . . . . . . 78\n4.3.3 Path Constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 79\n4.3.4 Linking Constraints . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 80\n\n4.4 Introduction of Legendre Pseudospectral Method . . . . . . . . . . . . . . 81\n4.5 Computational Considerations of Nonlinear Programming\n\nProblem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n4.6 Scaling of Nonlinear Programming Problem. . . . . . . . . . . . . . . . . . 83\n\n4.6.1 Initial Guess . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n4.6.2 Implementation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n\n4.7 Illustrative Examples . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n4.7.1 Example 1: Scenario of Two Satellites,\n\nOne Burn Phase . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85\n4.7.2 Example 2: Scenario of Two Satellites,\n\nTwo Phases: Coast\u2013Burn . . . . . . . . . . . . . . . . . . . . . . . . . . 90\n4.7.3 Example 3: Scenario of Two Satellites, Three Phases:\n\nBurn\u2013Coast\u2013Burn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\n4.7.4 Example 4: Scenario of Two Satellites, Four Phases:\n\nCoast\u2013Burn\u2013Coast\u2013Burn . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\n4.7.5 Example 5: Scenario of Formation Reconfiguration\n\nInvolving Four Satellites . . . . . . . . . . . . . . . . . . . . . . . . . . . 94\n4.7.6 Example 6: Scenario of Collision Avoidance Validation . . . 95\n\n4.8 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 98\n\n5 Optimal Control for Satellite Formation Keeping. . . . . . . . . . . . . . . . 101\n5.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 101\n\n5.1.1 Leader\u2013Follower Formation Keeping Approaches . . . . . . . . 102\n5.1.2 Decentralized Formation Keeping Approaches . . . . . . . . . . 103\n\nviii Contents\n\n\n\n5.2 Real-Time Optimal Formation Keeping in Leader\u2013Follower\nFrame . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 105\n5.2.1 Real-Time Optimal Control Law Design. . . . . . . . . . . . . . . 105\n5.2.2 Discretization Using Legendre Pseudospectral Method . . . . 108\n5.2.3 Computational Considerations of Quadratic\n\nProgramming Problem. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n5.2.4 Numerical Simulations . . . . . . . . . . . . . . . . . . . . . . . . . . . . 109\n\n5.3 Decentralized Formation Control Using Local Relative\nMeasurements . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 112\n5.3.1 Problem Formulation of Decentralized Formation\n\nControl . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 113\n5.3.2 Decentralized Formation Control Design. . . . . . . . . . . . . . . 116\n5.3.3 Optimal Guaranteed Cost Control Design . . . . . . . . . . . . . . 121\n5.3.4 Simulation Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124\n\n5.4 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 127\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 129\n\n6 Decentralized Control for Attitude Synchronization\nUnder Undirected Communication Topology . . . . . . . . . . . . . . . . . . . 131\n6.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131\n6.2 Satellite Attitude Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 133\n6.3 Problem Formulation of Attitude Synchronization . . . . . . . . . . . . . 136\n6.4 Decentralized Robust Adaptive Control for Attitude\n\nSynchronization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 136\n6.4.1 Multi-satellite Sliding Manifold. . . . . . . . . . . . . . . . . . . . . . 137\n6.4.2 Decentralized Adaptive Sliding Mode Control Design . . . . 139\n6.4.3 Smoothing Control Law . . . . . . . . . . . . . . . . . . . . . . . . . . . 143\n\n6.5 Velocity-Free Coordinated Attitude Control . . . . . . . . . . . . . . . . . . 145\n6.6 Simulation Studies . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 150\n\n6.6.1 Decentralized Adaptive Sliding Mode Control . . . . . . . . . . 151\n6.6.2 Velocity-Free Coordinated Attitude Control . . . . . . . . . . . . 157\n\n6.7 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161\n\n7 Decentralized Control for Attitude Synchronization\nUnder Directed Communication Topology . . . . . . . . . . . . . . . . . . . . . 165\n7.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 165\n7.2 Decentralized Adaptive Robust Control for Attitude\n\nSynchronization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 166\n7.2.1 Multi-satellite Sliding Manifold. . . . . . . . . . . . . . . . . . . . . . 166\n7.2.2 Decentralized Adaptive Sliding Mode Control Design . . . . 167\n\n7.3 Decentralized Adaptive Backstepping Control for Attitude\nSynchronization with Communication Delay . . . . . . . . . . . . . . . . . 171\n\nContents ix\n\n\n\n7.4 Numerical Results. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 177\n7.4.1 Decentralized Adaptive Sliding Mode Control . . . . . . . . . . 178\n7.4.2 Decentralized Adaptive Backstepping Control. . . . . . . . . . . 184\n\n7.5 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191\n\n8 Conclusions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193\n8.1 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193\n8.2 Trends and Challenges . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195\nReferences. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 196\n\nAppendix A: Algebraic Graph Theory . . . . . . . . . . . . . . . . . . . . . . . . . . . 197\n\nAppendix B: Optimal Guaranteed Cost Control. . . . . . . . . . . . . . . . . . . . 199\n\nAppendix C: Nomenclature . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 203\n\nx Contents\n\n\n\nChapter 1\nIntroduction\n\n1.1 Background\n\n1.1.1 Motivations\n\nAutonomous formation flying of multiple small satellites to replace a single large\nsatellite will be an enabling technology for a number of future defense- and\nscience-based space missions. Formation flying is defined as a set of more than one\nsatellite whose dynamic states are coupled through a common control law. In\nparticular, at least one member of the set must (1) track a desired state relative to\nanother member, and (2) the tracking control law must make use of the state of at\nleast one of other members. The second point is critical. For example, even though\nspecific relative positions are actively maintained, the Global Positioning System\n(GPS) satellites constitute a constellation but not formation flying since orbit cor-\nrection control law of GPS satellites only makes use of their own position and\nvelocity. Though there are potential limitations, the benefits of using multiple\nsatellites are obvious. As compared to a conventional single large satellite, satellite\nformation can increase the reliability and redundancy of the whole system, reduce\nthe cost of launching and maintenance, greatly widen the surveillance area, and add\nmore flexibility into the mission design. For instance, a ground observing sensor\ncan be carried by several satellites flying in a specified formation to increase\naperture size rather than construct a large and much more expensive single satellite.\nWith a single satellite, the whole mission will be aborted in the event of satellite\nfailure. However, a failed satellite in a formation can be mitigated in the sense that\nmission can be reorganized using remaining member satellites in the formation. In\naddition, formation flying technology enables us to easily add more satellites into\nthe mission or upgrade any satellite.\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_1\n\n1\n\n\n\n1.1.2 Applications\n\nPotential applications of satellite formation flying include synthetic apertures for\nsurveillance and interferometry missions, and for field measurements and atmo-\nspheric survey missions, as well as on-orbit satellite inspection, maintenance, and\nrecovery. There are a number of missions which benefit from satellite formation in\neither low Earth orbit (LEO) or deep space. For example, TechSat21 (Martin et al.\n2001) and Orion/Emerald (Busse et al. 2001), though never launched, paved the\nway for cooperative satellite operations. Several missions have been deployed,\nincluding EO-1/LandSat7 (Ungar et al. 2003), GRACE (Tapley et al. 2004),\nCLUSTER II/Phoenix (Escoubet et al. 2012), FORMOSAT-3/COSMIC (Wu et al.\n2005), PRISMA (Bodin et al. 2012), and TanDEM-X/TerraSAR-X (Buckreuss\net al. 2015). The CLUSTER, PRISMA, and TanDEM-X/TerraSAR-X missions are\nshown in Figs. 1.1, 1.2, and 1.3, respectively. In particular, Magnetospheric\nMultiscale Mission (MMS) (Fuselier et al. 2014) was launched in March 12, 2015.\nMMS is a National Aeronautics and Space Administration (NASA) unmanned\nspace mission, to study the Earth\u2019s magnetosphere using four identical spacecraft\nflying in a tetrahedral formation. It is designed to gather information about the\n\nFig. 1.1 Cluster formation. European Space Agency (ESA)\u2019s cluster is currently investigating the\nEarth\u2019s magnetic environment and its interaction with the solar wind in three dimensions. Science\noutput from cluster greatly advances our knowledge of space plasma physics, space weather, and\nthe Sun\u2013Earth connection and has been a key in improving the modeling of the magnetosphere and\nunderstanding its various physical processes (http://sci.esa.int/cluster)\n\n2 1 Introduction\n\nhttp://sci.esa.int/cluster\n\n\nmicrophysics of magnetic reconnection, energetic particle acceleration, and turbu-\nlence, processes that occur in many astrophysical plasmas. All of the missions have\nprescribed relative motion and attitude requirements, which are designed to meet\nspecific objectives.\n\n1.1.3 Challenges\n\nThe advantages from using satellite formations come at a cost of increased com-\nplexity and challenges, including high-precision relative navigation (Montenbruck\net al. 2011), distributed communication (Smith and Hadaegh 2007), fault detection\n(Lee et al. 2014; Wu et al. 2014), stable formation design (Roscoe et al. 2013),\ntrajectory optimization and control (Wu et al. 2009, 2016), and attitude synchro-\nnization (Wu et al. 2011, 2013). Specifically, the trajectory optimization and control\nproblem can be decomposed into two tasks: (i) Formation keeping to maintain the\nsatellites in a stable formation to within specified precision against various orbital\nperturbations and (ii) Formation maneuver to guide and execute control command\nto reconfigure from existing satellite formation to another stable formation.\n\nFig. 1.2 PRISMA provides a technology demonstration mission for the in-flight validation of\nsensor technologies and guidance/navigation strategies for spacecraft formation flying and\nrendezvous. PRISMA originates from an initiative of the Swedish National Space Board (SNSB)\nand the Swedish Space Corporation (SSC) and provides a precursor mission for critical\ntechnologies related to advanced formation flying and in-orbit Servicing (http://www.weblab.dlr.\nde/rbrt/GpsNav/Prisma/Prisma.html)\n\n1.1 Background 3\n\nhttp://www.weblab.dlr.de/rbrt/GpsNav/Prisma/Prisma.html\nhttp://www.weblab.dlr.de/rbrt/GpsNav/Prisma/Prisma.html\n\n\nAttitude synchronization, to maintain accurate relative orientation between satel-\nlites, is also critical in many satellite formation missions. For instance, in inter-\nferometry application, the relative orientation between satellites in a formation is\nrequired to be maintained precisely during formation maneuvers. In inter-satellite\nlaser communication operation, the participating satellites are also required to\nmaintain accurate relative attitude throughout the communication process.\n\n1.2 Objectives of This Book\n\nThe major objectives of this book are to describe the developments of relative\nmotion dynamics, formation design methods, optimal formation maneuver and\nkeeping methods, and attitude synchronization controllers for satellite formation\nmissions.\n\nFig. 1.3 The primary objective of TanDEM-X/TerraSAR-X mission is the generation of a\nconsistent global Digital Elevation Model (DEM) with an unprecedented accuracy. In the mission,\ntwo identical Earth observation satellites using synthetic aperture radar are in a closely controlled\nformation with typical distances between 250 and 500 m. The mission was implemented in a\nPublic\u2013Private Partnership between the German Aerospace centre (DLR) and EADS Astrium and\nwas launched in June 2010 (https://en.wikipedia.org/wiki/TanDEM-X)\n\n4 1 Introduction\n\nhttps://en.wikipedia.org/wiki/TanDEM-X\n\n\n\u2022 Firstly, this book provides detailed high fidelity nonlinear and linear relative\nmotion dynamics considering J2 perturbation and eccentricity for satellite for-\nmation design.\n\n\u2022 Secondly, this book designs passive and periodic satellite formations consid-\nering J2 perturbation and eccentricity.\n\n\u2022 Thirdly, this book proposes fuel-optimal trajectory optimization methods for\nsatellite formation maneuver using a low-thrust propulsion system.\n\n\u2022 Fourthly, this book examines fuel-optimal formation keeping methods in both\nleader-follower and decentralized frame.\n\n\u2022 Lastly, this book presents decentralized control laws for attitude synchronization\nin the presence of model uncertainties and external disturbances for both\nundirected and directed inter-satellite communication topologies.\n\n1.3 Preview of Chapters\n\nThis book is organized into 7 chapters. The details of each chapter are as follows:\n\n\u2022 Chapter 2: An exact J2 nonlinear model of satellite relative motion is developed\nbased on the Lagrangian mechanics. Next, with the aid of Gegenbauer\npolynomials, the nonlinear model is linearized to a complete J2 linear relative\nmodel. Furthermore, by means of eliminating the second order J2 effect, the\nlinear model is further approximated to a first order J2 linear relative model.\nFinally, a simulation method with a modeling error index is introduced for\ncomparing and evaluating various relative motion dynamics in the literature.\n\n\u2022 Chapter 3: Passive and periodic relative trajectories are a practical option for\nlong-term satellite formation flying. This chapter investigates periodic and\nquasi-periodic satellite relative orbits at critical inclination. Also, periodic and\nstable in-plane formations are discussed. In particular, a special in-plane for-\nmation named as Almost Constant Separation Formation is achieved by suitably\ndesigning the differential secular elements of the argument of perigee and the\nmean anomaly.\n\n\u2022 Chapter 4: A fuel-optimal nonlinear trajectory optimization approach using\nLegendre pseudospectral method is proposed for low-thrust satellite formation\nmaneuver. Accurate and collision-free maneuver trajectories are obtained, and\nbounded desired final satellite formations are ensured.\n\n\u2022 Chapter 5: A real-time optimal control law in a leader-follower frame is\ndeveloped for satellite formation keeping in elliptic orbits. The proposed control\nlaw can prioritize between fuel consumption and control accuracy subject to the\ncontrol saturation constraints. Next, decentralized control using only local rel-\native measurements is proposed for satellite formation keeping in mildly elliptic\norbits. The proposed decentralized formation control architecture is completely\ndecentralized, and scalable.\n\n1.2 Objectives of This Book 5\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_3\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_4\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_5\n\n\n\u2022 Chapter 6: Two decentralized coordinated attitude control laws are developed\nfor attitude synchronization with undirected inter-satellite communication\ntopology. Firstly, an adaptive sliding mode control law is developed against\ninertia matrix uncertainties and external disturbances. In the event that angular\nvelocity measurement is unavailable, a novel coordinated attitude control law is\nsubsequently proposed.\n\n\u2022 Chapter 7: Two decentralized adaptive cooperative attitude control laws are\ndeveloped for directed inter-satellite communication topology. A robust adap-\ntive control law is proposed to handle inertia matrix uncertainties and external\ndisturbances. In addition, an adaptive backstepping control law which takes into\naccount communication delay is proposed.\n\nReferences\n\nBodin P, Noteborn R, Larsson R, Karlsson T, D\u2019Amico S, Ardaens JS, Delpech M, Berges JC\n(2012) The prisma formation flying demonstrator: overview and conclusions from the nominal\nmission. In: 35th annual AAS guidance and control conference, pp 441\u2013460\n\nBuckreuss S, Steinbrecher U, Schattler B (2015) The TerraSAR-X mission status. In: IEEE 5th\nasia-pacific conference on synthetic aperture radar (APSAR), pp 357\u2013361. doi:10.1109/\nAPSAR.2015.7306224\n\nBusse FD, How JP, Simpson J, Leitner J (2001) Orion-emerald: carrier differential GPS for LEO\nformation flying. In: IEEE aerospace conference proceedings, vol 2, pp 2523\u20132533\n\nEscoubet C, Schmidt R, Russell C (2012) The cluster and PHOENIX missions. Springer Science\n& Business Media\n\nFuselier SA, Lewis WS, Schiff C, Ergun R, Burch JL, Petrinec SM, Trattner KJ (2014)\nMagnetospheric multiscale science mission profile and operations. Space Sci Rev 1\u201327. doi:\n10.1007/s11214-014-0087-x\n\nLee D, Kumar KD, Sinha M (2014) Fault detection and recovery of spacecraft formation flying\nusing nonlinear observer and reconfigurable controller. Acta Astronaut 97:58\u201372. doi:10.1016/\nj.actaastro.2013.12.002\n\nMartin M, Klupar P, Kilberg S, Winter J (2001) TechSat 21 and revolutionizing space missions\nusing microsatellites. In: AIAA small satellite conference\n\nMontenbruck O, Wermuth M, Kahle R (2011) GPS based relative navigation for the TanDEM-X\nmission\u2014first flight results. Navigation 58(4):293\u2013304. doi:10.1002/j.2161-4296.2011.\ntb02587.x\n\nRoscoe CWT, Vadali SR, Alfriend KT, Desai UP (2013) Satellite formation design in orbits of high\neccentricity with performance constraints specified over a region of interest: MMS phase II.\nActa Astronaut 82(1):16. doi:10.1016/j.actaastro.2012.07.028\n\nSmith RS, Hadaegh FY (2007) Distributed estimation, communication and control for deep space\nformations. IET Control Theory Appl 1(2):445. doi:10.1049/iet-cta:20050460\n\nTapley BD, Bettadpur S, Watkins M, Reigber C (2004) The gravity recovery and climate\nexperiment: mission overview and early results. Geophys Res Lett 31(9):L09604\u2013L09607.\ndoi:10.1029/2004GL019920\n\nUngar SG, Pearlman JS, Mendenhall JA, Reuter D (2003) Overview of the earth observing one\n(EO-1) mission. Trans Geosci Remote Sens 41(6):1149\u20131159. doi:10.1109/TGRS.2003.\n815999\n\nWu BH, Chu V, Chen P, Ting T (2005) FORMOSAT-3/COSMIC science mission update. GPS\nSolut 9(2):111\u2013121. doi:10.1007/s10291-005-0140-z\n\n6 1 Introduction\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_7\nhttp://dx.doi.org/10.1109/APSAR.2015.7306224\nhttp://dx.doi.org/10.1109/APSAR.2015.7306224\nhttp://dx.doi.org/10.1007/s11214-014-0087-x\nhttp://dx.doi.org/10.1016/j.actaastro.2013.12.002\nhttp://dx.doi.org/10.1016/j.actaastro.2013.12.002\nhttp://dx.doi.org/10.1002/j.2161-4296.2011.tb02587.x\nhttp://dx.doi.org/10.1002/j.2161-4296.2011.tb02587.x\nhttp://dx.doi.org/10.1016/j.actaastro.2012.07.028\nhttp://dx.doi.org/10.1049/iet-cta:20050460\nhttp://dx.doi.org/10.1029/2004GL019920\nhttp://dx.doi.org/10.1109/TGRS.2003.815999\nhttp://dx.doi.org/10.1109/TGRS.2003.815999\nhttp://dx.doi.org/10.1007/s10291-005-0140-z\n\n\nWu B, Wang D, Poh EK, Xu G (2009) Nonlinear optimization of low-thrust trajectory for satellite\nformation: legendre pseudospectral approach. J Guid Control Dyn 32(4):1371\u20131381. doi:10.\n2514/1.37675\n\nWu B, Wang D, Poh EK (2011) Decentralized robust adaptive control for attitude synchronization\nunder directed communication topology. J Guid Control Dyn 34(4):1276\u20131282. doi:10.2514/1.\n50189\n\nWu B, Wang D, Poh EK (2013) Decentralized sliding-mode control for attitude synchronization in\nspacecraft formation. Int J Robust Nonlinear Control 23(11):1183\u20131197. doi:10.1002/rnc.2812\n\nWu B, Wang D, Poh EK (2014) Decentralized sliding-mode control for spacecraft attitude\nsynchronization under actuator failures. Acta Astronaut 105(1):333\u2013343. doi:10.1016/j.\nactaastro.2014.10.011\n\nWu B, Xu G, Cao X (2016) Relative dynamics and control for satellite formation: accommodating\nJ2 perturbation. J Aerosp Eng 4016011. doi:10.1061/(ASCE)AS.1943-5525.0000600\n\nReferences 7\n\nhttp://dx.doi.org/10.2514/1.37675\nhttp://dx.doi.org/10.2514/1.37675\nhttp://dx.doi.org/10.2514/1.50189\nhttp://dx.doi.org/10.2514/1.50189\nhttp://dx.doi.org/10.1002/rnc.2812\nhttp://dx.doi.org/10.1016/j.actaastro.2014.10.011\nhttp://dx.doi.org/10.1016/j.actaastro.2014.10.011\nhttp://dx.doi.org/10.1061/(ASCE)AS.1943-5525.0000600\n\n\nChapter 2\nDynamic Models of Satellite Relative\nMotion Around an Oblate Earth\n\nAccurate dynamic model of relative motion is basic and critical to the study of\nsatellite formation flying. Hence, accurate nonlinear and linear dynamic models of\nsatellite relative motion considering J2 perturbation are derived in this chapter.\nFirstly, an exact J2 nonlinear model of satellite relative motion is developed based\non the Lagrangian mechanics. Subsequently, with the aid of Gegenbauer polyno-\nmials, the nonlinear model is linearized to a complete J2 linear relative model.\nFinally, by means of eliminating the second-order J2 effect, the linear model is\nfurther approximated to a first-order J2 linear relative model. Simulation results\nshow that the exact J2 nonlinear model produces exact results, and the first-order J2\nlinear model also performs well under conditions that the inter-satellite distance is\nsmall and time duration is short.\n\nMany relative dynamic models have been derived in the literature under different\nassumptions and using different methodologies. A comparison study is necessary to\nselect an appropriate model for a specific mission and determine what kind of\nperturbation should be considered for specific applications. Thus, in this chapter, a\nsimulation method with a modeling error index is also introduced for comparing\nand evaluating various existing models for relative motion of satellites flying in\nformation. The comparison results show that, when the Earth aspherical gravity and\nthe air drag are present, the accuracy of some models is affected adversely by\neccentricity, semimajor axis, inclination, and formation size. The numerical results\nprovide valuable information for formation design.\n\n2.1 Introduction\n\nThe autonomous formation flying of multiple small satellites to replace a single large\nsatellite will be an enabling technology for many future space missions. Potential\napplications include surveillance missions, field measurement missions, and atmo-\nspheric survey missions. With the desire to maneuver or keep a long-term flying\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_2\n\n9\n\n\n\nsatellite formation comes the need to predict accurate relative position and velocity\nbetween satellites. Many studies on relative motion of satellites flying in motion have\nbeen reported in the literature. Researchers initially use a set of linearized differential\nequations, i.e., Hill\u2019s equations (Hill 1878), which is also known as Clohessy-\nWiltshire (CW) equations (Clohessy and Wiltshire 1960), to describe the relative\nmotion of two satellites in near-circular orbits. Though CW equations had been suc-\ncessfully used in rendezvous scenario, its model error accumulates over time such that\nits solution becomes erroneous and unacceptable for long duration formation flying.\n\nThere has been active research interest to derive a simple and accurate dynamic\nmodel for formation design, guidance and control. Many dynamic models have been\ndeveloped to cater various applications. Generally speaking, these dynamic models\ncan be classified into three categories. The first category is the direct ordinary\ndifferential equation (ODE) models, which are mostly extensions or modifications of\nCW equations (Tschauner and Hempel 1965; Kechichian 1998; Schweighart and\nSedwick 2002, 2005; Tillerson and How 2002; Vadali et al. 2001; Ross 2003;\nRoberts and Roberts 2004; Pluym and Damaren 2006; Inalhan et al. 2002; Gurfil\n2005; Xu and Wang 2008; Morgan et al. 2012). As these models are in the form of\ndifferential equations, they have significant applications in controller design. The\nsecond category is the indirect models, which are usually expressed in differences of\norbit elements (Schaub and Alfriend 2001; Schaub 2002, 2004). It is easier to use the\nsecond category of models to design the satellite formation because they describe the\nformation geometry directly. The third category is the solution-based models, which\nare usually in the form of state transition matrix (STM) (Gim and Alfriend 2005;\nSengupta et al. 2007; Palmer and Imre 2007; Lee et al. 2007). Using STM, though it\nis very complicated, one can directly generate the satellite relative motion.\n\nFor the direct ODE models, CW equations were first extended to unperturbed\nrelative motion that takes into account of eccentricity and/or nonlinearity.\nTschauner and Hempel (1965) solved the satellite relative motion in elliptical\norbits. Analytical solution to their model can be derived both in true anomaly and\ntime domain (Tschauner and Hempel 1965; Tillerson and How 2002). The second\norder J2 effect is the dominant perturbation for satellite formation missions. As\nsuch, a J2 dynamic model of satellite relative motion in terms of differential\nequations in the local vertical local horizontal (LVLH) coordinate is significantly\nuseful for the study of satellite formation flying in low Earth orbits. In fact, different\nJ2 dynamic equations have been developed. A noteworthy work was reported by\nKechichian (1998), in which an exact nonlinear relative model that includes both\nthe J2 perturbation and the air drag was developed. Kechichian applied Newtonian\nmechanics and applied vector calculus to derive the relative dynamics. His result is\nvery complex and represented equivalently by 12 first-order differential equations.\nIn particular, some components of J2 acceleration are not explicitly expressed in the\nrelative model, and instead, a tedious algorithm is provided to calculate these J2\nacceleration components.\n\nSome recent attempts have been done on the development of J2 linear dynamics.\nSchweighart and Sedwick (2002, 2005) developed a hybrid J2 linear model in\nnear-circular orbits using averaged J2 acceleration. Equations of this model on the\n\n10 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nin-plane motion are linear time invariant (LTI) and somewhat similar to CW model\n(Clohessy and Wiltshire 1960), while equations to describe the cross-track motion\nare linear time varying (LTV). To simplify the cross-track dynamics, Tillerson and\nHow (2002) combined the cross-track dynamics proposed by Vadali et al. (2001)\nwith the in-plane dynamics of Schweighart and Sedwick. Some other results are\nreported (Ross 2003; Roberts and Roberts 2004; Pluym and Damaren 2006).\nA common assumption of those works is that the reference satellite flies in an\nunperturbed Keplerian orbit. As a result, the accuracy and the applicability of these\nmodels are limited.\n\nIn this chapter, similar to Kechichian\u2019s work, the satellite relative dynamics is\nstudied based on the perturbed reference orbit, which is accurately described by a\nset of differential equations (Xu and Wang 2008b). A modification to the\nKechichian\u2019s method is that the reference orbit is expressed simpler in terms of\nReference Satellite Variables (RSV). Different from Kechichian\u2019s techniques,\nLagrangian mechanics is used to derive the satellite relative dynamics.\nConsequently, an exact J2 nonlinear relative model is obtained, which is inde-\npendent of the right ascension of ascending node such that the satellite relative\nmotion is completely expressed by 11 simple first-order differential equations.\nFurthermore, the complete J2 linear relative model and the first-order J2 linear\nrelative model are derived by removing the nonlinear effect and the second-order J2\neffect (Xu and Wang 2008b). By means of numerical study, it is found that the\nnonlinear effect and the second-order J2 effects introduce errors in opposite direc-\ntions, so that they counteract each other somewhat. As a result, the first-order J2\nlinear relative model is suitable for short-duration formation maneuver and keeping.\n\n2.2 Nonlinear Dynamic Model of Relative Motion\n\n2.2.1 J2 Reference Satellite Dynamics in LVLH Frame\n\nIn the study, one satellite, or a virtual satellite, is taken as reference satellite and others\nas member satellites. Without loss of generality, a 2-satellite system is considered,\ni.e., a free-flying reference satellite S0 (without control force) and a controlled\nmember satellite Sj (with control force). This subsection is devoted to explicitly\nestablish the J2 dynamics of the single reference satellite S0 in the local rotating frame.\n\n2.2.1.1 Properties of LVLH Frame\n\nTwo Cartesian coordinates are used in this study. As shown in Fig. 2.1,\nEarth-centered inertial (ECI) coordinate is spanned by unit vectors X?; Y?; Z?\n\n? ?\n.\n\nLVLH coordinate x?; y?; z?\u00f0 \u00de is attached on reference satellite S0. Vectors r and _r\ndenote the position and the velocity of satellite S0, respectively. Hence, the vector\n\n2.1 Introduction 11\n\n\n\nof angular momentum per unit mass is defined by h \u00bc r? _r. Furthermore, r \u00bc rk k\nand h \u00bc hk k denote the geocentric distance and the magnitude of angular\nmomentum of satellite S0, where ?k k denotes Euclidean norm. Then, the LVLH\ncoordinate is spanned by unit vectors\n\nx? \u00bc r\nr\n\ny? \u00bc z?? x? z? \u00bc h\nh\n\n\u00f02:1\u00de\n\nVectors in LVLH coordinate and ECI coordinate can be transformed (Battin\n1999) to each other by the rotation matrix R as\n\nX? Y? Z?\n? ?T\u00bc R x? y? z?\u00bd ?T \u00f02:2\u00de\n\nwith\n\nR \u00bc\nchcX ? shcisX ?shcX ? chcisX sisX\nchsX \u00fe shcicX ?shsX \u00fe chcicX ?sicX\n\nshsi chsi ci\n\n2\n4\n\n3\n5 \u00f02:3\u00de\n\nwhere s? \u00bc sin ?\u00f0 \u00de; c? \u00bc cos ?\u00f0 \u00de, i is the inclination, ? is the true latitude, and ? is\nthe right ascension of ascending node.\n\nThe angular velocity of rotating LVLH frame is\n\nx \u00bc xxx?\u00fexzz? \u00f02:4\u00de\n\nNote that the component around y-axis is zero, i.e., xy \u00bc 0 (Kechichian 1998).\nThe component xz is referred as the orbital rate, and the component xx denotes the\nsteering rate of the orbital plane. Angular velocity ? can be expressed by Eulerian\nangles X; i; h\u00f0 \u00de, and its three components are (Kechichian 1998; Breakwell 1974):\n\nFig. 2.1 ECI and LVLH\ncoordinates\n\n12 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nxx \u00bc _ich \u00fe _Xshsi \u00f02:5\u00de\n\nxy \u00bc ?_ish \u00fe _Xchsi \u00bc 0 \u00f02:6\u00de\n\nxz \u00bc _h\u00fe _Xci \u00f02:7\u00de\n\nUsing Eq. (2.4), velocities of unit vectors of LVLH frame are expressed as\nfollows:\n\n_?x \u00bc x? x? \u00bc xzy? _?y \u00bc x? y? \u00bc xxz?? xzx? _?z \u00bc x? z? \u00bc ?xxy? \u00f02:8\u00de\n\nThen, the velocity of satellite S0 is computed to\n\n_r \u00bc d\ndt\n\nrx?\u00f0 \u00de \u00bc _rx?\u00fe rxzy? \u00f02:9\u00de\n\nUsing Eq. (2.9), the angular momentum can be expressed as\n\nh \u00bc r? _r \u00bc r2xzz? \u00f02:10\u00de\n\nComparing Eq. (2.10) with the last equation in (2.1), it is concluded that the\nmagnitude of angular momentum is\n\nh \u00bc xzr2 \u00f02:11\u00de\n\nTaking time derivative to Eq. (2.11), the rate of angular momentum is obtained\nas\n\n_h \u00bc 2xzr _r\u00fe _xzr2 \u00f02:12\u00de\n\n2.2.1.2 J2 Dynamics of a Satellite in LVLH Frame\n\nThe dynamics of reference satellite S0 in LVLH frame considering both the\nspherical gravitational potential and the oblate \u00f0J2\u00de gravitational potential is derived\nin this section. The governing equation is\n\n\u20acr \u00bc ?rU \u00f02:13\u00de\n\nwith\n\nU \u00bc ? l\nr\n? 3J2lR\n\n2\ne\n\n2r3\n1\n3\n? s2/\n\n? ?\n\u00f02:14\u00de\n\n2.2 Nonlinear Dynamic Model of Relative Motion 13\n\n\n\nwhere U is the gravitational potential energy of satellite. r denotes the vector\ndifferential operator. ? is the Earth gravitational constant. J2 is the second zonal\nharmonic coefficient of the Earth. Re is the Earth equatorial radius, and ? is the\ngeocentric latitude of satellite S0.\n\nUsing Eqs. (2.8) and (2.9), the left side of Eq. (2.13) is calculated as\n\n\u20acr \u00bc \u20acr ? x2z r\n? ?\n\nx?\u00fe _xzr\u00fe 2xz _r\u00f0 \u00dey?\u00fe xxxzr\u00f0 \u00dez? \u00f02:15\u00de\n\nUsing Eqs. (2.11) and (2.12), xz and _xz in Eq. (2.15) can be replaced by h and\n_h, and then, Eq. (2.15) is converted to\n\n\u20acr \u00bc \u20acr ? h\n2\n\nr3\n\n? ?\nx?\u00fe\n\n_h\nr\ny?\u00fe xxh\n\nr\nz? \u00f02:16\u00de\n\nNext, the gradient of U in Eq. (2.14) is computed in LVLH frame to be\n\nrU \u00bc l\nr2\nx?\u00fe kJ2\n\nr4\n1? 3s2i s2h\n? ?\n\nx?\u00fe kJ2s\n2\ni s2h\nr4\n\ny?\u00fe kJ2s2ish\nr4\n\nz? \u00f02:17\u00de\n\nwhere the constant kJ2 is defined as\n\nkJ2 \u00bc 3J2lR\n2\ne\n\n2\n\u00f02:18\u00de\n\nSubstituting Eqs. (2.16) and (2.17) into Eq. (2.13), the below three equations are\nobtained\n\nxx \u00bc ? kJ2s2ishhr3 \u00f02:19\u00de\n\n\u20acr \u00bc ? l\nr2\n\n\u00fe h\n2\n\nr3\n? kJ2\n\nr4\n1? 3s2i s2h\n? ? \u00f02:20\u00de\n\n_h \u00bc ? kJ2s\n2\ni s2h\nr3\n\n\u00f02:21\u00de\n\nReplacing xx in Eq. (2.5) by Eq. (2.19), differential terms \u00f0 _X; _i\u00de are solved using\nEqs. (2.5) and (2.6)\n\n_X \u00bc ? 2kJ2cis\n2\nh\n\nhr3\n\u00f02:22\u00de\n\n_i \u00bc ? kJ2s2is2h\n2hr3\n\n\u00f02:23\u00de\n\n14 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nSubstituting Eq. (2.22) into Eq. (2.7), and considering Eq. (2.11), _h is also\nsolved\n\n_h \u00bc h\nr2\n\n\u00fe 2kJ2c\n2\ni s\n\n2\nh\n\nhr3\n\u00f02:24\u00de\n\nThe results established are presented in the following theorem.\n\nTheorem 2.1 Considering spherical gravity and J2 gravity of the Earth, the motion\nof the reference satellite S0 can be described by a set of differential equations as in\nEqs. (2.20), (2.21), (2.23) and (2.24) in terms of Reference Satellite Variables\n(RSV) _r; r; h;X; i; h\u00f0 \u00de.\nRemark 2.1 It is noticed that five variables _r; r; h; i; h\u00f0 \u00de are independent of ?. This\nis expected because J2 gravity is independent of the change of ?.\n\nThe rotation rate of LVLH frame can be expressed conveniently in terms of RSV\nand also independent of ?. The steering rate xx is obtained in Eq. (2.19). The\norbital rate xz is the direct result of (2.11), i.e.,\n\nxz \u00bc hr2 \u00f02:25\u00de\n\nTaking time derivative Eqs. (2.19) and (2.25), respectively, and considering\nEqs. (2.21), (2.23), and (2.24), the steering acceleration ax and the orbital accel-\neration az are derived as\n\nax \u00bc _xx \u00bc ? kJ2s2ichr5 \u00fe\n3_rkJ2s2ish\n\nr4h\n? 8k\n\n2\nJ2s\n\n3\ni cis\n\n2\nhch\n\nr6h2\n\u00f02:26\u00de\n\naz \u00bc _xz \u00bc ? 2h_rr3 ?\nkJ2s2i s2h\n\nr5\n\u00f02:27\u00de\n\n2.2.2 Derivation of Exact J2 Nonlinear Relative Dynamics\n\n2.2.2.1 Lagrangian Formulation of Relative Motion\n\nThe Lagrangian formulation is used to develop the relative dynamics of the member\nsatellite Sj. The Lagrangian formulation for satellite relative motion is\n\nd\ndt\n\n@Lj\n@ _qj\n\n !\n? @Lj\n@qj\n\n\u00bc aj \u00f02:28\u00de\n\n2.2 Nonlinear Dynamic Model of Relative Motion 15\n\n\n\nwhere qj \u00bc xj yj zj\u00bd ?T and aj \u00bc ajx ajy ajz\u00bd ?T are respectively the configu-\nrations and the control accelerations of satellite Sj in LVLH coordinate, and Lj is its\nLagrangian, which can be further expressed in the form of\n\nLj q0; _q0; qj; _qj\n? ? \u00bc Kj q0; _q0; qj; _qj? ?? Uj q0; qj? ? \u00f02:29\u00de\n\nwhere q0 are configurations of reference satellite S0 in ECI coordinate. Kj and Uj\nare respectively the kinetic and potential energies of the j-th member satellite. Since\nkinetic energy Kj arises from inertial motion, it depends on the relative motion\nqj; _qj\n? ?\n\nof satellite Sj in LVLH coordinate as well as the transport motion q0; _q0\u00f0 \u00de of\nLVLH frame in ECI coordinate. On the other hand, potential energy Uj is solely due\nto gravity and thus is independent of velocities. Substituting Eq. (2.29) into\nEq. (2.28) yields\n\nd\ndt\n\n@Kj\n@ _qj\n\n !\n? @Kj\n\n@qj\n\u00fe @Uj\n\n@qj\n\u00bc aj \u00f02:30\u00de\n\nwhich is the Lagrangian formulation for the relative motion of member satellite Sj\nin LVLH frame. Next, Eq. (2.30) is used to develop the dynamics of satellite\nrelative motion. The key steps are the precise calculations of kinetic energy Kj and\npotential energy Uj.\n\n2.2.2.2 Kinetic Energy\n\nAs shown in Fig. 2.2, the position of satellite Sj in LVLH frame is\n\nqj \u00bc xjx?\u00fe yjy?\u00fe zjz? \u00f02:31\u00de\n\nFig. 2.2 Geometry of the\nmember satellite\n\n16 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nThen, in ECI frame, it is\n\nrj \u00bc r\u00fe qj \u00bc xj \u00fe r\n? ?\n\nx?\u00fe yjy?\u00fe zjz? \u00f02:32\u00de\n\nUsing the identities in Eq. (2.8), the velocity of satellite Sj in inertial space is\ncalculated by taking time derivative of Eq. (2.32)\n\n_rj \u00bc vjxx?\u00fe vjyy?\u00fe vjzz? \u00f02:33\u00de\n\nwhere\n\nvjx \u00bc _xj \u00fe _r ? yjxz vjy \u00bc _yj \u00fe r\u00fe xj\n? ?\n\nxz ? zjxx vjz \u00bc _zj \u00fe yjxx \u00f02:34\u00de\n\nThen, the kinetic energy per unit mass of satellite Sj is computed as\n\nKj \u00bc 12 v\n2\njx \u00fe v2jy \u00fe v2jz\n\n? \t\n\u00bc 1\n\n2\n_xj \u00fe _r ? yjxz\n? ?2 \u00fe 1\n\n2\n_yj \u00fe r\u00fe xj\n\n? ?\nxz ? zjxx\n\n? ?2 \u00fe 1\n2\n\n_zj \u00fe yjxx\n? ?2 \u00f02:35\u00de\n\nwhere time-varying variables \u00f0_r; r;xx;xz\u00de are functions of RSV.\n\n2.2.2.3 Potential Energy\n\nConsidering J2 perturbation, the gravitational potential energy of member satellite\nSj is\n\nUj \u00bc ? lrj ?\nkJ2\nr3j\n\n1\n3\n? s2/j\n\n? ?\n\u00f02:36\u00de\n\nwhere /j and rj are the geocentric latitude and the geocentric distance of satellite Sj,\nrespectively. From Eq. (2.32), geocentric distance rj is immediately obtained as\n\nrj \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr\u00fe xj\n? ?2 \u00fe y2j \u00fe z2j\n\nq\n\u00f02:37\u00de\n\nFrom the geometry shown in Fig. 2.2, it is obtained\n\ns/j \u00bc\nrjZ\nrj\n\n\u00f02:38\u00de\n\nwhere rjZ is the projection of rj on Z axis of ECI frame. Since transformation R in\nEq. (2.3) is an orthogonal matrix, rj in Eq. (2.32) can be transformed to\n\n2.2 Nonlinear Dynamic Model of Relative Motion 17\n\n\n\nrjX rjY rjZ\u00bd ?T\u00bc R xj \u00fe r yj zj\u00bd ?T \u00f02:39\u00de\n\nwhere rjX , rjY and rjZ are the respective components of rj expressed in ECI frame\nand\n\nrjZ \u00bc r\u00fe xj\n? ?\n\nsish \u00fe yjsich \u00fe zjci \u00f02:40\u00de\n\nSubstituting Eq. (2.38) into Eq. (2.36), the potential energy of the j-th member\nsatellite is given by\n\nUj \u00bc ? lrj ?\nkJ2\n3r3j\n\n\u00fe kJ2r\n2\njZ\n\nr5j\n\u00f02:41\u00de\n\nwhere rj and rjZ are expressed in equations Eqs. (2.37) and (2.40).\n\n2.2.2.4 Exact Nonlinear J2 Relative Dynamics\n\nHaving kinetic energy in Eq. (2.35) and potential energy in Eq. (2.41), it is ready to\nuse Lagrangian formulation of Eq. (2.30) to derive the satellite relative dynamics.\nSubstituting Eq. (2.35) into the first two terms of Eq. (2.30), it is obtained\n\nd\ndt\n\n@Kj\n@ _qj\n\n !\n? @Kj\n\n@qj\n\u00bc\n\n\u20acxj ? 2 _yjxz ? xjx2z ? yjaz \u00fe zjxxxz ? r xz\u00f0 \u00de2 \u00fe \u20acr\u00f0 \u00de\n\u20acyj \u00fe 2 _xjxz ? 2_zjxx \u00fe xjaz ? yjx2z ? yjx2x ? zjax \u00fe 2_r xz\u00f0 \u00de\u00fe r az\u00f0 \u00de\n\n\u20aczj \u00fe 2 _yjxx \u00fe xjxxxz \u00fe yjax ? zjx2x \u00fe r xxxz\u00f0 \u00de\n\n2\n64\n\n3\n75\n\n\u00f02:42\u00de\n\nNext RSV dynamics are applied. The variables in round brackets in Eq. (2.42)\nare replaced with Eqs. (2.19), (2.20), (2.25), and (2.27). Furthermore, define\n\nf \u00bc 2kJ2sish\nr4\n\nn2 \u00bc l\nr3\n\n\u00fe kJ2\nr5\n\n? 5kJ2s\n2\ni s\n\n2\nh\n\nr5\n\u00f02:43\u00de\n\nWith some manipulations, Eq. (2.42) is converted to\n\nd\ndt\n\n@Kj\n@ _qj\n\n !\n? @Kj\n\n@qj\n\u00bc\n\n\u20acxj ? 2_yjxz ? xjx2z ? yjaz \u00fe zjxxxz ? rn2 ? fsish\n\u20acyj \u00fe 2 _xjxz ? 2_zjxx \u00fe xjaz ? yj x2z \u00fex2x\n\n? ?? zjax ? fsich\n\u20aczj \u00fe 2 _yjxx \u00fe xjxxxz \u00fe yjax ? zjx2x ? fci\n\n2\n4\n\n3\n5\n\n\u00f02:44\u00de\n\nOn the other hand, inserting Eq. (2.41) into the third term in Eq. (2.30), and\ndefining\n\n18 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nfj \u00bc\n2kJ2rjZ\nr5j\n\nn2j \u00bc\nl\n\nr3j\n\u00fe kJ2\n\nr5j\n? 5kJ2r\n\n2\njZ\n\nr7j\n\u00f02:45\u00de\n\nit is obtained\n\n@Uj\n@qj\n\n\u00bc n2j r\u00fe xj\n? ?\u00fe fjsish n2j yj \u00fe fjsich n2j zj \u00fe fjci? ?T \u00f02:46\u00de\n\nThen, substituting Eqs. (2.44) and (2.46) into Eq. (2.30), the exact J2 nonlinear\nmodel of the satellite relative motion is derived to be\n\n\u20acxj \u00bc 2 _yjxz ? xj n2j ? x2z\n? \t\n\n\u00fe yjaz ? zjxxxz ? fj ? f\n? ?\n\nsish ? r n2j ? n2\n? \t\n\n\u00fe ajx\n\u20acyj \u00bc ?2 _xjxz \u00fe 2_zjxx ? xjaz ? yj n2j ? x2z ? x2x\n\n? \t\n\u00fe zjax ? fj ? f\n\n? ?\nsich \u00fe ajy\n\n\u20aczj \u00bc ?2 _yjxx ? xjxxxz ? yjax ? zj n2j ? x2x\n? \t\n\n? fj ? f\n? ?\n\nci \u00fe ajz\n\u00f02:47\u00de\n\nNow, the nonlinear dynamic equations of the satellite relative motion can be\npresented in the following theorem.\n\nTheorem 2.2 Consider a 2-satellite system of the reference satellite S0 and the\nmember satellite Sj, as shown in Fig. 2.1. In the presence of spherical gravity and\nJ2 gravity of the Earth, the relative motion of the satellite Sj in the LVLH coordinate\ncan be described by (2.47). In dynamics (2.47), all time varying parameters\nr; i; h;xx;xz; ax; az; f; n2\u00f0 \u00de are functions of RSV, which are given by Eqs. (2.19),\n(2.23)\u2013(2.27) and (2.43). Variables fj; n2j\n\n? \t\nare nonlinear terms of configuration\n\nxj; yj; zj\n? ?\n\n, which are given by Eqs. (2.45), (2.37) and (2.40).\n\nRemark 2.2 Dynamics (2.47) is independent of the motion of right ascension of\nascending node ?. This interesting observation is understandable because only the\nspherical and J2 gravities of the Earth are included in the developed dynamics, and\nboth of them are axial symmetric and independent of the motion of ?. Therefore,\nthe satellite relative motion under J2 perturbation is actually described by 11\nfirst-order differential equations of xj; yj; zj; _xj; _yj; _zj\n\n? ?\nand r; _r; h; i; h\u00f0 \u00de.\n\nRemark 2.3 When relative model (2.47) is applied to study the problems of for-\nmation guidance and control, Eqs. (2.20)\u2013(2.24) in RSV dynamics are good can-\ndidate to propagate time-varying parameters \u00f0r; _r; h; i; h\u00de. However, they are not\nnecessary in practice and other techniques can be used to evaluate these parameters,\ne.g., the technique that combines the advantages of orbit propagator and statistical\norbit determination.\n\n2.2 Nonlinear Dynamic Model of Relative Motion 19\n\n\n\n2.3 Linearized Dynamic Models of Relative Motion\n\nIn dynamics of Eq. (2.47), n2j and fj are nonlinear terms of configurations \u00f0xj; yj; zj\u00de,\nbecause they both include polynomials of the reciprocal of rj. The technique of\nGegenbauer polynomials is applied in this section to linearize the nonlinear model\nof Eq. (2.47).\n\nBased on Fig. 2.2 and using the cosine theorem, rj can be expressed as\n\nr2j \u00bc r2 ? 2rqj cos a\u00fe q2j \u00f02:48\u00de\n\nwith\n\ncos a \u00bc ?r\u00f0 \u00de ? qj\nrqj\n\n\u00bc ? xj\nqj\n\n\u00f02:49\u00de\n\nEquation (2.48) can be converted to\n\n1\nr2kj\n\n\u00bc 1\nr2k\n\n1? 2 cos a qj\nr\n\n? \t\n\u00fe qj\n\nr\n\n? \t2? ??k\n\u00f02:50\u00de\n\nNext, Gegenbauer polynomials (ultraspherical polynomials) is introduced, which\nare generalizations of the associated Legendre polynomials and expressed as\n\nC k\u00f0 \u00den \u00f0u\u00de \u00bc\nC k\u00fe 1=2\u00f0 \u00de\n\nC 2k\u00f0 \u00de\nC n\u00fe 2k\u00f0 \u00de\n\nC n\u00fe k\u00fe 1=2\u00f0 \u00de\n?1\u00f0 \u00den\n2nn!\n\n1? u2? ??k\u00fe 1=2 dn\ndun\n\n1? u2? ?n\u00fe k?1=2\n\u00f02:51\u00de\n\nwhere C ?\u00f0 \u00de is the gamma function. The first two terms of Eq. (2.51) are\n\nC k\u00f0 \u00de0 \u00f0u\u00de \u00bc 1 C k\u00f0 \u00de1 \u00f0u\u00de \u00bc 2ku \u00f02:52\u00de\n\nThe generating function of Gegenbauer polynomials is, for\nk\u00fe 1=2\u00f0 \u00de[ 0; vj j\\1 and uj j ? 1,\n\n1? 2uv\u00fe v2? ??k\u00bcX1\nn\u00bc0\n\nC k\u00f0 \u00den \u00f0u\u00devn ? 1\u00fe 2ku\u00f0 \u00dev \u00f02:53\u00de\n\nLet\n\nu \u00bc cos a v \u00bc qj\nr\n\n\u00f02:54\u00de\n\nEquation (2.50) can be expanded in the form of Eq. (2.53) as\n\n20 2 Dynamic Models of Satellite Relative \u2026\n\n\n\n1\nr2kj\n\n? 1\nr2k\n\n1\u00fe 2k ? xj\nqj\n\n !\nqj\nr\n\n? \t !\n\u00bc 1\n\nr2k\n1? 2kxj\n\nr\n\n? ?\n\u00f02:55\u00de\n\nFor k \u00bc 3=2\u00f0 \u00de; 5=2\u00f0 \u00de; 7=2\u00f0 \u00de, Eq. (2.55) gives\n\n1\nr3j\n\n? 1\nr3\n\n? 3xj\nr4\n\n1\nr5j\n\n? 1\nr5\n\n? 5xj\nr6\n\n1\nr7j\n\n? 1\nr7\n\n? 7xj\nr8\n\n\u00f02:56\u00de\n\nSubstituting Eqs. (2.56) and (2.40) into Eq. (2.45), and removing higher-order\nterms, fj and n2j are linearized to\n\nfj ? f?\n8kJ2xjsish\n\nr5\n\u00fe 2kJ2yjsich\n\nr5\n\u00fe 2kJ2zjci\n\nr5\n\u00f02:57\u00de\n\nn2j ? n2 ?\n3lxj\nr4\n\n? 5kJ2xj 1? 5s\n2\ni s\n\n2\nh\n\n? ?\nr6\n\n? 5kJ2yjs\n2\ni s2h\n\nr6\n? 5kJ2zjs2ish\n\nr6\n\u00f02:58\u00de\n\nNow, Eqs. (2.57) and (2.58) are substituted into Eq. (2.47). After some opera-\ntions and removing higher-order terms, the complete J2 linear model is obtained\n\n\u20acxj \u00bc 2 _yjxz \u00fe xj 2n2 \u00fex2z \u00fe\n2kJ2\nr5\n\n1? s2i s2h\n? ?? ?\n\n\u00fe yj az \u00fe 4kJ2s\n2\ni s2h\n\nr5\n\n? ?\n? 5zjxxxz \u00fe ajx\n\n\u20acyj \u00bc ?2 _xjxz \u00fe 2_zjxx \u00fe xj\n4kJ2s2i s2h\n\nr5\n? az\n\n? ?\n\n? yj 2kJ2s\n2\ni c\n\n2\nh\n\nr5\n\u00fe n2 ? x2z ? x2x\n\n? ?\n\n\u00fe zj ax ? kJ2s2ichr5\n? ?\n\n\u00fe ajy\n\n\u20aczj \u00bc ?2 _yjxx ? 5xjxxxz ? yj kJ2s2ichr5 \u00fe ax\n? ?\n\n? zj n2 ? x2x \u00fe\n2kJ2c2i\nr5\n\n? ?\n\u00fe ajz\n\n\u00f02:59\u00de\n\nThe above equation can be rewritten into the following form\n\nd\ndt\n\n_xj\n_yj\n_zj\n\n2\n4\n\n3\n5 \u00bc A1\u00f0t\u00de _xj_yj\n\n_zj\n\n2\n4\n\n3\n5\u00feA2\u00f0t\u00de xjyj\n\nzj\n\n2\n4\n\n3\n5\u00fe ajxajy\n\najz\n\n2\n4\n\n3\n5 \u00f02:60\u00de\n\n2.3 Linearized Dynamic Models of Relative Motion 21\n\n\n\nwhere\n\nA1\u00f0t\u00de \u00bc\n0 2xz 0\n\n?2xz 0 2xx\n0 ?2xx 0\n\n2\n4\n\n3\n5 \u00f02:61\u00de\n\nA2\u00f0t\u00de \u00bc\n2n2 \u00fex2z \u00fe 2kJ2r5 1? s2i s2h\n\n? ?\naz \u00fe 4kJ2s\n\n2\ni s2h\n\nr5 ?5xxxz\n4kJ2s2i s2h\n\nr5 ? az\n2kJ2s2i c\n\n2\nh\n\nr5 \u00fe n2 ? x2z ? x2x ax ? kJ2s2ichr5\n?5xjxxxz kJ2s2ichr5 \u00fe ax n2 ? x2x \u00fe\n\n2kJ2c2i\nr5\n\n2\n664\n\n3\n775\n\n\u00f02:62\u00de\n\nThe above results can be summarized in the following corollary.\n\nCorollary 2.1 Consider a 2-satellite system of the reference satellite S0 and the\nmember satellite Sj, as shown in Fig. 2.1. In the presence of spherical gravity and\nJ2 gravity of the Earth, linear model of the relative motion of the satellite Sj in the\nLVLH coordinate can be derived as in (2.60)\u2013(2.62) by removal of nonlinear effect.\n\nSince the nonlinear effect is removed in the linear model of Eq. (2.59), it is only\nexpected to work for the satellite relative motion with small inter-satellite distance.\n\nFurther approximation can be made to the linear model of Eq. (2.59) by drop-\nping the second-order J2 terms. By removing x2x and replacing steering acceleration\nax with\n\nax ? ? kJ2s2ichr5 \u00fe\n3_rkJ2s2ish\n\nr4h\n\u00f02:63\u00de\n\nand substituting n2;xx;xz; az\u00f0 \u00de in Eqs. (2.43), (2.19), (2.25), and (2.27) into\nEq. (2.59), the first-order J2 linear model is derived as\n\n\u20acxj \u00bc 2 _yjhr2 \u00fe xj\n2l\nr3\n\n\u00fe h\n2\n\nr4\n\u00fe 4kJ2 1? 3s\n\n2\ni s\n\n2\nh\n\n? ?\nr5\n\n? ?\n\n? yj 2_rhr3 ?\n3kJ2s2i s2h\n\nr5\n\n? ?\n\u00fe 5kJ2zjs2ish\n\nr5\n\u00fe ajx\n\n\u20acyj \u00bc ?\n2 _xjh\nr2\n\n? 2kJ2 _zjs2ish\nr3h\n\n\u00fe xj 2_rhr3 \u00fe\n5kJ2s2i s2h\n\nr5\n\n? ?\n\n? yj lr3 ?\nh2\n\nr4\n\u00fe kJ2 1\u00fe 2s\n\n2\ni ? 7s2i s2h\n\n? ?\nr5\n\n? ?\n\u00fe zj 3kJ2 _rs2ishr4h ?\n\n2kJ2s2ich\nr5\n\n? ?\n\u00fe ajy\n\n\u20aczj \u00bc 2kJ2 _yjs2ishr3h \u00fe\n5kJ2xjs2ish\n\nr5\n? 3kJ2yj _rs2ish\n\nr4h\n\n? zj lr3 \u00fe\nkJ2 3? 2s2i ? 5s2i s2h\n? ?\n\nr5\n\n? ?\n\u00fe ajz\n\n\u00f02:64\u00de\n\n22 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nThe above equation can be rewritten into the following form\n\nd\ndt\n\n_xj\n_yj\n_zj\n\n2\n4\n\n3\n5 \u00bc A3\u00f0t\u00de _xj_yj\n\n_zj\n\n2\n4\n\n3\n5\u00feA4\u00f0t\u00de xjyj\n\nzj\n\n2\n4\n\n3\n5\u00fe ajxajy\n\najz\n\n2\n4\n\n3\n5 \u00f02:65\u00de\n\nwhere\n\nA3\u00f0t\u00de \u00bc\n0 2hr2 0\n\n? 2hr2 0 ? 2kJ2s2ishr3h\n0 2kJ2s2ishr3h 0\n\n2\n64\n\n3\n75 \u00f02:66\u00de\n\nA4\u00f0t\u00de \u00bc\n2l\nr3 \u00fe h\n\n2\n\nr4 \u00fe\n4kJ2 1?3s2i s2h\u00f0 \u00de\n\nr5 ? 2_rhr3 \u00fe\n3kJ2s2i s2h\n\nr5\n5kJ2s2ish\n\nr5\n\n2_rh\nr3 \u00fe\n\n5kJ2s2i s2h\nr5 ? lr3 \u00fe h\n\n2\n\nr4 ?\nkJ2 1\u00fe 2s2i ?7s2i s2h\u00f0 \u00de\n\nr5\n3kJ2 _rs2ish\n\nr4h ? 2kJ2s2ichr5\n5kJ2s2ish\n\nr5 ? 3kJ2 _rs2ishr4h ? lr3 ?\nkJ2 3?2s2i ?5s2i s2h\u00f0 \u00de\n\nr5\n\n2\n6664\n\n3\n7775\n\n\u00f02:67\u00de\n\nThe above result can be presented in the following corollary.\n\nCorollary 2.2 Consider a 2-satellite system of the reference satellite S0 and the\nmember satellite Sj, in the presence of spherical gravity and J2 gravity of the Earth,\nrelative motion model in the LVLH coordinate can be further simplified into linear\nequations as in (2.65)\u2013(2.67) by removal of nonlinear effect and second order J2\nterms.\n\nRemark 2.4 The relative motion dynamics described by (2.60) and (2.65) are both\nlinear time-varying system. The time-varying parameters in A1 t\u00f0 \u00de and\nA2\u00f0t\u00de;A3\u00f0t\u00de andA4\u00f0t\u00de are the parameters of the reference satellite and are explicitly\nexpressed in terms of RSV r; _r; h; i; h\u00f0 \u00de.\nRemark 2.5 Both the nonlinear effect and the second-order J2 effect have been\nremoved in dynamics of Eq. (2.64). As a result, it is simpler than the exact non-\nlinear model in Eq. (2.47) and the complete linear model in Eq. (2.59). Moreover,\nin the dynamics of Eq. (2.64), all time-varying parameters of the reference orbit are\nexplicitly expressed in terms of RSV r; _r; h; i; h\u00f0 \u00de.\n\n2.4 Validation of Proposed Dynamic Models\nby Simulation\n\nSimulations are carried out in MATLAB for three newly developed models, i.e., the\nexact J2 nonlinear model in Eq. (2.47), the complete J2 linear model in Eq. (2.59),\nand the first-order J2 linear model in Eq. (2.64). In the simulations, each newly\n\n2.3 Linearized Dynamic Models of Relative Motion 23\n\n\n\ndeveloped model is compared with an exact J2 propagator of satellite relative\nmotion, which actually works by taking the difference of integrated solutions of two\nabsolute J2 dynamics in ECI frame. To do the comparison, the same initial con-\nditions of the reference and member satellites are applied to the exact J2 propagator\nand the newly developed models that are combined with RSV dynamics of\nEqs. (2.20), (2.21), (2.23), and (2.24).\n\nDifferent low Earth reference orbits are simulated by changing the initial values\nof osculating orbital elements on eccentricity and inclination, while the initial\nvalues of other osculating orbital elements remain the same as\n\na 0\u00f0 \u00de \u00bc 7100 km; x 0\u00f0 \u00de \u00bc ?20?; f 0\u00f0 \u00de \u00bc 20?; X 0\u00f0 \u00de \u00bc 0 \u00f02:68\u00de\n\nIt is known that the projected circular orbit (PCO) of satellite relative motion\ndoes not exist around an eccentric and perturbed reference orbit. However, when\nthe eccentricity is small, the satellite relative orbit may nearly be a circle. Those\nrelative orbits are referred as the Quasi-PCO. In the model simulations, Quasi-PCO\nis used as the motion of the member satellite, whose initial conditions are given by\n\nxj 0\u00f0 \u00de \u00bc q=2; yj 0\u00f0 \u00de \u00bc 0; xj 0\u00f0 \u00de \u00bc q; _xj 0\u00f0 \u00de \u00bc 0; _zj 0\u00f0 \u00de \u00bc 0 \u00f02:69\u00de\n\nand\n\n_yj 0\u00f0 \u00de is the solution of the energymatching condition: \u00f02:70\u00de\n\nIn Eq. (2.69), q is the initial radius of Quasi-PCO. Under conditions of\nEqs. (2.68) and (2.69), as well as e \u00bc 0:05; i \u00bc 45? and q \u00bc 2:5 km, the\nQuasi-PCO under J2 perturbation is shown in Fig. 2.3.\n\nFigures 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, and 2.10 show the simulation results in terms\nof errors between each newly developed model and the exact J2 propagator in\nLVLH frame. Errors of the exact J2 nonlinear model, the complete J2 linear model,\nand the first-order J2 linear model are presented by dash-dotted lines, dashed lines,\nand solid lines, respectively.\n\nIt can be seen from each figure in Figs. 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, and 2.10 that\nthe model errors of the exact J2 nonlinear model of Eq. (2.47) are always nearly\nzero in every scenario. This is because no approximation is taken in the derivation\nof the exact J2 nonlinear model, so that it covers all effects of eccentricity, non-\nlinearity, and J2 perturbation. The simulation results demonstrate that the exact J2\nnonlinear model of Eq. (2.47) is correct and performs perfectly.\n\nRemark 2.6 It is noticed that the primary errors of the two linear models are the\ndrifts in the along-track direction (y). Compared with errors in other two directions\n(x and z directions, as shown in (a) and (c) of Figs. 2.4, 2.5, 2.6, 2.7, 2.8, 2.9, and\n2.10), the error magnitude in the along-track direction (as shown in Fig. 2.10b) is at\nleast one order bigger.\n\n24 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nFig. 2.3 Quasi-PCO of 5 km diameter\n\nFig. 2.4 Model errors at q \u00bc 250m; i \u00bc 45?; e \u00bc 0:05; t \u00bc 48 h\n\nFig. 2.5 Model errors at q \u00bc 250m; i \u00bc 15?; e \u00bc 0:05; t \u00bc 5 h\n\n2.4 Validation of Proposed Dynamic Models by Simulation 25\n\n\n\nFig. 2.6 Model errors at q \u00bc 250m; i \u00bc 45?; e \u00bc 0:05; t \u00bc 5 h\n\nFig. 2.7 Model errors at q \u00bc 250m; i \u00bc 85?; e \u00bc 0:05; t \u00bc 5 h\n\nFig. 2.8 Model errors at q \u00bc 250m; i \u00bc 45?; e \u00bc 0:1; t \u00bc 5 h\n\nFig. 2.9 Model errors at q \u00bc 250m; i \u00bc 45?; e \u00bc 0; t \u00bc 5 h\n\n26 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nFig. 2.10 Model errors at q \u00bc 2500m; i \u00bc 45?; e \u00bc 0:05; t \u00bc 5 h\n\nNext, the drift errors in different satellite flying durations, different orbital\ninclinations, and eccentricities, as well as different formation sizes, are analyzed.\n\nFor a longer satellite flying such as 48 h as shown in Fig. 2.4b, the drift error of\nthe complete J2 linear model in Eq. (2.59) increases monotonously in positive\ndirection over time, while the drift error of the first-order J2 linear model in\nEq. (2.64) increases firstly in positive direction and then turns down to negative\ndirection. This phenomenon demonstrates that the removed nonlinear effect causes\nthe drift error to increases positively, while the removed second-order J2 effect is\nnegative. Nevertheless, the secular nonlinear effect is approximately linear over\ntime, while the secular second-order J2 effect is higher order than the nonlinear\neffect. Consequently, the nonlinear effect is primary at the beginning so that the drift\nerror increases positively. However, after some hours of flight, the second-order J2\neffect overwhelms the nonlinear effect and becomes dominant. Then, the drift error\ntends to negative direction.\n\nActually, the behaviors of the two linear models in the first several hours are\nmore concerned, because the potential application of linear models is the formation\nmaneuvering, which is usually carried out in a relative short duration such as one or\nfew revolution(s). For this reason, analysis are subsequently focused on different\nscenarios in the first few hours of flight.\n\nFigures 2.5, 2.6, and 2.7 compare the model performances in different inclina-\ntions. It is found that the drift errors of two linear models are similar in a smaller\ninclination (15\u00b0 as shown Fig. 2.5b) or a bigger inclination (85\u00b0 as shown\nFig. 2.7b), while the drift error of the first-order J2 linear model in a middle\ninclination (45\u00b0 as shown Fig. 2.6b) is smaller. It shows that the second-order J2\neffect becomes dominant later in a smaller or larger inclination orbit and earlier in a\nmiddle inclination orbit.\n\nFigures 2.6, 2.7, 2.8, and 2.9 compare the model performances in different\neccentricities. It is found that the difference of drift errors between two linear\nmodels is smaller in a bigger eccentricity. It demonstrates that the second-order J2\neffect becomes significant earlier in a smaller inclination.\n\nFigures 2.6, 2.7, 2.8, 2.9, and 2.10 compare the model performances in different\nformation sizes. They show that the two linear models tend to perform worse for a\nlarger satellite formation size. This result agrees with the assumption used to derive\nthe linear models. It is also observed that the second-order J2 effect becomes\nevident later for a larger formation.\n\n2.4 Validation of Proposed Dynamic Models by Simulation 27\n\n\n\nRemark 2.7 It is concluded that, when satellites fly in low Earth orbits such as a\nsemimajor axis of 7100 km, the removed second-order J2 effect compensates some\nremoved nonlinear effects in the first several hours of satellite relative motion. So,\nthe first-order J2 linear model of Eq. (2.64) is more accurate and performs better\nthan the complete J2 linear model of Eq. (2.59) in a short duration. In particular, the\nsecond-order J2 effect may manifest early and counteract the nonlinear effect more\nif the satellite flies in a middle inclination orbit which is near circular, and the\nformation size is small.\n\n2.5 Comparison Study of Relative Dynamic Models\n\nFrom the literature review in Sect. 2.1, it is known that the complexity of the relative\ndynamic models increases as the required accuracy becomes greater. The available\nmodels were derived under different assumptions and by different methodologies.\nA comparison study is necessary to select an appropriate model for a specific mission\nand determine what kind of perturbation should be considered for specific appli-\ncations. Thus, in this section, a simulation method with a modeling error index is\nintroduced for comparing and evaluating various theories of relative motion of\nsatellite formation dynamics (Hang et al. 2008). The index captures error compo-\nnents of relative position and velocity between a selected satellite relative model and\na precise propagator. It is applicable to evaluate the accuracy performance of any\nvalid relative dynamic model including both linear and nonlinear models.\n\nCommercial satellite software Satellite Tool Kit (STK) (www.STK.com) is used\nas a benchmarking tool to compare various dynamic models. The simulation results\nshow that, when the Earth aspherical gravity and the air drag are present, the\naccuracy of some models is affected tremendously by eccentricity, semimajor axis,\ninclination, and formation size. The simulation results may serve for the future\ndynamic model development and the satellite formation mission design. In this\nsection, the comparison focuses on the direct ODE models (ordinary differential\nequations in LVLH coordinate). However, the proposed evaluation method is\ngeneric and can be applied to other formulations.\n\n2.5.1 Comparison Method with Model Error Index\n\nIn this study, all selected dynamic models are compared with a propagator, which is\nprecise, standard, and acceptable in the practical application. In this research, STK\nis chosen as the key propagator. STK is popular commercial satellite software. It\nuses advanced algorithm and field data to generate satellite orbit, in which different\nperturbations can be customized and included.\n\nFigure 2.11 shows the function chart of the model comparison method. In the first\nstep, a group of initial conditions are assigned for both chief and deputy satellites,\n\n28 2 Dynamic Models of Satellite Relative \u2026\n\nhttp://www.STK.com\n\n\nincluding relative positions and relative velocities. In the second step, the STK\u2013\nMATLAB interface is utilized to transfer data into STK/Astrogator. Then, the initial\nconditions are propagated in STK which includes various orbital disturbances.\nMeanwhile, the same initial conditions are integrated numerically by the selected\nrelative dynamics in MATLAB. In the third step, through the STK\u2013MATLAB\ninterface again, the propagated satellite orbit data in STK are collected in MATLAB.\nFinally, the propagated data from STK and the integrated data by the selected\ndynamics in MATLAB are synthesized, and the model error index is calculated.\n\nIn this comparison method, the key technique is the calculation of the model\nerror index, which is comparable between different dynamic models. Alfriend and\nYan (2005) proposed a nonlinear index for comparing the accuracy of various\ndynamic models. Their method is extended from the linear index of Junkins et al.\n(1996). Here, a simple index is proposed for the comparison by means of the\nnumerical simulation. The proposed index ? is described as follows:\n\nr\u00f0n\u00de \u00bc 1\nn\n\nXn\ni\u00bc1\n\nlog2\u00f01\u00feP\u00f0e\u00dei \u00de\u00f01\u00feV \u00f0e\u00dei \u00dew \u00f02:71\u00de\n\nwhere\n\nV \u00f0e\u00dei \u00bc cos?1\nvSTKi ? vMi\nvSTKik k vMik k\n\n? ?\n\u00f02:72\u00de\n\nFig. 2.11 Function chart of model comparison method\n\n2.5 Comparison Study of Relative Dynamic Models 29\n\n\n\nP\u00f0e\u00dei \u00bc\nrSTKi ? rMi\n?? ??\n\nq\n\u00f02:73\u00de\n\nvSTKi ; v\nM\ni are velocity vectors and r\n\nSTK\ni ; r\n\nM\ni are position vectors. The data\n\npropagated in STK and the data integrated in MATLAB are with superscript STK\n\nand M, respectively. n denotes the total steps. i denotes the i-th step. P\u00f0e\u00dei and V\n\u00f0e\u00de\ni\n\nrepresent the position and velocity differences between the results of STK and\n\ndynamic model. In detail, V \u00f0e\u00dei is an adjusted radian value between two velocity\nvectors. It can effectively indicate the model error caused by the relative orbit\n\nrotation such as the tumbling. The exponent w is a weight to adjust V \u00f0e\u00dei in line with\n\nP\u00f0e\u00dei . Increasing w would lead to magnifying rotation effect in the model error index\nand vice versa. In the simulation, w \u00bc 2 is carried out to balance the errors caused\nby the relative orbit rotation and the drift.\n\nNote that the above model error index is computed at every sampling\nstep. Moreover, this model error index is proportional to the model error. So, a\nsmaller model error index implies that the model is more accurate.\n\n2.5.2 Selected Dynamic Models for Comparison Study\n\nThis comparison study focuses on the direct ODE models. Thus, the equations,\nwhich describe the relative motion between satellites, are generally in the following\nform:\n\nf \u20acq; _q; q; e\u00f0 \u00de \u00bc 0 \u00f02:74\u00de\n\nwhere q \u00bc x y z\u00bd ?T represents the vector of relative position of the deputy\nsatellite in LVLH coordinate frame. e is the vector of orbit parameters of the chief\nsatellite in ECI frame. It is constant for time-invariant models and is variable for\ntime-varying models.\n\nFive widely used models, including Clohessy-Wiltshire (CW) model,\nTschauner-Hempel (TH) model, Unperturbed Nonlinear (UN) model,\nSchweighart-Sedwick (SS) model, and Xu-Wang model, are compared and eval-\nuated. The assumptions about reference (chief) satellite orbit, perturbation, and\nformation size are different for each model and are summarized in Table 2.1. The\nfive models are introduced as follows:\n\n2.5.2.1 Clohessy-Wiltshire Model\n\nCW model (Hill 1878) (Hill\u2019s equations) is established in the LVLH coordinate by\nmaking the assumption of a circular chief orbit, spherical Earth, linearizing the\n\n30 2 Dynamic Models of Satellite Relative \u2026\n\n\n\ndifferential gravitational forces, and no other perturbations included. It was used\ninitially to solve the satellite rendezvous problem and later to study the satellite\nformation flying. CW model is a fundamental model. Other direct ODE models are\nbenchmarked on this model.\n\n\u20acx? 2n_y? 3n2x \u00bc 0 \u00f02:75\u00de\n\n\u20acy\u00fe 2n _x \u00bc 0 \u00f02:76\u00de\n\n\u20acz\u00fe n2z \u00bc 0 \u00f02:77\u00de\n\nwhere x; y and z are the LVLH Cartesian coordinates, and _x; _y and _z are the relative\nvelocity components, n \u00bc ffiffiffiffiffiffiffiffiffil=r3p is the mean motion, ? denotes gravitational\ncoefficient, and r denotes radius of satellite orbit.\n\n2.5.2.2 Tschauner-Hempel Model\n\nInalhan and How (Tillerson and How 2002; Clohessy and Wiltshire 1960) proved\nthat the eccentricity has great effects on the relative motion. Using CW model, even\na small eccentricity of e \u00bc 0:005 may result in a large fuel consumption to maintain\na specified formation. Tschauner and Hempel (1965) presented a method to express\nthe linearized relative dynamics around an eccentric orbit. TH model can be taken\nas an extension of CW model.\n\n\u20acx \u00bc 2l\nr3\n\nx\u00fe 2xy\u00fex2x \u00f02:78\u00de\n\n\u20acy \u00bc ?l\nr3\n\ny? 2x _x? x2y \u00f02:79\u00de\n\n\u20acz \u00bc ?lz\nr3\n\n\u00f02:80\u00de\n\nwhere x \u00bc _f \u00bc n\u00f01\u00fe e cos f \u00de2\u00f01?e2\u00de3=2 ; _x \u00bc \u20acf \u00bc\n?2n2e sin f \u00f01\u00fe e cos f \u00de3\n\n\u00f01?e2\u00de3 ; r \u00bc\na\u00f01?e2\u00de\n1\u00fe e cos f :\n\nTable 2.1 Comparison of assumptions for direct ODE models\n\nModels CW TH SS NU XW\n\nAssumption Chief orbit C E C E E\n\nPerturbation No No J2 No J2\nFormation size S S S L L\n\nNote S and L represent small and large, respectively. C and E denote circle and ellipse, respectively\n\n2.5 Comparison Study of Relative Dynamic Models 31\n\n\n\nSince this linear model will be used in Sect. 5.3 for decentralized formation\nkeeping, this model needs to include the control input and be rewritten into a new\nform. Although (2.78)\u2013(2.80) is expressed in the time domain, monotonically\nincreasing true anomaly f of the chief orbit provides a natural basis for parame-\nterizing the fleet time and motion. This observation is based on the fact that the\nangular velocity and the radius describing the orbital motion are functions of the\ntrue anomaly. When f is used as the free variable, the equations of motion can be\ntransformed using the following relationships between derivation over time (rep-\nresented by \u00f0??\u00de) and derivation over ? (represented by ?\u00f0 \u00de0)\n\n\u00f0??\u00de \u00bc \u00f0?\u00de0 _f ; \u00f0???\u00de \u00bc \u00f0?\u00de00 _f 2 \u00fe _f _f 0\u00f0?\u00de0 \u00f02:81\u00de\n\nwhere the time rate of change of the true anomaly _f can be written as\n\n_f \u00bc n 1\u00fe e cos f\u00f0 \u00de\n2\n\n1\u00fe e2\u00f0 \u00de3=2\n\u00f02:82\u00de\n\nWith these transformations, the set of LTV equations describing the relative\nmotion of the satellite with respect to an elliptic reference orbit can be written as\n(Inalhan et al. 2002).\n\nx0\u00f0f \u00de \u00bc A\u00f0f \u00dex\u00f0f \u00de\u00feB\u00f0f \u00deu\u00f0f \u00de \u00f02:83\u00de\n\nwhere\n\nA\u00f0f \u00de \u00bc\n\n2e sin f\n1\u00fe e cos f\n\n3\u00fe e cos f\n1\u00fe e cos f 2\n\n?2e sin f\n1\u00fe e cos f 0 0\n\n1 0 0 0 0 0\n?2 2e sin f1\u00fe e cos f 2e sin f1\u00fe e cos f e cos f1\u00fe e cos f 0 0\n0 0 1 0 0 0\n0 0 0 0 2e sin f1\u00fe e cos f\n\n?1\n1\u00fe e cos f\n\n0 0 0 0 1 0\n\n2\n6666664\n\n3\n7777775\n\n\u00f02:84\u00de\n\nB\u00f0f \u00de \u00bc 1? e\n2\u00f0 \u00de3\n\n1\u00fe e cos f\u00f0 \u00de4n2\n1 0 0 0 0 0\n0 0 1 0 0 0\n0 0 0 0 1 0\n\n2\n4\n\n3\n5\nT\n\n\u00f02:85\u00de\n\nwhere x\u00f0f \u00de \u00bc x0; x; y0; y; z0; z\u00bd ?T represent relative positions and velocities of the\nsatellite with respect to the LVLH frame expressed in f domain, u\u00f0f \u00de \u00bc\nux uy uz\u00bd ?T represent the vector of control acceleration, n is the natural fre-\nquency of the reference orbit, and e is the eccentricity.\n\n32 2 Dynamic Models of Satellite Relative \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_5\n\n\n2.5.2.3 Unperturbed Nonlinear Model\n\nTH model can be further expanded to a system of nonlinear differential equations\naccounting for both effects of nonlinearity and eccentricity (Gurfil 2005), which is\ncalled the unperturbed nonlinear model. The parameter e of the reference satellite in\n(2.47) is described by three augmented first-order differential equations in the\nunperturbed nonlinear model.\n\n\u20acx? 2 _h _y? \u20achy? _h2x \u00bc ? l\u00f0rc \u00fe x\u00de\nrc \u00fe x\u00f0 \u00de2 \u00fe y2 \u00fe z2\n\nh i3=2 \u00fe lr2c \u00f02:86\u00de\n\n\u20acy\u00fe 2 _h _x\u00fe \u20achx? _h2y \u00bc ? ly\nrc \u00fe x\u00f0 \u00de2 \u00fe y2 \u00fe z2\n\nh i3=2 \u00f02:87\u00de\n\n\u20acz \u00bc ? lz\nrc \u00fe x\u00f0 \u00de2 \u00fe y2 \u00fe z2\n\nh i3=2 \u00f02:88\u00de\n\n\u20acrc \u00bc rc _h2 ? lr2c\n\u00f02:89\u00de\n\n\u20ach \u00bc ? 2_rc\n_h\n\nrc\n\u00f02:90\u00de\n\nwhere x; y and z are the relative motion coordinates of the deputy with respect to the\nchief in the LVLH frame. rc refers to the radius of the chief satellite from the center\nof the Earth, ? refers to the latitude angle of the chief, and ? is the gravitational\nparameter.\n\n2.5.2.4 Schweighart-Sedwick Model\n\nSchweighart and Sedwick (2002) developed a set of linearized differential equations\nto capture the relative motion between satellites under J2 effect around a circular\norbit. This model can be taken as another extension of CW model.\n\n\u20acx? 2\u00f0nc\u00de _y? \u00f05c2 ? 2\u00den2x \u00bc 0 \u00f02:91\u00de\n\n\u20acy\u00fe 2\u00f0nc\u00de _x \u00bc 0 \u00f02:92\u00de\n\n_c? nb cos c \u00bc 0 \u00f02:93\u00de\n\n2.5 Comparison Study of Relative Dynamic Models 33\n\n\n\n_U? nbU cos c sin c \u00bc 0 \u00f02:94\u00de\n\nwhere z \u00bc rrefU sin\u00f0knt ? c\u00de. ? is angular distance between the equator and the\nintersection of two orbital planes (chief and deputy orbit). ? represents maximum\nangular cross-track separation. rref ; iref are radius and inclination of reference\nsatellite orbit.\n\n2.5.2.5 Xu-Wang Model\n\nXu and Wang (2008a) recently developed a satellite relative dynamic model which\nincludes eccentricity, nonlinearity, and J2 perturbation. This model is developed\nbased on the essential fact that the precise relative dynamics highly depends on the\naccurate information of the reference orbit. The parameter e of the chief satellite in\n(2.74) is described by five augmented first-order differential equations to describe\nreference orbit dynamics. It is stated that this dynamic model does not have model\nerror in arbitrary eccentric orbits under J2 perturbation. So, Xu-Wang model can be\nused to propagate the satellite relative motion from arbitrary initial conditions.\nXu-Wang model is introduced in Sect. 2.2.2.\n\n2.5.3 Case Studies\n\n2.5.3.1 Simulation Scenario\n\nFor setting up comparison scenario, the idea of the projected circular orbit (PCO) in\nthe LVLH frame centered at the chief satellite is utilized. It can be described by\n\nx \u00bc 0:5q sin\u00f0h\u00fe a0\u00de \u00f02:95\u00de\n\ny \u00bc q cos\u00f0h\u00fe a0\u00de \u00f02:96\u00de\n\nz \u00bc q sin\u00f0h\u00fe a0\u00de \u00f02:97\u00de\n\nwhere ? is the radial of PCO; ? is the true latitude angle of the chief satellite; a0 is\nthe initial phase angle of relative orbit. It is known that an exact PCO is only\npossible in circular orbits. When eccentricity and perturbations are present, the\nrelative orbit may be distort. However, if the eccentricity is small, the relative orbit\nwill still be close to PCO. Actually, an exact PCO is not necessary in the com-\nparison study, and a distorted PCO is acceptable.\n\nIn all test cases, the energy-matching initial conditions derived by Xu and Wang\n(Xu et al. 2009) are used to prevent a fast drift of the formation. It should be kept in\nmind that both the distorted PCO formation and the energy-matching conditions do\nnot change the evaluation and comparison results. In the simulation, no matter what\n\n34 2 Dynamic Models of Satellite Relative \u2026\n\n\n\nkind of formation is used, the selected dynamic model should predict the relative\nmotion which is close to the result in the STK propagator as long as the same set of\ninitial conditions are applied. Nevertheless, using a stable formation may improve\nthe reliability of the model error index.\n\nFour parameters i; e; a, and ? are selected as variables for comparison in the\nsimulation. Later on, it will be proved that these four parameters have important\neffects on dynamic model accuracy. The objective was to calculate the model error\nindex ? of each selected model due to each of the variables e; a; i, and ?. In the\nsimulation, the testing cases are assigned in the following Tables 2.2, 2.3, and 2.4:\n\nWithin the calculation of the model error index by (2.71), the scenario duration\nis 24 h, and the sampling interval is 1 min, which correspond that the total steps are\nn \u00bc 24? 60 \u00bc 1440. The astrogator in STK is customized to incorporate the Earth\nzonal harmonic perturbations up to J21 and the atmospheric drag.\n\n2.5.3.2 Case 1: Error Index Versus Formation Size\n\nFigure 2.12 shows the index comparison varying with the PCO radius. It is clear\nthat the model error indexes of linear models tend to be larger than those of\nnonlinear models (unperturbed nonlinear model and Xu-Wang model) as the\n\nTable 2.2 Orbit elements of\nchief satellite\n\nChief satellite orbit Value\n\na 6600\u20138000 km\n\n? 0?\n\ni 0?\u201390?\n\ne 0\u20130.01\n\n? 0?\n\n? 0?\n\nTable 2.3 Orbit parameters\nof deputy satellite\n\nDeputy satellite orbit Value\n\nx0 0.5 km\n\ny0 0 km\n\nz0 ? km\n\n_x0 0 km/s\n\n_y0 Adjusted\n\n_z0 0 km/s\n\n? 0.10\u201320.0 km\n\nTable 2.4 Physical\nparameters of both satellites\n\nSatellite parameters Value\n\nDry mass 150 kg\n\nDrag coefficient 2.2\n\nDrag area 5 m2\n\n2.5 Comparison Study of Relative Dynamic Models 35\n\n\n\nformation size increases. In this simulation, since the eccentricity is almost zero, the\nindexes of CW model and TH model are close to each other, while SS model that\ninclude J2 effects performs better than other linear models. The model error dif-\nference between TH model and unperturbed nonlinear model in the figure shows\nthe impact of nonlinearity. It is a function of formation size and increases as\nformation size getting large. The model error difference between unperturbed\nnonlinear model and Xu-Wang model shows the impact of J2 effects. It is found that\nthe influence of J2 effects is bigger than the nonlinearity effect.\n\n2.5.3.3 Case 2: Error Index Versus Eccentricity\n\nFigure 2.13 shows the error index as a function of the eccentricity. It can be seen\nthat errors of the models which exclude eccentricity consideration (CW model and\nSS model) grow larger and larger as the eccentricity gets larger. Since the formation\nsize is small, the performance of TH model is almost the same as unperturbed\nnonlinear model, because both of them compensate the effect of eccentricity. In\ncontrast to error due to formation size variation, eccentricity changes lead to more\nnoticeable error growth. The model error difference between CW model and TH\nmodel shows the impact of eccentricity. In contrast to the error difference between\nthe unperturbed nonlinear model and Xu-Wang model, which shows impact of J2\neffects, it is found that the eccentricity leads to much larger error growth. Thus,\neccentricity is the dominant error in formation flying design and needs to be con-\nsidered with high priority.\n\nFig. 2.12 Index comparison for e \u00bc 0:0001; i \u00bc 45?; a \u00bc 6600 km\n\n36 2 Dynamic Models of Satellite Relative \u2026\n\n\n\n2.5.3.4 Case 3: Error Index Versus Inclination\n\nFigure 2.14 shows error index comparison as a function of the inclination. The\nsimulation results show that SS model has distinct error trend. It is interesting that\nthe SS model even does not perform as good as the CW model in a larger incli-\nnation. The error indexes of all other models decrease as inclination increases.\nNevertheless, the models, which consider J2 effects, have better performance than\nother models (the change in magnitude is relatively small.). This demonstrates that\nthe J2 effect has a tight relationship with the inclination.\n\n2.5.3.5 Case 4: Error Index Versus Semimajor Axis\n\nFigure 2.15 shows error index comparison as a function of the chief satellite\nperigee. Since none of the selected dynamic models considers the atmospheric drag,\ntheir model errors increase exponentially when the chief satellite perigee is smaller\nthan a certain value. It can be seen that the inflexion of model error indexes appears\nwhen the perigee is around 300 km, which corresponds to a satellite semimajor axis\nof about 6750 km. Therefore, if the satellite altitude is lower than 300 km, the\ninclusion of atmospheric drag in the model is necessary. On the other hand, if the\nsatellite altitude is higher than 400 km, the effect of atmospheric drag is small.\n\nIn summary, the index comparison shows every model has distinct characteristic\nand performance, which is summarized in Table 2.5.\n\nFig. 2.13 Index comparison for q \u00bc 0:1 km, i \u00bc 45?; a \u00bc 6600 km\n\n2.5 Comparison Study of Relative Dynamic Models 37\n\n\n\nFig. 2.14 Index comparison for q \u00bc 0:1 km, e \u00bc 0:0001; a \u00bc 6600 km\n\nFig. 2.15 Index comparison for q \u00bc 0:1 km, e \u00bc 0:01; i \u00bc 45?\n\n38 2 Dynamic Models of Satellite Relative \u2026\n\n\n\n2.6 Summary\n\nFirstly, the exact J2 dynamics for a single satellite is presented based on RSV in this\nchapter. The expression of this dynamics itself is rather simple. Three variables of\nRSV, i.e., angular momentum h, inclination i, and right ascension of ascending\nnode ?, are slowly time varying under perturbations. The most important benefit of\nthis dynamics is that the rotation properties of LVLH frame can be expressed in\nterms of RSV explicitly and simply. So, it is suitable to describe the motion of a\nrotating LVLH frame.\n\nSecondly, the exact J2 nonlinear relative model is derived. Since no approxi-\nmation is applied in the derivation, this model does not have error if only J2\nperturbation is present. The model depends on 5 parameters of RSV, so that the\nsatellite relative motion is equivalently described by 11 simple first-order differ-\nential equations. It is a good candidate to solve the precise control problems of\nlong-term flying satellite formation such as formation maintenance. It can also be\nused in the study of formation design or even as a propagator of satellite relative\nmotion.\n\nThirdly, two J2 linear relative models are developed by removing the nonlinear\neffect and the second-order J2 effect from the exact J2 nonlinear relative model. The\nnumerical study demonstrates that the removed second-order J2 effect compensates\nsome of the removed nonlinear effect at the beginning stage. Moreover, the\nfirst-order J2 linear relative model is much simpler than the other two models. It is\nexpected to have potential application on formation maneuver and keeping.\n\nLastly, a simulation-based evaluation method is presented to compare various\nsatellite formation flying dynamic models in this chapter. With the formulation of a\nmodel error index, five existing direct ODE models have been evaluated and\ncompared in the proposed simulation platform. The simulation results provide\ninsights and guidance for the selection of suitable relative dynamic model taking\ninto account the presence of various perturbation effects. The numerical results\nshow that eccentricity, J2 perturbation, nonlinearity, and atmospheric drag play\ndifferent roles to affect the model error. The decision on model selection should be\nmade through the balanced consideration of every factor. If the satellite formation\nflies in orbits higher than 400 km, the eccentricity dominates the disturbances; the\nnext crucial perturbation is J2 effect followed by nonlinearity. However, if the\nsatellite formation flies in orbits lower than 300 km, the atmospheric drag affects\nthe model accuracy significantly. In contrast to other factors, the nonlinearity has a\n\nTable 2.5 Comparison of model error sources for direct ODE models\n\nModels CW TH SS NU XW\n\nModel error caused by Eccentricity L S L S S\n\nJ2 L L L L S\n\nNonlinearity L L L S S\n\nNote \u201cS\u201d and \u201cL\u201d represent small and large, respectively\n\n2.6 Summary 39\n\n\n\nsmaller effect for a small size formation. Among the five selected direct ODE\nmodels, the developed, exact nonlinear relative dynamics Xu-Wang model, intro-\nduced in Sect. 2.2.2, which takes into account of both J2 and chief (reference) orbit\neccentricity, performs best in every simulated scenario.\n\nReferences\n\nAlfriend KT, Yan H (2005) Evaluation and comparison of relative motion theories. J Guid Control\nDyn 28(2):254\u2013261. doi:10.2514/1.6691\n\nBattin RH (1999) Introduction to the mathematics and methods of astrodynamics. AIAA education\nseries, vol Book, Whole. American Institute of Aeronautics and Astronautics\n\nBreakwell JV (1974) Lecture notes\u2014space mechanics. Department of Aeronautics and\nAstronautics, Stanford University, Palo Alto, CA\n\nClohessy WH, Wiltshire R (1960) Terminal guidance system for satellite rendezvous. J Aerospace\nSci 27(9):653\u2013658. doi:10.2514/8.8704\n\nGim DW, Alfriend KT (2005) Satellite relative motion using differential equinoctial elements.\nCelest Mech Dyn Astron 92(4):295\u2013336. doi:10.1007/s10569-004-1799-0\n\nGurfil P (2005) Relative motion between elliptic orbits: generalized boundedness conditions and\noptimal formation keeping. J Guid Control Dyn 28(4):761\u2013767. doi:10.2514/1.9439\n\nHang Y, Xu G, Wang D, Poh EK (2008) Comparison study of relative dynamic models for\nsatellite formation flying. In: 2nd international symposium on systems and control in aerospace\nand astronautics, Shenzhen, China, 10\u201312 Dec 2008. IEEE, pp 1\u20136. doi:10.1109/ISSCAA.\n2008.4776195\n\nHill GW (1878) Researches in the lunar theory. Am J Math 1(1):5\u201326\nInalhan G, Tillerson M, How JP (2002) Relative dynamics and control of spacecraft formations in\n\neccentric orbits. J Guid Control Dyn 25(1):48\u201359. doi:10.2514/2.4874\nJunkins JL, Akella MR, Alfriend KT (1996) Non-Gaussian error propagation in orbital mechanics.\n\nJ Astronaut Sci 44(4):541\u2013563\nKechichian JA (1998) Motion in general elliptic orbit with respect to a dragging and precessing\n\ncoordinate frame. J Astronaut Sci 46(1):25\u201345\nLee D, Cochran JE, Jo JH (2007) Solutions to the variational equations for relative motion of\n\nsatellites. J Guid Control Dyn 30(3):669\u2013678. doi:10.2514/1.24373\nMorgan D, Chung SJ, Blackmore L, Acikmese B, Bayard D, Hadaegh FY (2012) Swarm-keeping\n\nstrategies for spacecraft under J2 and atmospheric drag perturbations. J Guid Control Dyn 35\n(5):1492\u20131506. doi:10.2514/1.55705\n\nPalmer PL, Imre E (2007) Relative motion between satellites on neighbouring Keplerian orbits.\nJ Guid Control Dyn 30(2):521\u2013528. doi:10.2514/1.24804\n\nPluym JP, Damaren CJ (2006) Second order relative motion model for spacecraft under J2\nperturbations. In: AIAA/AAS astrodynamics specialist conference and exhibit, Keystone,\nColorado, Aug. 21\u201324 2006. pp 2092\u20132098\n\nRoberts JA, Roberts PCE (2004) The development of high fidelity linearized J2 models for satellite\nformation flying control. In: AAS/AIAA the 14th space flight mechanics meeting, Maui,\nHawaii, 8\u201312 Feb 2004\n\nRoss IM (2003) Linearized dynamic equations for spacecraft subject to J2 perturbations. J Guid\nControl Dyn 26(4):657\u2013659\n\nSchaub H (2002) Spacecraft relative orbit geometry description through orbit element differences.\nIn: 14th US national congress of theoretical and applied mechanics blacksburg, VA,\nBlacksburg, Virginia, 23\u201328 June 2002\n\nSchaub H (2004) Relative orbit geometry through classical orbit element differences. J Guid\nControl Dyn 27(5):839\u2013848. doi:10.2514/1.12595\n\n40 2 Dynamic Models of Satellite Relative \u2026\n\nhttp://dx.doi.org/10.2514/1.6691\nhttp://dx.doi.org/10.2514/8.8704\nhttp://dx.doi.org/10.1007/s10569-004-1799-0\nhttp://dx.doi.org/10.2514/1.9439\nhttp://dx.doi.org/10.1109/ISSCAA.2008.4776195\nhttp://dx.doi.org/10.1109/ISSCAA.2008.4776195\nhttp://dx.doi.org/10.2514/2.4874\nhttp://dx.doi.org/10.2514/1.24373\nhttp://dx.doi.org/10.2514/1.55705\nhttp://dx.doi.org/10.2514/1.24804\nhttp://dx.doi.org/10.2514/1.12595\n\n\nSchaub H, Alfriend KT (2001) J2 invariant relative orbits for spacecraft formations. Celest Mech\nDyn Astron 79(2):77\u201395. doi:10.1023/A:1011161811472\n\nSchweighart SA, Sedwick RJ (2002) High-fidelity linearized J2 model for satellite formation flight.\nJ Guid Control Dyn 25(6):1073\u20131080\n\nSchweighart SA, Sedwick RJ (2005) Cross-track motion of satellite formations in the presence of\nJ2 disturbances. J Guid Control Dyn 28(4):824\u2013826. doi:10.2514/1.12387\n\nSengupta P, Vadali SR, Alfriend KT (2007) Second-order state transition for relative motion near\nperturbed, elliptic orbits. Celest Mech Dyn Astron 97(2):101\u2013129. doi:10.1007/s10569-006-\n9054-5\n\nTillerson M, How JP (2002) Advanced guidance algorithms for spacecraft formation-keeping. In:\nProceedings of American control conference, 2002. IEEE, pp 2830\u20132835. doi:10.1109/ACC.\n2002.1025218\n\nTschauner J, Hempel P (1965) Rendezvous zu einem in elliptischer Bahn umlaufenden Ziel.\nAstronautica Acta 11(2):104\u2013109\n\nVadali SR, Vaddi SS, Naik K, Alfriend KT (2001) Control of satellite formations. In: AIAA,\nguidance, navigation, and control conference and exhibit, Montreal, Canada, 6\u20139 August 2001\n\nXu G, Wang D (2008a) Nonlinear dynamic equations of satellite relative motion around an oblate\nearth. J Guid Control Dyn 31(5):1521\u20131524. doi:10.2514/1.33616\n\nXu GG, Wang DW (2008b) Dynamic models of satellite relative motion around an oblate earth. In:\nAAS/AIAA space flight mechanics meeting, AAS-08-208, Galveston, Texas, 27\u201331 Jan\n2008b. pp 1633\u20131648\n\nXu G, Poh EK, Wang D, Wu B (2009) Periodic and quasi-periodic satellite relative orbits at\ncritical inclination. In: IEEE Aerospace conference, Big Sky, MT, USA, 7\u201314 Mar 2009\n\nReferences 41\n\nhttp://dx.doi.org/10.1023/A:1011161811472\nhttp://dx.doi.org/10.2514/1.12387\nhttp://dx.doi.org/10.1007/s10569-006-9054-5\nhttp://dx.doi.org/10.1007/s10569-006-9054-5\nhttp://dx.doi.org/10.1109/ACC.2002.1025218\nhttp://dx.doi.org/10.1109/ACC.2002.1025218\nhttp://dx.doi.org/10.2514/1.33616\n\n\nChapter 3\nPassive and Periodic Satellite Formation\nDesign Around an Oblate Earth\n\nPassive and periodic relative trajectories (PPRT) are a practical option for long-term\nsatellite formation flying. This chapter proves that such trajectories under the J2\nperturbation are only possible under two circumstances. The first circumstance is\nthat all satellites fly in the orbits at the critical inclination. It is revealed that passive\nand periodic relative orbits with cross-track motion are only possible at the critical\ninclination under conditions that all satellites share the same inclination, the same\nsemimajor axis, and the same eccentricity. Furthermore, a quasi-periodic relative\norbit is achieved near the critical inclination by matching the orbital energy and the\npolar component of the orbital angular momentum. The second circumstance is that\nall satellites fly in the same regressing orbital plane. The satellites are further\nsubject to four constraints: the same inclination, semimajor axis, eccentricity, and\nascending node. Investigation of this circumstance focuses on the Almost Constant\nSeparation Formation. It is revealed that under a special geometric constraint on the\nremaining two differential orbit elements, the relative distance between satellites\nmay change very little even in highly elliptic orbits. Results in this chapter are valid\nin arbitrary elliptic orbits under the J2 perturbation.\n\n3.1 Introduction\n\nA passive and periodic satellite formation is critical to sustain a long-term formation\nflying mission. It is proved in Gurfil (2005), Xing et al. (2007) that the passive and\nperiodic satellite relative trajectories in the classical Keplerian motion around an\nideal spherical Earth can be achieved as long as every satellite in the formation has\nthe same orbital period T, which is equivalent to having the same mean motion _M,\nor same semimajor axis a, or same orbital energy E:\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_3\n\n43\n\n\n\ndT \u00bc 0 , d _M \u00bc 0 , da \u00bc 0 , dE \u00bc 0 \u00f03:1\u00de\n\nDifferent formations around an ideal spherical Earth were proposed for a circular\nreference orbit (Sabol et al. 2001) and for an elliptic reference orbit (Lane and\nAxelrad 2006; Jiang et al. 2008).\n\nHowever, various perturbations around the Earth require a formation flying\nsatellite expel fuel to overcome the perturbations to remain in formation. Among\nthe perturbations, the J2 gravity is the dominant factor and consumes a large amount\nof fuel that renders long-term formation flying unsustainable. A passive and peri-\nodic satellite formation accommodating the J2 perturbation will ensure long-term\nflying formation becomes practically possible.\n\nIncluding the J2 gravity term into the classical Keplerian motion causes the\n\nsecular growths of three mean orbit elements ?X\nt\n; ?xt; ?Mt\n\n? ?\n; i.e., the right ascension\n\nof the ascending node, the argument of perigee, and the mean anomaly (here, the\nover bars denote the mean orbit elements, and the superscript t denotes the\n\ntime-varying variables). It is known that the rates _?X; _?x; _?M\n? ?\n\nof the three secular\n\ngrowths are linear under the J2 perturbation. Schaub et al. (Schaub and Alfriend\n2001; Schaub and Junkins 2003) affirmed that, to keep the satellites from drifting\napart, it would be desirable to match the three linear rates for all satellites in a given\nformation. They also show that matching the three linear rates is equivalent to\nmatching another three constant mean orbit elements \u00f0?a;?e;?i\u00de, i.e., the semimajor\naxis, the eccentricity, and the inclination:\n\nd _?X \u00bc 0\nd _?x \u00bc 0\nd _?M \u00bc 0\n\n8<\n: ,\n\nd?a \u00bc 0\nd?e \u00bc 0\nd?i \u00bc 0\n\n8<\n: \u00f03:2\u00de\n\nConditions (3.2) are referred as the strict J2 invariant trajectory conditions. Since\nthese conditions are very conservative and severely restrict the possible relative\ntrajectories, Schaub et al. (Schaub and Alfriend 2001; Schaub and Junkins 2003)\nfurther proposed the so-called J2 invariant trajectory conditions which impose only\n\ntwo constraints, i.e., matching the rate _?X of right ascension of ascending node and\n\nthe sidereal orbital period (i.e., the rate _?M\u00fe _?x\u00de:\n\nd _?X \u00bc 0 d _?M\u00fe d _?x \u00bc 0 \u00f03:3\u00de\n\nComparing with the strict J2 invariant trajectory conditions (3.2), the J2 invariant\ntrajectory conditions (3.3) release one more degree of freedom for satellite forma-\ntion geometry design. However, the J2 invariant trajectory conditions (3.3) are still\ndeemed rather conservative such that a formation with cross-track motion cannot be\ndesigned at will. Consequently, some researchers (Tragesser and Skrehart 2008)\nsuggested confining a formation by only one constraint, i.e., matching the nodal\norbital period only\n\n44 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nd _?M\u00fe d _?x\u00fe d _?X cos ?i \u00bc 0 \u00f03:4\u00de\n\nThis condition is known as the no-drift condition. On one side, this condition can\nbe taken as the general case of the period-matching condition (3.1) of the unper-\n\nturbed Keplerian motion where the nodal rate _?X and the rate _?x of argument of\nperigee are constant zero. Also, since both the strict J2 invariant trajectory condi-\ntions (3.2) and the J2 invariant trajectory conditions (3.3) ensure the no-drift con-\ndition (3.4), the no-drift condition (3.4) can also be viewed as a general case of\nanother two J2 invariant trajectory conditions of (3.2) and (3.3).\n\nAn observation to the above-mentioned conditions under J2 perturbation is as\nfollows. Although these conditions may somewhat prevent formation flying satel-\nlites from drifting apart, none of them can guarantee a satellite under J2 perturbation\nto track a passive and periodic relative trajectory. This observation is important as it\nimplies that a satellite that satisfies the strict J2 invariant trajectory conditions (3.2)\nmay still tumble in its relative trajectory and requires compensation to maintain the\nperiodic relative trajectory. Coincidentally and independently, this observation has\nbeen illustrated recently by numerical study (Sabatini et al. 2008).\n\nIn this chapter, the general conditions are established for a passive and periodic\nrelative trajectory under the J2 perturbation (Xu et al. 2009b). It is shown that there are\ntwo classes of PPRT. The first class is that all satellites fly in the critical inclination,\nand the second class is that all satellitesfly in the same regressing orbital plane. Further\ninvestigations focus on the formation geometry design based on the second class of\npassive and periodic formations. A special formation of the second class is the Almost\nConstant Separation Formation (Xu et al. 2009a). This formation imposes an addi-\ntional geometric constraint that the ratio of the differential mean anomaly to the\ndifferential argument of perigee is a constant value associated with the eccentricity.\nThe only available degree offreedom is used to specify the distance between satellites.\n\nThe rest of this chapter is organized as follows. In Sect. 3.2, the general con-\nditions of the passive and periodic relative trajectory are described and proved. In\nSect. 3.3, periodic and quasi-periodic relative orbits at critical inclination are\ninvestigated. In Sect. 3.4, the formation in the same orbital plane is investigated. In\nSect. 3.5, the conclusions are summarized.\n\n3.2 Passive and Periodic Relative Motion Under J2\nPerturbation\n\nIn this section, the general conditions of the passive and periodic relative motion\nunder J2 perturbation are investigated.\n\nIn the study of the satellite relative motion, without loss of generality, a\n2-satellite system is considered (as shown in Fig. 3.1), i.e., a passive or a virtual\nreference satellite S0 (without control force) and a member satellite Sj (with or\nwithout control force).\n\n3.1 Introduction 45\n\n\n\nThe relative motion of the member satellite Sj can be presented in the local\ncurvilinear coordinate xyz in terms of the orbit elements \u00f0a; e; i;x; f \u00de of the refer-\nence satellite S0 and the differential orbit elements \u00f0daj; dej; dij; dxj; dXj; dMj\u00de\nbetween the reference satellite and the jth member satellite. In the literature, the\nexpressions of such satellite relative motion have been derived by Schaub (Schaub\nand Junkins 2003; Schaub 2004), Lane and Axelrad (2006), as well as Hamel and\nLafontaine (2007).\n\nThe result of Hamel and Lafontaine (2007) is as follows:\n\nxj \u00bc r\u00f0 f \u00dea daj ? acf dej \u00fe\naesf\ng\n\ndMj\n\nyj \u00bc r\u00f0 f \u00deg2 sf 2\u00fe ecf\n? ?\n\ndej \u00fe r\u00f0 f \u00decidXj \u00fe r\u00f0 f \u00dedxj \u00fe r\u00f0 f \u00deg3 1\u00fe ecf\n? ?2\n\ndMj\n\nzj \u00bc r\u00f0 f \u00desf \u00fexdij ? r\u00f0 f \u00desicf \u00fexdXj\n\n\u00f03:5\u00de\n\nwhere s\u00f0?\u00de \u00bc sin \u00f0?\u00de and c\u00f0?\u00de \u00bc cos \u00f0?\u00de. In (3.5), r is the distance from the reference\nsatellite to the Earth center,\n\nr\u00f0 f \u00de \u00bc ag\n2\n\n1\u00fe ecf \u00f03:6\u00de\n\nwith g being another expression of the eccentricity\n\ng \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffi\n1? e2\n\np\n\u00f03:7\u00de\n\nThe Eq. (3.5) contains 11 parameters of which \u00f0a; e; i;x; f \u00de are the osculating\norbit elements of the reference satellite S0, and \u00f0daj; dej; dij; dxj; dXj; dMj\u00de are\nthe osculating differential orbit elements of the member satellite Sj. It is noted that\nthe result (3.5) is linear to the differential orbit elements and is independent of the\nright ascension of ascending node X of the reference satellite S0. The independence\nproperty of the right ascension of ascending node is identical to the exact satellite\nrelative dynamics under J2 perturbation obtained in Xu and Wang (2008). However,\nthis property is due to somewhat different reasons. Actually, a precise result of\n\nFig. 3.1 Curvilinear\ncoordinate\n\n46 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nsatellite relative motion depends on X of the reference satellite S0. From theoretical\npoint of view, it should appear in the result when the accelerations that depend on X\nare present (e.g., the sectorial and tesseral harmonic perturbations). Fortunately,\nthese perturbations are small and their impacts on the accuracy of the relative\nmotion are insignificant. The omission of X in the linear result (3.5) is caused by the\napproximation used to evaluate the osculating radius in Eq. (3.6). Coincidently, this\napproximation does not affect the inclusion of the zonal harmonic perturbations that\nare independent of X.\n\nNext, the secular relative motion of member satellite Sj under J2 perturbation is\ninvestigated. From the well-known J2 perturbation theory, there are three types of\nchanges in the osculating orbit elements, namely short-period and long-period\noscillations and secular growth. Among three types of changes, the secular growth\nis significant to the relative motion. Because the J2 perturbation theory manifests\nthat the secular values of \u00f0a; e; i\u00de and daj; dej; dij\n\n? ?\nare constants, these elements\n\nmay be approximated by secular values as\n\na ? ?a i ? ?i e ? ?e \u00f0g ? ?g\u00de \u00f03:8\u00de\n\nand\n\ndaj ? d?aj dij ? d?ij dej ? d?ej \u00f03:9\u00de\n\nwhere the over bars denote the secular part of a variable. On the other hand, the\nsecular values of \u00f0x; f \u00de and dxj; dXj; dMj\n\n? ?\nare time-varying and may be\n\napproximated as\n\nx ? ?xt f ? ?f t \u00f03:10\u00de\n\nand\n\ndxj ? d?xtj dXj ? d?Xtj dMj ? d ?Mtj \u00f03:11\u00de\n\nwhere the superscript t denotes the time-varying variables. Considering (3.6) and\nsubstituting (3.8)\u2013(3.11) into (3.5), the secular relative motion of the member\nsatellite under J2 perturbation can be expressed as\n\nxj ?f\nt; d ?Mtj\n\n? ?\n\u00bc ?g\n\n2d?aj\n1\u00fe?ec?f t\n\n? ?ad?ej ? c?f t \u00fe\n?a ? ?e\n?g\n\ns?f td ?M\nt\nj\n\nyj ?f\nt; d ?Mtj; d?X\n\nt\nj; d?x\n\nt\nj\n\n? ?\n\u00bc 2\u00fe?ec?f t\n\n1\u00fe?ec?f t\n?ad?ej ? s?f t \u00fe\n\n?a\n?g\n\n1\u00fe?ec?f t\n? ?\n\nd ?Mtj \u00fe\n?a?g2\n\n1\u00fe?ec?f t\nc?id?X\n\nt\nj \u00fe d?xtj\n\n? ?\n\nzj ?f\nt; d?X\n\nt\nj; ?x\n\nt\n? ?\n\n\u00bc ?a?g\n2\n\n1\u00fe?ec?f t\nd?ij ? s ?f t \u00fe ?xt\u00f0 \u00de ? s?ic ?f t \u00fe ?xt\u00f0 \u00ded?Xtj\n? ?\n\n\u00f03:12\u00de\n\n3.2 Passive and Periodic Relative Motion Under J2 Perturbation 47\n\n\n\nBasically, secular relative motion (3.12) is a very complicated trajectory under the\nJ2 perturbation. Here, just the strict J2 invariant relative orbit is investigated. As\nproved by Schaub and Alfriend (2001), the member satellite and the reference\nsatellite have the same semimajor axis, the same inclination, and the same eccentricity\n\nd?aj \u00bc 0 d?ij \u00bc 0 d?ej \u00bc 0 \u00f03:13\u00de\n\nand the differences of another three orbit elements\n\nd?xtj \u00bc d?xj d?Xtj \u00bc d?Xj d ?Mtj \u00bc d ?Mj \u00f03:14\u00de\n\nare constants. Substituting (3.13) and (3.14) into (3.12) yields the solution of the\nstrict J2 invariant relative orbit\n\nxj ?f\nt\u00f0 \u00de \u00bc ?a ? ?ed\n\n?Mj\n?g\n\n? s?f t\n\nyj ?f\nt\u00f0 \u00de \u00bc ?ad\n\n?Mj\n?g\n\n1\u00fe?ec?f t\n? ?\u00fe ?a?g2 c?id?Xj \u00fe d?xj\n\n? ?\n1\u00fe?ec?f t\n\nzj ?f\nt; ?xt\u00f0 \u00de \u00bc ??a?g2s?id?Xj ?\n\nc ?f t \u00fe ?xt\u00f0 \u00de\n1\u00fe?ec?f t\n\n\u00f03:15\u00de\n\nRemark 3.1 By observing the result (3.15), it is found that the period of the\nin-plane motion \u00f0xj; yj\u00de is determined only by the secular motion of the true\nanomaly ?f t, while the period of the cross-track motion zj is determined by both the\nsecular motions of the true anomaly ?f t and the argument of perigee ?xt. Generally,\nthe period difference between the in-plane motion \u00f0xj; yj\u00de and the cross-track motion\nzj may cause the tumbling of the relative orbit. It implies that three conditions in\n(3.13) are generally not enough to ensure a periodic closed relative orbit.\n\nRemark 3.2 Upon further investigation into the last equation in (3.15), it is found\nthat the cross-track motion is independent of the time-varying variable ?xt if one of\nthe following conditions is satisfied\n\n?i \u00bc ic \u00f03:16\u00de\n\nor\n\n?i \u00bc 0 \u00f03:17\u00de\n\nor\n\nd?Xj \u00bc 0 \u00f03:18\u00de\n\nwhere ic \u00bc 63:435? or 116:565? is the critical inclination.\n\n48 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nFrom the J2 perturbation theory, it is known that, under condition (3.16), the\napsidal rotation rate is zero and the perigee is frozen at somewhere\n\n_?xt \u00bc 0 and ?xt \u00bc ?x 8?i \u00bc ic \u00f03:19\u00de\n\nCondition (3.16) illustrates that the periodic relative trajectory can be achieved at\nthe critical inclination, which will be discussed in detail in the next section.\n\nConditions (3.17) and (3.18) together with d?ij \u00bc 0 actually imply that the\nmember satellite shares the same orbital plane with the reference satellite so that the\nrelative orbit does not have the cross-track motion and\n\nzj \u00bc 0 \u00f03:20\u00de\n\nThe formations under the conditions (3.17) or (3.18) are referred as the in-plane\nformation, which are discussed in detail in Sect. 3.4.\n\n3.3 Periodic and Quasi-periodic Relative Orbits at Critical\nInclination\n\nOrbit at the critical inclination is a practical option for long-term satellite formation\nflying around an oblate Earth. This section establishes that passive and periodic\nrelative orbits with cross-track motion are only possible at the critical inclination\nunder conditions that all satellites share the same inclination, the same semimajor\naxis, and the same eccentricity. Furthermore, a quasi-periodic relative orbit is\nachieved near the critical inclination by matching the orbital energy and the polar\ncomponent of the orbital angular momentum. These matching conditions can be\nexpressed in terms of the actual orbit variables. The theoretical result shows that\nthese conditions are equivalent to matching the orbital period and the rate of the\nmean anomaly.\n\n3.3.1 Periodic Relative Orbit\n\nIn this subsection, the conditions of the passive and periodic relative orbit with\ncross-track motion under J2 perturbation are presented.\n\nzj \u00bc 0 \u00f03:20\u00de\n\n3.2 Passive and Periodic Relative Motion Under J2 Perturbation 49\n\n\n\nBy substituting (3.16) and (3.19) into (3.15), the solution of the passive and\nperiodic relative orbit is derived as\n\nxj ?f\nt\u00f0 \u00de \u00bc ?a ? ?ed\n\n?Mj\n?g\n\n? s?f t\n\nyj ?f\nt\u00f0 \u00de \u00bc ?ad\n\n?Mj\n?g\n\n? 1\u00fe?ec?f t\n? ?\u00fe ?a?g2 c?icd?Xj \u00fe d?xj\n\n? ?\n1\u00fe?ec?f t\n\nzj ?f\nt\u00f0 \u00de \u00bc ??a?g2s?icd?Xj ?\n\nc ?f tt \u00fe ?x\u00f0 \u00de\n1\u00fe?ec?f t\n\n\u00f03:21\u00de\n\nThe results established are presented in the following remark.\n\nRemark 3.3 It can be concluded that if the J2 perturbation is present, a passive and\nperiodic relative orbit with the cross-track motion requires four conditions\n\nd?aj \u00bc 0 d?ij \u00bc 0 d?ej \u00bc 0 ?i \u00bc ic \u00f03:22\u00de\n\ni.e., there is one more condition ?i \u00bc ic than the strict J2 invariant relative orbit\nconditions (3.13).\n\nThis remark can be illustrated with the aid of Fig. 3.2. Suppose that the strict J2\ninvariant relative orbit conditions (3.13) are satisfied and the orbital planes of two\nsatellites do not overlap. It follows that the secular rates of the ascending nodes\nn0; nj\n? ?\n\nand the perigees p0; pj\n? ?\n\nare the same for both the reference and the\nmember satellite orbital planes. They ensure the angle b between the z-axis and the\nintersection line b of two orbital planes is a constant. However, the angles between\nthe perigees p0; pj\n\n? ?\nand the intersection line b are varying, and hence, it causes the\n\ntumbling of the relative orbit. It is at the critical inclination that perigees p0; pj\n? ?\n\nare\nfrozen so that the relationship between two satellite orbits does not change.\n\nRemark 3.4 The above remark reveals that the critical inclination is very important\nfor long-term formation flying. Since the orbits at the critical inclination cover most\nparts of the Earth surface, these orbits may meet most mission requirement in\nsatellite formation flying.\n\n3.3.2 Quasi-periodic Relative Orbit\n\nThe periodic relative orbit conditions (3.22) are very strong and leave only three\ndegrees of freedom to design the formation geometry. In this subsection, one more\ndegrees of freedom is yielded by establishing a set of quasi-periodic relative orbit\nconditions.\n\n50 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nIt is known that both the 2-body and J2 gravities are conservative and axial\nsymmetric. So, if only the 2-body and J2 gravities are considered, a satellite motion\nwill be subject to some conservative quantities. Among possible conservative\nquantities, two classical mechanical quantities are highlighted, i.e., the orbital\nenergy and the polar component of the orbital angular momentum. Next, these two\nconservative quantities are shown play an important role in formation flying at the\ncritical inclination.\n\nThe difference of energies of the reference and jth member satellites is denoted\nas\n\ndEj \u00bc Ej ? E \u00f03:23\u00de\n\nFig. 3.2 Relative motion\naffected by the apsidal\nrotation\n\n3.3 Periodic and Quasi-periodic Relative Orbits at Critical Inclination 51\n\n\n\nand the difference of their polar components of the orbital angular momentum is\ndenoted as\n\ndHj \u00bc Hj ? H \u00f03:24\u00de\n\nGenerally, if the J2 gravity is included and both the satellites have the same\norbital period, the differences (3.23) and (3.24) may not be zero. However, if the\nreference satellite flies in a orbit at the critical inclination, i.e., ?i \u00bc ic, conditions\n\ndEj \u00bc 0 \u00f03:25\u00de\n\nand\n\ndHj \u00bc 0 \u00f03:26\u00de\n\nwill guarantee not only the orbital periods but also the mean anomaly rates of the\ntwo satellites are identical, which will be proved in the following derivations.\n\nThe quantities E and H of the reference satellite are expressed in terms of the\nmean orbital elements as\n\nE \u00bc ? l\n2?a\n\n\u00fe J2lR\n2\ne\n\n4?a3?g3\n1? 3c2?i\n? ? \u00f03:27\u00de\n\nH \u00bc c?i?g\nffiffiffiffiffiffi\nl?a\n\np \u00f03:28\u00de\n\nwhere l is the Earth gravitational constant; J2 is the second zonal harmonic coef-\nficient of the Earth; and Re is the Earth equatorial radius. The variations of (3.27)\nand (3.28) are\n\ndE \u00bc l\n2?a2\n\n? 3J2lR\n2\ne\n\n4?a4?g3\n1? 3c2?i\n? ?? ?\n\nd?a\u00fe 3J2lR\n2\ne\n\n4?a3?g4\ns2?i?gd?i? 1? 3c2?i\n\n? ?\nd?g\n\n? ? \u00f03:29\u00de\ndH \u00bc c?i\n\nffiffiffiffiffiffi\nl?a\n\np\nd?g? ?gs?i\n\nffiffiffiffiffiffi\nl?a\n\np\nd?i\u00fe 1\n\n2\n?gc?i\n\nffiffiffi\nl\n?a\n\nr\nd?a \u00f03:30\u00de\n\nApplying condition (3.16), the differences (3.23) and (3.24) of the jth member\nsatellite at the critical inclination are evaluated by the variations (3.29) and (3.30) as\n\ndEj \u00bc l2?a2 ?\n3J2lR2e\n10?a4?g3\n\n? ?\nd?aj \u00fe 3J2lR\n\n2\ne\n\n10?a3?g4\n?2?gdij ? d?gj\n? ? \u00f03:31\u00de\n\ndHj \u00bc ?\nffiffiffiffiffiffi\nl?a\n5\n\nr\n?g\n2?a\n\nd?aj ? ?2?gd?ij ? d?gj\n? ?? ? \u00f03:32\u00de\n\n52 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nwhere upper and lower signs of ? are for ?i \u00bc 63:425? and ?i \u00bc 116:565?, respec-\ntively. Applying conditions (3.25) and (3.26) and assuming\n\n?a2 6\u00bc 3J2R\n2\ne\n\n10?g3\n\u00f03:33\u00de\n\nEquations (3.31) and (3.32) yield\n\nd?aj \u00bc 0 \u00f03:34\u00de\n\nd?gj \u00bc ?2?gd?ij \u00f03:35\u00de\n\nActually, assumption (3.33) is always satisfied for an Earth orbital satellite.\nSince the orbit altitude at the perigee is larger than the Earth\u2019s radius, we have\n\n?a2 [\nR2e\n\n1? ?e\u00f0 \u00de2 \u00f03:36\u00de\n\nSubstituting\n\n?a2 \u00bc 3J2R\n2\ne\n\n10?g3\n\u00f03:37\u00de\n\ninto (3.36) yields that\n\n3J2\n10\n\n[\n?g3\n\n1? ?e\u00f0 \u00de2 [ 1 \u00f03:38\u00de\n\nis necessary such that (3.37) is true. It is known that J2 \u00bc 0:00108 so that (3.38)\ndoes not have a solution. As a result, assumption (3.33) is always true.\n\nThis derivation reveals that conditions (3.25) and (3.26) are equivalent to con-\nditions (3.34) and (3.35) at the critical inclination. Using the variation form of the\nidentity (3.7) to replace d?gj in (3.35), an alternate expression of (3.35) is obtained as\n\nd?ij \u00bc ??ed?ej2?g2 \u00f03:39\u00de\n\nNext, it is investigated how conditions (3.34) and (3.35) work on other orbit\n\nelement differences d?X\nt\nj; d?x\n\nt\nj; d ?M\n\nt\nj\n\n? ?\nat the critical inclination. The J2 perturbation\n\ntheory proves that\n\n_?X \u00bc ? 3\n2\nJ2\n\nR2e\n?a2\n\n?n\n?g4\n\nc?i \u00f03:40\u00de\n\n3.3 Periodic and Quasi-periodic Relative Orbits at Critical Inclination 53\n\n\n\n_?x \u00bc 3\n4\nJ2\n\nR2e\n?a2\n\n?n\n?g4\n\n5c2?i ? 1\n? ? \u00f03:41\u00de\n\n_?M \u00bc ?n? 3\n4\nJ2\n\nR2e\n?a2\n\n?n\n?g3\n\n1? 3c2?i\n? ? \u00f03:42\u00de\n\nwhere\n\n?n \u00bc\nffiffiffiffiffiffiffiffiffiffi\nl=?a3\n\np\n\u00f03:43\u00de\n\nis the mean motion. Substitute (3.43) into (3.40)\u2013(3.42) and then take the variations\nwhich give the rates of differential orbit elements as\n\nd _?X \u00bc 3J2R\n2\ne\nffiffiffi\nl\n\np\n4?a9=2?g5\n\n7c?i?gd?a\u00fe 2?a 4c?id?g\u00fe s?i?gd?i\u00f0 \u00de\u00f0 \u00de \u00f03:44\u00de\n\nd _?x \u00bc ? 3J2R\n2\ne\nffiffiffi\nl\n\np\n8?a9=2?g5\n\n? 7 5c2?i ? 1\n? ?\n\n?gd?a? 3J2R\n2\ne\nffiffiffi\nl\n\np\n8?a9=2?g5\n\n? 2?a 4 5c2?i ? 1\n? ?\n\nd?g\u00fe 5?gs2?id?i\n? ?\n\n\u00f03:45\u00de\n\nd _?M \u00bc 3\nffiffiffi\nl\n\np\n2?a5=2\n\n7J2R2e\n4?a2?g3\n\n1? 3c2?i\n? ?? 1? ?d?a\u00fe 9J2R2e ffiffiffiup\n\n4?a7=2?g4\n1? 3c2?i\n? ?\n\nd?g? ?gs2?id?i\n? ?\n\n\u00f03:46\u00de\n\nApplying (3.16) and (3.34)\u2013(3.35), the rates of the orbit element differences\n\nd?X\nt\nj; d?x\n\nt\nj; d ?M\n\nt\nj\n\n? ?\nof the jth member satellite at the critical inclination under con-\n\nditions (3.25) and (3.26) are derived from (3.44) to (3.46) as\n\nd _?Xj \u00bc\n3\nffiffiffi\n5\n\np\nJ2R2e\n\nffiffiffi\nl\n\np\n?a7=2?g4\n\nd?ij \u00f03:47\u00de\n\nd _?xj \u00bc ?\n3J2R2e\n\nffiffiffi\nl\n\np\n?a7=2?g4\n\nd?ij \u00f03:48\u00de\n\nd _?M j \u00bc 0 \u00f03:49\u00de\n\nDefine an angle d?ktj as\n\nd?ktj \u00bc d?xtj \u00fe d?Xtjc?i \u00f03:50\u00de\n\n54 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nwhich describes a perturbed motion between satellites caused by the J2 gravity.\nUsing the commutative principle\n\nd\ndt\n\u00f0dx\u00de \u00bc d _x \u00f03:51\u00de\n\nTaking time derivative of (3.50) and considering (3.16), (3.47), and (3.48) yield\n\nd _?kj \u00bc d _?xj \u00fe d _?Xjcic \u00bc 0 \u00f03:52\u00de\n\nBy combining (3.49) and (3.52), it is concluded that the orbital rate difference\nbetween the reference satellite and the jth member satellite is zero under conditions\n(3.25) and (3.26) at the critical inclination\n\nd _?Mj \u00fe d _?xj \u00fe d _?Xjcic \u00bc 0 \u00f03:53\u00de\n\nIn other words, it implies the two satellites have the same nodal orbital period\n(Schaub and Junkins 2003)\n\ndT \u00bc 0 \u00f03:54\u00de\n\nThe remarkable results (3.49) and (3.52) suggest that, under conditions (3.25)\nand (3.26) at the critical inclination, the time-varying variables d ?Mtj and\n\nd?xtj \u00fe d?Xtjcic can be replaced by constants d ?Mj and d?kj as\n\nd ?Mtj \u00bc d ?Mj \u00f03:55\u00de\n\nd?xtj \u00fe d?Xtjcic \u00bc d?kj \u00f03:56\u00de\n\nNow, by substituting (3.16), (3.19), (3.34)\u2013(3.35), (3.39), and (3.55)\u2013(3.56) into\n(3.12), the solution of the satellite relative orbit under conditions (3.25) and (3.26)\nnear the critical inclination is derived as\n\nxj ?f\nt\u00f0 \u00de \u00bc ?a ? ?ed\n\n?Mj\n?g\n\n? s?f t ? ?ad?ej ? c?f t\n\nyj ?f\nt\u00f0 \u00de \u00bc ?ad?ej 2\u00fe?ec?f t\n\n? ?\ns?f t\n\n1\u00fe?ec?f t\n\u00fe ?ad\n\n?Mj 1\u00fe?ec?f t\n? ?\n?g\n\n\u00fe ?a?g\n2d?kj\n\n1\u00fe?ec?f t\n\nzj ?f\nt; d?X\n\nt\nj\n\n? ?\n\u00bc ??a\n\n1\u00fe?ec?f t\n?g2s?icd\n\n?X\nt\njc ?f t \u00fe ?x\u00f0 \u00de ?\n\n?ed?ejs ?f t \u00fe ?x\u00f0 \u00de\n2\n\n? ? \u00f03:57\u00de\n\nRemark 3.5 Similar to solution (3.15), the in-plane trajectory xj; yj\n? ?\n\nof solution\n(3.57) is periodically closed. Nevertheless, conditions (3.16) and (3.34)\u2013(3.35) for\n\n3.3 Periodic and Quasi-periodic Relative Orbits at Critical Inclination 55\n\n\n\nsolution (3.57) are weaker than conditions (3.13) for solution (3.15). They allow\nfour degrees of freedom to design the satellite formation geometry, while conditions\n(3.13) grant only three degrees of freedom.\n\nRemark 3.6 Conditions (3.25)\u2013(3.26) or (3.34)\u2013(3.35) are referred as the quasi-\nperiodic relative orbit conditions near the critical inclination.\n\n3.3.3 Quasi-periodic Relative Orbit Conditions in Terms\nof Actual Orbit Variables\n\nThe quasi-periodic relative orbit conditions (3.34) and (3.35) are expressed in the\nmean orbital elements. They provide insight into the relationships among the mean\norbit element differences so as to gain an understanding on the formation geometry.\nHowever, they involve a complex transformation to establish the initial conditions\nof the member satellite in the local frame. Since the orbital energy and the polar\ncomponent of the orbital angular momentum are the conservative quantities, it is\npossible to express conditions (3.25) and (3.26) in terms of the actual orbit\nvariables.\n\nThere are different approaches to select the actual orbit variables of the reference\nsatellite. A convenient set of five reference satellite variables \u00f0r; _r; h; h; i\u00de, which are\npresented in Xu and Wang (2008) and called compact reference satellite variables\n(CRSV), is used in this book. The physical meanings of CRSV are the radius r, the\nvelocity component along the radial direction _r, the angular momentum magnitude\nh, the true latitude h, and the inclination i. On the other hand, the relative orbit\nvariables of the jth member satellite are commonly expressed by the relative\nposition components xj; yj; zj\n\n? ?\nand the relative velocity components _xj; _yj; _zj\n\n? ?\nin\n\nthe LVLH frame. Next, the expression of conditions (3.25) and (3.26) in terms of\n11 actual orbit variables \u00f0r; _r; h; h; i\u00de and xj; yj; zj; _xj; _yj; _zj\n\n? ?\nis derived.\n\nIn the LVLH frame, the position vectors of the reference and the jth member\nsatellites in the inertial space are\n\nr \u00bc rx? rj \u00bc r\u00fe xj\n? ?\n\nx?\u00fe yjy?\u00fe zjz? \u00f03:58\u00de\n\nTaking time derivative produces their velocity vectors (Xu and Wang 2008) as\n\n_r \u00bc _rx?\u00fe h\nr\ny? _rj \u00bc vjxx?\u00fe vjyy?\u00fe vjzz? \u00f03:59\u00de\n\nwith the velocity components along LVLH axes being\n\n56 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nvjx \u00bc _xj \u00fe _r ? yjxz\nvjy \u00bc _yj \u00fe r\u00fe xj\n\n? ?\nxz ? zjxx\n\nvjz \u00bc _zj \u00fe yjxx\n\u00f03:60\u00de\n\nand the angular velocity components being\n\nxx \u00bc ? kJ2s2ishhr3 xz \u00bc\nh\nr2\n\n\u00f03:61\u00de\n\nIn (3.61), kJ2 is a constant defined by\n\nkJ2 \u00bc 3J2lR2e=2 \u00f03:62\u00de\n\nUsing the position vectors (3.59) and the velocity vectors (3.60), the polar\ncomponents of the angular momentum of the reference and the member satellites\ncan be computed by\n\nH \u00bc \u00f0r? _r\u00de ? Z? Hj \u00bc rj ? _rj\n? ? ? Z? \u00f03:63\u00de\n\nwhere the unit vector Z? of the polar axis can be expressed in the LVLH frame as\n\nZ? \u00bc shsix?\u00fe chsiy?\u00fe ciz? \u00f03:64\u00de\n\nSubstituting (3.59)\u2013(3.60) and (3.64) into (3.63), then condition (3.26) dHj \u00bc\nHj ? H \u00bc 0 becomes\n\nvjx zjchsi ? yjci\n? ?\u00fe vjy xj \u00fe r? ?ci ? zjshsi? ?\u00fe vjz yjsh ? xj \u00fe r? ?ch? ?si \u00bc hci \u00f03:65\u00de\n\nOn the other hand, energy-matching condition (3.25) can be written as\n\nK \u00feU \u00bc Kj \u00feUj \u00f03:66\u00de\n\nwhere K and Kj are kinetic energies per unit mass of the two satellites, which are\ncomputed by\n\nK \u00bc 1\n2\n_r ? _r Kj \u00bc 12 _rj ? _rj \u00f03:67\u00de\n\nU and Uj are potential energies per unit mass of the two satellites, which are\nderived in Xu and Wang (2008) as\n\n3.3 Periodic and Quasi-periodic Relative Orbits at Critical Inclination 57\n\n\n\nU \u00bc ? l\nr\n? kJ2\n3r3\n\n\u00fe kJ2s\n2\nhs\n\n2\ni\n\nr3\n\nUj \u00bc ? lrj ?\nkJ2\n3r3j\n\n\u00fe kJ2r\n2\njZ\n\nr5j\n\n\u00f03:68\u00de\n\nwith\n\nrj \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nr\u00fe xj\n? ?2 \u00fe y2j \u00fe z2j\n\nq\nrjZ \u00bc r\u00fe xj\n\n? ?\nsish \u00fe yjsich \u00fe zjci\n\n\u00f03:69\u00de\n\nSubstituting (3.67) and (3.68) into (3.66) and considering (3.59), condition\n(3.25) becomes\n\nv2jx \u00fe v2jy \u00fe v2jz \u00bc _r2 \u00fe\nh2\n\nr2\n\u00fe 2l 1\n\nrj\n? 1\n\nr\n\n? ?\n\u00fe 2kJ2 13r3j\n\n? 1\n3r3\n\n? r\n2\njZ\n\nr5j\n\u00fe s\n\n2\nhs\n\n2\ni\n\nr3\n\n !\n\u00f03:70\u00de\n\nRemark 3.7 Now, the quasi-periodic relative orbit conditions (3.25) and (3.26) are\nexpressed in terms of the actual orbit variables in Eqs. (3.65) and (3.70).\n\n3.3.4 Numerical Simulations\n\nNumerical simulations are performed to verify the proposed quasi-periodic relative\norbit conditions. In the simulations, a reference satellite flies in an elliptic orbit at\nthe critical inclination, while a member satellite flies around the reference satellite.\nThree cases are simulated and compared. To evaluate the different simulated cases,\nthe same reference satellite orbit is used for each simulation, which is represented\nby the mean orbit elements as follows:\n\n?a \u00bc 8000 km ?e \u00bc 0:1 ?i \u00bc 63:4349?\n?x \u00bc 45? ?X \u00bc 0 ?f \u00bc 0 \u00f03:71\u00de\n\nCare must be taken when setting up the initial conditions of the simulation so\nthat the mean orbit elements (3.71) are converted to the osculating orbit elements\nfirst and then transformed to the CRSV. On the other hand, the same actual initial\nrelative position of the member satellite is assigned for each case\n\nxj\u00f00\u00de \u00bc 0:5 km yj\u00f00\u00de \u00bc 0 zj\u00f00\u00de \u00bc 1 km \u00f03:72\u00de\n\n58 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nbut the actual initial relative velocity is adjusted by three different techniques for the\nperiodic relative orbit. In the numerical simulations, both the actual initial condi-\ntions of the reference satellite and the member satellite are applied to an exact\npropagator of the satellite relative motion which accommodates eccentricity, non-\nlinearity, and J2 perturbation. Next, the details of how the initial velocity of the\nmember satellite is calculated by three different techniques are illustrated.\n\nIn the first case, the initial velocity is calculated by the technique (Inalhan et al.\n2002) for the linear relative dynamics in the elliptic orbit as\n\n_xj\u00f00\u00de \u00bc 0 _zj\u00f00\u00de \u00bc 0 \u00f03:73\u00de\n\n_y\u00f00\u00de \u00bc ??n 2\u00fe?e\u00f0 \u00dex\u00f00\u00de\n1\u00fe?e\u00f0 \u00de1=2 1? ?e\u00f0 \u00de3=2\n\n\u00f03:74\u00de\n\nThis initial velocity may produce a periodic relative orbit if the J2 perturbation\nand the nonlinearity are ignored.\n\nIn the second case, the initial velocity is calculated by the energy-matching\ntechnique (Gurfil 2005; Xing et al. 2007) for the classical elliptic Keplerian motion.\nSuch energy-matching condition is equivalent to condition (3.70) by canceling J2\neffect (setting J2 \u00bc 0), which is explicitly expressed as\n\n_xj \u00fe _r ? yjxz\n? ?2 \u00fe _yj \u00fe rxz \u00fe xjxz? ?2 \u00fe _z2j \u00bc _r2 \u00fe r2x2z \u00fe 2l 1rj ?\n\n1\nr\n\n? ?\n\u00f03:75\u00de\n\nIn the simulation of the second case, instead of (3.74), initial velocity component\n_y\u00f00\u00de is solved from condition (3.75), while initial velocity components\n_xj\u00f00\u00de; _zj\u00f00\u00de\n? ?\n\nremain the same as (3.73). As explained earlier, this initial velocity\nmay produce a periodic relative orbit if the J2 perturbation is ignored.\n\nIn the third case, the newly developed quasi-periodic relative orbit conditions\n(3.65) and (3.70) are applied to calculate the actual initial velocity of the member\nsatellite. Since the two conditions produce two velocity components, _xj\u00f00\u00de \u00bc 0 is\nkept and let _yj\u00f00\u00de; _zj\u00f00\u00de\n\n? ?\nbe determined by the algebraic equations (3.65) and\n\n(3.70).\nTable 3.1 shows the calculated values of the initial velocity with the three dif-\n\nferent techniques.\nSimulations are performed for each case, and the results of 96-h formation flying\n\nare shown in Figs. 3.3, 3.4, and 3.5. It can be seen that both the first case and the\nsecond case have a fast drift in the along-track (y) direction. The drift in Fig. 3.3 is\n\nTable 3.1 Initial velocities\n\u00f0m=s\u00de Case _xj\u00f00\u00de _yj\u00f00\u00de _zj\u00f00\u00de\n\n(1) Linear w/o J2 0 1.03415 0\n\n(2) Nonlinear w/o J2 0 ?1.03486 0\n\n(3) Quasi-periodic 0 ?1.03564 ?1.05058\n\n3.3 Periodic and Quasi-periodic Relative Orbits at Critical Inclination 59\n\n\n\nabout 2 km which is caused by the ignored nonlinearity and the J2 perturbation. The\ndrift in Fig. 3.4 is about 1.2 km which is caused solely by the J2 perturbation. This\nresult verifies the claim made by Schaub and Alfriend (2001) that the orbital energies\nof different orbits with the same orbital period may not be the same when the J2\nperturbation is present. The drift magnitudes of the first two cases show that the J2\nperturbation and the ignored nonlinearity induce large drift errors in the same order.\nMeanwhile, it is observed there is a slow reduction in the cross-track (z) direction for\nboth the first and the second cases. This reduction is generated from the tumbling of\nthe relative orbit which is caused by the J2 perturbation. On the other hand, the result\nof the third case (as shown in Fig. 3.5) is nearly a perfect periodic relative orbit. Both\nthe along-track drift and the tumbling of the relative orbit are eliminated.\n\nFig. 3.3 Under linear condition\n\nFig. 3.4 Under nonlinear condition without J2 gravity\n\nFig. 3.5 Under quasi-periodic condition\n\n60 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nRemark 3.8 As analyzed above, the simulation results actually demonstrate the\nseparate effect of the nonlinearity and the J2 perturbation. The along-track drift is\ncaused by the ignored nonlinearity and the J2 perturbation, while the tumbling of\nthe relative orbit is caused by the J2 perturbation only. If a designed formation does\nnot address the nonlinearity or the J2 perturbation, then active control must be\nemployed to compensate the formation drift and tumbling. Since to correct the\ntumbling of the relative orbit requires the maintenance of the perigee and/or the\nright ascension of the ascending node, the fuel consumption to compensate the J2\nperturbation is expected to be much more than that for the nonlinearity (at least for\nformations about 2-km separation) which involves the orbital period only. Hence, it\nis believed that the nonlinearity and especially the J2 perturbation effects are not\nnegligible in the design of long-term satellite formation.\n\nRemark 3.9 In summary, neither the linear periodic condition (3.74) nor the\nenergy-matching condition (3.75) can establish a periodic relative orbit when the J2\nperturbation is present. The quasi-periodic relative orbit is achieved in the critical\ninclination by using the proposed conditions (3.65) and (3.70). It is a promising\nsolution to design satellite formations with cross-track motion.\n\n3.4 In-Plane Satellite Formation in Eccentric Orbits\n\nIn this section, the passive and periodic in-plane formation is investigated. It is\nproved that a passive in-plane formation is periodic and stable in J2 perturbed\neccentric orbits by setting all satellites to have the same mean orbit elements of\nsemimajor axis, eccentricity, inclination, and right ascension of ascending node. As\na result, the geometry design approach of some special cases will be proposed. In\nparticular, a special in-plane formation named as Almost Constant Separation\nFormation is achieved by suitably designing the differential secular elements of the\nargument of perigee and the mean anomaly. Further analysis shows that the sep-\naration distances between satellites in this special in-plane formation can be\nspecified at will and are almost invariant if the eccentricity is smaller than 0.3.\n\nCondition (3.17) or condition (3.18) together with d?ij \u00bc 0 actually confines the\nmember satellite in the same orbital plane of the reference satellite. As a general-\nization to the study (Gurfil 2005) for circular orbits, the formations under the\ncondition (3.17) or (3.18) and under the strict J2 invariant relative conditions in\n(3.13) are referred as the in-plane formation.\n\nSince the orbit elements used here are singular in zero inclination condition\n(3.17), without loss of generality, the relative trajectory of an in-plane formation\ncan be studied by substituting (3.18) into (3.15)\n\nxj ?f\nt\u00f0 \u00de \u00bc ?a ? ?ed\n\n?Mj\n?g\n\n? s?f t \u00f03:76\u00de\n\n3.3 Periodic and Quasi-periodic Relative Orbits at Critical Inclination 61\n\n\n\nyj ?f\nt\u00f0 \u00de \u00bc ?ad\n\n?Mj\n?g\n\n1\u00fe?ec?f t\n? ?\u00fe ?a?g2d?xj\n\n1\u00fe?ec?f t\n\u00f03:77\u00de\n\nzj \u00bc 0 \u00f03:78\u00de\n\nIt is clear that the relative trajectory of (3.76)\u2013(3.78) is periodic and depends on\nthe sole variable ?f t. So, this in-plane formation is stable under the J2 perturbation.\n\nAs derived in Sect. 3.2, suppose the reference orbit is specified such that four\ndifferential orbit elements of d?aj; d?ij; d?ej; d?Xj\n\n? ?\nare zero\n\nd?aj \u00bc 0 d?ij \u00bc 0 d?ej \u00bc 0 d?Xj \u00bc 0 \u00f03:79\u00de\n\nThe relative trajectory is confined in the same orbit plane as described in (3.76)\u2013\n(3.78), which is dominated by only two constant parameters d ?Mj; d?xj\n\n? ?\n: Next, the\n\ngeometry design of the in-plane formation will be discussed in detail by specifying\ntwo parameters d ?Mj; d?xj\n\n? ?\n: Since there is no out-plane motion \u00f0zj \u00bc 0\u00de, only the\n\nin-plane motion \u00f0xj; yj\u00de will be investigated.\n\n3.4.1 Identical Anomaly In-Plane Formation\n\nThe first in-plane formation is obtained by the simple idea of setting d ?Mj \u00bc 0: As a\nresult, the in-plane motion of (3.76) and (3.77) is simplified to\n\nxj \u00bc 0 yj ?f t\u00f0 \u00de \u00bc ?a?g\n2d?xj\n\n1\u00fe?ec?f t\n\u00f03:80\u00de\n\nThis special formation was first discussed by Lane and Axelrad (2006) and\nreferred to as the in-track formation, which conflicts with another formation pro-\nposed earlier by Sabol et al. (Gurfil 2005). Since d ?Mj \u00bc 0; the member satellite has\nthe identical mean anomaly as the reference satellite. For this reason, this formation\nis named as the identical anomaly in-plane formation (IAIF). An obvious property\nof this formation is that all satellites in the formation have the same altitude \u00f0xj \u00bc 0\u00de\nabove the Earth surface.\n\nThe distance between the member satellite and the reference satellite is\n\nqj \u00bc yj\n\t\t \t\t \u00bc ?a 1? ?e2\u00f0 \u00de d?xj\n\n\t\t \t\t\n1\u00fe?ec?f t\n\n\u00f03:81\u00de\n\n62 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nEquation (3.81) illustrates that satellites never collide qj [ 0\n? ?\n\nin an eccentric\norbit \u00f0?e 6\u00bc 0\u00de as long as d?xj 6\u00bc 0\n\n? ?\n. Actually, the condition d?xj \u00bc 0 in this for-\n\nmation means that the member satellite occupies the same position as the reference\nsatellite.\n\nThe intersatellite distance qj in (3.81) achieves the maximum at the apogee\n?f t \u00bc p\u00f0 \u00de as\n\nmax qj\n? ? \u00bc ?a 1\u00fe?e\u00f0 \u00de d?xj\t\t \t\t \u00f03:82\u00de\n\nand attains the minimum at the perigee ?f t \u00bc 0\u00f0 \u00de as\n\nmin qj\n? ? \u00bc ?a 1? ?e\u00f0 \u00de d?xj\t\t \t\t \u00f03:83\u00de\n\nThe ratio of the minimum to the maximum is\n\nD\u00f0?e) \u00bc min qj\nmax qj\n\n\u00bc 1? ?e\n1\u00fe?e \u00f03:84\u00de\n\nIt is clear that the ratio D\u00f0?e) solely depends on the eccentricity ?e and is presented\nin Table 3.2 for ?e 2 \u00bd0; 0:3\t.\n\nIt is found that the intersatellite distance qj changes a lot in an eccentric orbit\n\u00f0?e 6\u00bc 0\u00de. As shown in Table 3.2, the intersatellite distance may change 19.2 % even\nif the eccentricity is 0.1.\n\n3.4.2 Differential Anomaly In-Plane Formation\n\nIn this subsection, special attention is paid to investigate another formation whose\nmember satellite has different mean anomaly, i.e., d ?Mj 6\u00bc 0: In contrast to IAIF, this\nformation is named as the differential anomaly in-plane formation (DAIF).\n\nTo facilitate the relative trajectory analysis of the DAIF formation, a transfor-\nmation for the differential orbit elements d ?Mj; d?xj\n\n? ?\nis introduced as\n\npj \u00bc ?gd?xjd ?Mj qj \u00bc\n?ad ?Mj\n?g\n\n\u00f03:85\u00de\n\nBecause of d ?Mj 6\u00bc 0; the range of pj; qj\n? ?\n\nis\n\nTable 3.2 Intersatellite\ndistance variation of IAIF\n\n?e 0 0.1 0.2 0.3\n\nD\u00f0?e\u00de 1.000 0.818 0.667 0.538\n% 0 19.2 % 33.3 % 46.2 %\n\n3.4 In-Plane Satellite Formation in Eccentric Orbits 63\n\n\n\npj 2 \u00f0?1;1\u00de qj 6\u00bc 0 \u00f03:86\u00de\n\nInserting (3.85) into (3.76) and (3.77), the relative trajectory of a DAIF is\nconverted to\n\nxj ?f\nt\u00f0 \u00de \u00bc qj?e ? s?f t \u00f03:87\u00de\n\nyj ?f\nt\u00f0 \u00de \u00bc qj 1\u00fe?ec?f t \u00fe\n\npj?g2\n\n1\u00fe?ec?f t\n\n !\n\u00f03:88\u00de\n\nObserving the relative trajectory (3.87) and (3.88), it is immediately found that\nfor a DAIF formation, the direction and size of the relative trajectory are dominated\nby parameter qj (corresponding sign and magnitude of d ?Mj), while the shape of the\nrelative trajectory is dominated by parameter pj (corresponding ratio of d?xj to d ?Mj).\n\nSome further insights of the relative trajectory (3.87) and (3.88) are disclosed by\nthe following properties.\n\nProperty 3.1 Relative trajectory (3.87) and (3.88) is periodic and its period is the\nanomalistic period 2p of ?f t. Moreover, it is symmetric with respect to the axis\naligning the along-tracking direction.\n\nProof It is clear that the relative trajectory of (3.87) and (3.88) satisfies\n\nxj ?f\nt\u00f0 \u00de \u00bc xj 2p\u00fe?f t\u00f0 \u00de yj ?f t\u00f0 \u00de \u00bc yj 2p\u00fe?f t\u00f0 \u00de \u00f03:89\u00de\n\nSo, it is periodic and its period is the anomalistic period of ?f t. Furthermore, the\nrelative trajectory also satisfies\n\nxj ?f\nt\u00f0 \u00de \u00bc ?xj ??f t\u00f0 \u00de yj ?f t\u00f0 \u00de \u00bc yj ??f t\u00f0 \u00de \u00f03:90\u00de\n\nSo, it is symmetric with respect to y-axis, i.e., the axis aligning the along-track\ndirection.\n\nProperty 3.1 suggests that the relative trajectory can be studied within one period\nof\n\n?f t 2 \u00f0?p; p\t \u00f03:91\u00de\n\nIt is noticed that the relative motion xj in the radial direction is rather simple and\njust a function of sine. So, in the region of (3.91), Property 3.2 is straightforward.\n\nProperty 3.2 Radial motion (3.87) crosses the zero twice in one period if and only\nif the reference satellite is at the apsides\n\n64 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\n?f t \u00bc 0 or ?f t \u00bc p \u00f03:92\u00de\n\nand reaches its extrema if and only if the reference satellite is at one of semilatus\nrectums. The extrema are\n\nmin yj\n? ? \u00bc ??e qj\t\t \t\t max yj? ? \u00bc ?e qj\t\t \t\t \u00f03:93\u00de\n\nat ?f t \u00bc ?p=2 and ?f t \u00bc p=2, respectively. ?\nComparing with the relative motion in the radial direction, the relative motion yj\n\nin the along-track direction is a bit complicated. A property of the along-track\nmotion is revealed by Property 3.3.\n\nProperty 3.3 Under the condition\n\npj \n 1\u00fe?e1? ?e or pj ?\n1? ?e\n1\u00fe?e \u00f03:94\u00de\n\nthe along-track motion (3.88) reaches its extrema twice in one period, which\nhappen when the reference satellite is at the apsides (3.92) and the two extrema are\n\nextremum1 yj\n? ? \u00bc qj 1\u00fe?e\u00fe pj 1? ?e\u00f0 \u00de? ? \u00f03:95\u00de\n\nextremum2 yj\n? ? \u00bc qj 1? ?e\u00fe pj 1\u00fe?e\u00f0 \u00de? ? \u00f03:96\u00de\n\nOn the other hand, under the condition\n\n1? ?e\n1\u00fe?e\\pj\\\n\n1\u00fe?e\n1? ?e \u00f03:97\u00de\n\n(it implies ?e 6\u00bc 0) the along-track motion (3.88) reaches its extrema four times,\nwhich happen when the reference satellite is at the apsides (3.92) and at\n\n?f t \u00bc ?cos?1 ?g\nffiffiffiffi\npj\n\np ? 1\n?e\n\n\u00f03:98\u00de\n\nthe four extrema are (3.95), (3.96) and\n\nextremum3 yj\n? ? \u00bc extremum4 yj? ? \u00bc 2qj?g ffiffiffiffipjp \u00f03:99\u00de\n\nProof First of all, ?e \u00bc 0 implies yj ? qj 1\u00fe pj\n? ?\n\n. Extrema (3.95), (3.96) are the\nsame at qj 1\u00fe pj\n\n? ?\nand hold in the whole trajectory. Next, the case of ?e 6\u00bc 0 is\n\ndiscussed.\n\n3.4 In-Plane Satellite Formation in Eccentric Orbits 65\n\n\n\nTaking derivative of (3.88) with respect to ?f t yields\n\ny0j \u00bc ?eqjs?f t\n?g2pj\n\n1\u00fe?ec?f t\n? ?2 ? 1\n\n !\n\u00f03:100\u00de\n\nCondition (3.94) implies\n\n?g2pj\n\n1\u00fe?ec?f t\n? ?2 ? 1 6\u00bc 0 \u00f03:101\u00de\n\nSo, y0j \u00bc 0 is equivalent to s?f t \u00bc 0, and hence, yj attains its extrema when the\nreference satellite is at the apsides (3.92). Substituting s?f t \u00bc 0 into (3.88), extrema\n(3.95) and (3.96) are solved.\n\nOn the other hand, under condition (3.97), y0j \u00bc 0 if either s?f t \u00bc 0 or\n\n?g2pj\n\n1\u00fe?ec?f t\n? ?2 ? 1 \u00bc 0 \u00f03:102\u00de\n\nEquation (3.102) is equivalent to (3.98). So, yj attains the extrema when the\nreference satellite is at the apsides (3.92) and at (3.98). Substituting (3.98) into\n(3.88), another two extrema are solved as (3.99). ?\n\nProperty 3.3 tells us that the along-track motion may have two or four extrema.\nAmong them, two extrema of (3.99) may vanish in regions (3.94), while another\ntwo extrema of (3.95) and (3.96) are always established. Combining Properties 3.2\nand 3.3, it is known that the nonvanishing extrema are achieved just when the radial\nmotion crosses the zero and the reference satellite is at the apsides. As a result, the\ntwo nonvanishing extrema are more significant. The bias of member satellite is\ndefined as the mean value of two nonvanishing extrema as\n\nbj \u00bc 12 extremum1 yj\n? ?\u00fe extremum2 yj? ?? ? \u00f03:103\u00de\n\nSubstituting (3.95) and (3.96) into (3.103), the bias is solved to\n\nbj \u00bc qj 1\u00fe pj\n? ? \u00f03:104\u00de\n\nActually, bias (3.103) or (3.104) also coincides with another comprehensive\nexpression of the along-track motion. Let ?Et be the secular eccentric anomaly as in\nthe approach of the unperturbed Keplerian motion. The following identity (Schaub\nand Junkins 2003) is true,\n\n66 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\n?g2\n\n1\u00fe?ec?f t\n\u00bc 1? ?ec?Et \u00f03:105\u00de\n\nUsing (3.105), the along-track motion (3.88) can be converted to\n\nyj \u00bc qj?e c?f t ? pjc?Et\n? ?\u00fe qj 1\u00fe pj? ? \u00f03:106\u00de\n\nOn the right side of Eq. (3.106), the first term is periodic and the second term\nplays the role of bias, which is the same as expression (3.104). The expression of\nbias (3.104) illustrates that parameter pj dominates not only the shape of the relative\ntrajectory but also its bias. It means that if the parameter pj is unsuitably selected,\nthe relative trajectory of the member satellite may cross the origin or, in other\nwords, collides with the reference satellite. This is demonstrated by the following\nproperty.\n\nProperty 3.4 In a DAIF formation, the member satellite may collide with the\nreference satellite at the apsides if\n\npj \u00bc ? 1\u00fe?e1? ?e or pj \u00bc ?\n1? ?e\n1\u00fe?e \u00f03:107\u00de\n\nProof The collision happens when xj \u00bc yj \u00bc zj \u00bc 0 at the same time. Here, zj \u00bc 0\nalways holds. From (3.87), it is known that xj \u00bc 0 if\n\ns?f t \u00bc 0 or ?e \u00bc 0 \u00f03:108\u00de\n\nThe first case of s?f t \u00bc 0 implies\n\n?f t \u00bc 0 or ?f t \u00bc p \u00f03:109\u00de\n\nThen, substituting (3.109) into (3.88) and setting yj \u00bc 0 yield pj being one of\nvalues in (3.107).\n\nOn the other hand, ?e \u00bc 0 implies that yj \u00bc 0 is equivalent to\n\npj \u00bc ?1 \u00f03:110\u00de\n\nIt is a special case of (3.107). ?\nProperties 3.1\u20133.4 sketch the essential geometric insights of the relative trajec-\n\ntory of a DAIF formation. They are further illustrated by Figs. 3.6 and 3.7\nSetting ?e \u00bc 0:2 and qj \u00bc 1, the relative trajectories of a DAIF formation are\n\nshown in Fig. 3.6 for pj in region\n\n1? ?e\n1\u00fe?e ? pj ?\n\n1\u00fe?e\n1? ?e \u00f03:111\u00de\n\n3.4 In-Plane Satellite Formation in Eccentric Orbits 67\n\n\n\nand shown in Fig. 3.7 for pj in region\n\n? 1\u00fe?e\n1? ?e ? pj ? ?\n\n1? ?e\n1\u00fe?e \u00f03:112\u00de\n\nFigures 3.6 and 3.7 clearly show that parameter pj plays a very important role in\nthe behavior of the satellite relative motion. Among the whole value space of\nparameter pj, two special values should be highlighted.\n\nOne special value is pj \u00bc ?1, where the bias of the along-track motion vanishes\n(as shown in Fig. 3.7). In this case, the member satellite flies around the reference\nsatellite. However, when the eccentricity approaches zero, the relative trajectory\nshrinks to the origin and disappears. Moreover, care must be taken to avoid the\ncollision between the member satellite and the reference satellite when pj changes a\nlittle as discussed in Property 3.4.\n\nAnother special value is pj \u00bc 1, where two nonvanishing extrema of the\nalong-track motion intersect at the same relative position. This result can be con-\ncluded from (3.95) and (3.96) by setting pj \u00bc 1,\n\nFig. 3.6 Along-track motion\nmay have four extrema\n\n68 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nextremum1 yj\n? ? \u00bc extremum2 yj? ? \u00bc 2qj \u00f03:113\u00de\n\nIn depth, the two nonvanishing extrema exchange their relative position around\npj \u00bc 1. When pj\\1, the first extreme (at perigee) is farther than the second extreme\n(at apogee) from the origin. When pj [ 1, the second extreme (at apogee) exceeds\nthe first extreme (at perigee) and becomes farther from the origin.\n\nBased on the above analysis, it is noticed that the special value of pj \u00bc 1 is very\nsignificant. As the two nonvanishing extrema are equal, it is expected that the\ndistance from every point on the relative trajectory to the reference satellite changes\nin a small range. Moreover, Eq. (3.113) shows that when pj \u00bc 1 is fixed, the bias\ncan be designed at will by parameter qj. In the next subsection, the special DAIF\nformation for pj \u00bc 1 is discussed in detail.\n\n3.4.3 Almost Constant Separation Formation\n\nIt is known that the two nonvanishing extrema in the along-track direction in the\nspecial DAIF for pj \u00bc 1 are the same. However, there are two more additional\nextrema in the along-track direction in this case as revealed in Property 3.3. So, the\ndistance between the member satellite and the reference satellite is not constant.\nNow, the range of the distance varying is concerned.\n\nFig. 3.7 Collisions and zero\nbias\n\n3.4 In-Plane Satellite Formation in Eccentric Orbits 69\n\n\n\nConsidering (3.87)\u2013(3.88) and (3.78), the distance between the member satellite\nand the reference satellite is\n\nqj ?f\nt\u00f0 \u00de \u00bc\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2j \u00fe y2j \u00fe z2j\n\nq\n\u00bc qj\n\t\t\t \t\t\t\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n1\u00fe?e2 \u00fe 2?ec?f t \u00fe 2?g2 \u00fe\n\n?g4\n\n1\u00fe?ec?f t\n? ?2\n\ns\n\u00f03:114\u00de\n\nTaking derivative with respect to ?f t yields\n\nq0j \u00bc\ndqj\nd?f t\n\n\u00bc q\n2\nj ?es?f t\n\nqj\n\n?g4\n\n1\u00fe?ec?f t\n? ?3 ? 1\n !\n\n\u00f03:115\u00de\n\nThe extrema of distance qj happen when q\n0\nj \u00bc 0, which gives\n\ns?f t \u00bc 0 or 1\u00fe?ec?f t \u00bc ?g4=3 \u00f03:116\u00de\n\nSubstituting (3.116) into (3.114), the extrema of distance qj are solved as\n\nmax qj \u00bc 2 qj\n\t\t \t\t \u00f03:117\u00de\n\nAnd\n\nmin qj \u00bc qj\n\t\t \t\t ffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi?g2 \u00fe 3?g4=3q \u00f03:118\u00de\n\nSo, the ratio of the minimum to the maximum can be calculated by\n\nD\u00f0?e\u00de \u00bc min qj\nmax qj\n\n\u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n?g2 \u00fe 3?g4=3\n\np\n2\n\n\u00f03:119\u00de\n\nIt is clear that the ratio D\u00f0?e\u00de solely depends on the eccentricity ?e and is presented\nin Table 3.3 for ?e 2 \u00bd0; 0:3\t. It is found that although the distance between the\nmember satellite and the reference satellite is variable in this special DAIF with\npj \u00bc 1, the variation is very small if the eccentricity is smaller than 0.3. For this\nreason, this special formation is named as the Almost Constant Separation\nFormation (ACSF).\n\nNow, the formation design approach of the ACSF can be presented by com-\nbining the periodic constraints (3.79), the geometric constraints pj \u00bc 1, the bias\n(3.104), and the transformation (3.85) as\n\nTable 3.3 Intersatellite\ndistance variation of ACSF\n\n?e 0 0.1 0.2 0.3\n\nD\u00f0?e\u00de 1.000 0.996 0.985 0.965\n% 0 0.4 % 1.5 % 3.5 %\n\n70 3 Passive and Periodic Satellite Formation Design \u2026\n\n\n\nd?aj \u00bc 0 d?ij \u00bc 0 d?ej \u00bc 0\nd?Xj \u00bc 0 d?xj \u00bc bj2?a d\n\n?Mj \u00bc ?gbj2?a\n\u00f03:120\u00de\n\nThe only design parameter is the bias bj, which specifies the separation distances\nbetween the member satellite and the reference satellite. Figure 3.8 shows an\nexample of a 5-satellite ACSF. In this example, the eccentricity is ?e \u00bc 0:2, and the\nseparation distance between satellites is 2 km. So, the biases of each satellite are\nspecified as\n\nb0 \u00bc 0 b1 \u00bc ?2 b2 \u00bc ?4 b3 \u00bc 2 b4 \u00bc 4 \u00f03:121\u00de\n\nRemark 3.10 When the bias bj of each satellite is specified for ACSF formation, the\nsatellite relative trajectories only depend on the eccentricity and the true anomaly\n\n?e;?f t\u00f0 \u00de but are independent of other orbit elements ?a;?i; ?Xt; ?xt\n? ?\n\nof the reference\n\norbit.\n\n3.5 Conclusions\n\nIn this chapter, general conditions are established for the PPRT under the J2 per-\nturbation in elliptic orbits. There are only two classes of the PPRT. In the first class,\nthe reference satellite orbit is subjected to one constraint: at the critical inclination,\nwhile the member satellite orbit must satisfy three constraints: the same semimajor\naxis, inclination, and eccentricity with the reference orbit. Conditions of the\nquasi-periodic relative orbit with cross-track motion are also proposed. Such a\nrelative orbit can be achieved by matching the orbital energy and the polar com-\nponent of the orbital angular momentum for orbits near the critical inclination. As\norbits at the critical inclination may cover most parts of the Earth surface and may\nsatisfy most missions for formation flying, and also because the conditions for\nquasi-periodic relative orbit impose fewer constraints and can be presented in terms\nof the actual orbit variables, the quasi-periodic relative orbits are good candidates to\nrealize a practical long-term flying satellite formation.\n\nFig. 3.8 An ACSF of five satellites\n\n3.4 In-Plane Satellite Formation in Eccentric Orbits 71\n\n\n\nIn the second class, the member satellite orbit has to meet four constraints: the\nsame semimajor axis, inclination, eccentricity, and ascending node with the refer-\nence orbit. A special satellite formation based on the second class PPRT is defined\nas the Almost Constant Separation Formation. This special formation introduces\none additional geometric constraint for each member satellite: the ratio of the\ndifferential mean anomaly to the differential argument of perigee being a constant\nvalue associated with the eccentricity. An approach is proposed to design the\nremaining one-dimensional constraint space via specifying the intersatellite dis-\ntance. This formation has a simple and almost constant geometry and it is applicable\nat arbitrary inclination, so it is suitable for most satellite formation flying missions,\nespecially in orbits other than the critical inclination.\n\nReferences\n\nGurfil P (2005) Relative motion between elliptic orbits: generalized boundedness conditions and\noptimal formationkeeping. J Guid Control Dyn 28(4):761\u2013767. doi:10.2514/1.9439\n\nHamel JF, Lafontaine JD (2007) Linearized dynamics of formation flying spacecraft on a J2-\nperturbed elliptical orbit. J Guid Control Dyn 30(6):1649\u20131658. doi:10.2514/1.29438\n\nInalhan G, Tillerson M, How JP (2002) Relative dynamics and control of spacecraft formations in\neccentric orbits. J Guid Control Dyn 25(1):48\u201359. doi:10.2514/2.4874\n\nJiang F, Li J, Baoyin H, Gao Y (2008) Study on relative orbit geometry of spacecraft formations in\nelliptical reference orbits. J Guid Control Dyn 31(1):123\u2013134. doi:10.2514/1.30394\n\nLane CM, Axelrad P (2006) Formation design in eccentric orbits using linearized equations of\nrelative motion. J Guid Control Dyn 29(1):146\u2013160. doi:10.2514/1.13173\n\nSabatini M, Izzo D, Bevilacqua R (2008) Special inclinations allowing minimal drift orbits for\nformation flying satellites. J Guid Control Dyn 31(1):94\u2013100. doi:10.2514/1.30314\n\nSabol C, Burns R, McLaughlin CA (2001) Satellite formation flying design and evolution.\nJ Spacecr Rocket 38(2):270\u2013278. doi:10.2514/2.3681\n\nSchaub H (2004) Relative orbit geometry through classical orbit element differences. J Guid\nControl Dyn 27(5):839\u2013848. doi:10.2514/1.12595\n\nSchaub H, Alfriend KT (2001) J2 invariant relative orbits for spacecraft formations. Celest Mech\nDyn Astron 79(2):77\u201395. doi:10.1023/A:1011161811472\n\nSchaub H, Junkins JL (2003) Analytical mechanics of space systems. In: American institute of\naeronautics and astronautics, Reston,VA. doi:10.2514/4.861550\n\nTragesser SG, Skrehart B (2008) Relative trajectory design to minimize stationkeeping effort. In:\nProceeding of 2008 AAS/AIAA space flight mechanics conference, AAS 08-210, Galveston,\nTX, US, pp 77\u201395\n\nXing J, Tang G, Xi X, Li H (2007) Satellite formation design and optimal stationkeeping\nconsidering nonlinearity and eccentricity. J Guid Control Dyn 30(5):1523\u20131528\n\nXu GG, Wang DW (2008) Dynamic models of satellite relative motion around an oblate earth. In:\nAAS/AIAA space flight mechanics meeting, AAS-08-208, Galveston, Texas, pp 1633\u20131648\n\nXu G, Poh EK, Wang D, Wu B (2009a) In-plane satellite formations in eccentric orbits under J2\nperturbation. In: IEEE aerospace conference, big sky, MT, USA, pp 1\u20139. doi:10.1109/AERO.\n2009.4839337\n\nXu G, Poh EK, Wang D, Wu B (2009b) Periodic and quasi-periodic satellite relative orbits at\ncritical inclination. In: IEEE aerospace conference, big sky, MT, USA\n\n72 3 Passive and Periodic Satellite Formation Design \u2026\n\nhttp://dx.doi.org/10.2514/1.9439\nhttp://dx.doi.org/10.2514/1.29438\nhttp://dx.doi.org/10.2514/2.4874\nhttp://dx.doi.org/10.2514/1.30394\nhttp://dx.doi.org/10.2514/1.13173\nhttp://dx.doi.org/10.2514/1.30314\nhttp://dx.doi.org/10.2514/2.3681\nhttp://dx.doi.org/10.2514/1.12595\nhttp://dx.doi.org/10.1023/A:1011161811472\nhttp://dx.doi.org/10.2514/4.861550\nhttp://dx.doi.org/10.1109/AERO.2009.4839337\nhttp://dx.doi.org/10.1109/AERO.2009.4839337\n\n\nChapter 4\nNonlinear Optimization of Low-Thrust\nTrajectory for Satellite Formation\n\nThis chapter presents a method to determine fuel-optimal trajectories for satellite\nformation maneuver using low-thrust continuous propulsion. It is cast as an opti-\nmization problem with a desired final satellite formation configuration subject to\ncollision avoidance constraints on the paths of the chief and all deputy satellites,\nwhich are correspondingly referred to as reference and member satellites in Chap. 3.\nThe satellite terminal orbit states corresponding to this desired formation configu-\nration are ensured by imposing energy-matching condition and final geometry\nconfiguration constraints in the problem formulation. In addition, the developed\nexact nonlinear relative satellite motion dynamics considering eccentricity and\nEarth\u2019s oblateness is adopted to accurately describe relative satellite orbit. The\nresulting nonlinear optimal control problem is transcribed into a nonlinear pro-\ngramming problem by the application of a direct transcription method called\nLegendre pseudospectral method. The nonlinear programming problem is then\nsolved by using sparse nonlinear optimization software named TOMLAB/SNOPT\n(Holmstr\u00f6m et al. 2008). Examples are presented across a range of applications.\nThese examples demonstrate the efficiency of the proposed method in designing\nfuel-optimal maneuvers for a wide class of satellite formation problems.\n\n4.1 Introduction\n\nTrajectory optimization for formation maneuver is critical to the successful\nimplementation of formation establishment, formation reconfiguration, and\nreplacement of a failed satellite. According to the type of thruster used, trajectory\noptimization techniques for satellite formation can be roughly categorized into two\nmain approaches: impulsive control, relying on chemical thrusters, and continuous\nlow-thrust control, using electric propulsion system. Impulsive control methods for\nformation reconfiguration and establishment are proposed in Schaub and Alfriend\n(2001), Vaddi et al. (2005), Gurfil (2005), and Jifuku et al. (2011). Continuous\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_4\n\n73\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_3\n\n\nlow-thrust control methods are actively investigated for satellite formation control.\nThe main advantages are that low-thrust engines (such as ion thruster and plasma\nthruster) can generate precise thrust output and consume less propellant due to its\nhigh specific impulse. Recent advances in the field of electric propulsion have made\nlow-thrust propulsion an operational reality (Polzin 2011; Pillet et al. 2006; Pencil\net al. 2004). Literature survey on trajectory optimization methods using continuous\nlow-thrust propulsion is given as follows.\n\nLinear optimization methods have been studied in Tillerson et al. (2002),\nRichards et al. (2002), Acikmese et al. (2006), Campbell (2002), Zanon and\nCampbell (2006), Cho et al. (2012), Lee and Park (2011), and Li and Xi (2012) for\nsatellite formation maneuver using continuous low-thrust propulsion. Tillerson\net al. (2002) proposed fuel-/time-optimal control algorithm for formation recon-\nfiguration by using linear time-varying relative model. The trajectory optimization\nalgorithms were based on the solutions of linear programming problems. The result\nwas a very flexible optimization framework that can be used offline to analyze\nvarious aspects of the mission design and in real time as part of an onboard\nautonomous formation flying control system. During the satellite formation\nmaneuver, the relative distance between satellites may range from thousands of\nmeters to several meters, so collision avoidance should be considered in the tra-\njectory optimization methods. In order to guarantee safe maneuvering among\nsatellites, Richards et al. (2002) extended the above method to include collision\navoidance by using mixed-integer linear programming. The necessary logical\nconstraints for collision avoidance are appended to a fuel-optimizing linear pro-\ngramming by including binary variables in the optimization. The resulting\nmixed-integer linear program (MILP) problem can be solved using available soft-\nware. Acikmese et al. (2006) presented a convex guidance algorithm for optimal\nformation reconfiguration with collision avoidance using CW equations. In this\nalgorithm, the collision avoidance constraints are imposed via separating planes\nbetween each pair of satellites. A heuristic solution is introduced to choose these\nseparating planes that lead to the convexification of the collision avoidance con-\nstraints. Additionally, convex constraints are imposed to guarantee that no colli-\nsions occur between discrete time samples. Campbell (2002) proposed a\nmethodology utilizing Hamilton-Jacobian-Bellman optimality to generate a set of\nfuel- or time-optimal trajectories from an initial stable formation to a final stable\nformation in circular orbits. It is assumed that the fuel-optimal solution is an\nintuitive form of control input, in which, after each constant thrust input is applied,\nthere is a period where the satellite \u201ccoasts\u201d to the next switching point. The\nmaneuver trajectories are calculated by optimizing the switch times using CW\nequations. But this methodology is limited to satellite formation in circular orbits.\nThis methodology is then extended to satellite formations in elliptic orbits by Zanon\nand Campbell (2006). An example is presented of a tetrahedron formation in a\nhighly elliptical reference orbit, with solutions to both formation minimum-time and\nminimum-fuel problems given. Cho et al. (2012) presented an analytic solution to\nthe optimal reconfiguration problem of satellite formation flying in circular orbit in\nJ2 perturbation by using continuous and variable low-thrust propulsion.\n\n74 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nPerturbations associated with differential gravity effects, the eccentricity effects of a\nchief orbit, and the J2 effects were considered to obtain an approximated analytic\nsolution to the optimal reconfiguration problem of formation flying using a\npower-limited low-thrust propulsion in Lee and Park (2011).\n\nLinear relative dynamics models were used in the above linear optimization\nmethods. However, these linearized relative motion equations ignore nonlinearity\nand orbital perturbations due to the Earth\u2019s oblateness or the J2 effects. In order to\nobtain the accurate formation maneuver trajectories, some researchers investigated\nnonlinear trajectory optimization by using nonlinear dynamics.\n\nPetit et al. (2001) used the Nonlinear Trajectory Generation (NTG) software\npackage to generate constrained trajectories for satellite formation keeping and\nreconfiguration based on equations of satellite\u2019s absolute motion in inertia coor-\ndinate frame. The formulated optimal control problems were discretized into non-\nlinear programming problems. Sequential quadratic programming package NPSOL\nwas used to solve nonlinear programming in NTG. Huntington et al. (2007b)\nproposed nonlinear fuel-optimal configuration method for tetrahedral formation\nbased on Gauss variational equations. This configuration is to transfer a\nfour-satellite formation from an initial parking orbit to a terminal reference orbit\nwhere the formation attains a desired tetrahedral shape at a specified point in the\nterminal reference orbit. The optimization problems were solved numerically by\nusing Gauss pseudospectral method. The same method is used to solve the optimal\nformation reconfiguration problem in Huntington and Rao (2008). However,\ncollision avoidance was not considered in both papers. Thevenet and Epenoy\n(2008) proposed a methodology to generate fuel-optimal maneuver trajectories for\nthe deployment of satellite formation based on Gauss variational equations. The\nproblem was addressed as an optimal control problem, the necessary optimality\nconditions of which were derived from Pontryagin\u2019s maximum principle. The\nresulting necessary optimality conditions were then solved with continuation-\nsmoothing method. Mauro and Franco (2006) proposed a nonlinear low-thrust\ntrajectory optimization method for formation flying using parallel multiple shoot-\ning. The problem was stated as the solution of an optimal control problem in which\nan objective function related to controls is minimized satisfying a series of con-\nstraints on the trajectory which are both differential and algebraic. The optimization\nproblem was transcribed into a nonlinear programming problem with a parallel\nmultiple shooting transcription method. The resulting nonlinear programming\nproblems were then solved with an interior point method. However, the final rel-\native state for each satellite was restricted to some prior fixed state, and the mass\nflow of the engine is not considered in this paper.\n\nThis chapter aims to design fuel-optimal low-thrust trajectories with high pre-\ncision for formation maneuver by using the exact nonlinear relative dynamics in the\npresence of eccentricity and Earth\u2019s oblateness (Wu et al. 2009). In order to\nmaneuver the satellites to a bounded desired formation, the energy-matching con-\ndition constraint and final geometry configuration constraints are included in the\noptimization problem (Wu et al. 2011). Furthermore, the collision avoidance con-\nstraints are considered to guarantee safe maneuvering among satellites.\n\n4.1 Introduction 75\n\n\n\nThe problem is numerically solved by a direct transcription method called Legendre\npseudospectral method (Fahroo and Ross 2001; Elnagar et al. 1995; Qi et al. 2006).\n\nNumerical methods for solving trajectory optimization problem can be grouped\ninto two major categories: indirect methods and direct methods. A comprehensive\nsurvey of various numerical methods for solving trajectory optimization problems\ncan be found in Betts (1998). In indirect methods, the optimality conditions are\nderived using calculus of variations. These necessary conditions lead to a nonlinear\nmultipoint boundary-value problem. The main drawbacks of indirect method are\nthat the radius of the convergent is usually very small and it is difficult to analyt-\nically derive the optimality condition for complex problem (Betts 1998). In direct\nmethods, trajectory optimization problem is discretized into parameter optimization\nproblem which results in nonlinear programming problem (NLP). NLP can be\nsolved using appropriate optimization method such as those described in Betts\n(1998). Common discretization methods used in direct methods include trapezoidal,\nHermite-Simpson, and Runge-Kutta. Direct methods are actively investigated by\nmany researchers. There are two main reasons for the widespread use of direct\nmethods. First, they can be applied without explicitly deriving the necessary\noptimality conditions. Second, direct methods do not require a prior specification of\nthe arc sequence for problems with path inequalities.\n\nIn particular, a direct method that has shown tremendous promise is Legendre\npseudospectral method. It has been applied to a wide variety of applications\nincluding atmospheric entry (Rao and Clarke 2002; Bollino et al. 2006) orbital\ntransfer (Stanton and Proulx 2003; Ross et al. 2002), satellite formation design\n(Ross et al. 2002; Infeld et al. 2004), trajectory design for launch vehicle (Rea 2003;\nRoss et al. 2003), and satellite attitude control (Hui et al. 2007). In the Legendre\npseudospectral method, the continuous state and control variables are approximated\nusing a basis of globally orthogonal polynomials which results in improved accu-\nracy and faster speed of convergence. The pseudospectral differentiation matrix\nthen provides a numerical estimation of the derivatives at those points. The pseu-\ndospectral differentiation matrix transforms the differential equation of relative\nmotion into a nonlinear programming problem.\n\n4.2 Nonlinear Relative Motion Dynamics\n\nIn order to generate accurate formation maneuver trajectories, high-fidelity relative\ndynamics model is required. An exact nonlinear relative dynamics model developed\nby Xu and Wang (2008) is used in this chapter. In the presence of only J2 pertur-\nbation, these developed dynamic equations are exact in describing the relative\nsatellite motion in any eccentric orbits. This model is introduced in detail in Sect. 2.2\n. In this section, this model is modified to take into account of thruster dynamics.\n\nThe J2 nonlinear ordinary differential equations describing relative satellite\nmotion are as follows:\n\n76 4 Nonlinear Optimization of Low-Thrust \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5\n\n\n\u20acxj \u00bc 2 _yjxz ? xj g2j ? x2z\n? ?\n\n\u00fe yjaz ? zjxxxz ? fj ? f\n? ?\n\nsin i sinw? r g2j ? g2\n? ?\n\n\u00fe aj;x\n\u20acyj \u00bc ?2 _xjxz \u00fe 2_zjxx ? xjaz ? yj g2j ? x2z ? x2x\n\n? ?\n\u00fe zjax ? fj ? f\n\n? ?\nsin i cosw\u00fe aj;y\n\n\u20aczj \u00bc ?2 _yjxx ? xjxxxz ? yjax ? zj g2j ? x2x\n? ?\n\n? fj ? f\n? ?\n\ncos i\u00fe aj;z\n\u00f04:1\u00de\n\nwhere \u00f0xj; yj; zj\u00de denote the coordinates of the jth deputy satellite in LVLH frame\nand \u00f0aj;x; aj;y; aj;z\u00de are the control accelerations;\n\nFor the application under consideration here, the control accelerations are written\nas follows:\n\naj;x \u00bc Fjuj;x=mj; aj;y \u00bc Fjuj;y=mj; aj;z \u00bc Fjuj;z=mj \u00f04:2\u00de\n\nwhere Fj is the magnitude of constant thrust, mj is the satellite mass, and\n\u00f0uj;x; uj;y; uj;z\u00de are the components of the thrust direction.\n\nDuring the burn phase of maneuver trajectory, the thrust magnitude is constant,\nbut the thrust direction is steerable. Finally, the mass flow rate of the engine is\ndescribed by the following equation:\n\n_mj\u00f0t\u00de \u00bc ?Tj= g0Isp\n? ? \u00f04:3\u00de\n\nwhere g0 is the sea-level acceleration due to gravity and Isp is the specific impulse of\nthe engine.\n\n4.3 Problem Formulation of Trajectory Optimization\nfor Satellite Formation\n\nTrajectory optimization is critical to stable initial satellite formation deployment\nand successful subsequent formation reconfiguration. The trajectory optimization\nproblem for a fuel-optimal satellite formation maneuver is to determine the control\ninput, the maneuver time, and the corresponding state trajectory so that the fuel\nconsumption is minimized. The optimization problem is subject to constraints on\nnonlinear relative motion dynamics, given initial and final conditions, path con-\nstraints, and other constraints. The trajectory optimization problem for a\nfuel-optimal satellite formation maneuver can be formulated as follows.\n\nDetermine the thrust direction and the maneuver time that maximize the terminal\nmass of satellites, i.e., minimize the following objective function:\n\nJ \u00bc ?\nXNs\nj\u00bc1\n\nmj\u00f0tj; f \u00de \u00f04:4\u00de\n\n4.2 Nonlinear Relative Motion Dynamics 77\n\n\n\nThe above-mentioned optimization problem is subject to constraints on relative\nmotion dynamics, given initial and final conditions, and path and linking con-\nstraints. The details of others constraints are given as follows.\n\n4.3.1 Initial Condition Constraints\n\nThe initial conditions for the trajectory optimization are the initial relative state and\nthe initial mass of each deputy satellite. The initial conditions are given as follows:\n\nxj\u00f0t0\u00de \u00bc xj;0; yj\u00f0t0\u00de \u00bc yj;0; zj\u00f0t0\u00de \u00bc zj;0; _xj\u00f0t0\u00de \u00bc _xj;0; _yj\u00f0t0\u00de \u00bc _yj;0; _zj\u00f0t0\u00de \u00bc _zj;0 \u00f04:5\u00de\n\nmj\u00f0t0\u00de \u00bc mj;0 \u00f04:6\u00de\n\n4.3.2 Final Condition Constraints\n\nA few published works deal with the final conditions of trajectory optimization for\nsatellite formation, but most of them set the final states of satellites as a priori fixed\npoints. Richards et al. (2002) define many subsets of final states and perform the\nassessment for all subsets within the trajectory optimization process. Subsequently,\nthe subset requiring the lowest overall fuel cost is selected. Huntington and Rao\n(2005) derive the final configuration constraints for tetrahedral formation. Two\nmethods to deal with the final condition constraints are studied and compared in this\nchapter. In the first method, the final relative states are treated as variables in the\noptimization and are subjected to final geometry configuration constraints and\nenergy-matching condition to obtain bounded desired final formation. In the second\nmethod, the final relative states are given as fixed points determined a priori by using\nan analytic (Sabol et al. 2001) or a numerical (Infeld et al. 2004) formation design\nmethod. The analytic formation designmethod proposed by Sabol et al. (2001) is used\nin this chapter. It can be seen from the simulation results presented later in this chapter\nthat the first method can result in lower fuel consumption than the second method.\n\nThe energy-matching condition considering nonlinearity and orbit eccentricity\nfor bounded relative satellite motion is derived by Gurfil (2005). This energy-\nmatching constraint imposed at the end of maneuver for each satellite, shown in\n(4.7), is included in the optimization to obtain a bounded final formation.\n\n1\n2\n\n_xj; f ? xz; f yj; f \u00fe _rf\n? ?2 \u00fe _yj; f \u00fexz; f xj; f \u00fe rf? ?? ?2 \u00fe _z2j;f\n\nn o????\n?l=\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nrf \u00fe xj; f\n? ?2 \u00fe y2j; f \u00fe z2j; f\n\nq\n\u00fe l=2a\n\n????? e1\n\u00f04:7\u00de\n\nwhere ?1 is a very small number which ensures that the optimization is feasible.\n\n78 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nThere are too many possibilities for formation geometry configuration, but cir-\ncular formation and projected circular formation are the two most studied satellite\nformations (Sabol et al. 2001). The final geometry configuration constraints are\nderived for circular formation with three deputy satellites evenly spaced in a circle.\nThese constraints can be easily extended to projected circular formation.\n\nFor circular formation (Sabol et al. 2001), one of the geometry constraints is as\nfollows:\n\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nx2j \u00fe y2j \u00fe z2j\n\nq\n? rcf\n\n??? ???? e2 \u00f04:8\u00de\nwhere rcf is the radius of circular formation and ?2 is a very small number which\nensures that the optimization is feasible, because an exact circular formation does\nnot exist when the chief satellite is in an elliptic orbit. Note that the above constraint\nimposed only on the final state is not sufficient to establish a circular formation.\nThis constraint should also be imposed on several relative positions during one\norbital period after the maneuver.\n\nThere are two planes on which the circular formation is possible. Both planes\nintersect the cross-track/along-track plane along the along-track axis, but one is\ninclined at a positive angle to that plane and the other is inclined at a negative angle.\nSo another geometry constraint as shown in (4.9) should be included to obtain the\nfinal formation in a specified plane.\n\nxj; f zj; f [ 0 for plane inclined at a positive angle\nor xj; f zj; f\\0 for plane inclined at a negative angle\n\n\n\n\u00f04:9\u00de\n\nFor the formation with three deputy satellites evenly spaced on the circle, the\nfollowing constraints should also be included to ensure that the three satellites are\nevenly spaced in the circle.\n\n?d12\u00f0tf \u00de \u00bc ?d13\u00f0tf \u00de \u00bc ?d23\u00f0tf \u00de \u00f04:10\u00de\n\nwhere ?dp;q denotes the distance between satellite p and satellites q.\n\n4.3.3 Path Constraints\n\nFirstly, the collision between the satellites should be avoided during the maneuver,\nso the following inequality constraints should be imposed on relative positions.\n\n?dp;q\u00f0t\u00de? ?dsafe\u00f0t\u00de; 8p; q 2 1; 2; . . .;Ns\u00bd ?; p 6\u00bc q; 8t 2 t0; tf\n? ? \u00f04:11\u00de\n\nSecondly, the mass of each satellite cannot fall below the dry mass. Defining the\ndry mass of the each satellite as mj, dry, the following inequality constraints should\nbe imposed on the mass of each satellite throughout the whole trajectory.\n\n4.3 Problem Formulation of Trajectory Optimization for Satellite Formation 79\n\n\n\nmj\u00f0t\u00de?mj;dry; 8t 2 t0; tf\n? ? \u00f04:12\u00de\n\nLastly, it is necessary to constrain the thrust direction vector to a constant unit\nlength during the burn phase of the trajectory as follows:\n\nu2j;x\u00f0t\u00de\u00fe u2j;y\u00f0t\u00de\u00fe u2j;z\u00f0t\u00de \u00bc 1; 8t 2 t0; tf\n? ? \u00f04:13\u00de\n\n4.3.4 Linking Constraints\n\nIn order to reduce fuel consumption during maneuver, the thruster can fire several\ntimes such that the trajectory can be divided into several phases including coast\nphases and burn phases. During the coast phase, the thruster is turned off. While\nduring the burn phase, the thrust is constant at its maximum value, but the thrust\ndirection is steerable. So it is necessary to enforce linkage conditions at every phase\nboundary to ensure that the trajectory and mass of each satellite are continuous at\nthe interface. These linkage conditions are enforced on the relative position, relative\nvelocity, mass, and time and are given as follows:\n\nxj\u00f0tvf \u00de \u00bc xj\u00f0tv\u00fe 10 \u00de; yj\u00f0tvf \u00de \u00bc yj\u00f0tv\u00fe 10 \u00de; zj\u00f0tvf \u00de \u00bc zj\u00f0tv\u00fe 10 \u00de;\n_xj\u00f0tvf \u00de \u00bc _xj\u00f0tv\u00fe 10 \u00de; _yj\u00f0tvf \u00de \u00bc _yj\u00f0tv\u00fe 10 \u00de; _zj\u00f0tvf \u00de \u00bc _zj\u00f0tv\u00fe 10 \u00de;\nmj\u00f0tvf \u00de \u00bc mj\u00f0tv\u00fe 10 \u00de; tvj; f \u00bc tv\u00fe 1j;0\n\n\u00f04:14\u00de\n\nThe initial time and the terminal time of each phase are free, but the initial time\nof the first phase is fixed. In order to ensure that the time is increasing during the\ntrajectory, the following inequality constraints are imposed on the time during each\nphase of the trajectory:\n\ntvj; f [ t\nv\nj;0 \u00f04:15\u00de\n\nIn summary, the trajectory optimization problem for satellite formation\nmaneuver using continuous low thrust can be described as follows.\n\nProblem Statement 4.1 The trajectory optimization problem for a fuel-optimal\nsatellite formation maneuver is to determine the thrust direction and the maneuver\ntime that maximize the terminal mass of satellites, i.e., minimize fuel consumption\nfunction as in (4.4). The optimization problem is subject to relative motion\ndynamics constraint (4.1)\u2013(4.3); the initial relative state constraint (4.5) and the\ninitial mass constraint (4.6); path constraints including collision avoidance con-\nstraint (4.11), mass constraints (4.12), and thrust direction constraint (4.13); final\nenergy-matching constraint (4.7) and final formation geometry constraints\n(4.8)\u2013(4.10); and phase linking constraints (4.14) and (4.15).\n\n80 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\n4.4 Introduction of Legendre Pseudospectral Method\n\nAs noted earlier, Legendre pseudospectral method has been widely used over the\nlast few years to solve a variety of optimal control problems. A detailed description\nof the Legendre pseudospectral method for solving optimal control problems is\nprovided in Fahroo and Ross (2001), Elnagar et al. (1995), and Qi et al. (2006).\nA brief review of this numerical method is given below.\n\nThe aforementioned single-phase trajectory optimization Problem Statement 4.1\ncan be written in the following general form. Determine the control direction, the\nmaneuver time, and the corresponding state trajectory that minimize the following\ncost function:\n\nJ x; u; tf\n? ? \u00bc M x\u00f0tf \u00de; tf? ? \u00f04:16\u00de\n\nwith x 2 RNx and u 2 RNu subject to the following dynamic constraint\n\n_x t\u00f0 \u00de \u00bc f x t\u00f0 \u00de;u t\u00f0 \u00de\u00bd ?; t 2 t0; tf\n? ? \u00f04:17\u00de\n\nand boundary conditions\n\nw0l ?w0 x t0\u00f0 \u00de; t0\u00bd ? ?w0u \u00f04:18\u00de\n\nwf l ?wf x tf\n? ?\n\n; tf\n? ??wfu \u00f04:19\u00de\n\nwith w0 2 Rp with p? n and wf 2 Rq with q? n and mixed state-control path\nconstraint\n\nhl ? h x t\u00f0 \u00de; u t\u00f0 \u00de; t\u00bd ? ? hu \u00f04:20\u00de\n\nIt is assumed that the above functions are continuously differentiable with\nrespect to their arguments.\n\nThe above trajectory optimization problem can be discretized into nonlinear\nprogramming by the Legendre pseudospectral method. In the Legendre pseu-\ndospectral method, the Legendre\u2013Gauss\u2013Lobatto (LGL) points are used. These\npoints sl; l \u00bc 0; . . .;N, which are distributed on the interval [?1, 1], are defined as\nfollows:\n\ns0 \u00bc ?1; sN \u00bc 1 \u00f04:21\u00de\n\nand for 1? l?N ? 1; sl are the zeros of _LN , the derivative of the Legendre\npolynomial LN . The discretization process begins by approximating the continuous\nstate and control variables by Nth polynomials of the form.\n\n4.4 Introduction of Legendre Pseudospectral Method 81\n\n\n\nx\u00f0s\u00de ? xN\u00f0s\u00de \u00bc\nXN\nl\u00bc0\n\nx\u00f0sl\u00de/l\u00f0s\u00de \u00f04:22\u00de\n\nu\u00f0s\u00de ? uN\u00f0s\u00de \u00bc\nXN\nl\u00bc0\n\nu\u00f0sl\u00de/l\u00f0s\u00de \u00f04:23\u00de\n\nwhere for l \u00bc 0; 1; . . .;N\n\n/l\u00f0s\u00de \u00bc\n1\n\nN\u00f0N\u00fe 1\u00deLN\u00f0sl\u00de\n\u00f0s2 ? 1\u00de _LN\u00f0s\u00de\n\ns? sl \u00f04:24\u00de\n\nare the Lagrange interpolating polynomials of order N.\nThe dynamic equations are discretized by imposing the condition that the\n\nderivatives of the state approximations satisfy the differential equations exactly at\nthe node points. Thus, the derivative of xN\u00f0s\u00de in terms of x\u00f0s\u00de at the collocation\npoint sk can be obtained by differentiating (4.22) and evaluating the result at sk . The\nresult is a matrix multiplication given by\n\n_x\u00f0sk\u00de ? _xN\u00f0sk\u00de \u00bc\nXN\nl\u00bc0\n\nx\u00f0sl\u00de _/l\u00f0sk\u00de \u00bc\nXN\nl\u00bc0\n\nDklx\u00f0sl\u00de \u00f04:25\u00de\n\nFor LGL points, Dkl \u00bc _/l\u00f0sk\u00de are the entries of the \u00f0N \u00fe 1\u00de ? \u00f0N \u00fe 1\u00de differ-\nentiation matrix D.\n\nD :\u00bc Dkl\u00bd ? :\u00bc\n\nLN\u00f0sk\u00de\nLN\u00f0sl\u00de\n\n1\nsk ? sl k 6\u00bc l\n\n?N\u00f0N\u00fe 1\u00de\n4\n\nk \u00bc l \u00bc 0\nN\u00f0N \u00fe 1\u00de\n\n4\nk \u00bc l \u00bc N\n\n0 otherwise\n\n8>>>>>>>><\n>>>>>>>>:\n\n\u00f04:26\u00de\n\nBecause the trajectory optimization problem presented in (4.16)\u2013(4.20) is for-\nmulated over the time interval t0; tf\n\n? ?\n, the LGL points lie in the interval ?1; 1\u00bd ?; the\n\nfollowing transformation is used to express the problem for s 2 s0; sN\u00bd ? \u00bc ?1; 1\u00bd ?:\n\nt \u00bc tf ? t0\n? ?\n\ns\u00fe tf \u00fe t0\n? ?? ?\n\n2\n\u00f04:27\u00de\n\nThe mixed state-control path constraints and the boundary conditions can also be\ndiscretized by evaluating these inequalities at the LGL nodes. Thus, the\nsingle-phase trajectory optimization problem can now be discretized as follows:\n\nFind the \u00f0N\u00fe 1\u00de\u00f0Nx \u00feNu\u00de\u00fe 1 vector Xopt\n\n82 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nXopt \u00bc x\u00f0s0\u00de; x\u00f0s1\u00de; . . .; x\u00f0sN\u00de; u\u00f0s0\u00de; u\u00f0s1\u00de; . . .; u\u00f0sN\u00de; tf\n? ? \u00f04:28\u00de\n\nwhich minimizes\n\nJ Xopt\n? ? \u00bc M x\u00f0sN\u00de; tf? ? \u00f04:29\u00de\n\nsubject to\n\nXN\nl\u00bc0\n\nDklx\u00f0sl\u00de ? tf ? t02 f x\u00f0sk\u00de; u\u00f0sk\u00de; sk\u00f0 \u00de \u00bc 0 \u00f04:30\u00de\n\nw0l ?w0 x\u00f0s0\u00de; s0\u00f0 \u00de?w0u \u00f04:31\u00de\n\nwf l ?wf x\u00f0sN\u00de; sN\u00f0 \u00de?wfu \u00f04:32\u00de\n\nhl ? hk x\u00f0sk\u00de; u\u00f0sk\u00de\u00f0 \u00de? hu k \u00bc 0; . . .;N: \u00f04:33\u00de\n\nRemark 4.1 The Legendre pseudospectral method can be extended to problems\nwith multiple phases in a straightforward manner (Ross et al. 2003). The pseu-\ndospectral implementation of trajectory optimization with multiple phases is treated\nby defining each phase separately and then linking these phases with a set of phase\nboundary conditions.\n\n4.5 Computational Considerations of Nonlinear\nProgramming Problem\n\nThis section discusses issues related to the implementation and solution of the\noptimization problem presented in the preceding sections. The methods presented\nhere do not change the basic constraints already described, but assist greatly in\nobtaining solutions within a practical and reasonable computational time interval.\n\n4.6 Scaling of Nonlinear Programming Problem\n\nScaling a nonlinear programming problem is very important in order to obtain\nrobust and rapid convergence to the final solution. Betts (2001) commented that\n\u201cScaling affects everything! Poor scaling can make a good algorithm bad. Scaling\nchanges the convergence rate, termination tests, and numerical conditioning.\u201d One\nway to construct a well-scaled problem is to normalize the independent variables to\nhave the same range (Betts 2001), e.g., 0?~xk ? 1, where ~xk denotes the scaled\nvariables. So the following normalizations are used in this work.\n\n4.4 Introduction of Legendre Pseudospectral Method 83\n\n\n\n~x \u00bc x=?dmax;~y \u00bc y=?dmax;~z \u00bc z=?dmax \u00f04:34\u00de\n\n~m \u00bc m=m0; ~t \u00bc t=Tc \u00f04:35\u00de\n\nThe magnitude of the maximum relative velocities during a maneuver is in the\norder of 1, so it is not necessary to normalize the relative velocities.\n\n4.6.1 Initial Guess\n\nThe Legendre pseudospectral method has a larger radius of convergence than other\nnumerical methods, and it may not require a good initial guess for convergence.\nHowever, an educated initial guess does improve convergence rate and robustness.\n\nIn this section, an initial guess is generated by integrating the relative dynamics\nnumerically using an arbitrary control direction. The generated states and control\ndirection thus satisfy the initial conditions and the differential dynamic constraints,\nbut do not satisfy the terminal constraints and are generally non-optimal. Using this\ninitial guess, TOMLAB/SNOPT (Holmstr\u00f6m et al. 2008) is able to solve the\nresulting NLP problems within several minutes. A better initial guess could be the\noptimized trajectory solution obtained for a relative dynamics model such as CW\nequations. The trajectory generated by the presented algorithm without considering\ncollision avoidance constraint would also provide good initial guess for the tra-\njectory optimization problem with collision avoidance constraint.\n\n4.6.2 Implementation\n\nThe optimization was carried out with the TOMLABTM version of the NLP solver\nSNOPT using default optimality and feasibility tolerances. TOMLAB/SNOPT is a\nsoftware package for solving large-scale optimization problems (linear and non-\nlinear programs). It is especially effective for nonlinear problems whose functions\nand gradients are expensive to evaluate. So TOMLAB/SNOPT is well suited to\nsolve the proposed trajectory optimization problem after it is transcribed into a\nlarge-scale nonlinear programming problem.\n\n4.7 Illustrative Examples\n\nIn this section, examples are presented for a wide class of satellite formation\nreconfiguration problems. Firstly, formation reconfigurations involving two satel-\nlites (one chief satellite and one deputy satellite) are studied. As mentioned earlier,\n\n84 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nin order to conserve fuel during the maneuver, the thruster can be fired several times\nduring the trajectory according to certain phase sequence. Trajectory optimizations\nwith the following different phase sequences are studied and compared.\n\n1. One phase: burn;\n2. Two phases: coast\u2013burn;\n3. Three phases: burn\u2013coast\u2013burn; and\n4. Four phases: coast\u2013burn\u2013coast\u2013burn.\n\nSecondly, formation reconfigurations involving multiple satellites, such as four\nsatellites, are studied. Finally, the collision avoidance capability of the proposed\nmethod is also demonstrated.\n\nThe chief satellite orbit is characterized by the following orbit elements:\n\na \u00bc 7100 km; e \u00bc 0:001; i \u00bc 45?;- \u00bc 30?;X \u00bc 45?; h \u00bc 0? \u00f04:36\u00de\n\nAll the deputy satellites have been considered with the same following\nparameters:\n\nm0 \u00bc 50 kg; T \u00bc 50 mN; Isp \u00bc 1000 s \u00f04:37\u00de\n\nFor easy of presentation, the parameters of deputy satellites, such as the masses,\nmaximum thrusts, and thruster\u2019s specific impulse, are assumed to be identical. In\npractice, there will be variation. The proposed trajectory optimization method also\napplies to the case with different parameters. The above control force can be\nrealized with an actual electric propulsion system (Polzin 2011; Pillet et al. 2006;\nPencil et al. 2004).\n\n4.7.1 Example 1: Scenario of Two Satellites, One Burn\nPhase\n\nIn this example, the deputy satellite in a circular formation of 1000 m radius is\nmaneuvered to another circular formation with radius of 2000 m. During this\nmaneuver with one burn phase, the thrust is constant at its maximum value. The\nnumber of LGL points is chosen as 64. More accurate results can be obtained in this\nNLP problem with more LGL points at the expense of computational cost. The\nclock frequency of the CPU used is 1.86 GHz. The optimization can be completed\nwithin 30 s even without using analytic first-order derivatives for both the con-\nstraints Jacobian and the gradient of the objective function. The initial relative state\nof deputy satellite with respect to chief satellite is given as follows:\n\n4.7 Illustrative Examples 85\n\n\n\nx0 \u00bc 500 m; _x0 \u00bc 0 m/s; y0 \u00bc 0 m; _y0 \u00bc 1 m/s; z0 \u00bc 866:0254 m; _z0 \u00bc 0 m/s\n\u00f04:38\u00de\n\nAs noted earlier, two different methods of handling the final condition con-\nstraints are considered. In the first method, the final relative state is treated as a\nvariable in the optimization problem and subjected to final geometry configuration\nconstraints and energy-matching condition to obtain bounded desired final forma-\ntion. In the second method, the final relative state is determined by an analytic\nformation design method (Sabol et al. 2001). The computed final relative state for\nthe second method is given as follows:\n\nxf \u00bc 1000 m; _xf \u00bc 0 m/s; yf \u00bc 0 m; _yf \u00bc 2 m/s; zf \u00bc 1732:1 m; _z0 \u00bc 0 m/s\n\u00f04:39\u00de\n\nThe fuel-optimal trajectories generated for the two cases are shown in Figs. 4.1\nand 4.2, respectively. Maneuver time and fuel consumption are shown in Table 4.1.\nFor ease of interpretation, DV is calculated approximately by assuming constant\nmass of satellite during the formation maneuver. As observed from the result, the\nfirst method results in 48.35 % fuel saving as compared to the second method. So it\ncan be concluded that for formation maneuver with a single burn phase, the first\nmethod, with substantially lower fuel consumption, is much better than the second\nmethod. The components of the control direction for the first method are shown in\nFig. 4.3.\n\nAn open-loop guidance demonstration is performed using the control direction\ngenerated by the Legendre pseudospectral method. The Legendre pseudospectral\nmethod gives a state estimation and control only at the LGL points. Cubic spline\n\nFig. 4.1 Trajectories of formation reconfiguration with free relative final state\n\n86 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nFig. 4.2 Trajectories of formation reconfiguration with given final relative states prior\n\nTable 4.1 Fuel consumption and maneuver time for single-phase maneuver\n\nFuel consumption Maneuver time, s\n\n?m, kg ?V, m/s\n\nFree final state 0.01131 2.217 2221\n\nFixed final state 0.02190 4.292 4283\n\nFig. 4.3 The control direction of thrust\n\n4.7 Illustrative Examples 87\n\n\n\ninterpolation is used to estimate the controls between the LGL points. In the sim-\nulation, the optimized control force is executed on the deputy satellite in an\nopen-loop way, with no in-flight corrections, and the actual relative trajectory is\ngenerated by integrating the absolute equation of motion including J2 effect for each\nsatellite using MATLAB command \u201code45\u201d. The errors between the actual tra-\njectory and the optimized trajectory are plotted in Fig. 4.4. For comparison, another\ntrajectory is generated by the Legendre pseudospectral method using nonlinear\nrelative dynamics without J2 effect. The errors between the actual trajectory and this\noptimized trajectory are shown in Fig. 4.5. As can be observed from the results, the\nerrors with relative dynamics considering J2 effect are much smaller than that\nwithout considering J2 effect. It can be concluded that nonlinear relative satellite\n\nFig. 4.4 Error history with\ndynamics considering J2\nperturbation\n\nFig. 4.5 Error history with\ndynamics not considering J2\nperturbation\n\n88 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\ndynamics model considering J2 effect is necessary to obtain accurate trajectory for\nsatellite formation maneuver.\n\nIn order to validate the effectiveness of the energy-matching condition in\nobtaining bounded final formation, the generated final formation is propagated in\nthe dynamics environment without considering J2 effect for 24 h. The propagated\nformation is plotted in Fig. 4.6. As can be seen from the result, the drift of the\nformation is very small, and a bounded formation is obtained. As noted earlier, the\nexact energy-matching condition considering J2 effect is presently under\ndevelopment.\n\nAnother kind of pseudospectral method developed for solving trajectory opti-\nmization problem is Gauss pseudospectral method (GPM) (Benson et al. 2006),\nwhich is similar to the Legendre pseudospectral method (LPM). In order to further\nvalidate the efficiency of pseudospectral method in designing fuel-optimal\nmaneuvers for satellite formation reconfiguration problem, GPM is also utilized\nto solve the above formation reconfiguration problem with equivalent initial guess\nas for LPM. Relative position error histories for LPM and GPM are generated using\nthe open-loop guidance method as in the above example. Maximum relative\nposition errors and computational times are shown in Table 4.2. It is shown\nTable 4.2 that LPM and GPM are comparable in computational efficiency and\ntrajectory accuracy. Note that it is shown in Huntington et al. (2007a) that GPM can\nproduce significantly more accurate costate estimations than LPM without incurring\n\nFig. 4.6 Trajectories of final formation propagated for 1 day\n\n4.7 Illustrative Examples 89\n\n\n\nadditional computational burden. For the details of performance comparison\nbetween LPM and GPM, please refer to Huntington et al. (2007a).\n\n4.7.2 Example 2: Scenario of Two Satellites, Two Phases:\nCoast\u2013Burn\n\nIn this example, the formation maneuver mission, the initial condition, and the final\ncondition are the same as those in the previous example. The only difference is the\nphase sequence. Before the burn phase, one coast phase is added to the trajectory so\nthat the satellite can choose a right time to leave the original formation so as to save\nfuel. The number of LGL points for each phase is 64. Fuel-optimal trajectories\ngenerated by using the two different methods dealing with the final condition\nconstraints are plotted in Figs. 4.7 and 4.8, respectively. Coast time, burn time, and\nfuel consumption are shown in Table 4.3. As seen from simulation results, the\nmaneuver with two phases can save about half the fuel required by that with a\nsingle burn phase.\n\nTable 4.2 Computation\ntimes and maximum position\nerrors for LPM and GPM\n\nCPU times, s Maximum position error, m\n\nLPM GPM LPM GPM\n\nN = 15 3.06 4.08 2.802 \u00d7 10?1 3.420 \u00d7 10?1\n\nN = 30 10.21 8.06 1.65 \u00d7 10?2 1.54 \u00d7 10?2\n\nN = 45 17.20 16.06 2.7 \u00d7 10?3 3.0 \u00d7 10?3\n\nFig. 4.7 Trajectories of formation reconfiguration with free relative final state\n\n90 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\n4.7.3 Example 3: Scenario of Two Satellites, Three Phases:\nBurn\u2013Coast\u2013Burn\n\nIn this example, the trajectory is divided into three phases: burn\u2013coast\u2013burn.\nFuel-optimal trajectories generated by using the two different methods dealing with\nfinal condition constraints are shown in Figs. 4.9 and 4.10, respectively. Maneuver\ntime and fuel consumption are shown in Table 4.4. As observed from the result, the\nfirst method uses 0.4 % less fuel than the second method, and the maneuver with\nthree phases requires less fuel than maneuver with two phases.\n\n4.7.4 Example 4: Scenario of Two Satellites, Four Phases:\nCoast\u2013Burn\u2013Coast\u2013Burn\n\nIn this example, the trajectory is divided into four phases: coast\u2013burn\u2013coast\u2013burn.\nFuel-optimal trajectories generated by using the two different methods dealing with\nfinal condition constraints are plotted in Figs. 4.11 and 4.12, respectively. Coast\ntimes, burn times, and the fuel consumption in each case are shown in Table 4.5.\n\nFig. 4.8 Trajectories of formation reconfiguration with given relative final state\n\nTable 4.3 Fuel consumption\nand maneuver time for\ntwo-phase maneuver\n\nCases Fuel consumption Maneuver\ntime, s\n\n?m, kg ?V, m/s Coast Burn\n\nFree final state 0.01046 2.050 5255 2050\n\nFixed final state 0.01069 2.095 4149 2095\n\n4.7 Illustrative Examples 91\n\n\n\nIt is observed from the result that the first method can save 3.4 % fuel as compared\nto the second method, and a maneuver with four phases requires less fuel than a\nmaneuver with three phases.\n\nFig. 4.9 Trajectories of formation reconfiguration with free relative final state\n\nFig. 4.10 Trajectories of formation reconfiguration with given relative final state\n\nTable 4.4 Fuel consumption and maneuver time for three-phase maneuver\n\nCases Fuel Consumption Maneuver time, s\n\n?m, kg ?V, m/s 1st burn Coast 2nd burn Total\n\nFree final state 0.006671 1.308 1243 4692 65 6000\n\nFixed final state 0.006698 1.313 1248 4429 64 5741\n\n92 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nIn this chapter, several structures of the trajectories up to coast\u2013burn\u2013coast\u2013burn\nwith progressive but diminishing improvement on fuel consumption have been\nstudied. The fuel consumption of the trajectory of coast\u2013burn\u2013coast\u2013burn sequence\n\nFig. 4.11 Trajectories of formation reconfiguration with free relative final state\n\nFig. 4.12 Trajectories of formation reconfiguration with given relative final state\n\nTable 4.5 Fuel consumption and maneuver time for four-phase maneuver\n\nCases Fuel consumption Maneuver time, s\n\n?m (kg) ?V (m/s) 1st coast 1st burn 2nd\ncoast\n\n2nd burn\n\nFree final state 0.005181 1.016 1146 946 4198 73\n\nFixed final state 0.005357 1.050 1053 988 4146 65\n\n4.7 Illustrative Examples 93\n\n\n\nis close to minimum. As observed in Huntington and Rao (2005, 2008), although\nthe satellite formation maneuver trajectories are divided into six phases and nine\nphases, there are only one or two actual burn phases in the optimized trajectories,\nand the optimal durations of other left burn phases are zero.\n\n4.7.5 Example 5: Scenario of Formation Reconfiguration\nInvolving Four Satellites\n\nThis example is to validate the applicability of the proposed trajectory optimization\nmethod for multi-satellite formation. Formation reconfiguration is studied for for-\nmation with four satellites (one chief satellite and three deputy satellites). The three\ndeputy satellites are maneuvered from a circular formation with radius of 1000 m to\nanother circular formation with radius of 2000 m, and the three deputy satellites are\nevenly spaced in the final circular formation. The initial relative state of each deputy\nsatellite is as follows:\n\nx1;0 \u00bc 500; _x1;0 \u00bc 0; y1;0 \u00bc 0; _y1;0 \u00bc 1; z1;0 \u00bc 866; _z1;0 \u00bc 0\nx2;0 \u00bc ?250; _x2;0 \u00bc 00:433; y2;0 \u00bc 866; _y2;0 \u00bc 0:5; z2;0 \u00bc 433; _z2;0 \u00bc 0:75\nx3;0 \u00bc ?250; _x3;0 \u00bc 00:433; y3;0 \u00bc ?866; _y3;0 \u00bc 0:5; z3;0 \u00bc 433; _z3;0 \u00bc ?0:75\n\n\u00f04:40\u00de\n\nwhere the unit of relative positions is m and that of relative velocities is m/s.\nAs can be concluded from the earlier examples, for a maneuver with more than\n\none phase, the optimization with a free final state does not result in significant fuel\nsaving as compared to that with fixed final state. Thus, the final state for a maneuver\nwith multiple phases is chosen to be fixed. In this example, the final relative states\nsatisfying the desired final formation are given in (4.41) by applying the analytic\nformation design method (Sabol et al. 2001), and the trajectory is divided into two\nphases (coast\u2013burn).\n\nx1; f \u00bc ?110:8; _x1; f \u00bc ?0:9942; y1; f \u00bc ?1988:7; _y1; f \u00bc 0:2216; z1; f \u00bc ?191:4; _z1; f \u00bc ?1:7195;\nx2; f \u00bc 914:4; _x2; f \u00bc 0:4051; y2; f \u00bc 800:6; _y2; f \u00bc ?1:8289; z2; f \u00bc 1587:1; _z2; f \u00bc 0:6940;\nx3; f \u00bc ?806:9; _x3; f \u00bc 0:5918; y3; f \u00bc 1183:3; _y3; f \u00bc 1:6138; z3; f \u00bc ?1394:9; _z3; f \u00bc 1:0231\n\n\u00f04:41\u00de\n\nwhere the unit of relative positions is m and that of relative velocities is m/s.\n\n94 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nFuel-optimal trajectories generated for three deputy satellites are shown in\nFig. 4.13. The corresponding maneuver times and fuel consumptions are shown in\nTable 4.6.\n\n4.7.6 Example 6: Scenario of Collision Avoidance\nValidation\n\nThe final example demonstrates the effectiveness of the proposed method in\nmeeting collision avoidance requirement. The three deputy satellites are maneu-\nvered from a circular formation with a radius of 500 m to another circular formation\nwith a radius of 1000 m using only one burn phase. The initial and final positions as\nwell as velocities are chosen a priori.\n\nThe optimized trajectories of each satellite obtained without considering the\ncollision avoidance are shown in Fig. 4.14, and the distances between the deputy\nsatellites during the maneuver are plotted in Fig. 4.15. As observed from the\nsimulation results, the smallest distance between the 1st and the 3rd satellite is only\n43 m. This separation is hazardous, and so collision avoidance constraint should be\n\nFig. 4.13 Trajectories of formation reconfiguration of four satellites\n\nTable 4.6 Fuel consumption and maneuver time for four-satellite formation (the units of ?m and\n?V are kg and m/s, respectively)\n\nDeputy satellite 1 Deputy satellite 2 Deputy satellite 3\n\nFuel Time, s Fuel Time, s Fuel Time, s\n\n?m ?V Coast Burn ?m ?V Coast Burn ?m ?V Coast Burn\n\n0.0106 2.08 5918 2081 0.0109 2.13 5821 2131 0.0108 2.11 5804 2110\n\n4.7 Illustrative Examples 95\n\n\n\nincluded in the optimization. In the ensuing optimization problem the safe distance\nis assumed to be dsafe = 200 m. The optimized trajectories obtained by incorpo-\nrating collision avoidance requirement are shown in Fig. 4.16, and the corre-\nsponding distances between deputy satellites during the maneuver are shown in\n\nFig. 4.14 Trajectories of formation maneuver without collision avoidance constraints\n\nFig. 4.15 Satellite relative distances during maneuver without collision avoidance constraints\n\n96 4 Nonlinear Optimization of Low-Thrust \u2026\n\n\n\nFig. 4.17. As seen from the results, the distances between satellites are always\ngreater than or equal to the required safe distance. It can be concluded that the\nproposed method can perform safe formation maneuver. As observed from\nTable 4.7, the fuel consumptions for the two cases are almost the same, but the\nmethod that incorporates the collision avoidance constraints can guarantee collision\navoidance during the maneuver.\n\nFig. 4.16 Trajectories of formation with collision avoidance constraints\n\nFig. 4.17 Satellite relative\ndistances during maneuver\nwith collision avoidance\nconstraints\n\n4.7 Illustrative Examples 97\n\n\n\n4.8 Conclusions\n\nThe use of Legendre pseudospectral method to design fuel-optimal trajectories for\nsatellite formation maneuver subject to collision avoidance is described and\ndemonstrated in this chapter. Continuous low-thrust propulsion is used in order to\nobtain high maneuver precision. The trajectory optimization problem is reduced\ninto nonlinear programming problem which is solved numerically by TOMLAB/\nSNOPT. High precision maneuver is obtained by using a newly developed exact\nrelative dynamics considering eccentricity, nonlinearity, and Earth\u2019s oblateness.\nBounded desired final formation is acquired by including the energy-matching\ncondition and final geometry configuration constraints. Extensive simulation results\ndemonstrate the applicability of Legendre pseudospectral method to optimal for-\nmation trajectory design.\n\nReferences\n\nAcikmese B, Scharf D, Hadaegh F, Murray E (2006) A convex guidance algorithm for formation\nreconfiguration. In: AIAA guidance, navigation, and control conference and exhibit, Keystone,\nCO, USA, Aug 2006. doi:10.2514/6.2006-6070\n\nBenson DA, Huntington GT, Thorvaldsen TP, Rao AV (2006) Direct trajectory optimization and\ncostate estimation via an orthogonal collocation method. J Guid Control Dyn 29\n(6):1435\u20131440. doi:10.2514/1.20478\n\nBetts JT (1998) Survey of numerical methods for trajectory optimization. J Guid Control Dyn 21\n(2):193\u2013207. doi:10.2514/2.4231\n\nBetts JT (2001) Practical methods for optimal control using nonlinear programming. vol book,\nwhole. Society for Industrial and Applied Mathematics Press, Philadelphia\n\nBollino K, Ross M, Doman D (2006) Optimal nonlinear feedback guidance for reentry vehicles.\nIn: AIAA guidance, navigation, and control conference and exhibit, Keystone, CO, USA, Aug\n2006\n\nCampbell M (2002) Planning algorithm for large satellite clusters. In: AIAA guidance, navigation,\nand control conference and exhibit, Monterey, California, 2002\n\nCho H, Park S-Y, Park H-E, Choi K-H (2012) Analytic solution to optimal reconfigurations of\nsatellite formation flying in circular orbit under J2 perturbation. IEEE Trans Aerosp Electron\nSyst 48(3):2180\u20132197. doi:10.1109/TAES.2012.6237587\n\nElnagar G, Kazemi MA, Razzaghi M (1995) The pseudospectral Legendre method for discretizing\noptimal control problems. IEEE Trans Autom Control 40(10):1793\u20131796. doi:10.1109/9.\n467672\n\nTable 4.7 Fuel consumption of each satellite during maneuver\n\nFuel consumption of\nsatellite 1\n\nFuel consumption of\nsatellite 2\n\nFuel consumption of\nsatellite 3\n\n?m, kg ?V, m/s ?m, kg ?V, m/s ?m, kg ?V, m/s\n\nFirst maneuver 0.0255 4.998 0.0256 5.018 0.0255 4.998\n\nSecond maneuver 0.0258 5.057 0.0278 5.449 0.0267 5.233\n\n98 4 Nonlinear Optimization of Low-Thrust \u2026\n\nhttp://dx.doi.org/10.2514/6.2006-6070\nhttp://dx.doi.org/10.2514/1.20478\nhttp://dx.doi.org/10.2514/2.4231\nhttp://dx.doi.org/10.1109/TAES.2012.6237587\nhttp://dx.doi.org/10.1109/9.467672\nhttp://dx.doi.org/10.1109/9.467672\n\n\nFahroo F, Ross IM (2001) Costate estimation by a Legendre pseudospectral method. J Guid\nControl Dyn 24(2):270\u2013277. doi:10.2514/2.4709\n\nGurfil P (2005) Relative motion between elliptic orbits: generalized boundedness conditions and\noptimal formationkeeping. J Guid Control Dyn 28(4):761\u2013767. doi:10.2514/1.9439\n\nHolmstr\u00f6m K, G\u00f6ranAnders O, Edvall MM (2008) User\u2019s guide for TOMLAB /SNOPT.\nM\u00e4lardalen University, Department of Mathematics and Physics, V\u00e4ster\u00e5s, Sweden\n\nHui Y, Ross IM, Alfriend KT (2007) Pseudospectral feedback control for three-axis magnetic\nattitude stabilization in elliptic orbits. J Guid Control Dyn 30(4):1107\u20131115. doi:10.2514/1.\n26591\n\nHuntington GT, Rao AV (2005) Optimal configuration of spacecraft formations via a gauss\npseudospectral method. Adv Astronaut Sci 120(I):33\u201350\n\nHuntington GT, Rao AV (2008) Optimal reconfiguration of spacecraft formations using the gauss\npseudospectral method. J Guid Control Dyn 31(3):689\u2013698. doi:10.2514/1.31083\n\nHuntington G, Benson D, Rao A (2007a) A comparison of accuracy and computational efficiency\nof three pseudospectral methods. In: AIAA guidance, navigation, and control conference and\nexhibit, Hilton Head, South Carolina, 20\u201323 Aug 2007\n\nHuntington GT, Benson D, Rao AV (2007b) Optimal configuration of tetrahedral spacecraft\nformations. J Astronaut Sci 55(2):141\u2013169. doi:10.1007/BF03256518\n\nInfeld S, Josselyn S, Murray W, Ross I (2004) Design and control of libration point spacecraft\nformations. In: AIAA guidance, navigation, and control conference and exhibit, Providence,\nRI, USA, Aug 2004\n\nJifuku R, Ichikawa A, Bando M (2011) Optimal pulse strategies for relative orbit transfer along a\ncircular orbit. J Guid Control Dyn 34(5):1329\u20131341. doi:10.2514/1.51230\n\nLee S, Park SY (2011) Approximate analytical solutions to optimal reconfiguration problems in\nperturbed satellite relative motion. J Guid Control Dyn 34(4):1097\u20131111. doi:10.2514/1.52283\n\nLi J, Xi X (2012) Fuel-optimal low-thrust reconfiguration of formation-flying satellites via\nhomotopic approach. J Guid Control Dyn 35(6):1709\u20131717. doi:10.2514/1.57354\n\nMauro M, Franco B (2006) Optimization of low-thrust trajectories for formation flying with\nparallel multiple shooting. In: AIAA/AAS astrodynamics specialist conference and exhibit,\nKeystone, CO, USA, Aug 2006\n\nPencil EJ, Kamhawi H, Arrington LA (2004) Overview of NASA\u2019s pulsed plasma thruster\ndevelopment program. In: AIAA/ASME/SAE/ASEE joint propulsion conference and exhibit,\nFort Lauderdale, FL, USA, July 2004\n\nPetit N, Milam M, Murray R (2001) Constrained trajectory generation for micro-satellite formation\nflying. In: AIAA guidance, navigation, and control conference and exhibit, Montreal, Canada,\nAug 2001\n\nPillet N, Bousquet P, Chesta E, Cledassou R, Delpech M, Hinglais E, Sire JP (2006) Propulsion\noptions for preliminary formation flying missions studies at CNES. In: AIAA/ASME/\nSAE/ASEE 42nd joint propulsion conference, Sacramento, CA, USA, July 2006\n\nPolzin KA (2011) Comprehensive review of planar pulsed inductive plasma thruster research and\ntechnology. J Propul Power 27(3):513\u2013531. doi:10.2514/1.B34188\n\nQi G, Kang W, Ross IM (2006) A pseudospectral method for the optimal control of constrained\nfeedback linearizable systems. IEEE Trans Autom Control 51(7):1115\u20131129. doi:10.1109/\nTAC.2006.878570\n\nRao A, Clarke K (2002) Performance optimization of a maneuvering re-entry vehicle using a\nlegendre pseudospectral method. In: AIAA atmospheric flight mechanics conference,\nMonterey, CA, USA, Aug 2002\n\nRea J (2003) Launch vehicle trajectory optimization using a legendre pseudospectral method. In:\nAIAA guidance, navigation, and control conference and exhibit, Austin, TE, USA, Aug 2003\n\nRichards A, Schouwenaars T, How JP, Feron E (2002) Spacecraft trajectory planning with\navoidance constraints using mixed-integer linear programming. J Guid Control Dyn\n25(4):755\u2013764. doi:10.2514/2.4943\n\nRoss I, King J, Fahroo F (2002) Designing optimal spacecraft formations. In: AAS/AIAA\nAstrodynamics specialist conference, Monterey, CA, USA, Aug 2002\n\nReferences 99\n\nhttp://dx.doi.org/10.2514/2.4709\nhttp://dx.doi.org/10.2514/1.9439\nhttp://dx.doi.org/10.2514/1.26591\nhttp://dx.doi.org/10.2514/1.26591\nhttp://dx.doi.org/10.2514/1.31083\nhttp://dx.doi.org/10.1007/BF03256518\nhttp://dx.doi.org/10.2514/1.51230\nhttp://dx.doi.org/10.2514/1.52283\nhttp://dx.doi.org/10.2514/1.57354\nhttp://dx.doi.org/10.2514/1.B34188\nhttp://dx.doi.org/10.1109/TAC.2006.878570\nhttp://dx.doi.org/10.1109/TAC.2006.878570\nhttp://dx.doi.org/10.2514/2.4943\n\n\nRoss I, D\u2019Souza C, Fahroo F, Ross J (2003) A fast approach to multi-stage launch vehicle\ntrajectory optimization. In: AIAA guidance, navigation, and control conference and exhibit,\nAustin, TE, USA, Aug 2003. doi:10.2514/6.2003-5639\n\nSabol C, Burns R, McLaughlin CA (2001) Satellite formation flying design and evolution.\nJ Spacecraft Rock 38(2):270\u2013278. doi:10.2514/2.3681\n\nSchaub H, Alfriend KT (2001) Impulsive feedback control to establish specific mean orbit\nelements of spacecraft formations. J Guid Control Dyn 24(4):739\u2013745. doi:10.2514/2.4774\n\nStanton SA, Proulx R (2003) Optimal orbital transfer using a legendre pseudospectral method. In:\nAAS/AIAA astrodynamics specialist conference, Big Sky, MO, USA, Aug 2003\n\nThevenet J-B, Epenoy R (2008) Minimum-fuel deployment for spacecraft formations via optimal\ncontrol. J Guid Control Dyn 31(1):101\u2013113. doi:10.2514/1.30364\n\nTillerson M, Inalhan G, How JP (2002) Coordination and control of distributed spacecraft systems\nusing convex optimization techniques. Int J Robust Nonlinear Control 12(2\u20133):207\u2013242\n\nVaddi SS, Alfriend KT, Vadali SR, Sengupta P (2005) Formation establishment and reconfig-\nuration using impulsive control. J Guid Control Dyn 28(2):262\u2013268. doi:10.2514/1.6687\n\nWu B, Wang D, Poh EK, Xu G (2009) Nonlinear optimization of low-thrust trajectory for satellite\nformation: legendre pseudospectral approach. J Guid Control Dyn 32(4):1371\u20131381. doi:\n10.2514/1.37675\n\nWu BL, Wang DW, Poh EK (2011) Energy-optimal low-thrust satellite formation manoeuvre in\npresence of J2 perturbation. Proc Inst Mech Eng J Aerosp Eng 225(9):961\u2013968\n\nXu GG, Wang DW (2008) Dynamic models of satellite relative motion around an oblate earth. In:\nAAS/AIAA space flight mechanics meeting, AAS-08-208, Galveston, Texas, 27\u201331 Jan 2008,\npp 1633\u20131648\n\nZanon DJ, Campbell ME (2006) Optimal planner for spacecraft formations in elliptical orbits.\nJ Guid Control Dyn 29(1):161\u2013171. doi:10.2514/1.7236\n\n100 4 Nonlinear Optimization of Low-Thrust \u2026\n\nhttp://dx.doi.org/10.2514/6.2003-5639\nhttp://dx.doi.org/10.2514/2.3681\nhttp://dx.doi.org/10.2514/2.4774\nhttp://dx.doi.org/10.2514/1.30364\nhttp://dx.doi.org/10.2514/1.6687\nhttp://dx.doi.org/10.2514/1.37675\nhttp://dx.doi.org/10.2514/1.7236\n\n\nChapter 5\nOptimal Control for Satellite\nFormation Keeping\n\nThis chapter presents two kinds of optimal control-based satellite formation keeping\nstrategies. Firstly, a real-time optimal control law in a leader\u2013follower frame is\ndeveloped for satellite formation keeping in elliptic orbits. The proposed control\nlaw can prioritize between fuel consumption and control accuracy subject to the\ncontrol saturation constraints. Then, decentralized control using only local relative\nmeasurements is proposed for satellite formation keeping in mildly elliptic orbits.\nOptimal guaranteed cost control law is applied to the resulting linear time-varying\n(LTV) system with uncertain parameters. The proposed decentralized formation\ncontrol architecture is completely decentralized and scalable.\n\n5.1 Introduction\n\nFormation will drift apart slowly due to various environmental perturbations after\nthe desired formation is established. Thus, satellite formation keeping strategy is\nrequired. Various continuous control approaches (De Queiroz et al. 2000; Vignal\nand Pernicka 2006; Gurfil et al. 2002; Mesbahi and Hadaegh 2001; Yeh et al. 2002;\nMassey and Shtessel 2005; Subbarao and Welsh 2008; Beard et al. 2001; Vassar\nand Sherwood 1985; Redding et al. 1989; Kapila et al. 2000; Cap\u00f3-Lugo and\nBainum 2007; Liu and Kumar 2012; Wang et al. 2012; Carpenter 2002; Belanger\net al. 2006; Lavaei et al. 2008; Chung et al. 2009; Ren and Beard 2004; Ren 2007;\nGurfil and Mishne 2007; Smith and Hadaegh 2005; Min et al. 2011;\nRamirez-Riberos et al. 2010; Shan 2008; Breger and How 2007) have been pro-\nposed to investigate the problem of formation keeping. A survey of various control\ndesign methodologies for satellite formation using non-impulsive propulsion sys-\ntem can be found in Scharf et al. (2004). These approaches can be roughly divided\ninto two categories: leader\u2013follower control and decentralized control. In this\nchapter, firstly a real-time fuel-optimal formation keeping approach in the leader\u2013\nfollower frame is designed using low-thrust propulsion system. Then, a\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_5\n\n101\n\n\n\ndecentralized continuous formation keeping approach using local relative mea-\nsurements is proposed based on algebraic graph theories. Before the two control\napproaches are presented, the literature review of leader\u2013follower control and\ndecentralized control for satellite formation keeping is firstly given below.\n\n5.1.1 Leader\u2013Follower Formation Keeping Approaches\n\nMost of control strategies for satellite formation keeping use leader\u2013follower\narchitecture in which one satellite is designated as leader, and the remaining\nsatellites are manipulated to follow the same leader. Numerous contributions (De\nQueiroz et al. 2000; Vignal and Pernicka 2006; Gurfil et al. 2002; Mesbahi and\nHadaegh 2001; Yeh et al. 2002; Massey and Shtessel 2005; Subbarao and Welsh\n2008; Shan 2008; Beard et al. 2001; Vassar and Sherwood 1985; Redding et al.\n1989; Kapila et al. 2000; Cap\u00f3-Lugo and Bainum 2007; Breger and How 2007; Liu\nand Kumar 2012; Wang et al. 2012) to the leader\u2013follower literature differ primarily\nin the types of formation tracking control laws designed for the followers. In this\nregard, most of the modern control paradigms have been investigated to solve this\nproblem.\n\nThe problem of relative position control for satellite formation flying was con-\nsidered in De Queiroz et al. (2000). Specifically, the full nonlinear dynamics\ndescribing the relative positioning of satellite formation flying are used to develop a\nLyapunov-based, nonlinear adaptive control law that guarantees global asymptotic\nconvergence of the position tracking error in the presence of unknown constant, or\nslow-varying satellite masses, disturbance forces, and gravity forces. Vignal and\nPernicka (2006) compared two active control system designs that can be used to\nmaintain formation composed of microsatellites with limited on\u2013off thrusting\ncapabilities in low Earth orbit. The two evaluated designs are based on a linear\napproach using optimal control theory and on a nonlinear approach based on\nLyapunov stability concepts. The final selection is a trade-off between fuel con-\nsumption and controller robustness based on model uncertainties. Gurfil et al.\n(2002) presented a nonlinear adaptive neural control methodology for spacecraft\nformation flying in the spatial elliptic restricted three-body problem. This controller\nconsists of an approximate dynamic model inversion, linear compensation of the\nideal feedback linearized model, and an adaptive neural network-based element\ndesigned to compensate for the model inversion errors. Mesbahi and Hadaegh\n(2001) also presented several results in the leader-follower framework for satellite\nformation flying control. Ideas from elementary graph theory and linear matrix\ninequalities are combined with logic-based switching to shed light on the class of\ncontrol designs that are feasible through leader\u2013follower for a representative set of\nformation flying scenarios. A tracking control design using sliding mode techniques\nwas derived to control a desired satellite formation in Yeh et al. (2002). CW\nequations are used to model the follower satellite motion relative to the leader. The\ncontrol law is modified to account for discontinuous nature of the control forces\n\n102 5 Optimal Control for Satellite Formation Keeping\n\n\n\navailable with the satellite propulsive thrusters. This study is further improved in\nMassey and Shtessel (2005) via application of recently developed continuous\nsliding mode control algorithms modulated by pulse-width modulation (PWM),\nallowing high tracking accuracy in the presence of bounded matched disturbances\nand uncertainties and providing a required duty cycle in a control command to the\njet thrusters.\n\nMost of the above-cited formation keeping approaches dealt with model\nuncertainties and external disturbances. However, fuel consumption is a major\nconcern for satellite formation keeping mission. Linear quadratic regulator (LQR) is\nan optimal control approach, which saves fuel consumption by increasing the rel-\native weight matrix of control input over state error in the cost function, and it was\nstudied by several researchers for formation keeping (Vassar and Sherwood 1985;\nRedding et al. 1989; Kapila et al. 2000; Cap\u00f3-Lugo and Bainum 2007). But solving\nthe LQR problem for LTV system, modeling the relative motion in elliptic orbits\nrequires an efficient computation of the Riccati equations (Cap\u00f3-Lugo and Bainum\n2007) and solving Riccati equations in real time is computation-intensive.\nFurthermore, LQR cannot handle control input saturation efficiently, which is very\nimportant for low-thrust formation keeping system. To overcome the mentioned\nlimitations of LQR for LTV system, Breger and How (2007) proposed a real-time\noptimal control for satellite formation keeping in elliptic orbits. However,\nzero-order-hold discretized model is required for the optimization-based controller\nin Breger and How (2007). Hence, large discretization error will result when the\ndiscretization step is large.\n\n5.1.2 Decentralized Formation Keeping Approaches\n\nAlthough the leader\u2013follower approach is easy to understand and implement, there\nare limitations. The leader\u2013follower approach is a centralized control law, and the\nleader is a single point of failure for the formation. Hence, various decentralized\ncontrol approaches (Carpenter 2002; Belanger et al. 2006; Lavaei et al. 2008;\nChung et al. 2009; Ren and Beard 2004; Ren 2007; Gurfil and Mishne 2007; Smith\nand Hadaegh 2005; Min et al. 2011; Ramirez-Riberos et al. 2010; Wu et al. 2012)\nwere proposed for formation keeping.\n\nCarpenter (2002) proposed a decentralized linear-quadratic-Gaussian controller\nfor autonomous establishment and maintenance of satellite formations. Two\nextended decentralized linear-quadratic-Gaussian controllers, each employing a\nunique information exchange scheme, were considered in Belanger et al. (2006).\nOne of these algorithms employs a communication paradigm in which control and\nlocal state estimate information is exchanged between members of a formation after\nany one of the members executes a control. The other algorithm requires only that\ncontrol information be exchanged between members. Lavaei et al. (2008) proposed\na decentralized model predictive control for satellite formation. This decentralized\ncontroller consists of local estimators inherently, so that each local controller\n\n5.1 Introduction 103\n\n\n\nestimates the state of the whole formation. Necessary and sufficient conditions for\nthe stability of the formation under the proposed decentralized controller are\nobtained. A decentralized translational tracking control law based on oscillator\nphase synchronization is presented for satellite formation in Chung et al. (2009).\nThe nonlinear relative motion dynamics is described in the Lagrangian form. The\ndistributed stability and performance analysis tool, called contraction analysis, is\nused to yield exact nonlinear stability proofs. A decentralized implementation of a\nvirtual structure coordination strategy is presented for formation control of\ndeep-space spacecraft formation flying in Ren and Beard (2004). However, Ren and\nBeard (2004) require a bidirectional ring communication topology, which is rather\nrestrictive in the sense that each satellite needs to explicitly identify its two adjacent\nneighbors in the group to form the ring. This approach is improved in Ren (2007),\nin which the constraint on the communication topology is relaxed to be having a\ndirected spanning tree.\n\nHowever, the above-cited decentralized control approaches have not considered\nthe measurement hardware required for relative navigation in formation flying\nmissions. It was assumed that the relative position and velocity of every satellite\nwith respect to the virtual reference orbit is available in these studies. Some of these\nstudies suggested the use of GPS for relative navigation of near-Earth formation\nflying missions (Busse and How 2002). However, GPS is not suitable for precision\nrelative navigation in formation flying missions beyond low Earth orbits. Also, full\ncollaboration and communication architecture among the formation satellites is not\npreferable for some formation flying missions due to high operational cost and\ntechnology immaturity. These two reasons motivate us to find an alternative (such\nas local relative measurements) to GPS-based relative navigation for formation\nflying missions.\n\nGurfil and Mishine (2007) developed a relative motion control law based on\nline-of-sight (LOS) measurements only (local relative measurements). Each satellite\ntracks its neighboring satellite to produce a LOS vector measurement, and the last\nsatellite in the formation will track the first satellite to create a cyclic formation.\nHowever, bounded formation, which is obtained under the condition that the ener-\ngies of satellites in the formation are matched, is not sufficient to satisfy all the\nrequirements for satellite formation flying missions. In some missions, the relative\npositions and velocities between each of the satellites need to be controlled precisely.\n\nSmith and Hadaegh (2005) presented a formation control design approach for\ndeep-space spacecraft formation flying, based on local relative measurements. This\napproach exploits the redundancy inherent in a relative position specification to\ndevelop a family of equivalent control topologies for formation control. Switching\nbetween topologies provides redundancy and allows combinations of measured\nrelative positions and communicated estimates to be used in the implementation of\nthe formation control.\n\nAs mentioned earlier, fuel consumption is a major concern for satellite formation\nkeeping mission. However, fuel consumption was not taken into account in the\nabove two local relative measurements-based decentralized formation keeping\nmethods.\n\n104 5 Optimal Control for Satellite Formation Keeping\n\n\n\n5.2 Real-Time Optimal Formation Keeping\nin Leader\u2013Follower Frame\n\nFormation will drift apart slowly due to various environmental perturbations, such\nas gravitational perturbation and atmospheric drag, after the desired formation is\nestablished. Thus, formation keeping strategy is required. This section proposes a\nformation keeping strategy for satellite formation in eccentric orbits in a leader\u2013\nfollower frame (Wu et al. 2009, 2016). In the leader\u2013follower frame, the leader is\nassumed to be well controlled, and the follower needs to track the desired relative\nmotion with respect to the leader. This section proposes a real-time fuel-optimal\ncontrol approach for the follower to track the leader using continuous low-thrust\npropulsion system. The control acceleration constraints are included in the opti-\nmization problem to avoid control saturation for low-thrust propulsion system. The\nfuel-optimal control problem is then converted into a quadratic programming\nproblem by application of Legendre pseudospectral method. To solve the smooth\noptimal control problem, Legendre pseudospectral method has two advantages over\nother numerical methods: improved accuracy and faster convergence rate which\nmakes real-time optimal control feasible. The proposed control law is simulated\nusing MATLAB. The reported simulation results confirm the effectiveness of the\nproposed method.\n\n5.2.1 Real-Time Optimal Control Law Design\n\nIn this subsection, a real-time optimal control is designed for satellite formation\nkeeping. This proposed optimal control has potential real-time implementation. The\ncost function of the real-time fuel-optimal control for satellite formation keeping is\nchosen as follows.\n\nJ \u00bc 1\n2\n\nZtf\nt0\n\nuT\u00f0t\u00deu\u00f0t\u00dedt \u00f05:1\u00de\n\nwhere u\u00f0t\u00de 2 R3 is the control acceleration, t0 and tf are the initial, final time of the\noptimization, respectively.\n\nRemark 5.1 The chosen form of performance index is appropriate for\npower-limited, low-thrust propulsion. For variable specific impulse (Isp)\npower-limited propulsion systems, the fuel consumption is directly proportional to\nthe integral sum of squares of the control accelerations given above.\n\n5.2 Real-Time Optimal Formation Keeping in Leader\u2013Follower Frame 105\n\n\n\nThe fuel-optimal control problem for satellite formation keeping should be\nsubject to the following constraints.\n\nA. Relative dynamics constraints\n\nIn order to make the real-time fuel-optimal control approach practical, a linear\noptimal control problem should be formulated. Thus, a linearized relative motion\nmodel (2.64) considering J2 perturbation and eccentricity is used in this section.\nThe reference relative motion dynamics can be written as the following matrix\nform.\n\n_xd\u00f0t\u00de \u00bc A\u00f0t\u00dexd\u00f0t\u00de \u00f05:2\u00de\n\nwhere xd 2 R6 denotes the reference relative state, A(t) is the state matrix.\nRemark 5.2 The desired formation geometry can be designed by choosing the\ninitial reference relative state xd\u00f0t0\u00de. For instance, a circular formation can be\ndesigned as follows (Sabol et al. 2001):\n\nxd\u00f0t0\u00de \u00bc \u00f0R=2\u00de cos#; _xd\u00f0t0\u00de \u00bc ?Rn=2\u00f0 \u00de sin#\nyd\u00f0t0\u00de \u00bc 2 _x0=n; zd\u00f0t0\u00de \u00bc ?\n\nffiffiffi\n3\n\np\nxd\u00f0t0\u00de; _zd\u00f0t0\u00de \u00bc ?\n\nffiffiffi\n3\n\np\n_xd\u00f0t0\u00de\n\n?\n\u00f05:3\u00de\n\nand\n\n_yd\u00f0t0\u00de\nxd\u00f0t0\u00de \u00bc ?\n\nn\u00f02\u00fe e\u00de\n\u00f01\u00fe e\u00de1=2\u00f01? e\u00de3=2\n\n\u00f05:4\u00de\n\nwhere R is the radius of the formation, # is initial phasing angle of the formation,\n(5.4) is the periodicity or no-drift condition (Inalhan et al. 2002).\n\nConsidering (5.2) and (2.64) yields the following relative state error dynamics\n\nd _x\u00f0t\u00de \u00bc A\u00f0t\u00dedx\u00f0t\u00de\u00feB\u00f0t\u00deu\u00f0t\u00de \u00f05:5\u00de\n\nwhere dx \u00bc x? xd denotes the relative state error. x 2 R6, xd 2 R6 denote,\nrespectively, the measured, reference relative state of the follower with respect to\nthe leader. u\u00f0t\u00de is the control acceleration vector.\nB. Control acceleration constraints\n\nThe control acceleration constraints should be enforced, because continuous\nlow-thrust engine for satellite formation keeping can only generate limited output\nforce (Pencil et al. 2004).\n\n?umaxx ? ux\u00f0t\u00de? umaxx ; ?umaxy ? uy\u00f0t\u00de? umaxy ; ?umaxz ? uz\u00f0t\u00de? umaxz ;\n8t 2 \u00bdt0; tf ? \u00f05:6\u00de\n\n106 5 Optimal Control for Satellite Formation Keeping\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\n\n\nwhere umaxx ; u\nmax\ny ; u\n\nmax\nz denotes the limits of control accelerations u in three direc-\n\ntions in LVLH frame. For simplicity, (5.6) is written as the following vector form\n\n?umax ? u\u00f0t\u00de? umax \u00f05:7\u00de\n\nC. Initial condition constraints\n\ndx\u00f0t0\u00de \u00bc xd\u00f0t0\u00de ? x\u00f0t0\u00de; \u00f05:8\u00de\n\nD. Final condition constraints\n\ndx\u00f0tf\u00de \u00bc 0 \u00f05:9\u00de\n\nThe above optimal control problem can be summarized. The problem is to\ndetermine the control acceleration u\u00f0t\u00de and the corresponding state trajectory dx\u00f0t\u00de\nto minimize the following cost function\n\nJ \u00bc 1\n2\n\nZtf\nt0\n\nuT\u00f0t\u00deu\u00f0t\u00dedt \u00f05:10\u00de\n\nsubject to\n\nd _x\u00f0t\u00de \u00bc A\u00f0t\u00dedx\u00f0t\u00de\u00feB\u00f0t\u00deu\u00f0t\u00de\n?umax ? u\u00f0t\u00de? umax; 8t 2 \u00bdt0; tf ?\ndx\u00f0t0\u00de \u00bc xd\u00f0t0\u00de ? x\u00f0t0\u00de\ndx\u00f0tf\u00de \u00bc 0\n\n8>><\n>>: \u00f05:11\u00de\n\nThe above optimal control can now be discretized into quadratic programming\nusing Legendre pseudospectral method.\n\nThe implementation procedure for real-time optimal control is as follows:\n\nA. Obtain the measured relative state for the time t0, and calculate the relative state\nerror between desired relative state and measured relative state.\n\nB. Solve the above linear optimization problem (5.10) and (5.11).\nC. Apply the control input u?\u00f0t\u00de t 2 t0; t0 \u00feDt\u00bd ? to system\nD. Set t0 \u00bc t0 \u00feDt; tf \u00bc tf \u00feDt, and go to the first step, repeat steps A\u2013D.\n\nNote that the stability of the above real-time optimal control approach can be\nensured by the terminal constraint (5.9) according to Mayne et al. (2000).\n\n5.2 Real-Time Optimal Formation Keeping in Leader\u2013Follower Frame 107\n\n\n\n5.2.2 Discretization Using Legendre Pseudospectral Method\n\nThe above optimal control can now be discretized into quadratic programming\nusing Legendre pseudospectral method introduced in Sect. 4.4.\n\nBecause the above optimal control problem is formulated over the time interval\n[t0, tf], and the LGL points lie in the interval [?1, 1], the following transformation is\nused to express the problem for s 2 s0; sN\u00bd ? \u00bc \u00bd?1; 1?:\n\nt \u00bc \u00f0tf ? t0\u00des\u00fe\u00f0tf \u00fe t0\u00de\n2\n\n\u00f05:12\u00de\n\nIt follows that (5.10) and (5.11) can replaced by\n\nJ \u00bc tf?t04\nR 1\n?1 u\u00f0s\u00deTu\u00f0s\u00de\n? ?\n\nds\n\nd _x\u00f0s\u00de \u00bc tf?t04 A\u00f0s\u00dedx\u00f0s\u00de\u00feB\u00f0s\u00deu\u00f0s\u00de\u00bd ?\ndx\u00f0?1\u00de \u00bc x\u00f0t0\u00de ? xd\u00f0t0\u00de\ndx\u00f01\u00de \u00bc 0; ?umax ? u\u00f0s\u00de? umax\n\n8>>><\n>>>:\n\n\u00f05:13\u00de\n\nNote that the above functions are continuously differentiable with respect to their\narguments, which are required in the Legendre pseudospectral method.\n\nIn summary, the fuel-optimal control problem for satellite formation keeping can\nbe converted into the following mathematical programming problem using\nLegendre pseudospectral method:\n\nFind the 9(N + 1) vector Xopt\n\nXopt \u00bc dx0; dx1; . . .; dxN ; u0; u1; . . .; uN\u00bd ? \u00f05:14\u00de\n\nto minimize\n\nJ\u00f0Xopt\u00de \u00bc tf ? t04\nXN\nk\u00bc0\n\nu\u00f0sk\u00deTu\u00f0sk\u00de\n? ?\n\nxk \u00f05:15\u00de\n\nsubject to\n\nPN\nl\u00bc0\n\nDkldxl ? tf?t02 A\u00f0sk\u00dedx\u00f0sk\u00de\u00feB\u00f0sk\u00deu\u00f0sk\u00de\u00bd ? \u00bc 0\numin ? u\u00f0sk\u00de? umax\ndx\u00f0?1\u00de \u00bc x\u00f0t0\u00de ? xd\u00f0t0\u00de\nx\u00f01\u00de \u00bc 0\n\n8>>>><\n>>>>:\n\n\u00f05:16\u00de\n\nwhere xk are the weights given by\n\nxk :\u00bc 2= N\u00f0N \u00fe 1\u00de\u00bd ?f g 1= LN sk\u00f0 \u00de\u00bd ?2\nn o\n\n; k \u00bc 0; 1; . . .;N \u00f05:17\u00de\n\n108 5 Optimal Control for Satellite Formation Keeping\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_4\n\n\nFor the details of Legendre pseudospectral method, please refer to Smith and\nHadaegh (2005).\n\n5.2.3 Computational Considerations of Quadratic\nProgramming Problem\n\nThis section discusses issues related to the implementation and solution of the\noptimization problem presented in the preceding sections. The methods presented\nhere do not change the basic constraints already described, but assist greatly in\nobtaining solutions within a practical and reasonable computational time interval.\n\nAs mentioned in previous chapter, scaling a mathematical programming problem\nis very important in order to obtain robust and rapid convergence to the final\nsolution. One way to construct a well-scaled problem is to normalize the inde-\npendent variables to have the same range. For example, 0?~xk ? 1, where ~xk\ndenotes the scaled variables. So the following normalizations are used in this work.\n\nd~x \u00bc dx=?dmax; d~y \u00bc dy=?dmax; d~z \u00bc dz=?dmax \u00f05:18\u00de\n\nd~_x \u00bc d _x=vmax; d~_y \u00bc d_y=vmax; d~_z \u00bc d_z=vmax \u00f05:19\u00de\n\n~ux \u00bc 105ux; ~uy \u00bc 105uy; ~uj;z \u00bc 105uz \u00f05:20\u00de\n\nwhere ?dmax and vmax denote the possible maximal relative position and velocity,\nrespectively.\n\nThe Legendre pseudospectral method has a larger radius of convergence than\nother numerical methods, and it may not require a good initial guess for conver-\ngence. However, an educated initial guess does improve convergence rate and\nrobustness. In this section, an initial guess is generated by integrating the relative\ndynamics numerically using zero control acceleration.\n\nThe quadratic programming problem is solved by the command \u201cquadprog\u201d in\nMATLAB.\n\n5.2.4 Numerical Simulations\n\nIn this section, simulations are performed using MATLAB to validate the proposed\nformation keeping approaches. The chief satellite selected for the numerical sim-\nulations has the following orbital elements\n\n5.2 Real-Time Optimal Formation Keeping in Leader\u2013Follower Frame 109\n\n\n\na \u00bc 7100 km; e \u00bc 0:01; i \u00bc 45?; - \u00bc 20?; X \u00bc 0?; h \u00bc 340? \u00f05:21\u00de\n\nA full nonlinear propagator with the Earth zonal harmonic perturbations up to\nJ21, and atmospheric drag in a software \u201cOrbital Mechanics with MATLAB\u201d\n(http://www.cdeagle.com/html/ommatlab.html, June, 2010) is used for simulation.\nThe area-to-mass ratio of two satellites is assumed to be identical. The number of\nLGL points is chosen as 20. More accurate results can be obtained in this opti-\nmization problem with more LGL points at the expense of computational cost. The\nclock frequency of the CPU used is 1.86 GHz. The optimization can be completed\nwithin 0.03 s, which promises great potential for real-time computations.\n\nThe first example in this section is to correct initial position errors by using\nreal-time fuel-optimal control. The prediction horizon is chosen as tf ? t0 \u00bc 3000 s.\nThe assumed maximum control accelerations in three directions in LVLH frame are\nidentical and chosen to be umax \u00bc 3? 10?4 m=s2. The initial relative velocity errors\nare assumed to be zeros. The initial relative position errors are assumed to be\n\ndx0 \u00bc 100m; dy0 \u00bc ?200m; dz0 \u00bc 100m \u00f05:22\u00de\n\nThe time histories of the relative position error, velocity error, and control\naccelerations are shown in Figs. 5.1, 5.2, and 5.3, respectively. As seen from\nFigs. 5.1, 5.2, and 5.3, the position error and velocity error are corrected in about\none orbital period using fuel-optimal control, and the control accelerations are kept\nwithin their limits.\n\nIn the second example, real-time optimal control is used to maintain formation\nagainst various perturbations over five orbital periods. The initial relative state error\nis assumed to be zero. The prediction horizon is chosen as tf ? t0 \u00bc 3000 s. The\ntime histories of the relative position error, velocity error, and control accelerations\nare shown in Figs. 5.4, 5.5, and 5.6, respectively.\n\nFig. 5.1 Relative position\nerror under real-time optimal\ncontrol\n\n110 5 Optimal Control for Satellite Formation Keeping\n\nhttp://www.cdeagle.com/html/ommatlab.html\n\n\nThe choice of the prediction horizon tf ? t0 is a trade-off between fuel con-\nsumption and control accuracy. Suppose the control accuracy needs to be increased,\nthe prediction horizon can be decreased. Thus, in the third example, the prediction\nhorizon is chosen as tf ? t0 \u00bc 600 s. The time histories of the relative position error,\nvelocity error, and control accelerations are shown in Figs. 5.7, 5.8 and 5.9,\nrespectively. As observed from simulation results, the relative state error in the third\nexample is much less than that of the previous example.\n\nFig. 5.2 Relative velocity\nerror under real-time optimal\ncontrol\n\nFig. 5.3 Control acceleration\nunder real-time optimal\ncontrol\n\n5.2 Real-Time Optimal Formation Keeping in Leader\u2013Follower Frame 111\n\n\n\n5.3 Decentralized Formation Control Using\nLocal Relative Measurements\n\nThis section introduces a decentralized control design technique for satellite for-\nmation in elliptic orbits using algebraic graph theories (Wu et al. 2010). Each\nsatellite controls itself by using only the relative states describing its position and\nvelocity relative to neighboring satellites it can sense. These relative states can be\nobtained by local relative measurements, such as LOS measurements. The forma-\ntion control problem with n satellites is thus reduced into n stabilization problems of\nsingle satellite with the identical relative dynamics differentiated by a distinct scalar\nparameter. This scalar parameter takes the values of nonzero eigenvalues of a\nLaplacian matrix which represents the topology of relative measurements among all\n\nFig. 5.4 Relative position\nerror under real-time optimal\ncontrol with tf ? t0 \u00bc 3000 s\n\nFig. 5.5 Relative velocity\nerror under real-time optimal\ncontrol with tf ? t0 \u00bc 3000 s\n\n112 5 Optimal Control for Satellite Formation Keeping\n\n\n\nthe satellites. The resulting relative dynamics can be treated as a LTV system with\nuncertain parameters and an optimal guaranteed cost control law can be applied.\nSimulation results are presented to show the efficiency of the proposed decentral-\nized formation control strategy for satellite formation flying.\n\n5.3.1 Problem Formulation of Decentralized\nFormation Control\n\nConsider a formation of n satellites with identical dynamics. The relative motion\ndynamics of each satellite with respect to an elliptic reference orbit is modeled in (2.\n83). Now it is rewritten with index as follows:\n\nFig. 5.6 Control acceleration\nunder real-time optimal\ncontrol with tf ? t0 \u00bc 3000 s\n\nFig. 5.7 Relative position\nerror under real-time optimal\ncontrol with tf ? t0 \u00bc 600 s\n\n5.3 Decentralized Formation Control Using Local Relative Measurements 113\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\n\n\nx0i\u00f0 f \u00de \u00bc A\u00f0 f \u00dexi\u00f0 f \u00de\u00feB\u00f0 f \u00deui\u00f0 f \u00de; 8i \u00bc 1; 2; . . .; n \u00f05:23\u00de\n\nwhere the subscript i denotes the ith satellite in a formation.\nMotivated by the study of cooperative control for multi-agent systems using\n\nlocal interaction (Fax and Murray 2004; Ren and Atkins 2007), this section pro-\nposes a decentralized formation control approach in which each satellite controls\nitself by using only relative states describing its position and velocity relative to\nneighboring satellites it can sense. These relative states can be obtained from local\nrelative measurements, such as local LOS measurements.\n\nThe proposed decentralized formation control is to design the following\ndecentralized state-feedback control for each satellite\n\nFig. 5.8 Relative velocity\nerror under real-time optimal\ncontrol with tf ? t0 \u00bc 600 s\n\nFig. 5.9 Control input by\nusing real-time optimal\ncontrol with tf ? t0 \u00bc 600 s\n\n114 5 Optimal Control for Satellite Formation Keeping\n\n\n\nui\u00f0 f \u00de \u00bc riK\nX\nj2Ni\n\nDxi;j\u00f0 f \u00de ? Dxdi;j\u00f0 f \u00de\n? ?\n\n; 8i; j \u00bc 1; 2; . . .; n \u00f05:24\u00de\n\nwhere K is a constant state-feedback gain matrix. The set Ni represents the set of\nsatellites which the ith satellite can sense. Dxi;j \u00bc xj ? xi and Dxdi;j \u00bc xdj ? xdi\ndenote, respectively, the actual and desired relative states of the jth with respect to\nthe ith satellite. xi and xdi denote, respectively, the actual and the desired relative\nstates of the ith satellite with respect to the reference orbit.\n\nIn some formation flying missions, if one of the satellites runs out of fuel faster,\nthe entire distributed system can be non-operational. Generally, this fuel imbalance\nmay shorten total mission duration. Thus, besides fuel minimization, fuel balance\nshould be considered to guarantee maximum mission lifetime. The parameters ri\ndenote positive weight scalars for fuel balance among satellites. It can be chosen as\ngiven below\n\nri \u00bc Fueli1\nn\n\nPn\nj\u00bc1 Fuelj\n\n; 8i \u00bc 1; 2; . . .; n \u00f05:25\u00de\n\nwhere Fueli denotes the fuel left on the ith satellite.\nThe goal of formation control is\n\nlim\nf!1\n\nDxi;j\u00f0 f \u00de ? Dxdi;j\u00f0 f \u00de\n? ?\n\n\u00bc 0; 8i; j \u00bc 1; 2; . . .; n \u00f05:26\u00de\n\nAs observed from the above equation, the desired relative positions and veloc-\nities between each pair of the satellites are obtained. Note that the relative states\nDxi;j between satellites in formation need to be controlled, but not necessarily the\nrelative states xi of satellites with respect to the reference orbit.\n\nAssumption 5.1 The desired relative states between satellites Dxdi;j are assumed to\nbe also governed by the relative motion dynamics in (2.83) without control inputs\nas follows.\n\nDx0di;j\u00f0 f \u00de \u00bc A\u00f0 f \u00deDxdi;j\u00f0 f \u00de 8i; j \u00bc 1; 2; . . .; n \u00f05:27\u00de\n\nRemark 5.3 The relative state between satellites Dxi;j 8i; j \u00bc 1; 2; . . .; n can be\nobtained by local relative measurements, such as local LOS measurement. LOS\nmeasurements, as illustrated in Fig. 5.10, include relative distance measurement\nand relative orientation measurements in (5.28). LOS measurements can be\nacquired by several readily available methods, such as the use of vision-based\nsensors that combine star trackers and optical/RF ranging (Alonso et al. 2000) or a\ncombination of onboard optical tracking with rate gyros for the determination of\nLOS. In any case, only the relative LOS vector is required for the control and no\nabsolute position of each satellite is required.\n\n5.3 Decentralized Formation Control Using Local Relative Measurements 115\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\n\n\nDri;j \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nDx2i;j \u00feDy2i;j \u00feDz2i;j\n\nq\nDui;j \u00bc arcsin Dzi;j=Dri;j\n\n? ?\nD/i;j \u00bc arctan Dyi;j=Dxi;j\n\n? ? 8i; j \u00bc 1; 2; . . .; n:\n\n8><\n>: \u00f05:28\u00de\n\n5.3.2 Decentralized Formation Control Design\n\nThis section derives the condition under which the goal of formation control (5.26)\nis achieved. Meanwhile, the relative state of each satellite at steady state is given.\nThe following lemma will be used to derive the proposed control law.\n\nLemma 5.1 (Horn and Johnson 1991) Suppose that M 2 Rm?m, N 2 Rn?n, X 2\nR\n\nm?m and Y 2 Rn?n. The following results hold:\n(i) \u00f0M \t N\u00de\u00f0X \t Y\u00de \u00bc MX \t NY , where \t denotes the Kronecker product;\n\n(ii) Suppose that M and N are invertible. Then M \t N\u00f0 \u00de?1\u00bc M?1 \t N?1; and\n(iii) Let k1; . . .; km be the eigenvalues of M and l1; . . .; ln be those of N. Then the\neigenvalues of M \t N are kilj; i \u00bc 1; . . .;m; j \u00bc 1; . . .; n.\n\nThe decentralized formation control law given in (5.24) can be rewritten as\n\nui\u00f0 f \u00de \u00bc riK\nX\nj2Ni\n\nxj\u00f0 f \u00de ? xi\u00f0 f \u00de\n? ?? xdj \u00f0 f \u00de ? xdi \u00f0 f \u00de? ?h i; 8i; j 2 1; 2; . . .; n\u00bd ?\n\n\u00f05:29\u00de\n\nwhere xi and xdi denote, respectively, the actual and the desired relative states of\nthe ith satellite with respect to reference orbit.\n\nFig. 5.10 Illustration of LOS\nmeasurements among\nsatellites\n\n116 5 Optimal Control for Satellite Formation Keeping\n\n\n\nCollecting the equations for all satellites into a single system using Kronecker\nproduct, the system in (5.23) and (5.24) is represented as follows:\n\nx0\u00f0 f \u00de \u00bc In \t A\u00f0 f \u00de\u00f0 \u00dex\u00f0 f \u00de\u00fe In \t B\u00f0 f \u00de\u00f0 \u00deu\u00f0 f \u00de \u00f05:30\u00de\n\nu\u00f0 f \u00de \u00bc In \t K\u00f0 \u00de L\t I6\u00f0 \u00de xd\u00f0 f \u00de ? x\u00f0 f \u00de\n? ? \u00f05:31\u00de\n\nwhere\n\nx \u00bc x1; x2; . . .; xn\u00bd ?T ; xd \u00bc xd1 ; xd2; . . .; xdn\n? \tT\n\n; u \u00bc u1; u2; . . .; un\u00bd ?T\n\nand L is a Laplacian matrix presenting the topology of relative measurements\namong satellites in a formation and weight on each satellite for fuel balance, as\ndefined in (A.3).\n\nTheorem 5.1 Consider a satellite formation described by (5.23) with the control\nlaw in (5.24). Suppose Assumption 5.1 is valid and if the control gain K in (5.24)\ncan be chosen such that the following system is stable\n\nv0\u00f0 f \u00de \u00bc A\u00f0 f \u00de ? kiB\u00f0 f \u00deK\u00f0 \u00dev\u00f0 f \u00de 8i \u00bc 2; 3; . . .; n \u00f05:32\u00de\n\nwhere v are the state variable of appropriate dimensions. ki are nonzero eigen-\nvalues of L, the goal of formation control defined in (5.26) is achieved if and only If\nthe graph Gn representing the topology of the relative measurement among satellite\nin the formation has a directed spanning tree.\n\nFurthermore, the relative state of each satellite at steady state is given by, with\nxei \u00bc xdi ? xi\n\nxi;ss\u00f0 f \u00de \u00bc xdi \u00f0 f \u00de ?\nXn\ni\u00bc1\n\nviUA\u00f0 f \u00de\n !\n\nxei \u00f00\u00de; 8i \u00bc 1; 2; . . .; n \u00f05:33\u00de\n\nwhere v1; v2; . . .; vn\u00bd ? is the associated left eigenvector of L corresponding to zero\neigenvalue, and\n\nPn\ni\u00bc1 vi \u00bc 1; vi \n 0: UA\u00f0 f \u00de is the state transition matrix of the\n\nsystem in (5.23) without control input.\n\nProof Note that the systems described by (5.23) with the control law in (5.24) can\nbe represented in a single system in (5.30) with control law in (5.31) using the\nKronecker product. Substituting (5.31) into (5.30) yields\n\nx0\u00f0 f \u00de \u00bc In \t A\u00f0 f \u00de\u00f0 \u00dex\u00f0 f \u00de\u00fe In \t B\u00f0 f \u00deK\u00f0 \u00de L\t I6\u00f0 \u00de xd\u00f0 f \u00de ? x\u00f0 f \u00de\n? ? \u00f05:34\u00de\n\n5.3 Decentralized Formation Control Using Local Relative Measurements 117\n\n\n\nAssumption 5.1 implies\n\nx0d\u00f0 f \u00de \u00bc In \t A\u00f0 f \u00de\u00f0 \u00dexd\u00f0 f \u00de \u00f05:35\u00de\n\nDefine\n\nxe\u00f0 f \u00de \u00bc xd\u00f0 f \u00de ? x\u00f0 f \u00de \u00f05:36\u00de\n\nSubtracting (5.35) from (5.34) and using the definition in the above equation\nlead to\n\nx0e\u00f0 f \u00de \u00bc In \t A\u00f0 f \u00de\u00f0 \u00dexe\u00f0 f \u00de ? In \t B\u00f0 f \u00deK\u00f0 \u00de L\t I6\u00f0 \u00dexe\u00f0 f \u00de \u00f05:37\u00de\n\nLet T 2 Cn?n be Schur transformation of L, meaning the unitary matrix, such\nthat U \u00bc T?1LT is upper triangular with the eigenvalues of L along the diagonal.\nObviously, T \t I6 can transform L\t I6 into U \t I6 using Kronecker product\u2019s\nproperty A\t B\u00f0 \u00de C \t D\u00f0 \u00de \u00bc AC \t BD.\n\nT \t I6\u00f0 \u00de?1 L\t I6\u00f0 \u00de T \t I6\u00f0 \u00de \u00bc U \t I6 \u00f05:38\u00de\n\nLet ~x \u00bc T \t I6\u00f0 \u00dex, (5.37) is transformed into\n\n~x0e\u00f0 f \u00de \u00bc In \t A\u00f0 f \u00de\u00f0 \u00de~xe\u00f0 f \u00de ? U \t B\u00f0 f \u00deK\u00f0 \u00de\u00bd ?~xe\u00f0 f \u00de \u00f05:39\u00de\n\nNote that In \t A\u00f0 f \u00de is block diagonal matrix and U \t B\u00f0 f \u00deK is block upper\ntriangular matrix or block diagonal matrix with the diagonal block kiB\u00f0 f \u00deK, so the\nstability of the above complex systems is equivalent to the stability of the n sub-\nsystems in the diagonal blocks. Its n diagonal subsystems are of the form:\n\n~x0ei \u00f0 f \u00de \u00bc A\u00f0h\u00de~xei \u00f0 f \u00de ? kiB\u00f0 f \u00deK~xei \u00f0 f \u00de; i \u00bc 1; 2; . . .; n \u00f05:40\u00de\n\nAccording to Proposition A.4, if and only if the topology graph representing the\nrelative measurements between satellites has a spanning tree, then zero is an\neigenvalue of algebraic multiplicity one for the Laplacian L. So the Laplacian L can\nbe transformed into the following form:\n\n\u00f05:41\u00de\n\nwhere U?\u00f0n?1\u00de?\u00f0n?1\u00de is upper matrix with the diagonal entries of ki; i \u00bc 2; 3; . . .; n.\n\n118 5 Optimal Control for Satellite Formation Keeping\n\n\n\nBy using (5.41), the transformed system in (5.39) can be rewritten as\n\n( )\n\n( )\n( )\n\n( )\n( )( ) ( )\n\n( )\n\n( )\n\n6 6 6 6 6 66 6 6 6\n\n6 66 6\n\n6 6 6 6\n\n6 6 6 6\n\n6 6\n\n6 6\n\n0 0 00 0\n00\n\n\u02c6\n\n0 0\n\n0 0\n0\n\nU\n0\n\ne\n\nA f\nA f\n\nU B f K\nA f\n\nA f\n\nf\n\n\u00d7 \u00d7 \u00d7\u00d7 \u00d7\n\n\u00d7\u00d7\n\n\u00d7 \u00d7\n\n\u00d7 \u00d7\n\n\u00d7\n\n\u00d7\n\n?\n?\n\n= x\n\n\u00f05:42\u00de\n\nwhere U \u00bc In?1 \t A? U? \t \u00f0BK\u00de:\nThe state transition matrix of transformed system in (5.42) can be written as\n\nU~xe\u00f0 f \u00de \u00bc diag UA\u00f0 f \u00de;Uu\u00f0 f \u00de\u00f0 \u00de \u00f05:43\u00de\n\nIf the control gain K in (5.24) can be chosen such that the closed-loop system in\n(5.32) is stable, then\n\nlim\nf!1\n\nUu\u00f0 f \u00de \u00bc 0 \u00f05:44\u00de\n\nAccording to Proposition A.4, it is known that the first column of the unitary\nmatrix T is 1; 1; . . .; 1\u00bd ?Tn and the first row of the matrix T?1 is v1; v2; . . .; vn\u00bd ?.\nTransforming the state variable ~xe back into the original system yields\n\nxess\u00f0 f \u00de \u00bc T \t I6\u00f0 \u00de limt!1U~xe\u00f0 f \u00de T \t I6\u00f0 \u00de\n?1xe\u00f00\u00de\n\n\u00bc T \t I6\u00f0 \u00de diag UA\u00f0 f \u00de; 0; . . .; 0\u00f0 \u00de\u00f0 \u00de T \t I6\u00f0 \u00de?1xe\u00f00\u00de\n\n\u00bc 1; 1; . . .; 1\u00bd ?Tn\tI6\n? ?Xn\n\ni\u00bc1\nviUA\u00f0 f \u00dexei \u00f00\u00de\n? ? \u00f05:45\u00de\n\nwhere the subscript ss denotes steady-state variable.\nThat is\n\nxei;ss\u00f0 f \u00de \u00bc\nXn\ni\u00bc1\n\nviUA\u00f0 f \u00dexei \u00f00\u00de\n? ?\n\n; i \u00bc 1; 2; . . .; n \u00f05:46\u00de\n\nwhere\nPn\n\ni\u00bc1 vi \u00bc 1, and vi \n 0; i \u00bc 1; 2; . . .; n.\n\n5.3 Decentralized Formation Control Using Local Relative Measurements 119\n\n\n\nSo the relative state of each satellite at steady states is\n\nxi;ss\u00f0 f \u00de \u00bc xdi \u00f0 f \u00de ? xei;ss\u00f0 f \u00de \u00bc xdi \u00f0 f \u00de ?\nXn\ni\u00bc1\n\nviUA\u00f0 f \u00dexei \u00f00\u00de\n? ?\n\n; i \u00bc 1; 2; . . .; n\n\n\u00f05:47\u00de\n\nUsing the above equation leads to\n\nlim\nf!1\n\nDxi;j\u00f0 f \u00de \u00bc xj;ss f\u00f0 \u00de ? xi;ss\u00f0 f \u00de\n\n\u00bc xdj \u00f0 f \u00de ? xej;ss\u00f0 f \u00de\n? ?\n\n? xdi \u00f0 f \u00de ? xei;ss\u00f0 f \u00de\n? ?\n\n\u00bc xdj \u00f0 f \u00de ? xdi \u00f0 f \u00de\n\u00bc Dxdi;j\u00f0 f \u00de; 8i; j \u00bc 1; 2; . . .; n:\n\n\u00f05:48\u00de\n\nwhere Dxdj;i\u00f0 f \u00de is the desired relative state of the ith with respect to the jth satellite.\nAs concluded from (5.48), the goal of the formation defined in (5.26) is achieved. ?\n\nRemark 5.4 Observe that if there is a satellite i in the formation which cannot\nmeasure other satellite, then there will be no control input acting on this satellite. So\nthe relative state of the ith satellite with respect to the reference orbit is obtained as\nxi\u00f0 f \u00de \u00bc UA\u00f0 f \u00dexi\u00f00\u00de. Therefore, the other satellites will converge to xi\u00f0 f \u00de. That is\nvi \u00bc 1 and vk \u00bc 0; 8k 6\u00bc i.\n\nIn general, the initial state of a satellite contributes to the steady-state value if\nand only if the satellite has directed path to all the other satellites in the formation.\nThus, vi 6\u00bc 0 for any satellite which has directed paths to all the other satellites, and\nvi \u00bc 0 otherwise. As a special case, the initial state of each satellite in a formation\ncontributes to steady-state value if and only if the graph is strongly connected. The\nabove argument can be explained as follows. If there is no path from the jth to the\nmth satellite in the formation, it is impossible for xm\u00f0 f \u00de to be influenced by xj\u00f0 f \u00de.\nOn the other hand, if there is a path from the jth satellite to every other satellite, then\nxi\u00f0 f \u00de 8i 6\u00bc j, will be influenced by xj\u00f0 f \u00de.\n\nNext, the problem is to design state-feedback gain K such that the system in\n(5.32) is stable. The closed-loop system in (5.32) can be viewed as the following\nlinear parameter uncertain system with state-feedback control.\n\nv0\u00f0 f \u00de \u00bc A\u00f0 f \u00dev\u00f0 f \u00de ? kiB f\u00f0 \u00det\u00f0 f \u00de;\nt\u00f0 f \u00de \u00bc Kv\u00f0 f \u00de; 8i \u00bc 2; 3; . . .; n\n\n?\n\u00f05:49\u00de\n\nThe optimal guaranteed cost control law to be introduced in the next section is\nchosen to design the above state-feedback controller, because it can stabilize the\nlinear system (5.32) while minimizing a quadratic cost function. The choice of the\nweight matrices in the cost function is a trade-off between the fuel consumption and\nthe convergence rate.\n\n120 5 Optimal Control for Satellite Formation Keeping\n\n\n\n5.3.3 Optimal Guaranteed Cost Control Design\n\nIn this subsection, a state-feedback controller is designed using the optimal guar-\nanteed cost control for the system in (5.32). The optimal guaranteed cost control\nlaw can minimize the quadratic cost function while stabilizing the linear\nnorm-bounded uncertain system. The weight matrices in quadratic cost function are\nused to balance fuel consumption against convergence time. The optimal guaran-\nteed cost control is reviewed in Appendix B.\n\nNow the problem is making use of the optimal guaranteed cost control to design\na state-feedback controller that can asymptotically stabilize the system in (5.32) for\neach nonzero eigenvalue ki of L. So the LTV system with an uncertain parameter as\nin (5.49) needs to be written into the linear norm-bounded uncertain system in\n(A.4). For mildly elliptic reference orbit e? 0:1\u00f0 \u00de, it is valid for (5.49) to be written\nas linear norm-bounded uncertain system. For the case of e[ 0:1, it will be con-\nservative to express the time-varying part of the dynamics (5.49) as uncertainty. As\nseen from (2.83), the in-plane (x and y) and out-of-plane (z) motions are decoupled,\nso the controller for in plane and out-of-plane can be designed separately. The\ncontroller for in plane is designed firstly.\n\nIn order to rewrite time-varying system (5.49) into the linear norm-bounded\nuncertain system as in (A.4), the following variables are defined\n\nc \u00bc 2e sin f\n1\u00fe e cos f ; q \u00bc\n\ne cos f\n1\u00fe e cos f ; n \u00bc\n\n1\n\n1\u00fe e cos f\u00f0 \u00de4 \u00f05:50\u00de\n\nThen,\n\nc \u00bc crDr; q \u00bc qc \u00fe qrDq; n \u00bc nc \u00fe nrDn; k \u00bc kc \u00fe krDk \u00f05:51\u00de\n\nwhere Dr, Dq, Dn, and Dk are the uncertainties, cr, qr, nr, and kr are the known\nbounds of these uncertainties. qc, nc, and kc are the nominal values of q, n and k,\nand\n\nqc \u00bc\n?e2\n1? e2 ; qr \u00bc\n\ne\n1? e2 ; Drj j ? 1; Dq\n\n\n\n \n\n? 1; Dnj j ? 1; Dkj j ? 1\n\u00f05:52\u00de\n\nBy using (5.50) and (5.51), the in-plane part of the system in (5.49) can be\nexpressed as the following linear norm-bounded uncertain system:\n\nv0inf \u00bc ?Ain \u00feD?Ain\u00f0 \u00devin\u00f0 f \u00de\u00fe ?Bin \u00feD?Bin\u00f0 \u00detin\u00f0 f \u00de \u00f05:53\u00de\n\n5.3 Decentralized Formation Control Using Local Relative Measurements 121\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\n\n\nwhere ?Ain and D?Ain are nominal and uncertain parts of system matrix, ?Bin and D?Bin\nare nominal and uncertain parts of input matrix, and\n\n?Ain \u00bc\n0 3? 2qc 2 0\n1 0 0 0\n?2 0 0 qc\n0 0 1 0\n\n2\n664\n\n3\n775; D?Ain \u00bc\n\ncrDr ?2qrDq 0 ?crDr\n0 0 0 0\n0 crDr crDr qrDq\n0 0 0 0\n\n2\n664\n\n3\n775\n\n\u00f05:54\u00de\n\n:\n\n?Bin \u00bc ?kcnc\u00f01? e\n2\u00de3\n\nn2\n\n1 0\n\n0 0\n\n0 1\n\n0 0\n\n2\n6664\n\n3\n7775;\n\nD?Bin \u00bc krncDk \u00fe kcnrDn \u00fe krnrDkDn\u00f0 \u00de\u00f01? e\n2\u00de3\n\nn2\n\n1 0\n\n0 0\n\n0 1\n\n0 0\n\n2\n6664\n\n3\n7775:\n\n\u00f05:55\u00de\n\nand D?Ain, D?Bin are written as the following form:\n\nD?Ain D?Bin\n? \t \u00bc DinFin E1;in E2;in\u00bd ? \u00f05:56\u00de\n\nand\n\nDin \u00bc D1;in D2;in\u00bd ? \u00f05:57\u00de\n\nD1;in \u00bc\ncr ?cr 0 0 ?2qr 0\n0 0 0 0 0 0\n0 0 cr cr 0 qr\n0 0 0 0 0 0\n\n2\n664\n\n3\n775 \u00f05:58\u00de\n\nD2;in \u00bc \u00f01? e\n2\u00de3\n\nn2\n\nkrnc 0 kcnr 0 krnr 0\n0 0 0 0 0 0\n0 krnc 0 kcnr 0 krnr\n0 0 0 0 0 0\n\n2\n664\n\n3\n775 \u00f05:59\u00de\n\nE1;in \u00bc E?1;in06?4\n\n? ?\n; E?1;in \u00bc\n\n1 0 0 0 0 0\n0 0 1 0 1 0\n0 0 0 1 0 0\n0 1 0 0 0 1\n\n2\n664\n\n3\n775\nT\n\n\u00f05:60\u00de\n\n122 5 Optimal Control for Satellite Formation Keeping\n\n\n\nE2;in \u00bc 06?2E?2;in\n? ?\n\n; E?2;in \u00bc 1 0 1 0 1 00 1 0 1 0 1\n? ?T\n\n\u00f05:61\u00de\n\nFin \u00bc diag Dc;Dc;Dc;Dc;Dq;Dq;Dk;Dk;Dn;Dn;DkDn;DkDn\n\n ?\n\n; FTinFin ? I;\n\u00f05:62\u00de\n\nwith Fin denoting the uncertainty.\nThe out-of-plane part of the system in (5.49) can also be expressed as the\n\nfollowing linear norm-bounded uncertain system.\n\nv0out\u00f0 f \u00de \u00bc ?Aout \u00feD?Aout\u00f0 \u00devout\u00f0 f \u00de\u00fe ?Bout \u00feD?Bout\u00f0 \u00detout\u00f0 f \u00de \u00f05:63\u00de\n\nwhere\n\n?Aout \u00bc 0 ?11 0\n? ?\n\n; D?Aout \u00bc crDr qrDq0 0\n? ?\n\n\u00f05:64\u00de\n\n?Bout \u00bc ?kcnc\u00f01? e\n2\u00de3\n\nn2\n1\n0\n\n? ?\n;\n\nD?Bout \u00bc krncDk \u00fe kcnrDn \u00fe krnrDkDn\u00f0 \u00de\u00f01? e\n2\u00de3\n\nn2\n1\n0\n\n? ? \u00f05:65\u00de\n\nand D?Aout, D?Bout are written as the following form:\n\nD?Aout D?Bout\n? \t \u00bc DoutFout E1;out E2;out\u00bd ? \u00f05:66\u00de\n\nand\n\nDout \u00bc D1;out D2;out\u00bd ?; D1;out \u00bc cr qr0 0\n? ?\n\n;\n\nD2;out \u00bc \u00f01? e\n2\u00de3\n\nn2\nkrnc kcnr krnr\n0 0 0\n\n? ? \u00f05:67\u00de\n\nE1;out \u00bc 1 0 0 0 00 1 0 0 0\n? ?T\n\n; E2;out \u00bc 0 0 1 1 1\u00bd ?T \u00f05:68\u00de\n\nFout \u00bc diag Dc;Dq;Dk;Dn;DkDn\n\n ?\n\n; FToutFout ? I \u00f05:69\u00de\n\nThen, the state-feedback control gain for the norm-bounded uncertain systems in\n(5.53) and (5.63) can be designed using the optimal guaranteed cost control.\n\n5.3 Decentralized Formation Control Using Local Relative Measurements 123\n\n\n\n5.3.4 Simulation Results\n\nIn this section, simulations using STK and MATLAB demonstrate the performance\nof the proposed decentralized formation control for satellite formation. For illus-\ntration, two scenarios of keeping a circular formation and an in-plane formation are\nconsidered. It is assumed that their corresponding relative measurement topologies\nare undirected cyclic and line topology, respectively, as shown in Fig. 5.11. In the\nprocess of simulation, the control accelerations are calculated in MATLAB using\ndata transmitted from STK via STK connect. The motion of each satellite is\npropagated through STK real-time propagator with J2, J3, and J4 perturbations.\n\n5.3.4.1 Circular Formation\n\nFor the desired circular formation, it is assumed that there are six satellites evenly\nspaced in a circle with radius of 1000 m. The desired initial relative position and\nvelocity of each satellite in local LVLH frame in order to form a circular formation\nare given by (5.70) (Inalhan et al. 2002; Pencil et al. 2004). The desired relative\nposition and velocity of each satellite are then obtained by solving the relative\ndynamics in (2.83) with desired initial conditions.\n\n#1 \u00bc 0?; #2 \u00bc 60?; #3 \u00bc 120?; #4 \u00bc 180?; #5 \u00bc 240?; #6 \u00bc 300?;\nxdi;0 \u00bc R=2\u00f0 \u00de cos#i; x0di;0 \u00bc R=2\u00f0 \u00de sin#i;\nydi;0 \u00bc 2x0i;0; y0di;0 \u00bc ?\u00f02\u00fe e\u00de=\u00f01\u00fe e\u00dexdi;0;\nzdi;0 \u00bc\n\nffiffiffi\n3\n\np\nxi;0; z0di;0 \u00bc\n\nffiffiffi\n3\n\np\nx0di;0; 8i \u00bc 1; 2; . . .; 6\n\n8>><\n>>:\n\n\u00f05:70\u00de\n\nFig. 5.11 Topologies of local relative measurements between formation satellites in LVLH frame.\na Cyclic topology for circular formation. b Line topology for in-plane formation\n\n124 5 Optimal Control for Satellite Formation Keeping\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_2\n\n\nThe actual initial relative positions and velocities for the six satellites in the test\nscenario have initial errors as compared to the desired relative state, as given below:\n\nx1;0 \u00bc 1:4xd1;0; x2;0 \u00bc 1:2xd2;0; x3;0 \u00bc 0:8xd3;0; x4;0 \u00bc 0:6xd4;0;\nx5;0 \u00bc 0:8xd5;0; x6;0 \u00bc 1:2xd6;0\n\n\u00f05:71\u00de\n\nThe reference orbit is characterized by the following orbit elements:\n\na \u00bc 7350 km; e \u00bc 0:01; i \u00bc 45?; - \u00bc 30?; X \u00bc 45?; h \u00bc 0? \u00f05:72\u00de\n\nThe minimum and maximum nonzero eigenvalues of LG are kmin \u00bc 1, kmax \u00bc 4,\nrespectively, since there are 6 satellites in the formation in the test scenario. The\nweight scalars for fuel balance among satellites is chosen as ri \u00bc 1. The choice of\nthe state-feedback control gain, which is subject to the available maximum thrust, is\na trade-off between fuel consumption and convergence rate. In order to save fuel\nconsumption, quadratic performance weight matrices in (A.12) are chosen as ?Q \u00bc\nI3 and ?R \u00bc 1010I3.\n\nFig. 5.12 Satellite motion under decentralized formation control and simulated with STK and\nMATLAB\n\n5.3 Decentralized Formation Control Using Local Relative Measurements 125\n\n\n\nThe satellite motion under the decentralized formation control is shown in\nFig. 5.12. As illustrated from this figure, the geometry center of the circular for-\nmation deviates from the reference orbit, because the relative state of each satellite\nwith respect to other satellites rather than the one with respect to the reference orbit\nneeds to be controlled. Figure 5.13 shows the formation error ei;j \u00bc Dxei;j between\nthe ith and jth satellite. For ease of interpretation, the horizontal axis is described by\ntime instead of true anomaly. As observed from this figure, the convergence time of\nformation control is 355 s assuming tolerant relative error is 1 %. Figure 5.14\nshows the control acceleration of each satellite.\n\n5.3.4.2 In-Plane Formation\n\nFor the desired line formation, it is assumed that there are five satellites are evenly\nspaced in the in-track direction with separation of 1000 m. The desired relative\nposition and velocity of each satellite are obtained using the method in Pencil et al.\n(2004). The actual initial relative positions and velocities for the six satellites in the\ntest scenario have initial errors as compared to the desired relative state. The\nsatellite motion under the decentralized formation control is shown in Fig. 5.15,\nwhere the lines are maneuver trajectories. As can be seen from this figure, the\ndesired in-plane formation is maintained from random positions.\n\nFig. 5.13 Formation errors among satellites under decentralized formation control\n\n126 5 Optimal Control for Satellite Formation Keeping\n\n\n\n5.4 Conclusions\n\nIn this chapter, two different kinds of continuous formation keeping approaches are\nproposed. Firstly, a real-time fuel-optimal control approach in the leader\u2013follower\nframe is proposed to keep the formation against various orbital perturbations.\nControl saturation problem for low-thrust propulsion system is considered in the\noptimization problem. The resulting optimal control problem is then converted into\na quadratic programming problem by application of Legendre pseudospectral\nmethod. To solve the smooth optimal control problem, Legendre pseudospectral\nmethod has two advantages over other numerical methods: improved accuracy and\nfaster convergence rate which makes real-time optimal control feasible. Simulation\nresults demonstrate the effectiveness of the proposed methodology for formation\nkeeping problems.\n\nFig. 5.14 Control acceleration of each satellite under decentralized formation control\n\n5.4 Conclusions 127\n\n\n\nSecondly, an efficient decentralized formation control method is presented in this\nchapter for satellite formation in mildly elliptic orbits using only local relative\nmeasurements. The desired formation is formulated as a general directed topology\nwhere the resulting graph has a spanning tree due to the availability of measurement\nbetween pairs of neighboring satellites. The goal of formation control for n satellites\nis achieved if the state-feedback controller stabilizes a system described by relative\ndynamics, differentiated by a scalar parameter. This scalar parameter takes values of\nthe nonzero eigenvalues of a Laplacian matrix L representing the topology of\nrelative measurements among the satellites. The proposed decentralized formation\ncontrol architecture is completely decentralized and scalable. No infrastructure for\nfull collaboration and communication among the formation satellites is required in\nthe proposed scheme. Simulation results demonstrate the effectiveness of the pro-\nposed methodology for satellite formation control.\n\nFig. 5.15 Satellite motion under decentralized formation control to maintain in-plane formation\n\n128 5 Optimal Control for Satellite Formation Keeping\n\n\n\nReferences\n\nAlonso R, Crassidis J, Junkins J (2000) Vision-based relative navigation for formation flying of\nspacecraft. In: AIAA guidance, navigation, and control conference and exhibit, Denver, CO.\ndoi:10.2514/6.2000-4439\n\nBeard RW, Lawton J, Hadaegh FY (2001) A coordination architecture for spacecraft formation\ncontrol. IEEE Trans Control Syst Technol 9(6):777\u2013790. doi:10.1109/87.960341\n\nBelanger GM, Ananyev S, Speyer JL, Chichka DF, Carpenter JR (2006) Decentralized control of\nsatellite clusters under limited communication. J Guid Control Dyn 29(1):134\u2013145. doi:10.\n2514/1.13233\n\nBreger L, How JP (2007) Gauss\u2019s variational equation-based dynamics and control for formation\nflying spacecraft. J Guid Control Dyn 30(2):437\u2013448. doi:10.2514/1.22649\n\nBusse F, How J (2002) Real-time experimental demonstration of precise decentralized relative\nnavigation for formation flying spacecraft. In: AIAA guidance, navigation, and control\nconference, Reston, VA. doi:10.2514/6.2002-5003\n\nCap\u00f3-Lugo PA, Bainum PM (2007) Active control schemes to satisfy separation distance\nconstraints. J Guid Control Dyn 30(4):1152\u20131156. doi:10.2514/1.24371\n\nCarpenter JR (2002) Decentralized control of satellite formations. Int J Robust Nonlinear Control\n12(2\u20133):141\u2013161. doi:10.1002/rnc.680\n\nChung SJ, Ahsun U, Slotine JJE (2009) Application of synchronization to formation flying\nspacecraft: Lagrangian approach. J Guid Control Dyn 32(2):512\u2013526. doi:10.2514/1.37261\n\nDe Queiroz MS, Kapila V, Yan Q (2000) Adaptive nonlinear control of multiple spacecraft\nformation flying. J Guid Control Dyn 23(3):385\u2013390. doi:10.2514/2.4549\n\nFax JA, Murray RM (2004) Information flow and cooperative control of vehicle formations. IEEE\nTrans Autom Control 49(9):1465\u20131476. doi:10.1109/TAC.2004.834433\n\nGurfil P, Mishne D (2007) Cyclic spacecraft formations: relative motion control using line-of-sight\nmeasurements only. J Guid Control Dyn 30(1):214\u2013226. doi:10.2514/1.19850\n\nGurfil P, Idan M, Kasdin J (2002) Neurocontrol of spacecraft formation flying in the elliptic\nrestricted three-body problem. J Guid Control Dyn 26(3):466\u2013475\n\nHorn RA, Johnson CR (1991) Topics in matrix analysis. ZAMM J Appl Math Mech/Zeitschrift f\u00fcr\nAngewandte Mathematik und Mechanik 72(12):242\u2013254. doi:10.1002/zamm.19920721231\n\nInalhan G, Tillerson M, How JP (2002) Relative dynamics and control of spacecraft formations in\neccentric orbits. J Guid Control Dyn 25(1):48\u201359. doi:10.2514/2.4874\n\nKapila V, Sparks AG, Buffington JM, Yan Q (2000) Spacecraft formation flying: dynamics and\ncontrol. J Guid Control Dyn 23(3):561\u2013564. doi:10.2514/2.4567\n\nLavaei J, Momeni A, Aghdam AG (2008) A model predictive decentralized control scheme with\nreduced communication requirement for spacecraft formation. Trans Control Syst Technol 16\n(2):268\u2013278. doi:10.1109/TCST.2007.903389\n\nLiu X, Kumar KD (2012) Network-based tracking control of spacecraft formation flying with\ncommunication delays. IEEE Trans Aerosp Electron Syst 48(3):2302\u20132314. doi:10.1109/\nTAES.2012.6237593\n\nMassey TE, Shtessel YB (2005) Continuous traditional and high-order sliding modes for satellite\nformation control. J Guid Control Dyn 28(4):826\u2013831. doi:10.2514/1.14126\n\nMayne DQ, Rawlings JB, Rao CV, Scokaert POM (2000) Constrained model predictive control:\nstability and optimality. Automatica 36(6):789\u2013814. doi:10.1016/S0005-1098(99)00214-9\n\nMesbahi M, Hadaegh FY (2001) Formation flying control of multiple spacecraft via graphs, matrix\ninequalities, and switching. J Guid Control Dyn 24(2):369\u2013377. doi:10.2514/2.4721\n\nMin H, Wang S, Sun F, Gao Z, Wang Y (2011) Distributed six degree-of-freedom spacecraft\nformation control with possible switching topology. Control Theory Appl 5(9):1120\u20131130.\ndoi:10.1049/iet-cta.2010.0139\n\nPencil EJ, Kamhawi H, Arrington LA (2004) Overview of NASA\u2019s pulsed plasma thruster\ndevelopment program. In: AIAA/ASME/SAE/ASEE joint propulsion conference and exhibit,\nFort Lauderdale, FL, USA\n\nReferences 129\n\nhttp://dx.doi.org/10.2514/6.2000-4439\nhttp://dx.doi.org/10.1109/87.960341\nhttp://dx.doi.org/10.2514/1.13233\nhttp://dx.doi.org/10.2514/1.13233\nhttp://dx.doi.org/10.2514/1.22649\nhttp://dx.doi.org/10.2514/6.2002-5003\nhttp://dx.doi.org/10.2514/1.24371\nhttp://dx.doi.org/10.1002/rnc.680\nhttp://dx.doi.org/10.2514/1.37261\nhttp://dx.doi.org/10.2514/2.4549\nhttp://dx.doi.org/10.1109/TAC.2004.834433\nhttp://dx.doi.org/10.2514/1.19850\nhttp://dx.doi.org/10.1002/zamm.19920721231\nhttp://dx.doi.org/10.2514/2.4874\nhttp://dx.doi.org/10.2514/2.4567\nhttp://dx.doi.org/10.1109/TCST.2007.903389\nhttp://dx.doi.org/10.1109/TAES.2012.6237593\nhttp://dx.doi.org/10.1109/TAES.2012.6237593\nhttp://dx.doi.org/10.2514/1.14126\nhttp://dx.doi.org/10.1016/S0005-1098(99)00214-9\nhttp://dx.doi.org/10.2514/2.4721\nhttp://dx.doi.org/10.1049/iet-cta.2010.0139\n\n\nRamirez-Riberos JL, Pavone M, Frazzoli E, Miller DW (2010) Distributed control of spacecraft\nformations via cyclic pursuit: theory and experiments. J Guid Control Dyn 33(5):1655\u20131669.\ndoi:10.2514/1.46511\n\nRedding DC, Adams NJ, Kubiak ET (1989) Linear-quadratic stationkeeping for the STS orbiter.\nJ Guid Control Dyn 12(2):248\u2013255. doi:10.2514/3.20398\n\nRen W (2007) Formation keeping and attitude alignment for multiple spacecraft through local\ninteractions. J Guid Control Dyn 30(2):633\u2013638. doi:10.2514/1.25629\n\nRen W, Atkins E (2007) Distributed multi-vehicle coordinated control via local information\nexchange. Int J Robust Nonlinear Control 17(10\u201311):1002\u20131033. doi:10.1002/rnc.1147\n\nRen W, Beard R (2004) Decentralized scheme for spacecraft formation flying via the virtual\nstructure approach. J Guid Control Dyn 27(1):73\u201382. doi:10.2514/1.9287\n\nSabol C, Burns R, McLaughlin CA (2001) Satellite formation flying design and evolution.\nJ Spacecr Rocket 38(2):270\u2013278. doi:10.2514/2.3681\n\nScharf DP, Hadaegh FY, Ploen SR (2004) A survey of spacecraft formation flying guidance and\ncontrol (Part II): control. In: Proceedings of the 2004 American control conference, Boston,\nMA, USA, pp 2976\u20132985\n\nShan J (2008) Six-degree-of-freedom synchronised adaptive learning control for spacecraft\nformation flying. Control Theory and Appl 2(10):930\u2013949. doi:10.1049/iet-cta:20080063\n\nSmith RS, Hadaegh FY (2005) Control of deep-space formation-flying spacecraft; relative sensing\nand switched information. J Guid Control Dyn 28(1):106\u2013114. doi:10.2514/1.6165\n\nSubbarao K, Welsh SJ (2008) Nonlinear control of motion synchronization for satellite proximity\noperations. J Guid Control Dyn 31(5):1284\u20131294. doi:10.2514/1.34248\n\nVassar RH, Sherwood RB (1985) Formationkeeping for a pair of satellites in a circular orbit.\nJ Guid Control Dyn 8(2):235\u2013242. doi:10.2514/3.19965\n\nVignal P, Pernicka H (2006) Low-thrust spacecraft formation keeping. J Spacecr Rocket 43\n(2):466\u2013475. doi:10.2514/1.11117\n\nWang J, Liang H, Sun Z, Zhang S, Liu M (2012) Finite-time control for spacecraft formation with\ndual-number-based description. J Guid Control Dyn 35(3):950\u2013962. doi:10.2514/1.54277\n\nWu B, Poh EK, Wang D, Xu G (2009) Satellite formation keeping via real-time optimal control\nand iterative learning control. In: IEEE aerospace conference, Big Sky, MT, USA, pp 1\u20138.\ndoi:10.1109/AERO.2009.4839333\n\nWu B, Wang D, Poh EK (2010) Decentralized control for satellite formation using local relative\nmeasurements only. In: the 8th IEEE international conference on control and automation,\nXiamen, China, pp 661\u2013666. doi:10.1109/ICCA.2010.5524080\n\nWu B, Wang D, Poh EK (2012) Cyclic formation control for satellite formation using local relative\nmeasurements. Control Intell Syst 40(1):11\u201321. doi:10.2316/Journal.201.2012.1.201-2308\n\nWu B, Xu G, Cao X (2016) Relative dynamics and control for satellite formation: accommodating\nJ2 perturbation. J Aerosp Eng 4016011. doi:10.1061/(ASCE)AS.1943-5525.0000600\n\nYeh HH, Nelson E, Sparks A (2002) Nonlinear tracking control for satellite formations. J Guid\nControl Dyn 25(2):376\u2013386. doi:10.2514/2.4892\n\n130 5 Optimal Control for Satellite Formation Keeping\n\nhttp://dx.doi.org/10.2514/1.46511\nhttp://dx.doi.org/10.2514/3.20398\nhttp://dx.doi.org/10.2514/1.25629\nhttp://dx.doi.org/10.1002/rnc.1147\nhttp://dx.doi.org/10.2514/1.9287\nhttp://dx.doi.org/10.2514/2.3681\nhttp://dx.doi.org/10.1049/iet-cta:20080063\nhttp://dx.doi.org/10.2514/1.6165\nhttp://dx.doi.org/10.2514/1.34248\nhttp://dx.doi.org/10.2514/3.19965\nhttp://dx.doi.org/10.2514/1.11117\nhttp://dx.doi.org/10.2514/1.54277\nhttp://dx.doi.org/10.1109/AERO.2009.4839333\nhttp://dx.doi.org/10.1109/ICCA.2010.5524080\nhttp://dx.doi.org/10.2316/Journal.201.2012.1.201-2308\nhttp://dx.doi.org/10.1061/(ASCE)AS.1943-5525.0000600\nhttp://dx.doi.org/10.2514/2.4892\n\n\nChapter 6\nDecentralized Control for Attitude\nSynchronization Under Undirected\nCommunication Topology\n\nThis chapter developed two decentralized coordinated attitude control laws for\nattitude synchronization and tracking problem with undirected (it is also named\nbidirectional) inter-satellite communication topology. Firstly, an adaptive sliding\nmode control law is developed against inertia matrix uncertainties and external\ndisturbances. The proposed control law is based on the proposed multi-satellite\nsliding mode vector, on which each satellite approaches its desired time-varying\nattitude and angular velocity while achieving attitude synchronization among\nsatellites in the formation. The first control law requires that each satellite knows its\nown angular velocity and the angular velocities of other satellites it can commu-\nnicate with. However, angular velocity is not always available, because of either\ncost limitations or implementation considerations. As a remedy to such situation, a\ncoordinated attitude control law without angular velocity measurements is then\nproposed. Passivity approach is deployed to remove the requirements for angular\nvelocity measurements. The only assumption on communication topology for the\nproposed control laws is that the communication links are undirected. The stability\nof the resulting closed-loop systems is proved by virtue of Barbalat\u2019s Lemma.\nSimulation results demonstrate the effectiveness of the proposed attitude synchro-\nnization and tracking approaches.\n\n6.1 Introduction\n\nTheneed tomaintain accurate relative orientationbetween spacecraft is critical inmany\nsatellite formation missions. For instance, in interferometry application, the relative\norientation between spacecraft in a formation is required to be maintained precisely\nduring formation maneuvers. In inter-spacecraft laser communication operation, the\nparticipating spacecraft are also required to maintain accurate relative attitude\nthroughout the communication process. This control problem, commonly referred to as\nattitude synchronization in the literature, has attracted much research attention.\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_6\n\n131\n\n\n\nVarious approaches have been proposed to investigate the problem of attitude\nsynchronization. These solutions can be roughly categorized into four main\napproaches: leader-follower approach (Subbarao and Welsh 2008; Wang et al.\n1999; Kang and Yeh 2002; Kristiansen et al. 2009), virtual structure approach\n(Beard et al. 2001; Ren and Beard 2004), behavior-based approach (Shan 2008;\nChung et al. 2009; Lawton and Beard 2002; VanDyke and Hall 2006; Jin et al.\n2008; Jin and Sun 2009), and graph-theoretical approach (Ren 2007a, b; Bai et al.\n2008; Dimarogonas et al. 2009; Zou and Kumar 2012, 2013; Wu et al. 2014; Li and\nKumar 2012; Zhou et al. 2013).\n\nA leader-follower approach was deployed for attitude synchronization in\nSubbarao and Welsh (2008), Wang et al. (1999), Kang and Yeh (2002), Kristiansen\net al. (2009), where the followers maintain the relative attitude with respect to the\nleader. But, as mentioned earlier, the leader-follower approach is a centralized\ncontrol law, and the leader is a single point of failure for the formation. Centralized\nand decentralized implementations of a virtual structure coordination strategy were\npresented for attitude synchronization in Beard et al. (2001) and Ren and Beard\n(2004), respectively. In Shan (2008), Chung et al. (2009), Lawton and Beard\n(2002), VanDyke and Hall (2006), Jin et al. (2008), Jin and Sun (2009), a\nbehavioral approach was used for attitude synchronization. In the behavior-based\napproach, each satellite has several basic behaviors, such as station-keeping and\nformation keeping. Each behavior generates a control input, and the control action\nfor each satellite is a weighted average of control for each behavior. The behavioral\napproach lends itself naturally to a decentralized implementation. Graph-theoretical\napproach has been actively studied for cooperative control of multi-agent system\nusing limited local interaction (Lawton et al. 2003; Fax and Murray 2004;\nJadbabaie et al. 2003; Ren and Atkins 2007; Lafferriere et al. 2005; Khoo et al.\n2009), and it has been investigated for attitude synchronization problem in Ren\n(2007a, b), Bai et al. (2008), Dimarogonas et al. (2009), Zou and Kumar 2012,\n2013, Wu et al. (2014), Li and Kumar (2012) and Zhou et al. (2013).\n\nThe above-cited coordinated attitude control approaches were based on an\nassumption that each satellite knows it own angular velocity and the angular velocity\nof its neighbor. However, this assumption is not always satisfied, because of either\ncost limitations or implementation considerations. As a remedy to such situation,\nseveral researchers (Kristiansen et al. 2009; Lawton and Beard 2002; Ren 2009;\nAbdessameud and Tayebi 2009) proposed passivity-based attitude synchronization\napproaches without using angular velocity measurements. Lawton and Beard (2002)\npresented an attitude alignment law by use of passivity-based damping. However,\nthe result in Lawton and Beard (2002) requires a bidirectional ring communication\ntopology and relies on a restrictive domain of attraction for convergence analysis.\nRen (2009) proposed a velocity-free distributed attitude synchronization approach\nby use of Modified Rodrigues Parameters for attitude representation. Minimal rep-\nresentation of attitude dynamics, such as Modified Rodrigues Parameters or Euler\nangles, contains singularities and is hence not suited for the design of globally\nstabilizing control algorithms. Kristiansen et al. (2009) presented a leader-follower\napproach for relative attitude tracking using feedback from attitude measurements\n\n132 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nonly. However, the leader-follower approach is a centralized controller, and the\nleader satellite is a single point of failure for the formation. Abdessameud and Tayebi\n(2009) proposed an attitude synchronization approach without velocity measure-\nments using unit quaternion. The result in Abdessameud and Tayebi (2009) consists\nof associating an auxiliary nonlinear dynamic system to each satellite and to each\npair of satellites with a communication link in order to recover and generate the\nnecessary damping. Thus, this approach requires a lot of computation to solve\nauxiliary variables from those auxiliary nonlinear dynamic systems, especially when\nthere are many communication links in a formation.\n\nIn the above decentralized attitude synchronization results, except Ren and Atkins\n(2007) andRen (2010), it was assumed that the inter-satellite communication links are\nundirected (i.e., bidirectional). However, in practice, the inter-satellite communica-\ntion topology may be restricted to be directed, such as in unidirectional satellite laser\ncommunication system. The control problem of attitude synchronization under\ndirected communication topology is more challenging as compared to the case with\nundirected communication topology. This issue was studied in Ren andAtkins (2007)\nbut the proposed control law requires derivative of the angular velocity, which may\nintroduce additional noise into the system. Furthermore, the attitude tracking per-\nformance analysis in Ren and Atkins (2007) is applicable only to the case where the\ndirected graph can be simplified to a graph with only one node. This constraint on\ncommunication topology is relaxed in Ren (2010), which uses Modified Rodrigues\nParameters and Euler\u2013Lagrange system to describe the satellite attitude dynamics.\nHowever, Modified Rodrigues Parameters contain singularity and are thus not suit-\nable for the development of globally stabilizing control algorithms.\n\n6.2 Satellite Attitude Dynamics\n\nThe rigid satellite attitude dynamics is described in this section. For the details,\nplease refer to Wertz (1978). The unit quaternion, ?g, represents the orientation of a\nbody-fixed frame B with respect to an inertial frame I and is defined as\n\n?g \u00bc\ncos\n\nu\n2\n\n? ?\ne sin\n\nu\n2\n\n? ?\n2\n64\n\n3\n75 \u00bc g0g\n\n? ?\n\u00f06:1\u00de\n\nwhere e is the Euler axis, u is the Euler angle, g 2 R3; g0 2 R are the vector part and\nscalar part of the quaternion ?g, respectively, and satisfy the following constraint.\n\ngTg\u00fe g20 \u00bc 1 \u00f06:2\u00de\n\n6.1 Introduction 133\n\n\n\nThe product of two unit quaternion ?g1 and ?g2 is defined by\n\n?g1?g2 \u00bc\ng0;1g2 \u00fe g0;2g1 \u00fe g?1 g2\n\ng0;1g0;2 ? gT1g2\n\n? ?\n\u00f06:3\u00de\n\nwhich is also a unit quaternion. The notation a? for a vector a \u00bc \u00bd a1 a2 a3 ?T is\nused to denote the skew-symmetric matrix.\n\na? \u00bc\n0 ?a3 a2\na3 0 ?a1\n?a2 a1 0\n\n2\n4\n\n3\n5 \u00f06:4\u00de\n\nwhich satisfies the following important properties\n\na?b \u00bc ?b?a; a?a \u00bc 0; aTb?a \u00bc 0\na?b? \u00bc baT ? aTbI3; a?b\u00f0 \u00de?\u00bc baT ? abT\n\n\u00f06:5\u00de\n\nThe conjugate of the unit quaternion ?g is defined by ?g? \u00bc g0;?gT\u00bd ?T .\nThe dynamic and kinematic equations of a rigid satellite are described, respec-\n\ntively, as\n\nJ _x \u00bc ?x?Jx\u00fe u\u00fe d \u00f06:6\u00de\n\nand\n\n_g \u00bc 1\n2\n\ng? \u00fe g0I3\u00f0 \u00dex \u00f06:7\u00de\n\n_g0 \u00bc ?\n1\n2\ngTx \u00f06:8\u00de\n\nwhere x 2 R3 denotes the angular velocity of satellite with respect to an inertial\nframe I and expressed in the body-fixed frame B,\n\nJ \u00bc\nJ11 J12 J13\nJ12 J22 J23\nJ13 J23 J33\n\n2\n4\n\n3\n5 \u00f06:9\u00de\n\nis the constant, positive definite inertia matrix of the satellite and expressed in the\nbody-fixed frame B, u 2 R3 denotes the vector of control torque, d 2 R3 denotes\nthe vector of external disturbances, I3 denotes a 3? 3 identity matrix.\n\n134 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nIn the case of tracking a desired attitude motion, the attitude tracking problem is\nformulated similarly as in the related work (Ahmed et al. 1998; Luo et al. 2005).\nThe desired motion of the satellite is specified by the attitude of the reference frame\nD. The target attitude of the satellite in the reference frame D with respect to the\n\ninertial frame I is described by unit quaternion ?gd \u00bc gd0 ; \u00f0gd\u00deT\n? ?T\n\nwhich satisfies\n\n\u00f0gd\u00deTgd \u00fe\u00f0gd0\u00de2 \u00bc 1. Let xd 2 R3 be the desired angular velocity of reference\nframe D with respect to the inertial frame I. The following assumptions are made\nabout xd and _xd .\n\nAssumption 6.1 The desired angular velocity xd and its derivative _xd are bounded\nfor all t? 0, i.e., there exists some finite constants c1 [ 0 and c2 [ 0 such that\nxdk k? c1 and _xdk k? c2 for all t? 0.\nLet error quaternion ?q \u00bc q0; qT\u00bd ?T represent the orientation error of the\n\nbody-fixed frame B with respect to the reference frame D and satisfies\nqTq\u00fe q20 \u00bc 1. ?q is related to ?gd and ?g by quaternion multiplication ?q \u00bc ?gd\n\n? \t?\n?g. The\n\nangular velocity error ~x of frame B with respect to frame D is then represented by\n~x \u00bc x? R ?q\u00f0 \u00dexd;R ?q\u00f0 \u00de 2 SO 3\u00f0 \u00de is the rotation matrix from the reference frame\nD to the body-fixed frame B and is given by\n\nR ?q\u00f0 \u00de \u00bc q20 ? qTq\n? \t\n\nI3 \u00fe 2qqT ? 2q0q? \u00f06:10\u00de\n\nwhere SO 3\u00f0 \u00de is the Lie group of orthogonal matrices with determinant 1. It follows\nfrom Wertz (1978) that RTR \u00bc 1; Rk k \u00bc 1; det R\u00f0 \u00de \u00bc 1 and _R ?q\u00f0 \u00de \u00bc ?~x?R ?q\u00f0 \u00de. Note\nthat both ?q and ??q stand for exactly the same physical attitude orientation, resulting\nin the same R ?q\u00f0 \u00de 2 SO 3\u00f0 \u00de.\n\nThe rigid satellite attitude tracking error dynamics is described in Wertz (1978)\nand Ahmed et al. (1998).\n\nJi _~xi \u00bc ?x?i Jixi \u00fe Ji ~x?i R ?qi\u00f0 \u00dexd ? R ?qi\u00f0 \u00de _xd\n? \t\u00fe ui \u00fe di; i \u00bc 1; . . .; n \u00f06:11\u00de\n\n_qi \u00bc 12 q\n?\ni \u00fe q0iI\n\n? \t\n~xi ,\n\n1\n2\nS ?qi\u00f0 \u00de~xi; i \u00bc 1; . . .; n \u00f06:12\u00de\n\n_q0i \u00bc ? 12 q\nT\ni ~xi; i \u00bc 1; . . .; n \u00f06:13\u00de\n\nwhere superscript i denotes the ith satellite in a formation.\nThe attitude tracking problem of the ith satellite is solved if limt!1 qi t\u00f0 \u00de ! 0\n\nand limt!1 ~xi t\u00f0 \u00de ! 0. It can be seen from (6.11) to (6.13) that the satellite attitude\ntracking problem is equivalent to an asymptotic stabilization problem for ~xi and qi.\n\n6.2 Satellite Attitude Dynamics 135\n\n\n\n6.3 Problem Formulation of Attitude Synchronization\n\nThere are two objectives in attitude synchronization and tracking problem. The first\nobjective is to rotate each individual satellite to its desired attitude and angular\nvelocity. This behavior is called station-keeping behavior in VanDyke and Hall\n(2006). The second objective is to maintain the relative attitudes and relative\nangular velocities among satellites in the formation, called formation keeping\nbehavior. The attitude synchronization and tracking problem is to find a continuous\nfeedback control for each satellite in a formation by using the attitude information\nof itself and its neighboring satellites it can communicate with, so that the two\nobjectives are achieved in the presence of inertia matrix uncertainties, external\ndisturbances, and even inter-satellite communication delay.\n\nThe first objective is to rotate each individual satellite to its desired attitude and\nangular velocity as in the following equation. This behavior is called\nstation-keeping behavior in VanDyke and Hall (2006).\n\nlim\nt!1\n\n~xik k \u00bc lim\nt!1 qik k \u00bc 0; i \u00bc 1; . . .; n \u00f06:14\u00de\n\nwhere qi; ~xi are attitude tracking error and angular velocity error of the ith satellite,\nrespectively.\n\nThe second objective is to maintain the relative attitudes and relative angular\nvelocities among satellites in the formation, called formation keeping behavior, as in\n\nlim\nt!1\n\n~xi ? ~xj\n\n\n \n\n \u00bc lim\n\nt!1 qi ? qj\n\n\n \n\n \u00bc 0; i; j \u00bc 1; . . .; n; i 6\u00bc j \u00f06:15\u00de\n\nDefinition 6.1 The attitude synchronization and tracking problem is to find a\ncontinuous feedback control ui; i \u00bc 1; . . .; n for each satellite in a formation by\nusing the attitude information of itself and its neighboring satellites it can com-\nmunicate with, so that the two objectives in (6.14) and (6.15) are achieved.\n\nThe following assumption is made about the inter-satellite communication links\nin this chapter:\n\nAssumption 6.2 The inter-satellite communication links are assumed to be\nundirected.\n\n6.4 Decentralized Robust Adaptive Control for Attitude\nSynchronization\n\nIn this section, a decentralized adaptive sliding mode control law is proposed for\nattitude synchronization and tracking in the presence of inertia matrix uncertainties\nand external disturbances under a general undirected communication topology\n\n136 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\n(Wu et al. 2013). Firstly, the multi-satellite sliding mode vector is developed.\nSubsequently, a decentralized adaptive sliding mode control law is proposed.\nFinally, a smoothing control law is introduced to avoid the chattering of control\ninput of the proposed control law.\n\nThe following assumptions are made about the dynamics of the attitude syn-\nchronization and tracking systems\n\nAssumption 6.3 Let Ji \u00bc ?Ji \u00feDJi, where ?Ji;DJi are the nominal part and uncertain\npart of the inertia matrix of the ith satellite, respectively. The inertia matrix\nuncertainty DJi is assumed to satisfy DJik k? ci;0;\nAssumption 6.4 All the environmental disturbances due to gravitation, solar\nradiation pressure, and magnetic forces are assumed to be bounded, and aerody-\nnamic drag is proportional to the square of angular velocity. Since the desired\nangular velocity xdi is assumed to be bounded in Assumption 6.1, the external\ndisturbances di are assumed to satisfy dik k? ci;1 \u00fe ci;2 ~xik k2;\nAssumption 6.5 The control law of each satellite might use angular velocity errors\nand error quaternions of its neighboring satellites in the cooperative attitude control\nproblem, and error quaternion is bounded from its definition. Thus, the control\n\ntorque ui is assumed to satisfy uik k? ni;0 \u00fe ni;1\nP\n\nj2Ni ~xj\n\n\n \n\n\u00fe ni;2Pj2Ni ~xj\n\n \n\n2.\n\nWhere ci;j and ni;j; i \u00bc 1; . . .; n; j \u00bc 0; 1; 2 are unknown non-negative constant, Ni\ndenotes the ith satellite and all satellites which the ith satellite can communicate\nwith, and ?k k denotes the standard Euclidean vector norm or induced matrix norm\nas appropriate.\n\n6.4.1 Multi-satellite Sliding Manifold\n\nIn this subsection, the multi-satellite sliding mode vector is developed in order to\nguarantee the two objectives of attitude synchronization and tracking in satellite\nformation and is defined as\n\nS \u00bc s1; . . .; sn\u00bd ?T \u00f06:16\u00de\n\nwhere\n\nsi \u00bc bi ~xi \u00feCqi\u00f0 \u00de\u00fe\nXn\nj\u00bc1\n\naij ~xi ? ~xj\n? \t\u00feC qi ? qj? \t? ?; i \u00bc 1; . . .; n; j 6\u00bc i \u00f06:17\u00de\n\nwith C is a positive definite constant matrix, scalar bi [ 0 is control gain for attitude\ntracking of the ith satellite (station-keeping behavior), scalar aij ? 0 is control gain\nfor inter-satellite attitude synchronization between the ith and jth satellite\n\n6.4 Decentralized Robust Adaptive Control for Attitude Synchronization 137\n\n\n\n(formation keeping behavior), and aij is the (i, j)th entry of the weighted adjacency\nmatrix A associated with the undirected inter-satellite communication topology as\ndefined in (A.3). A positive aij is referred to that a undirected communication link\nbetween the ith and the jth satellite is available, and the behavior weights are\nrestricted to be aij \u00bc aji.\nRemark 6.1 In the multi-satellite sliding mode vector defined in (6.16) and (6.17),\nin addition to attitude error and angular velocity error of each individual satellite,\nthe relative attitude errors and relative angular velocity errors among satellites are\nalso included. Hence, under the sliding mode control proposed in the next section,\neach satellite approaches its desired attitude and angular velocity while achieving\nattitude synchronization among satellites in the formation. This gives rise to the\nconcept of attitude synchronization and tracking.\n\nUsing the Kronecker product and the algebraic graph theory in Appendix A, the\nmulti-satellite sliding vector in (6.16) can be rewritten as\n\nS \u00bc L\u00feB\u00f0 \u00de \t I3\u00bd ? ~X\u00fe ~CQ\n? \t \u00f06:18\u00de\n\nwhere ~X \u00bc ~x1; . . .; ~xn\u00bd ?T ;B \u00bc diag\u00bdb1; . . .; bn?, ~C \u00bc diag C; . . .;C\u00bd ? 2 R3n?3n; I3\ndenotes the 3 \u00d7 3 identity matrix, Q \u00bc q1; . . .; qn\u00bd ?T ; L is the weighted Laplacian\nmatrix corresponding to the inter-satellite undirected communication topology,\ncontrol gain aij for inter-satellite attitude synchronization are the weights in L.\n\nThe multi-satellite sliding mode surface is then defined as S \u00bc 0 or\n\nL\u00feB\u00f0 \u00de \t I3\u00bd ? ~X\u00fe ~CQ\n? \t \u00bc 0 \u00f06:19\u00de\n\nThe following theorem defines the condition under which the attitude syn-\nchronization and tracking will be achieved.\n\nTheorem 6.1 Consider satellite formation attitude tracking systems described by\n(6.11)\u2013(6.13), if Assumption 6.2 is valid, then on the multi-satellite sliding mode\nsurface S \u00bc 0, the attitude synchronization and tracking problem in Definition 6.1\nis asymptotically solved.\n\nProof Since the inter-satellite communication links are undirected, all eigenvalues\nof the weighted Laplacian matrix L are non-negative through Proposition A.3.\nMoreover, B is a diagonal matrix with all positive elements in the diagonal. Thus, all\neigenvalues of L\u00feB are positive. With Lemma 5.1, all eigenvalues of L\u00feB\u00f0 \u00de \t I3\nare positive. Furthermore, L is symmetrical, and so is L\u00feB\u00f0 \u00de \t I3 from Lemma 5.1.\nConsequently, it follows that L\u00feB\u00f0 \u00de \t I3 is positive definite and non-singular.\n\nSince L\u00feB\u00f0 \u00de \t I3 is non-singular, on the slidingmode surface S \u00bc 0, (6.19) yields\n\n~X\u00fe ~CQ \u00bc 0 \u00f06:20\u00de\n\n138 6 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_5\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_5\n\n\nwhich is equivalent to\n\n~xi \u00feCqi \u00bc 0; i \u00bc 1; . . .; n \u00f06:21\u00de\n\nAs proved in Li and Wang (2007), the above equation implies that\n\nlim\nt!1\n\n~xik k \u00bc lim\nt!1 qik k \u00bc 0; i \u00bc 1; . . .; n \u00f06:22\u00de\n\nIt can be concluded that on the multi-satellite sliding mode surface S \u00bc 0, the\nattitude synchronization and tracking problem in Definition 6.1 is asymptotically\nsolved. ?\n\n6.4.2 Decentralized Adaptive Sliding Mode Control Design\n\nThis subsection designs the equivalent control-based sliding mode control laws\nsuch that the reaching and sliding conditions are satisfied.\n\nTo develop the control law, the following equations are derived from (6.11) and\n(6.12)\n\n_~xi \u00feC _qi \u00bc hi \u00fe qi \u00fe ?J?1i ui; i \u00bc 1; . . .; n \u00f06:23\u00de\n\nwith\n\nhi t\u00f0 \u00de, ? ?J?1i x?i ?Jixi \u00fe ~x?i R ?qi\u00f0 \u00dexdi ? R ?qi\u00f0 \u00de _xdi\n? \t\u00fe 1\n\n2\nC q?i \u00fe qi;0I\n? \t\n\n~xi \u00f06:24\u00de\n\nqi t\u00f0 \u00de, ?J?1i di ? DJi _~xi ? x?i DJixi \u00feDJi ~x?i R ?qi\u00f0 \u00dexdi ? R ?qi\u00f0 \u00de _xdi\n? \t? ? \u00f06:25\u00de\n\nqi\u00f0t\u00de represents the inertia matrix uncertainties and external disturbances. Under\nAssumptions 6.1 and 6.3\u20136.5, it can be verified that qi t\u00f0 \u00de is bounded by the fol-\nlowing function\n\nqi t\u00f0 \u00dek k1 ? di;0 \u00fe di;1\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1 \u00fe di;2\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1; i \u00bc 1; . . .; n \u00f06:26\u00de\n\nwhere di;0; di;1; di;2 are positive constant numbers, and ?k k1 denotes the induced\nmatrix 1-norm.\n\nSliding mode control is deployed in this section for attitude synchronization and\ntracking in the presence of model uncertainties and external disturbances. However,\nin those conventional sliding mode control laws in Lo and Chen (1995), Crassidis\net al. (2000) and Bo\u0161kovic et al. (2001), an important assumption is that inertia\nuncertainties and external disturbances are bounded and that their bounds are\navailable to the designer. These bounds are an important clue to guarantee the\n\n6.4 Decentralized Robust Adaptive Control for Attitude Synchronization 139\n\n\n\nstability of the closed-loop system. However, bounds on the uncertainties of satellite\nare not easily obtained because of the complexity of the structure of the uncertainties.\nIn particular, the magnitude of external disturbances cannot be easily estimated,\nsince various environmental disturbances exist, such as gravity-gradient torque,\naerodynamic torque, earth magnetic torque, and solar radiation torque. In many\npractical situations, even if the bounds can be learned, they may be conservative. The\nimplementation of the control law, based on these conservative bounds, may result in\nimpractically large control authority and control chattering. Control chattering is\nhighly undesirable in satellite mission, since it implies extremely high control\nactivity and may excite neglected high-frequency dynamics. Therefore, a simple\nmethodology is required to acquire the bounds on uncertainties. Adaptive approach\nintroduced in the following offers a simple and effective tool to this problem.\n\nSuppose d?i;0; d?i;1; and d?i;2 are estimations of di;0; di;1; and di;2, respectively.\nThen, the estimation errors are defined as ~di;0 \u00bc d?i;0 ? di;0; ~di;1 \u00bc d?i;1 ? di;1\nand ~di;2 \u00bc d?i;2 ? di;2.\n\nNow, consider the simple adaptation laws for the upper bound of the norm\nqi t\u00f0 \u00de\n\n\n \n\n\n\n1 such that\n\n_~di;0 , ji;0 sik k1\n_~di;1 , ji;1 sik k1\n\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1\n\n_~di;2 , ji;2 sik k1\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1\n\n\u00f06:27\u00de\n\nwhere ji;0; ji;1 and ji;2 are positive adaptive gains.\nSince di;0; di;1; and di;2 are assumed to be constant,\n\n_?di;0 \u00bc _~di;0; _?di;1 \u00bc _~di;1;\n_?di;2 \u00bc _~di;2. Then, the adaptive parameters can be obtained by integrating\n\nd?i;0\u00f0t\u00de, d?0i;0 \u00fe ji;0\nZ t\nt0\n\nsik k1dt\n\nd?i;1\u00f0t\u00de, d?0i;1 \u00fe ji;1\nZ t\nt0\n\nsik k1\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1dt\n\nd?i;2\u00f0t\u00de, d?0i;2 \u00fe ji;2\nZ t\nt0\n\nsik k1\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1dt\n\n\u00f06:28\u00de\n\nwhere d?0i;0; d?\n0\ni;1 and d?\n\n0\ni;2 are the initial values of d?i;0; d?i;1 and d?i;2. By choosing\n\nappropriate d?0i;0; d?\n0\ni;1; d?\n\n0\ni;2\n\nn o\nand ji;0; ji;1; ji;2\n\n? ?\n, the rate of parameter adaptation\n\ncan be adjusted.\n\n140 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nThe control input for the ith satellite is proposed as\n\nui \u00bc ??Ji hi \u00feKisi \u00fe a?i sgn si\u00f0 \u00de\u00bd ?; i \u00bc 1; . . .; n \u00f06:29\u00de\n\nwhere ?Ji is the nominal inertia matrix of the ith satellite, Ki is the positive definite\ngain matrix, hi is defined in (6.24), si is the component of multi-satellite sliding\n\nmode vector S defined in (6.17), and sgn si\u00f0 \u00de, sgn si;1\n? \t\n\nsgn si;2\n? \t\n\nsgn si;3\n? \t? ?T\n\n,\nsi;j; j \u00bc 1; 2; 3 is the jth component of si, sgn ?\u00f0 \u00de denotes the sign function, i.e.,\n\nsgn x\u00f0 \u00de \u00bc\n1; x[ 0\n0; x \u00bc 0\n?1; x\\0\n\n8<\n: \u00f06:30\u00de\n\nand a?i is the adaptive upper bound of the norm qi t\u00f0 \u00dek k1 and is defined by\n\na?i , d?i;0 \u00fe d?i;1\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1 \u00fe d?i;2\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1 \u00f06:31\u00de\n\nThe following theorem gives the condition for the existence of the multi-satellite\nsliding mode surface (6.19) for satellite formation attitude tracking systems\ndescribed by (6.11)\u2013(6.13).\n\nTheorem 6.2 Consider satellite formation attitude tracking systems described by\n(6.11)\u2013(6.13) with the decentralized adaptive sling mode control law (6.29) and the\nparameter adaptation law (6.27). If Assumptions 6.1\u20136.5 are valid, then the\nmulti-satellite sliding mode surface S \u00bc 0 defined in (6.16) and (6.17) will be\nreached asymptotically.\n\nProof The candidate of Lyapunov function is set as\n\nV \u00bc V1 \u00feV2 \u00f06:32\u00de\n\nwith\n\nV1 \u00bc 12 S\nT L\u00feB\u00f0 \u00de \t I3\u00bd ??1S \u00f06:33\u00de\n\nV2 \u00bc 12\nXn\ni\u00bc1\n\nj?1i;0 ~d\n2\ni;0 \u00fe j?1i;1 ~d2i;1 \u00fe j?1i;2 ~d2i;2\n\n? ?\n\u00f06:34\u00de\n\nAs proved in previous subsection, L\u00feB\u00f0 \u00de \t I3 is positive definite,\nso L\u00feB\u00f0 \u00de \t I3\u00bd ??1 is positive definite. Thus, V is positive definite and radially\nunbounded. h\n\n6.4 Decentralized Robust Adaptive Control for Attitude Synchronization 141\n\n\n\nTaking the first derivative of V1 and adopting (6.18) yields\n\n_V1 \u00bc ST L\u00feB\u00f0 \u00de \t I3\u00bd ??1 _S\n\n\u00bc ST L\u00feB\u00f0 \u00de \t I3\u00bd ??1 L\u00feB\u00f0 \u00de \t I3\u00bd ?\n_~x1 \u00feC _q1\n\n..\n\n.\n\n_~xn \u00feC _qn\n\n2\n664\n\n3\n775\n\n\u00bc\nXn\ni\u00bc1\n\nsTi _~xi \u00feC _qi\n? \t\n\n\u00f06:35\u00de\n\nSubstituting (6.23) into the above equation leads to\n\n_V1 \u00bc\nXn\ni\u00bc1\n\nsTi hi \u00fe qi \u00fe ?J?1i ui\n? \t \u00f06:36\u00de\n\nSubstituting the control input (6.29) into the above equation and adopting (6.26)\nand (6.31) yields\n\n_V1 \u00bc\nXn\ni\u00bc1\n\n?sTi Kisi ? sTi ?ai sgn si\u00f0 \u00de\u00f0 \u00de\u00fe sTi qi\n? ?\n\n\u00bc\nXn\ni\u00bc1\n\n?sTi Kisi ? a?i sik k1 \u00fe sTi qi\n? \t\n\n?\nXn\ni\u00bc1\n\n?sTi Kisi ? a?i sik k1 \u00fe sik k1? qik k1\n? \t\n\n?\nXn\ni\u00bc1\n\n?sTi Kisi ? d?i;0 \u00fe d?i;1\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1 \u00fe d?i;2\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1\n\n !\nsk k1\n\n\" #\n\n\u00fe\nXn\ni\u00bc1\n\nsik k1? di;0 \u00fe di;1\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1 \u00fe di;2\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1\n\n !\" #\n\n\u00bc\nXn\ni\u00bc1\n\n?sTi Kisi ? ~di;0 \u00fe ~di;1\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1 \u00fe ~di;2\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1\n\n !\nsik k1\n\n\" #\n\n\u00f06:37\u00de\n\nTaking the first derivative of V2 and adopting (6.27) yields\n\n_V2 \u00bc\nXn\ni\u00bc1\n\nj?1i;0 ~di;0\n_~di;0 \u00fe j?1i;1 ~di;1 _~di;1 \u00fe j?1i;2 ~di;2 _~di;2\n\n? ?\n\n\u00bc\nXn\ni\u00bc1\n\n~di;0 \u00fe ~di;1\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1 \u00fe ~di;2\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1\n\n !\nsik k1\n\n\u00f06:38\u00de\n\n142 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nCombining the above equation with (6.37) leads to\n\n_V ? ?\nXn\ni\u00bc1\n\nsTi Kisi \u00f06:39\u00de\n\nTherefore, it follows that si 2 L1 and ~di;0; ~di;1; ~di;2 2 L1. Consequently, ui 2\nL1 with (6.29) and Assumption 6.5. It follows that _~xi; _qi and hence _si are all\nbounded from (6.11) and (6.12). Integrating _V gives the results that si 2 L2 . Hence,\nusing the corollary of Barbalat\u2019s Lemma in Sastry and Bodson (1989), it follows\nthat limt!1 si t\u00f0 \u00de \u00bc 0; i \u00bc 1; . . .; n. Thus, it is obtained that limt!1 S t\u00f0 \u00de \u00bc 0.\nRemark 6.2 There is no extra restriction on parameters bi [ 0; aij ? 0 in (6.17)\nunlike VanDyke and Hall (2006), Jin et al. (2008) and Ren (2007a). So the pro-\nposed attitude synchronization and tracking scheme will enable the designer to\nprioritize between station-keeping behavior and formation keeping behavior. For\nexample, if one wants to prioritize formation keeping behavior, aij should be\nincreased while bi should be decreased or invariant.\n\nRemark 6.3 In the proposed control law, the desired attitude of each satellite with\nrespect to inertial frame I is not restricted to be same. Thus, the given relative\n\nattitude among satellites can be maintained. Note that ?qdi;j \u00bc ?qdj\n? ?T\n\n?qdi defines the\n\nrelative attitude of the ith with respect to the jth satellite, where ?qdi and ?q\nd\nj denote the\n\nrelative attitude of the ith and jth satellite with respect to inertial frame I,\nrespectively.\n\nRemark 6.4 Reference Jin et al. (2008) presents a sliding mode controller for\nattitude synchronization and stabilization. Unlike Jin et al. (2008), the proposed\ncontrol law is for attitude synchronization and tracking and is based on graph theory\nand the proposed multi-satellite sliding mode vector.\n\n6.4.3 Smoothing Control Law\n\nThe proposed control law in previous subsection is discontinuous across the surface\nS\u00f0t\u00de, thus leads to control chattering. This situation can be remedied by smoothing\nout the control discontinuity in a thin boundary layer neighboring the switching\nsurface. To do this, the sign function in the control law (6.29) can be replaced by a\nsaturation function, which is defined as\n\nsat x\u00f0 \u00de \u00bc\n1 if x/ ? 1\nx\n/ if ?1\\ x/\\1?1 if x/ ? 1\n\n8<\n: \u00f06:40\u00de\n\n6.4 Decentralized Robust Adaptive Control for Attitude Synchronization 143\n\n\n\nwhere / is the boundary layer thickness. As / tends to be zero, the performance of\ncontrol law with this boundary layer can be made arbitrarily close to that of original\ncontrol law (6.29). The practical advantages of control law with this boundary layer\nmay be significant, although it leads to small terminal tracking error. However, it\nshould be pointed out that in this case, the estimated gains ~d0; ~d1 and ~d2 may\nbecome unbounded in the boundary layer since the restriction to the sliding surface\ncannot always be achieved.\n\nIn order to address this problem, the adaptive sliding mode control law given in\n(6.29) is modified as\n\nui \u00bc ??Ji hi \u00feKi?si \u00fe a?i sat si\u00f0 \u00de\u00bd ?; i \u00bc 1; . . .; n \u00f06:41\u00de\n\nwhere sat si\u00f0 \u00de, sat si;1\n? \t\n\nsat si;2\n? \t\n\nsat si;3\n? \t? ?T , ?si \u00bc ?si;1;?si;2;?si;3? ?T is a measure\n\nof the algebraic distance of the current state to the boundary layer (Slotine and\nCoetsee 1986), ?si;j \u00bc si;j ? /isat si;j\n\n? \t\n; i \u00bc 1; . . .; n; j \u00bc 1; 2; 3.\n\nThe adaptation laws (6.27) are modified as\n\n_~di;0 , ji;0 ?sik k1\n_~di;1 , ji;1 ?sik k1\n\nX\nj2Ni\n\n~xj\n\n\n \n\n\n\n1\n\n_~di;2 , ji;2 ?sik k1\nX\nj2Ni\n\n~xj\n\n\n \n\n2\n\n1\n\n\u00f06:42\u00de\n\nThe following Lyapunov function is defined in order to prove the convergence to\nthe boundary layer:\n\n?V \u00bc 1\n2\n?ST L\u00feB\u00f0 \u00de \t I3\u00bd ??1?S\u00fe 12\n\nXn\ni\u00bc1\n\nj?1i;0 ~d\n2\ni;0 \u00fe j?1i;1 ~d2i;1 \u00fe j?1i;2 ~d2i;2\n\n? ?\n\u00f06:43\u00de\n\nwhere ?S \u00bc ?s1; . . .;?sn\u00bd ?.\nNoting that _?S \u00bc _S outside the boundary layer, while ?S \u00bc 0 inside the boundary\n\nlayer leads to\n\n_?V ? ?\nXn\ni\u00bc1\n\n?si\u00f0 \u00deTKi?si \u00f06:44\u00de\n\nso that _?V ? 0 outside the boundary layer. Finally, (6.43) implies that _?V \u00bc 0 inside\nthe boundary layer, which shows that _?V ? 0 is valid everywhere and thus guar-\nantees further that states eventually converge to the boundary layer.\n\nIt can be shown that the system is globally uniformly ultimately bounded inside\nthe boundary layer (Slotine and Coetsee 1986).\n\n144 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nRemark 6.5 As seen from (6.42) that adaptation ceased as soon as the boundary\nlayer is reached. This avoids the undesirable long-term drift found in many adaptive\nschemes and provides a consistent rule on when to stop adaptation (Slotine and\nCoetsee 1986).\n\n6.5 Velocity-Free Coordinated Attitude Control\n\nThis section generalizes the passivity approach in Kristiansen et al. (2009), Lizarralde\nand Wen (1996) and Tsiotras (1998) for attitude synchronization in satellite forma-\ntion, where angular velocity measurements are not required (Wu et al. 2010).\n\nAssumption 6.6 For simplicity, it is assumed that the desired orientations and\nangular velocities of all satellites are identical, i.e.,\n\n?gd1 t\u00f0 \u00de \u00bc ? ? ? \u00bc ?gdn t\u00f0 \u00de \u00bc ?gd t\u00f0 \u00de; xd1 t\u00f0 \u00de \u00bc ? ? ? \u00bc xdn t\u00f0 \u00de \u00bc xd t\u00f0 \u00de \u00f06:45\u00de\n\nFurthermore, each satellite knows the desired orientation and angular velocity.\n\nFor simplicity, the attitude tracking error kinematic equations in (6.12) and\n(6.13) are combined as follows:\n\n_?qi \u00bc\n1\n2\nA ?qi\u00f0 \u00de~xi i \u00bc 1; . . .; n \u00f06:46\u00de\n\nwith\n\nA ?qi\n? \t \u00bc ?qTi\n\nS ?qi\n? \t\n\n\" #\n\u00f06:47\u00de\n\nThe following property about A ?qi\u00f0 \u00de is useful.\n\nA ?qi\u00f0 \u00deTA ?qi\u00f0 \u00de \u00bc I3 \u00f06:48\u00de\n\nThe dynamic control action for the ith satellite in a formation is proposed as\nfollows:\n\n_xi \u00bc Axi \u00fe kiqi \u00fe\nXn\nj\u00bc1\n\nkij qi ? qj\n? \t \u00f06:49\u00de\n\nyi \u00bc PAxi \u00fe kiPqi \u00feP\nXn\nj\u00bc1\n\nkij qi ? qj\n? \t \u00f06:50\u00de\n\n6.4 Decentralized Robust Adaptive Control for Attitude Synchronization 145\n\n\n\nui \u00bc ?qiqi ?\nXn\nj\u00bc1\n\nqijqij ? ST ?qi\u00f0 \u00deyi \u00fe R ?qi\u00f0 \u00dexd\n? \t?\n\nJi R ?qi\u00f0 \u00dexd\n? \t\u00fe JiR ?qi\u00f0 \u00de _xd \u00f06:51\u00de\n\nwhere i \u00bc 1; . . .; n, A 2 R3?3 is Hurwitz, P 2 R3?3 is a positive definite matrix,\nwhich is the solution of the Lyapunov equation ATP\u00fePA \u00bc ?Q with Q 2 R3?3\nbeing a positive definite matrix, ki is a positive scalar, qi [ 0 is control gain for\nattitude tracking of each individual satellite, qij is control gain for attitude syn-\nchronization among satellites, If inter-satellite undirected communication between\nthe ith and the jth satellite is available, then it is assumed that qij \u00bc qji [ 0 and\nkij \u00bc kji [ 0, otherwise qij \u00bc qji \u00bc 0 and kij \u00bc kji \u00bc 0.\n\nqij is the vector part of ?qij. From Assumption 6.5, it can be verified that ?qij is\nequal to the relative quaternions ?gij as follows\n\n?qij \u00bc ?qj\n? \t?\n\n?qi \u00bc ?gd\n? \t?\n\n?gj\nh i?\n\n?gd\n? \t?\n\n?gi\nh i\n\n\u00bc ?gj\n? \t?\n\n?gd ?gd\n? \t?\n\n?gi \u00bc ?gj\n? \t?\n\n?gi \u00bc ?gij \u00f06:52\u00de\n\n?gij representing the relative attitude of the ith with respect to jth satellite, which\ncan be obtained by the inter-satellite communication or relative sensing.\n\nRemark 6.6 The proposed controller (6.51) has a clear intuitive structure. The term\n?qiqi is for absolute attitude tracking for each individual satellite, and the termPn\n\nj\u00bc1 qijqij is for attitude synchronization among satellites. The term ?ET ?qi\u00f0 \u00deyi is to\nrecover and generate the necessary damping that would have been generated by the\nangular velocities and the relative angular velocities. The term\nR ?qi\u00f0 \u00dexd\n? \t?\n\nJi R ?qi\u00f0 \u00dexd\n? \t\u00fe JiR ?qi\u00f0 \u00de _xd is feedforward compensation for absolute\n\nattitude tracking. Equations (6.49) and (6.50) take the role of a filter whose output\nyi provides damping to the formation. The term kiqi in (6.49) is used to introduce\nabsolute damping for each individual satellite, and the term\n\nPn\nj\u00bc1 kij qi ? qj\n\n? \t\nin\n\n(6.49) is used to generate relative damping between neighboring satellites.\n\nThe stability of the proposed control law is given in the following theorem.\n\nTheorem 6.3 Consider satellite attitude tracking systems described by (6.11)\u2013\n(6.13) with the decentralized coordinated attitude control law (6.49)\u2013(6.51), if the\nAssumptions 6.2 and 6.6 are valid and the control gains satisfy\n\nqi [ 2\nXn\nj\u00bc1\n\nqij; i \u00bc 1; . . .; n \u00f06:53\u00de\n\nthen the attitude synchronization and tracking problem in Definition 6.1 is\nasymptotically solved. Furthermore, if there exist a time T [ 0 such that q0;i t\u00f0 \u00de[ 0\nfor all t? T and i \u00bc 1; . . .; n, then the same convergence results are obtained\nwithout condition (6.53).\n\n146 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nProof Choose the candidate of Lyapunov function as\n\nV \u00bc 1\n2\n\nXn\ni\u00bc1\n\n~xTi Ji ~xi \u00fe\nXn\ni\u00bc1\n\nqi 1? q0;i\n? \t2 \u00fe qTi qih i\u00fe 12\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij 1? q0;ij\n? \t2 \u00fe qTij qijh i\u00feV1\n\n\u00f06:54\u00de\n\nwith\n\nV1 \u00bc 12 _x\nT M \t I3\u00f0 \u00de?1 In \t P\u00f0 \u00de _x \u00f06:55\u00de\n\nwhere \t denotes Kronecker product, _x is column stack vector of all _xi; i \u00bc\n1; . . .; n;M,L\u00fe diag k1; . . .; kn\u00bd ?; with L \u00bc lij\n\n? ? 2 Rn?n defined as lij \u00bc ?kij and\nlii \u00bc\n\nP\nj 6\u00bci kij: M is symmetric positive definite from algebraic graph theorem in\n\nAppendix A, thus M \t I3\u00f0 \u00de?1 is also symmetric positive definite by use of the\nproperty of Kronecker product in Lemma 5.1. Note that In \t P is symmetric pos-\nitive definite. It is easy to verify that M \t I3\u00f0 \u00de?1 and In \t P\n\n? \t\ncommute. Thus, it\n\nfollows that M \t I3\u00f0 \u00de?1 In \t P\n? \t\n\nis also symmetric positive definite. Therefore, the\nfunction V1 is positive definite and radially unbounded, so is V. h\n\nFrom (6.13), the following equation is obtained\n\n_q0;ij \u00bc ? 12 ~xij\n? \tT\n\nqij; i; j \u00bc 1; n; i 6\u00bc j \u00f06:56\u00de\n\nTaking the first derivative of V and adopting (6.8) and the above equation yields\n\n_V \u00bc\nXn\ni\u00bc1\n\n~xTi Ji _~xi \u00fe\nXn\ni\u00bc1\n\nqi ~x\nT\ni qi \u00fe\n\n1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~x\nT\nij qij \u00fe _V1 \u00f06:57\u00de\n\nNote that\n\n~xTi Ji _~xi \u00bc? ~xTi R ?qi\u00f0 \u00dexd\n? \t?\n\nJi \u00fe Ji R ?qi\u00f0 \u00dexd\n? \t?h i\n\n~xi\n\n? ~xTi R ?qi\u00f0 \u00dexd\n? \t?\n\nJi R ?qi\u00f0 \u00dexd\n? \t\u00fe JiR ?qi\u00f0 \u00de _xdh i\u00fe ~xTi ui\n\n\u00bc? ~xTi R ?qi\u00f0 \u00dexd\n? \t?\n\nJi R ?qi\u00f0 \u00dexd\n? \t\u00fe JiR ?qi\u00f0 \u00de _xdh i\u00fe ~xTi ui\n\n\u00f06:58\u00de\n\nwhere ~xTi R ?qi\u00f0 \u00dexd\n? \t?\n\nJi \u00fe Ji R ?qi\u00f0 \u00dexd\n? \t?? ?\n\n~xi \u00bc 0 is used to obtain the last equality.\nIt can be readily shown that R ?qi\u00f0 \u00dexd\n\n? \t?\nJi \u00fe Ji R ?qi\u00f0 \u00dexd\n\n? \t? is skew-symmetric due\nto the fact that Ji is symmetric and R ?qi\u00f0 \u00dexd is skew-symmetric. Substituting the\ncontrol inputs (6.51) and (6.58) into (6.57) leads to\n\n6.5 Velocity-Free Coordinated Attitude Control 147\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_5\n\n\n_V \u00bc ?\nXn\ni\u00bc1\n\n~xTi\nXn\nj\u00bc1\n\nqijqij?\nXn\ni\u00bc1\n\n~xTi S\nT ?qi\u00f0 \u00deyi \u00fe 12\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~x\nT\nij qij \u00fe _V1 \u00f06:59\u00de\n\nNote that\n\n?\nXn\ni\u00bc1\n\n~xTi\nXn\nj\u00bc1\n\nqijqij \u00fe\n1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~xij\n? \tT\n\nqij\n\n\u00bc ? 1\n2\n\nXn\ni\u00bc1\n\n~xTi\nXn\nj\u00bc1\n\nqijqij ?\n1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~x\nT\nj qji \u00fe\n\n1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~xij\n? \tT\n\nqij\n\n\u00bc ? 1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~x\nT\ni qij \u00fe qij ~xTj ?R ?qji\n\n? \t\nqij\n\n? \th i\u00fe 1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~xij\n? \tT\n\nqij\n\n\u00bc ? 1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~xi ? R ?qij\n? \t\n\n~xj\n? \tT\n\nqij\nh i\n\n\u00fe 1\n2\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nqij ~xij\n? \tT\n\nqij\n\n\u00bc 0\n\n\u00f06:60\u00de\n\nwhere the fact qij \u00bc qji is used to obtain the second equality.\nEquation (6.49) can be rewritten as follows\n\n_x \u00bc In \t A\n? \t\n\nx\u00fe M \t I3\u00f0 \u00deq \u00f06:61\u00de\n\nwhere q is column stack vector of all qi; i \u00bc 1; ? ? ? ; n.\nDifferentiating both sides of the above equation yields\n\n\u20acx \u00bc In \t A\u00f0 \u00de _x\u00fe M \t I3\u00f0 \u00de _q \u00f06:62\u00de\n\nTaking the first derivative of V1 leads to\n\n_V1 \u00bc 12 _x\nT In \t AT\n? \t\n\nM \t I3\u00f0 \u00de?1 In \t P\u00f0 \u00de _x\u00fe 12 _q\nT M \t I3\u00f0 \u00deT M \t I3\u00f0 \u00de?1 In \t P\u00f0 \u00de _x\n\n\u00fe 1\n2\n_xT M \t I3\u00f0 \u00de?1 In \t P\u00f0 \u00de In \t A\u00f0 \u00de _x\u00fe 12 _x\n\nT M \t I3\u00f0 \u00de?1 In \t P\u00f0 \u00de M \t I3\u00f0 \u00de _q\n\n\u00bc ? 1\n2\n_xT M \t I3\u00f0 \u00de?1 In \t Q\u00f0 \u00de _x\u00fe _xT In \t P\u00f0 \u00de _q\n\n\u00f06:63\u00de\n\nwhere (6.62) is used to obtain first equality, and the fact that M \t I3\u00f0 \u00de?1 commutes\nwith both In \t P and In \t AT is used to obtain the second equality.\n\n148 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nSubstituting (6.60) and (6.63) into (6.59) leads to\n\n_V \u00bc ?\nXn\ni\u00bc1\n\n~xTi S\nT ?qi\u00f0 \u00deyi ? 12 _x\n\nT M \t I3\u00f0 \u00de?1 In \t Q\u00f0 \u00de _x\u00fe _xT In \t P\u00f0 \u00de _q\n\n\u00bc ?\nXn\ni\u00bc1\n\nqTi P _xi\u00f0 \u00de ?\n1\n2\n_xT M \t I3\u00f0 \u00de?1 In \t Q\u00f0 \u00de _x\u00fe _xT In \t P\u00f0 \u00de _q\n\n\u00bc ? 1\n2\n_xT M \t I3\u00f0 \u00de?1 In \t Q\u00f0 \u00de _x\n\n\u00f06:64\u00de\n\nIt follows that _V ? 0 because M \t I3\u00f0 \u00de?1 In \t Q\u00f0 \u00de \u00bc In \t Q\u00f0 \u00de?1 M \t I3\u00f0 \u00de is a\nsymmetric positive definite matrix.\n\nLet S \u00bc ~xi; qi; _xi _V\n\n\n \u00bc 0? ?; i \u00bc 1; . . .; n. Note that _V \n 0 implies _x \n 0, so is\n\n\u20acx \n 0. It follows M \t I3\u00f0 \u00de _q \n 0 according to (6.62). Noting that M \t I3 has full\nrank leads to _q \n 0. Thus, _?qi \n 0 using that fact ?q2i \u00fe q2i \n 0. It follows that ~xi \n 0\naccording to (6.46) and A ?qi\u00f0 \u00deTA ?qi\u00f0 \u00de \u00bc I3. From (6.11), (6.51), and the fact\nyi \u00bc P _xi \n 0, the following equations can be obtained\n\n?qiqi ?\nXn\nj\u00bc1\n\nqijqij \n 0; i \u00bc 1; . . .; n \u00f06:65\u00de\n\nFollowing a similar procedure as in Lawton and Beard (2002), Abdessameud\nand Tayebi (2009), and using (6.3) and the definition of qij, the above equation can\nbe written as follows:\n\nN \t I3\u00f0 \u00deq \n 0 \u00f06:66\u00de\n\nwhere N \u00bc nij\n? ? 2 Rn?n defined as nii \u00bc qi \u00fe Pnj\u00bc1 qijq0;j and nij \u00bc ?qijq0;j.\n\nIf the condition (6.53) is satisfied, the matrix N is strictly dominant due to\nq0;j\n\n\n \n\n? 1; j \u00bc 1; . . .; n. Thus, N has full rank. It follows q \n 0 from (6.66). Thus,\nqi \n 0. By LaSalle\u2019s invariance principle, it follows that\n\nlim\nt!1\n\n~xi t\u00f0 \u00de \u00bc lim\nt!1 qi t\u00f0 \u00de \u00bc 0; i \u00bc 1; . . .; n \u00f06:67\u00de\n\nFurthermore, as observed from (6.66), if q0;i t\u00f0 \u00de[ 0 for i \u00bc 1; . . .; n is positive,\nthen the matrix N is strictly dominant. Then, if there exist a time T [ 0 such that\nq0;i t\u00f0 \u00de[ 0 for all t? T and i \u00bc 1; . . .; n, then the same convergence results are\nobtained (Abdessameud and Tayebi 2009) without (6.53).\n\n6.5 Velocity-Free Coordinated Attitude Control 149\n\n\n\n6.6 Simulation Studies\n\nSimulation is carried out in this section to illustrate the performance and stability\ncharacteristics of the proposed decentralized coordinated attitude control laws.\nA scenario with four satellites is considered in the simulation. The inter-satellite\nundirected communication topology used is shown in Fig. 6.1. Although the com-\nmunication graphs used in the simulation have a spanning tree (see Ren (2009)) for\nthe definition of spanning tree), the proposed control laws are valid when there is no\nspanning tree. The corresponding weighted Laplacian matrix for the topology is\n\nL \u00bc\n1 ?1 0 0\n\n?0:5 1 ?0:5 0\n0 ?0:5 1 ?0:5\n0 0 ?1 1\n\n2\n664\n\n3\n775\n\nThe actual inertia matrices of the satellites are assumed to be as follows (the unit\nof which is kgm2)\n\nJ1 \u00bc\n20 2 0:9\n2 17 0:5\n0:9 0:5 15\n\n2\n4\n\n3\n5; J2 \u00bc 22 1 0:91 19 0:5\n\n0:9 0:5 15\n\n2\n4\n\n3\n5; J3 \u00bc 18 1 1:51 15 0:5\n\n1:5 0:5 17\n\n2\n4\n\n3\n5;\n\nJ4 \u00bc\n18 1 1\n1 20 0:5\n1 0:5 15\n\n2\n4\n\n3\n5\n\n\u00f06:68\u00de\n\nThe following two subsections present simulation results of adaptive sliding\nmode control in Sect. 6.4 and velocity-free coordinated attitude control in Sect. 6.5\nfor attitude synchronization and tracking, respectively.\n\nFig. 6.1 Undirected\ncommunication topology for\nsatellite attitude\nsynchronization\n\n150 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\n6.6.1 Decentralized Adaptive Sliding Mode Control\n\nIn order to validate the robustness against model uncertainties and external dis-\nturbances of the proposed control laws, it is assumed that the nominal inertia\nmatrices of the satellites are\n\n?J1 \u00bc ?J2 \u00bc ?J3 \u00bc ?J4 \u00bc diag 20; 20; 20\u00bd ?T\n? \t\n\nkgm2 \u00f06:69\u00de\n\nand different sinusoidal-wave disturbances as in (6.70) are added to each satellite\nrandomly. The external disturbances used in the simulation are far worse than those\nobserved in practice.\n\nd1 t\u00f0 \u00de \u00bc 0:10 sin 0:4t\u00f0 \u00de; 0:05 cos 0:5t\u00f0 \u00de; 0:08 cos 0:7t\u00f0 \u00de\u00bd ?TNm\nd2 t\u00f0 \u00de \u00bc 0:06 cos 0:4t\u00f0 \u00de; 0:10 sin 0:5t\u00f0 \u00de; 0:05 sin 0:7t\u00f0 \u00de\u00bd ?TNm\nd3 t\u00f0 \u00de \u00bc 0:08 sin 0:4t\u00fe pi=4\u00f0 \u00de; 0:06 cos 0:5t\u00fe pi=4\u00f0 \u00de; 0:07 cos 0:7t\u00fe pi=4\u00f0 \u00de\u00bd ?TNm\nd4 t\u00f0 \u00de \u00bc 0:06 cos 0:4t\u00fe pi=4\u00f0 \u00de; 0:08 sin 0:5t\u00fe pi=4\u00f0 \u00de; 0:10 sin 0:7t\u00fe pi=4\u00f0 \u00de\u00bd ?TNm\n\n\u00f06:70\u00de\n\nThe initial angular velocity errors of all satellites are chosen to be zeros, and the\ninitial attitude tracking errors are chosen as\n\n?q1 0\u00f0 \u00de \u00bc 0:8986 0:4 ?0:1 0:15\u00bd ?T ; ?q2 0\u00f0 \u00de \u00bc 0:8888 ?0:2 0:1 0:4\u00bd ?T ;\n?q3 0\u00f0 \u00de \u00bc 0:8062 0:1 ?0:5 0:3\u00bd ?T ; ?q4 0\u00f0 \u00de \u00bc 0:8426 ?0:4 ?0:2 0:3\u00bd ?T :\n\n\u00f06:71\u00de\n\nThe initial desired attitudes are ?gdi 0\u00f0 \u00de \u00bc 1 0 0 0\u00bd ?T ; i \u00bc 1; 2; 3; 4. The\ntime-varying desired angular velocities of the satellites are identical as follows:\n\nxdi t\u00f0 \u00de \u00bc 0:1 cos t=40\u00f0 \u00de ?0:1 sin t=50\u00f0 \u00de ?0:1 cos t=60\u00f0 \u00de\u00bd ?T i \u00bc 1; 2; 3; 4\n\u00f06:72\u00de\n\nThe controller parameters for the first control law (6.29) are chosen as C \u00bc I3;\nKi \u00bc 0:01I3; bi \u00bc 1;/i \u00bc 0:01;Ki \u00bc 0:01I3, and the parameters of the adaptation\nlaw (6.42) are chosen as ji;0 \u00bc 0:1; ji;1 \u00bc ji;2 \u00bc 0:2 and d?0i;0 \u00bc d?0i;1 \u00bc d?0i;2 \u00bc 0,\nwhere i \u00bc 1; . . .; n.\n\nThe smoothing technique introduced in Sect. 6.4.3 is deployed for control law\n(6.29) to avoid the chattering of control input.\n\nThe attitude error, angular velocity error, and control torque of the 1st satellite\nare shown in Figs. 6.2, 6.3 and 6.4, respectively. For ease of interpretation, attitude\nerrors are expressed by Euler angles converted from unit quaternion. It is observed\nthat attitude tracking of the 1st satellite is achieved despite the presence of external\n\n6.6 Simulation Studies 151\n\n\n\ndisturbances and model uncertainties. The responses of the closed-loop systems of\nother satellites are similar to those of the 1st satellite and are not plotted here due to\nspace constraint. The adaptive parameter a?1 is bounded as shown in Fig. 6.5, thus\n\nFig. 6.2 Attitude tracking error of the 1st satellite under decentralized adaptive robust control\nwith undirected communication topology\n\nFig. 6.3 Angular velocity error of the 1st satellite under decentralized adaptive robust control\nwith undirected communication topology\n\n152 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nthe proposed adaptation laws (6.42) are verified. The relative attitudes of the 2nd\nwith respect to the 1st satellite and the 1st with respect to the 4th satellite are plotted\nin Figs. 6.6 and 6.7, respectively. Relative attitude errors between other pairs of\nsatellites are similar to those of the above two.\n\nFor comparison, Figs. 6.8, 6.9, 6.10, and 6.11 show attitude error, relative\nattitude errors, and control torque when there is no coupling between neighbors\n[i.e., aij \u00bc 0; i; j \u00bc 1; 2; 3; 4 in (6.17)]. It is observed from Figs. 6.6 and 6.9 that\nrelative attitude errors among satellites, especially steady-state relative attitude\n\nFig. 6.4 Control torque of the 1st satellite under decentralized adaptive robust control with\nundirected communication topology\n\nFig. 6.5 Adaptive parameter\na?1 of the 1st satellite under\ndecentralized adaptive robust\ncontrol with undirected\ncommunication topology\n\n6.6 Simulation Studies 153\n\n\n\nerrors, in the case with coupling between neighbors are reduced as compared to the\ncase without coupling. Furthermore, even the relative attitude errors between\nsatellites without direct inter-satellite communication are reduced, such as relative\n\nFig. 6.6 Relative attitude errors of the 2nd satellite with respect to the 1st satellite under\ndecentralized adaptive robust control with undirected communication topology\n\nFig. 6.7 Relative attitude errors of the 1st satellite with respect to the 4th satellite under\ndecentralized adaptive robust control with undirected communication topology\n\n154 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nattitude errors between the 1st and 4th satellite as seen from Figs. 6.7 and 6.10.\nAlthough steady-state relative attitude errors are greatly reduced in the case with\ncoupling, the control torques in the steady-state process for the two cases are almost\n\nFig. 6.8 Attitude tracking error of the 1st satellite without coupling between neighbors under\ndecentralized adaptive robust control with undirected communication topology\n\nFig. 6.9 Relative attitude error from the 1st to the 2nd satellite without coupling between\nneighbors under decentralized adaptive robust control with undirected communication topology\n\n6.6 Simulation Studies 155\n\n\n\nidentical, as can be seen from Figs. 6.4 and 6.11. Thus, simulation results validate\nthe effectiveness of the proposed decentralized adaptive sliding mode control law\nfor attitude synchronization and tracking.\n\nFig. 6.10 Relative attitude error from the 4th to the 1st satellite without coupling between\nneighbors under decentralized adaptive robust control with undirected communication topology\n\nFig. 6.11 Control torque of the 1st satellite without coupling between neighbors under\ndecentralized adaptive robust control with undirected communication topology\n\n156 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\n6.6.2 Velocity-Free Coordinated Attitude Control\n\nThe initial angular velocities of the satellites are xi 0\u00f0 \u00de \u00bc ?0:1 0:1 0:1\u00bd ?T rad=s;\ni \u00bc 1; 2; 3; 4; and the initial attitudes are given as\n\n?g1 0\u00f0 \u00de \u00bc 0:8986; 0:4;?0:1; 0:15\u00bd ?T ;\n?g2 0\u00f0 \u00de \u00bc 0:8888;?0:2; 0:1; 0:4\u00bd ?T ;\n?g3 0\u00f0 \u00de \u00bc 0:8062; 0:1;?0:5; 0:3\u00bd ?T ;\n?g4 0\u00f0 \u00de \u00bc 0:8426;?0:4;?0:2; 0:3\u00bd ?T :\n\n\u00f06:73\u00de\n\nThe initial desired quaternions are ?gdi 0\u00f0 \u00de \u00bc 1 0 0 0\u00bd ?T and the desired angular\nvelocities are xdi t\u00f0 \u00de \u00bc 0:1 cos t=40\u00f0 \u00de;?0:1 sin t=50\u00f0 \u00de;?0:1 cos t=60\u00f0 \u00de\u00bd ?T rad=s, where\ni \u00bc 1; 2; 3; 4:Different square-wave disturbances are added to each satellite randomly\nas shown in Table 6.1. The external disturbances used in the simulation areworse than\nthose observed in practice.\n\nThe controller parameters are chosen as, A \u00bc ?I3;P \u00bc 8I3; qi \u00bc 2; ki \u00bc 1; i \u00bc\n1; 2; 3; 4: Since q0;i [ 0; the condition (6.53) is not needed. Thus, in order to obtain\nbetter performance for attitude synchronization, the relative weight for attitude\nsynchronization can be chosen larger as follows. q12 \u00bc q43 \u00bc 4; k12 \u00bc k43 \u00bc 2:\nq21 \u00bc q23 \u00bc q32 \u00bc q34 \u00bc 2, k21 \u00bc k23 \u00bc k32 \u00bc k34 \u00bc 1; other parameters of qij; kij\nare chosen to be zero according to the communication topology.\n\nFor comparison, two cases are considered in the simulation. In the first case, the\ncoupling between neighbors corresponding to inter-satellite communication topol-\nogy in Fig. 6.1 is used. In the second case, it is assumed there is no coupling\nbetween neighbors (i.e., kij \u00bc qij \u00bc 0 for all i and j).\n\nAttitude tracking error, control torque of the 1st satellite, and relative attitude\nerror of the 2nd with respect to the 1st satellite in the first case are shown in\nFigs. 6.12, 6.13 and 6.14, respectively. Attitude tracking errors of other satellites\nand relative attitude errors between other pairs of satellites are similar to those of\nthe above. Due to space constraint, they are not plotted here. For ease of inter-\npretation, attitude error is expressed by Euler angles converted from unit quater-\nnion. It is observed from Figs. 6.12, 6.13 and 6.14 that attitude tracking of the 1st\n\nTable 6.1 Square-wave\ndisturbance of each satellite\n\nPeriod, s Magnitude, Nm\n\nAxis 1 Axis 2 Axis 3 Axis 1 Axis 2 Axis 3\n\nSp1 20 30 40 0.005 0.003 0.004\n\nSp2 40 15 20 0.003 0.005 0.007\n\nSp3 15 20 30 0.004 0.007 0.005\n\nSp4 30 25 15 0.003 0.004 0.007\n\n6.6 Simulation Studies 157\n\n\n\nsatellite is achieved, while the attitudes of the 1st and 2nd satellite are synchronized\nduring the transition, despite the presence of external disturbances and the absence\nof angular velocity measurements.\n\nFig. 6.12 Attitude tracking error of the 1st satellite under velocity-free coordinated attitude\ncontrol with undirected communication topology\n\nFig. 6.13 Control torque of the 1st satellite under velocity-free coordinated attitude control with\nundirected communication topology\n\n158 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nAttitude tracking error, control torque of the 1st satellite and relative attitude\nerror of the 2nd with respect to the 1st satellite in the second case are shown in\nFigs. 6.15, 6.16 and 6.17, respectively. As observed from Figs. 6.14 and 6.17,\n\nFig. 6.14 Relative attitude error from the 1st to the 2nd satellite under velocity-free coordinated\nattitude control with undirected communication topology\n\nFig. 6.15 Attitude tracking error of the 1st satellite without coupling between neighbors under\nvelocity-free coordinated attitude control with undirected communication topology\n\n6.6 Simulation Studies 159\n\n\n\nrelative attitude errors among satellites are greatly reduced in the first case as\ncompared to the second case, especially steady-state relative attitude errors.\nSteady-state relative attitude errors are reduced by 75 % approximately. Although\n\nFig. 6.16 Control torque of the 1st satellite without coupling between neighbors under\nvelocity-free coordinated attitude control with undirected communication topology\n\nFig. 6.17 Relative attitude error from the 1st to the 2nd satellite without coupling between\nneighbors under velocity-free coordinated attitude control with undirected communication\ntopology\n\n160 6 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nsteady-state relative attitude errors in the first case are greatly reduced as compared\nto the second case, the magnitudes of control torques in the steady-state process for\nthe two cases are almost identical, as can be seen from Figs. 6.13 and 6.16.\n\n6.7 Conclusions\n\nAttitude synchronization and tracking problems of satellite formation with undi-\nrected communication topology are studied with unit quaternion parameterization.\nFirstly, a decentralized adaptive sliding mode control law is designed by intro-\nducing the multi-satellite sliding mode vector, which includes attitude error, angular\nvelocity error of each individual satellite, relative attitude errors, and relative\nangular velocity errors among satellites. Then, this chapter solves the attitude\ntracking synchronization problem without angular velocity measurements. The\npassivity approach is applied to generate the necessary damping in the absence of\nthe actual absolute angular velocities measurements and relative angular velocities\nmeasurements between neighboring satellites. Numerical simulations are performed\nto validate the effectiveness of the proposed control laws. Simulation results\ndemonstrate that each individual satellite converges to the desired attitude and\nangular velocity with fine control performance. Furthermore, relative attitude errors\namong satellites, especially steady-state relative attitudes errors, are reduced by\nincluding the relative attitude errors and relative angular velocity errors (relative\ndamping in the second control law) in the proposed control laws.\n\nReferences\n\nAbdessameud A, Tayebi A (2009) Attitude synchronization of a group of spacecraft without\nvelocity measurements. IEEE Trans Autom Control 54(11):2642\u20132648. doi:10.1109/TAC.\n2009.2031567\n\nAhmed J, Coppola VT, Bernstein DS (1998) Adaptive asymptotic tracking of spacecraft attitude\nmotion with inertia matrix identification. J Guid Control Dyn 21(5):684\u2013691. doi:10.2514/2.\n4310\n\nBai H, Arcak M, Wen JT (2008) Rigid body attitude coordination without inertial frame\ninformation. Automatica 44(12):3170\u20133175. doi:10.1016/j.automatica.2008.05.018\n\nBeard RW, Lawton J, Hadaegh FY (2001) A coordination architecture for spacecraft formation\ncontrol. IEEE Trans Contr Syst Technol 9(6):777\u2013790. doi:10.1109/87.960341\n\nBo\u0161kovic JD, Li S, Mehra RK (2001) Robust adaptive variable structure control of spacecraft\nunder control input saturation. J Guid Control Dyn 24(1):14\u201322. doi:10.2514/2.4704\n\nChung SJ, Ahsun U, Slotine JJE (2009) Application of synchronization to formation flying\nspacecraft: Lagrangian approach. J Guid Control Dyn 32(2):512\u2013526. doi:10.2514/1.37261\n\nCrassidis JL, Vadali SR, Markley FL (2000) Optimal variable-structure control tracking of\nspacecraft maneuvers. J Guid Control Dyn 23(3):564\u2013566. doi:10.2514/2.4568\n\nDimarogonas DV, Tsiotras P, Kyriakopoulos KJ (2009) Leader\u2013follower cooperative attitude\ncontrol of multiple rigid bodies. Syst Control Lett 58(6):429\u2013435. doi:10.1016/j.sysconle.2009.\n02.002\n\n6.6 Simulation Studies 161\n\nhttp://dx.doi.org/10.1109/TAC.2009.2031567\nhttp://dx.doi.org/10.1109/TAC.2009.2031567\nhttp://dx.doi.org/10.2514/2.4310\nhttp://dx.doi.org/10.2514/2.4310\nhttp://dx.doi.org/10.1016/j.automatica.2008.05.018\nhttp://dx.doi.org/10.1109/87.960341\nhttp://dx.doi.org/10.2514/2.4704\nhttp://dx.doi.org/10.2514/1.37261\nhttp://dx.doi.org/10.2514/2.4568\nhttp://dx.doi.org/10.1016/j.sysconle.2009.02.002\nhttp://dx.doi.org/10.1016/j.sysconle.2009.02.002\n\n\nFax JA, Murray RM (2004) Information flow and cooperative control of vehicle formations. IEEE\nTrans Autom Control 49(9):1465\u20131476. doi:10.1109/TAC.2004.834433\n\nJadbabaie A, Lin J, Morse AS (2003) Coordination of groups of mobile autonomous agents using\nnearest neighbor rules. IEEE Trans Autom Control 48(6):988\u20131001. doi:10.1109/TAC.2003.\n812781\n\nJin E, Sun Z (2009) Robust attitude synchronisation controllers design for spacecraft formation.\nControl Theory Appl 3(3):325\u2013339. doi:10.1049/iet-cta:20070240\n\nJin E, Jiang X, Sun Z (2008) Robust decentralized attitude coordination control of spacecraft\nformation. Syst Control Lett 57(7):567\u2013577. doi:10.1016/j.sysconle.2007.12.006\n\nKang W, Yeh HH (2002) Co-ordinated attitude control of multi-satellite systems. Int J Robust\nNonlinear Control 12(2\u20133):185\u2013205. doi:10.1002/rnc.682\n\nKhoo S, Xie L, Man Z (2009) Robust finite-time consensus tracking algorithm for multirobot\nsystems. IEEE/ASME Trans Mechatron 14(2):219\u2013228. doi:10.1109/TMECH.2009.2014057\n\nKristiansen R, Lor\u00eda A, Chaillet A, Nicklasson PJ (2009) Spacecraft relative rotation tracking\nwithout angular velocity measurements. Automatica 45(3):750\u2013756. doi:10.1016/j.automatica.\n2008.10.012\n\nLafferriere G, Williams A, Caughman J, Veerman JJP (2005) Decentralized control of vehicle\nformations. Syst Control Lett 54(9):899\u2013910. doi:10.1016/j.sysconle.2005.05.004\n\nLawton JR, Beard RW (2002) Synchronized multiple spacecraft rotations. Automatica 38\n(8):1359\u20131364. doi:10.1016/S0005-1098(02)00025-0\n\nLawton JRT, Beard RW, Young BJ (2003) A decentralized approach to formation maneuvers.\nIEEE Trans Robot Autom 19(6):933\u2013941. doi:10.1109/TRA.2003.819598\n\nLi J, Kumar KD (2012) Decentralized fault-tolerant control for satellite attitude synchronization.\nTrans Fuzzy Syst 20(3):572\u2013586. doi:10.1109/TFUZZ.2011.2180391\n\nLi Z, Wang B (2007) Robust attitude tracking control of spacecraft in the presence of disturbances.\nJ Guid Control Dyn 30(4):1156\u20131159. doi:10.2514/1.26230\n\nLizarralde F, Wen JT (1996) Attitude control without angular velocity measurement: a passivity\napproach. IEEE Trans Autom Control 41(3):468\u2013472. doi:10.1109/9.486654\n\nLo SC, Chen Y (1995) Smooth sliding-mode control for spacecraft attitude tracking maneuvers.\nJ Guid Control Dyn 18(6):1345\u20131349. doi:10.2514/3.21551\n\nLuo W, Chu Y, Ling KV (2005) Inverse optimal adaptive control for attitude tracking of\nspacecraft. IEEE Trans Autom Control 50(11):1639\u20131654. doi:10.1109/TAC.2005.858694\n\nRen W (2007a) Distributed attitude alignment in spacecraft formation flying. Int J Adapt Control\nSignal Process 21(2\u20133):95\u2013113. doi:10.1002/acs.916\n\nRen W (2007b) Formation keeping and attitude alignment for multiple spacecraft through local\ninteractions. J Guid Control Dyn 30(2):633\u2013638. doi:10.2514/1.25629\n\nRen W (2009) Distributed leaderless consensus algorithms for networked Euler-Lagrange systems.\nInt J Control 82(11):2137\u20132149. doi:10.1080/00207170902948027\n\nRen W (2010) Distributed cooperative attitude synchronization and tracking for multiple rigid\nbodies. IEEE Trans Contr Syst Technol 18(2):383\u2013392. doi:10.1109/TCST.2009.2016428\n\nRen W, Atkins E (2007) Distributed multi-vehicle coordinated control via local information\nexchange. Int J Robust Nonlinear Control 17(10\u201311):1002\u20131033. doi:10.1002/rnc.1147\n\nRen W, Beard R (2004) Decentralized scheme for spacecraft formation flying via the virtual\nstructure approach. J Guid Control Dyn 27(1):73\u201382. doi:10.2514/1.9287\n\nSastry S, Bodson M (1989) Adaptive control: stability, convergence, and robustness. Pretnice Hall,\nNew Jersey\n\nShan J (2008) Six-degree-of-freedom synchronised adaptive learning control for spacecraft\nformation flying. Control Theory Appl 2(10):930\u2013949. doi:10.1049/iet-cta:20080063\n\nSlotine JJE, Coetsee JA (1986) Adaptive sliding controller synthesis for non-linear systems. Int J\nControl 43(6):1631\u20131651. doi:10.1080/00207178608933564\n\nSubbarao K, Welsh SJ (2008) Nonlinear control of motion synchronization for satellite proximity\noperations. J Guid Control Dyn 31(5):1284\u20131294. doi:10.2514/1.34248\n\nTsiotras P (1998) Further passivity results for the attitude control problem. IEEE Trans Autom\nControl 43(11):1597\u20131600. doi:10.1109/9.728877\n\n162 6 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1109/TAC.2004.834433\nhttp://dx.doi.org/10.1109/TAC.2003.812781\nhttp://dx.doi.org/10.1109/TAC.2003.812781\nhttp://dx.doi.org/10.1049/iet-cta:20070240\nhttp://dx.doi.org/10.1016/j.sysconle.2007.12.006\nhttp://dx.doi.org/10.1002/rnc.682\nhttp://dx.doi.org/10.1109/TMECH.2009.2014057\nhttp://dx.doi.org/10.1016/j.automatica.2008.10.012\nhttp://dx.doi.org/10.1016/j.automatica.2008.10.012\nhttp://dx.doi.org/10.1016/j.sysconle.2005.05.004\nhttp://dx.doi.org/10.1016/S0005-1098(02)00025-0\nhttp://dx.doi.org/10.1109/TRA.2003.819598\nhttp://dx.doi.org/10.1109/TFUZZ.2011.2180391\nhttp://dx.doi.org/10.2514/1.26230\nhttp://dx.doi.org/10.1109/9.486654\nhttp://dx.doi.org/10.2514/3.21551\nhttp://dx.doi.org/10.1109/TAC.2005.858694\nhttp://dx.doi.org/10.1002/acs.916\nhttp://dx.doi.org/10.2514/1.25629\nhttp://dx.doi.org/10.1080/00207170902948027\nhttp://dx.doi.org/10.1109/TCST.2009.2016428\nhttp://dx.doi.org/10.1002/rnc.1147\nhttp://dx.doi.org/10.2514/1.9287\nhttp://dx.doi.org/10.1049/iet-cta:20080063\nhttp://dx.doi.org/10.1080/00207178608933564\nhttp://dx.doi.org/10.2514/1.34248\nhttp://dx.doi.org/10.1109/9.728877\n\n\nVanDyke MC, Hall CD (2006) Decentralized coordinated attitude control within a formation of\nspacecraft. J Guid Control Dyn 29(5):1101\u20131109. doi:10.2514/1.17857\n\nWang PKC, Hadaegh FY, Lau K (1999) Synchronized formation rotation and attitude control of\nmultiple free-flying spacecraft. J Guid Control Dyn 22(1):28\u201335. doi:10.2514/2.4367\n\nWertz JR (1978) Spacecraft attitude determination and control, vol 73, Chaps. 12 and 16. Springer\nNetherlands\n\nWu B, Wang D, Poh EK (2010) Decentralized attitude coordinated control without velocity\nmeasurements for spacecraft formation. In: 8th IEEE international conference on control and\nautomation, Xiamen, China, pp 667\u2013672. doi:10.1109/ICCA.2010.5524126\n\nWu B, Wang D, Poh EK (2013) Decentralized sliding-mode control for attitude synchronization in\nspacecraft formation. Int J Robust Nonlinear Control 23(11):1183\u20131197. doi:10.1002/rnc.2812\n\nWu B, Wang D, Poh EK (2014) Decentralized sliding-mode control for spacecraft attitude\nsynchronization under actuator failures. Acta Astronaut 105(1):333\u2013343. doi:10.1016/j.\nactaastro.2014.10.011\n\nZhou J, Hu Q, Friswell MI (2013) Decentralized finite time attitude synchronization control of\nsatellite formation flying. J Guid Control Dyn 36(1):185\u2013195. doi:10.2514/1.56740\n\nZou A, Kumar KD (2012) Robust attitude coordination control for spacecraft formation flying\nunder actuator failures. J Guid Control Dyn 35(4):1247\u20131255. doi:10.2514/1.55218\n\nZou A, Kumar KD (2013) Quaternion-based distributed output feedback attitude coordination\ncontrol for spacecraft formation flying. J Guid Control Dyn 36(2):548\u2013556. doi:10.2514/1.\n56352\n\nReferences 163\n\nhttp://dx.doi.org/10.2514/1.17857\nhttp://dx.doi.org/10.2514/2.4367\nhttp://dx.doi.org/10.1109/ICCA.2010.5524126\nhttp://dx.doi.org/10.1002/rnc.2812\nhttp://dx.doi.org/10.1016/j.actaastro.2014.10.011\nhttp://dx.doi.org/10.1016/j.actaastro.2014.10.011\nhttp://dx.doi.org/10.2514/1.56740\nhttp://dx.doi.org/10.2514/1.55218\nhttp://dx.doi.org/10.2514/1.56352\nhttp://dx.doi.org/10.2514/1.56352\n\n\nChapter 7\nDecentralized Control for Attitude\nSynchronization Under Directed\nCommunication Topology\n\nThis chapter developed two decentralized coordinated attitude control laws for\nattitude synchronization and tracking problem with directed inter-satellite com-\nmunication topology. Firstly, an adaptive sliding mode control law is developed\nagainst inertia matrix uncertainties and external disturbances. Then, an adaptive\nbackstepping control law with considering inter-satellite communication delay is\nproposed.\n\n7.1 Introduction\n\nIn previous chapter, two decentralized coordinated attitude control laws are pro-\nposed for the undirected inter-satellite communication topology. However, in\npractice, the inter-satellite communication topology may be restricted to be directed,\nsuch as in unidirectional satellite laser communication system. Thus, two decen-\ntralized adaptive cooperative attitude control laws are developed for attitude syn-\nchronization with directed inter-satellite communication topology. Firstly, a robust\nadaptive control law is developed against inertia matrix uncertainties and external\ndisturbances. Time delays exist in the inter-satellite communication channels,\nwhich can lead to substantial performance deterioration and even to instability of\nthe attitude control system. Hence, an adaptive backstepping control law consid-\nering communication delay is subsequently proposed. The reported simulation\nresults confirm the effectiveness of the proposed methods with directed inter-\nsatellite communication topology.\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_7\n\n165\n\n\n\n7.2 Decentralized Adaptive Robust Control for Attitude\nSynchronization\n\nIn this section, a decentralized adaptive sliding mode control law is proposed for\nattitude synchronization and tracking using a general directed communication\ntopology (Wu et al. 2011). Firstly, the multi-satellite sliding mode vector is\ndeveloped. Subsequently, a decentralized adaptive sliding mode control law is\nderived based on the multi-satellite sliding mode vector.\n\nAssumptions 6.1 and 6.3\u20136.5 are also made about the dynamics of the attitude\nsynchronization and tracking systems in this section\n\n7.2.1 Multi-satellite Sliding Manifold\n\nIn Sect. 6.4.1, a multi-satellite sliding manifold is designed for the case of undi-\nrected communication topology. In this subsection, the multi-satellite sliding mode\nvector is modified for the case of directed communication topology and is defined\nas\n\nS \u00bc s1; . . .; sn\u00bd ?T \u00f07:1\u00de\n\nwhere si 2 R3? 1 is given by\n\nsi \u00bc bi?Ji ~xi \u00feCqi\u00f0 \u00de\u00fe\nXn\n\nj\u00bc1; j6\u00bci\naij ?Ji ~xi ? ?Jj ~xj\n? ?\u00fe ?JiCqi ? ?JjCqj? ?? ?; i \u00bc 1; . . .; n:\n\n\u00f07:2\u00de\n\nwith C being a positive definite constant matrix, scalar bi [ 0 is the control weight\nparameter for attitude tracking of the ith satellite (station-keeping behavior), scalar\naij ? 0 defined in (A.1) is the control weight parameter for inter-satellite attitude\nsynchronization between the ith and jth satellites (formation-keeping behavior), and\n?Ji is the nominal inertia matrix of the ith satellite.\n\nRemark 7.1 In the case of undirected communication topology, it is valid to assume\nai;j \u00bc aj;i in (7.2). This assumption greatly simplifies the stability proof of the\ncooperative attitude control system, because some terms involving ai; j in the time\nderivative of the Lyapunov function are eliminated by mutual cancelation.\nHowever, it is not valid to assume ai; j \u00bc aj;i in the case of directed communication\ntopology. Thus, cooperative control for attitude synchronization under directed\ncommunication topology is more challenging as compared to the case of undirected\ncommunication topology.\n\n166 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nUsing the Kronecker product, the multi-satellite sliding vector (7.1) can be\nrewritten as\n\nS \u00bc L\u00feB\u00f0 \u00de ? I3\u00bd ??J ~X\u00fe ~CQ\n? ? \u00f07:3\u00de\n\nwhere ~X \u00bc ~x1; . . .; ~xn\u00bd ?T , Q \u00bc q1; . . .; qn\u00bd ?T , B \u00bc diag \u00bdb1; . . .; bn?, I3 denotes the\n3 \u00d7 3 identity matrix, ~C \u00bc diag C; . . .;C\u00bd ? 2 R3n?3n, L is the weighted Laplacian\nmatrix corresponding to the inter-satellite directed communication topology as\ndescribed in (A.3), and ?J \u00bc diag ?J1; . . .; ?Jn\u00bd ?.\n\nThe multi-satellite sliding mode surface is then defined as S \u00bc 0. In view of\nProposition A.3, Lemma 5.1(iii) and the definition of B, it follows that L\u00feB\u00f0 \u00de ? I3\nhas full rank. Furthermore, ?J has full rank. Consequently, L\u00feB\u00f0 \u00de ? I3\u00bd ??J has full\nrank. Thus, it follows that ~X\u00fe ~CQ \u00bc 0 on the sliding mode surface S \u00bc 0 from\n(7.3). ~X\u00fe ~CQ \u00bc 0 implies ~xi \u00feCqi \u00bc 0; i \u00bc 1; . . .; n. It is obvious that\n~xi \u00feCqi \u00bc 0 implies that\n\nlim\nt!1\n\n~xik k \u00bc lim\nt!1 qik k \u00bc 0; i \u00bc 1; . . .; n \u00f07:4\u00de\n\nIt can be concluded that on the multi-satellite sliding mode surface S \u00bc 0, the\nattitude synchronization and tracking problem in Definition 6.1 is asymptotically\nsolved.\n\n7.2.2 Decentralized Adaptive Sliding Mode Control Design\n\nThis subsection presents the adaptive sliding mode control law which ensures that\nthe satellite attitude error dynamics (6.11)\u2013(6.13) will converge to the sliding\nmanifold S \u00bc 0.\n\nTo develop the control law, the following equations are derived from (6.11) and\n(6.12)\n\n?Ji _~xi \u00feC _qi\n? ? \u00bc hi \u00fe qi \u00fe ui; i \u00bc 1; . . .; n \u00f07:5\u00de\n\nwith\n\nhi t\u00f0 \u00de, ? x?i ?Jixi \u00fe ?Ji ~x?i R ?qi\u00f0 \u00dexdi ? R ?qi\u00f0 \u00de _xdi\n? ?\u00fe 1\n\n2\n?JiC q\n\n?\ni \u00fe qi;0I\n\n? ?\n~xi \u00f07:6\u00de\n\nqi t\u00f0 \u00de, di ? DJi _~xi ? x?i DJixi \u00feDJi ~x?i R ?qi\u00f0 \u00dexdi ? R ?qi\u00f0 \u00de _xdi\n? ? \u00f07:7\u00de\n\nqi t\u00f0 \u00de represents the inertia matrix uncertainties and external disturbances. Under\nAssumptions 6.1 and 6.3\u20136.5, and the definition of L and B, it can be shown that\n\n7.2 Decentralized Adaptive Robust Control \u2026 167\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_5\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nL\u00feB\u00f0 \u00de ? I3k k1 qi t\u00f0 \u00dek k1 ? ci;0 \u00fe ci;1\nX\nj2Ni\n\n~xj\n?? ??\n\n1 \u00fe ci;2\nX\nj2Ni\n\n~xj\n?? ??2\n\n1 \u00f07:8\u00de\n\nwhere ci;0; ci;1; and ci;2, are nonnegative constant numbers.\nHowever, as mentioned in Sect. 6.4.2, in the conventional sliding mode control\n\nlaws for attitude control in (Lo and Chen 1995; Crassidis et al. 2000; Bo\u0161kovic et al.\n2001), an important assumption is that inertia uncertainties and external distur-\nbances are bounded and that their bounds are known to the designer. The imple-\nmentation of the control law, based on a conservative bound, may result in\nimpractically large control authority and control chattering. Therefore, in order to\navoid the requirement of prior knowledge of the upper bound of\nL\u00feB\u00f0 \u00de ? I3k k1 qi t\u00f0 \u00dek k1, an adaptive mechanism is introduced to estimate its\n\nupper bound parameters.\nLet c?i;0; c?i;1; and c?i;2 denote the estimates of ci;0; ci;1; and ci;2, respectively. Now,\n\nconsider the simple adaptation laws for the upper bound of the norm\nL\u00feB\u00f0 \u00de ? I3k k1 qi t\u00f0 \u00dek k1 such that\n\n_~ci;0 , ji;0 sik k1\n_~ci;1 , ji;1 sik k1\n\nX\nj2Ni\n\n~xj\n?? ??\n\n1\n\n_~ci;2 , ji;2 sik k1\nX\nj2Ni\n\n~xj\n?? ??2\n\n1\n\n\u00f07:9\u00de\n\nwhere ~ci;0 \u00bc c?i;0 ? ci;0; ~ci;1 \u00bc c?i;1 ? ci;1 and~ci;2 \u00bc c?i;2 ? ci;2 are parameter adapta-\ntion errors, ji;0; ji;1 and ji;2 are positive adaptive gains, and si is the component of\nmulti-satellite sliding mode vector S, which is defined in (7.2).\n\nThe control input ui 2 R3?1 for the ith satellite is proposed as\n\nui \u00bc ?hi \u00fe\nXn\n\nj\u00bc1; j6\u00bci\naij \u00fe bi\n\n !?1 Xn\nj\u00bc1;j6\u00bci\n\naij uj \u00fe hj\n? ?? Kisi ? b?i sgn si\u00f0 \u00de\n\n\" #\n; i\n\n\u00bc 1; . . .; n \u00f07:10\u00de\n\nwhere hi is defined in (7.6), Ki 2 R3?3 is a positive definite gain matrix, aij and bi\nare defined in (7.2), sgn si\u00f0 \u00de, sgn si;1\n\n? ?\nsgn si;2\n? ?\n\nsgn si;3\n? ?? ?T , si; j; j \u00bc 1; 2; 3 is\n\nthe jth component of si, b?i is the adaptive upper bound of the norm\nL\u00feB\u00f0 \u00de ? I3k k1 qi t\u00f0 \u00dek k1 and is defined by\n\nb?i , c?i;0 \u00fe c?i;1\nX\nj2Ni\n\n~xj\n?? ??\n\n1 \u00fe c?i;2\nX\nj2Ni\n\n~xj\n?? ??2\n\n1; i \u00bc 1; . . .; n \u00f07:11\u00de\n\nNote that in the proposed control law (7.10), the information flow between satel-\nlites includes quaternion error and angular velocity error, as well as control input.\n\n168 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nThe following theorem establishes the condition for the existence of the\nmulti-satellite sliding mode surface S \u00bc 0 for satellite formation attitude tracking\nsystems described by (6.11)\u2013(6.13).\n\nTheorem 7.1 Consider the satellite formation attitude tracking dynamics descri-\nbed by (6.11)\u2013(6.13) with the decentralized adaptive sliding mode control law\n(7.10) and the adaptation law (7.9). If Assumptions 6.1 and 6.3\u20136.5 are valid, then\nthe multi-satellite sliding mode surface S \u00bc 0 defined in (7.1) will be reached\nasymptotically.\n\nProof The candidate Lyapunov function is chosen as\n\nV \u00bc V1 \u00feV2 \u00f07:12\u00de\n\nwith\n\nV1 \u00bc 12 S\nTS\n\nV2 \u00bc 12\nXn\ni\u00bc1\n\nj?1i;0 ~c\n2\ni;0 \u00fe j?1i;1 ~c2i;1 \u00fe j?1i;2 ~c2i;2\n\n? ?\n\nUsing the Kronecker product and the definition of adjacent matrix A and\nin-degree matrix D of inter-satellite communication graph, (7.10) can be rewritten\nas\n\nU \u00bc ?H\u00fe D\u00feB\u00f0 \u00de?1 ? I3\nh i\n\nA ? I3\u00f0 \u00de U\u00feH\u00f0 \u00de ?KS? b? sgn S\u00f0 \u00de\nh i\n\n\u00f07:13\u00de\n\nwhere U \u00bc u1; . . .; un\u00bd ?T , H \u00bc h1; . . .; hn\u00bd ?T , K \u00bc diag K1; . . .;Kn\u00bd ? and b? \u00bc\ndiag b?1I3; . . .; b?nI3\n\nh i\n.\n\nThe above equation can rewritten as\n\nU \u00bc ?H ? I3n ? D\u00feB\u00f0 \u00de?1 ? I3\nh i\n\nA ? I3\u00f0 \u00de\nn o?1\n\nD\u00feB\u00f0 \u00de?1 ? I3\nh i\n\nKS\u00fe b? sgn S\u00f0 \u00de\n? ?\n\n\u00bc ?H ? L\u00feB\u00f0 \u00de ? I3\u00bd ??1 KS\u00fe b? sgn S\u00f0 \u00de\n? ?\n\n\u00f07:14\u00de\n\nwhere the following equality is used\n\nI3n ? D\u00feB\u00f0 \u00de?1 ? I3\nh i\n\nA ? I3\u00f0 \u00de \u00bc D\u00feB\u00f0 \u00de?1 ? I3\nh i\n\nD\u00feB\u00f0 \u00de ? I3\u00bd ? ? A ? I3f g\n\n\u00bc D\u00feB\u00f0 \u00de?1 ? I3\nh i\n\nL\u00feB\u00f0 \u00de ? I3\u00bd ?\n\u00f07:15\u00de\n\nTaking the first derivative of V1 and using (7.3) and (7.5) leads to\n\n7.2 Decentralized Adaptive Robust Control \u2026 169\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\n_V1 \u00bc ST _S\n\u00bc ST L\u00feB\u00f0 \u00de ? I3\u00bd ? ?J _X\u00fe ?J~C _Q\n\n? ?\n\u00bc ST L\u00feB\u00f0 \u00de ? I3\u00bd ? H\u00fe q\u00feU\u00f0 \u00de\n\n\u00f07:16\u00de\n\nwhere q \u00bc q1; . . .;qn\u00bd ?T .\nSubstituting (7.14) into the above equation yields\n\n_V1 \u00bc ST L\u00feB\u00f0 \u00de ? I3\u00bd ?q? ST b? sgn S\u00f0 \u00de ? STKS\n\n?\nXn\ni\u00bc1\n\n?sTi Kisi ? b?i sik k1 \u00fe L\u00feB\u00f0 \u00de ? I3k k1? qik k1? sik k1\n? ?\n\n?\nXn\ni\u00bc1\n\n?sTi Kisi ? c?i;0 \u00fe c?i;1\nX\nj2Ni\n\n~xj\n?? ??\n\n1 \u00fe c?i;2 ~xik k\n2\n1\n\n !\nsik k1\n\n\" #\n\n\u00fe\nXn\ni\u00bc1\n\nsik k1? ci;0 \u00fe ci;1\nX\nj2Ni\n\n~xj\n?? ??\n\n1 \u00fe ci;2\nX\nj2Ni\n\n~xj\n?? ??2\n\n1\n\n !\" #\n\n\u00bc\nXn\ni\u00bc1\n\n?sTi Kisi ? ~ci;0 \u00fe~ci;1\nX\nj2Ni\n\n~xj\n?? ??\n\n1 \u00fe~ci;2\nX\nj2Ni\n\n~xj\n?? ??2\n\n1\n\n !\nsik k1\n\n\" #\n\n\u00f07:17\u00de\n\nTaking the first derivative of V2 and making use of the parameter adaptation law\n(7.9) yields\n\n_V2 \u00bc\nXn\ni\u00bc1\n\nj?1i;0 ~ci;0 _~ci;0 \u00fe j?1i;1 ~ci;1 _~ci;1 \u00fe j?1i;2 ~ci;2 _~ci;2\n? ?\n\n\u00bc ?\nXn\ni\u00bc1\n\n~c0 \u00fe~c1\nX\nj2Ni\n\n~xj\n?? ??\n\n1 \u00fe~c2\nX\nj2Ni\n\n~xj\n?? ??2\n\n1\n\n !\nsik k1\n\n\" # \u00f07:18\u00de\n\nAdding the above equation to (7.17) leads to\n\n_V ? ?\nXn\ni\u00bc1\n\nsTi Kisi ? 0 \u00f07:19\u00de\n\nTherefore, it follows that si 2 L1, and ~ci;0; ~ci;1; ~ci;2 2 L1. Consequently, from\n(7.10) and Assumption 6.1, it is obtained that ui 2 L1. It follows that _~xi, _qi hence\n_si are all bounded from (6.11) and (6.12). Integrating _V gives the results that\nsi 2 L2. Hence, using the corollary of Barbalat\u2019s Lemma in (Sastry and Bodson\n1989), it follows that lim\n\nt!1 si t\u00f0 \u00de \u00bc 0; i \u00bc 1; . . .; n. Thus, it is obtained that\nlim\nt!1 S t\u00f0 \u00de \u00bc 0. ?\n\n170 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nRemark 7.2 There is no assumption on inter-satellite communication topology in\nthe proposed control law. Thus, the proposed control law is applicable to any\ncommunication topology and is not restricted to be ring topology or undirected\ncommunication topology. The stability of the proposed control law is guaranteed\neven when there is no communication link, and then each satellite will be controlled\nindividually.\n\nRemark 7.3 Unlike (VanDyke and Hall 2006) and (Jin and Sun 2009), there is no\nadditional restriction on parameters bi and aij other than bi [ 0; aij ? 0 in (7.10). So\nthe proposed attitude synchronization and tracking scheme will allow the designer\nto prioritize between station-keeping behavior and formation-keeping behavior. For\nexample, if one want to prioritize formation-keeping behavior, aij should be chosen\nto be large relative to bi.\n\nRemark 7.4 In the proposed control law, the desired attitude of each satellite with\nrespect to inertial frame I is not restricted to be the same. Thus, the desired relative\nattitude between satellites can be maintained.\n\nRemark 7.5 The proposed control law (7.10) is discontinuous across the surface\nS\u00f0t\u00de, thus leading to control chattering. The smoothing control technique introduced\nin Sect. 6.4.3 can also be deployed to avoid the chattering of control input.\n\n7.3 Decentralized Adaptive Backstepping\nControl for Attitude Synchronization\nwith Communication Delay\n\nTime delays exist in inter-satellite communication channels, which may make the\nwhole control system lose stability. Hence, this section proposes an adaptive\nbackstepping control approach for satellite attitude synchronization and tracking\nunder directed communication topology with time delay.\n\nBackstepping is a popular nonlinear control design technique (Krsti? et al.\n1995). The term backstepping refers to the recursive nature of the control design\nprocedure in which a control law and a control Lyapunov function are recursively\nconstructed to guarantee stability. The advantage of integrator backstepping com-\npared with other control methods lies in its design flexibility, due to its recursive\nuse of Lyapunov functions. The control torque is designed for each integrator level\nin the system and thus enables the possibility to compensate for destabilizing\nnonlinearities, while stabilizing nonlinearities can be exploited. Backstepping has\nbeen considered for the satellite attitude control (Krstic and Tsiotras 1999;\nKristiansen et al. 2009; Ali et al. 2010). The cascaded structure of satellite kine-\nmatics and dynamics makes the integrator backstepping a preferred approach for the\nsatellite attitude control problem. This section proposes a decentralized adaptive\nbackstepping control law for attitude synchronization problem in the presence of\ninertia matrix uncertainties, external disturbances, and communication delays.\n\n7.2 Decentralized Adaptive Robust Control \u2026 171\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nThe following assumptions are made about the dynamics of the attitude syn-\nchronization and tracking systems\n\nAssumption 7.1 The upper bound of norm of the external disturbances di t\u00f0 \u00de is\nassumed to be known as\n\ndi t\u00f0 \u00dek k?Di \u00f07:20\u00de\n\nAssumption 6.6 is also assumed to be valid in this section.\n\nObserve that the attitude tracking error system in (6.11)\u2013(6.13) is a nonlinear\ncascade interconnection, that is, the kinematics subsystem (6.12) and (6.13) is\nstabilized only indirectly through the angular velocity error vector ~xi. Stabilizing\ncontrol laws for cascade systems can be efficiently designed using the method of\nintegrator backstepping (Krsti? et al. 1995). By this method, ~xi in (6.11)\u2013(6.13) is\nconsidered as a virtual control input of the ith satellite and a control law ai is\ndesigned to stabilize the kinematics subsystem. Subsequently, the actual control ui\nis designed to stabilize the dynamics subsystem (6.11) without destabilizing the\nkinematics subsystem (6.12) and (6.13).\n\nStep (1) Synchronization of the kinematics subsystems: The first backstepping\n~xi variable is chosen as z1i \u00bc 1? q0;i; qTi\n\n? ?T\n. Consider ~xi in the kinematics sub-\n\nsystem (6.12) and (6.13) as control input. Let z2i be an error variable representing\nthe difference between the actual and virtual control of the ith spacecraft for the\nkinematic subsystem (6.12) and (6.13), i.e. z2i \u00bc ~xi ? ai. The virtual control law\nfor the ith satellite is chosen as\n\nai \u00bc ?qiqi ?\nXn\n\nj\u00bc1; j 6\u00bci\nqaijqi ? qbijqj t ? Tij\n\n? ?? ?\n; i; j \u00bc 1; . . .; n \u00f07:21\u00de\n\nwhere Tij denotes the nonnegative time-varying communication delay from the jth\nto the ith satellite, Tij satisfies the following assumption.\n\nAssumption 7.2 Tij \u00bc Tji; _Tij\\1; i; j \u00bc 1; . . .; n; i 6\u00bc j\nRemark 7.6 The virtual control input (7.21) for ith satellite makes use of the error\nquaternion qj of its neighboring satellites. This information flow can be achieved by\ninter-satellite communication.\n\nRemark 7.7 The term ?qiqi in (7.21) is for attitude tracking of each individual\nsatellite, and the term\n\nPn\nj\u00bc1; j6\u00bci\n\n\u00f0qaijqi ? qbijqj\u00f0t ? Tij\u00de\u00de is for attitude synchronization\namong satellites.\n\nThe control parameters in (7.21) satisfy the following constraints\n\nqi [ 0; q\na\nij ? 0; qbij ? 0 \u00f07:22\u00de\n\n172 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nqbij ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n4cij 1? _Tij\n? ?\n\nciqaij ? cij\n? ?.\n\nc2i\n\nr\n\u00f07:23\u00de\n\nwhere ci is a positive constant, cij is an arbitrary positive constant which is not used\nin control law and only used in stability proof, thus cij can be chosen to guaranteed\n(7.23) is satisfied.\n\nThe candidate of Lyapunov function is chosen as\n\nV1 \u00bc\nXn\ni\u00bc1\n\nciz\nT\n1iz1i \u00fe\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\ncij\n\nZ t\nt?Tij\n\nqi\u00f0s\u00de\u00f0 \u00deTqi\u00f0s\u00deds \u00f07:24\u00de\n\nwhere the constant ci [ 0. The derivative of V1 is given by\n\n_V1 \u00bc\nXn\ni\u00bc1\n\nciq\nT\ni ~xi \u00fe\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\ncij q\nT\ni qi ? 1? _Tij\n\n? ?\nqi t ? Tij\n? ?? ?T\n\nqi t ? Tij\n? ?? ?h i\n\n\u00bc\nXn\ni\u00bc1\n\nciq\nT\ni z2i ? qiqi ?\n\nXn\nj\u00bc1\n\nqaijqi ? qbijqj t ? Tij\n? ?? ? !\n\n\u00fe\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\ncij q\nT\ni qi ? 1? _Tij\n\n? ?\nqi t ? Tij\n? ?? ?T\n\nqi t ? Tij\n? ?? ?h i\n\n\u00bc ?\nXn\ni\u00bc1\n\nciqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nciq\na\nij ? cij\n\n? ?\nqTi qi \u00fe\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nciq\nb\nijq\n\nT\ni qj t ? Tij\n? ?\n\n?\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\ncij 1? _Tij\n? ?\n\nqi t ? Tij\n? ?? ?T\n\nqi t ? Tij\n? ?? ?\u00fe Xn\n\ni\u00bc1\nciq\n\nT\ni z2i\n\n\u00f07:25\u00de\n\nIf Tij \u00bc Tji and cij \u00bc cji, then the above equation can be written as\n\n_V1 \u00bc ?\nXn\ni\u00bc1\n\nciqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nciq\na\nij ? cij\n\n? ?\nqTi qi \u00fe\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\nciq\nb\nijq\n\nT\ni qj t ? Tij\n? ?\n\n?\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\ncij 1? _Tij\n? ?\n\nqj t ? Tij\n? ?? ?T\n\nqj t ? Tij\n? ?? ?\u00fe Xn\n\ni\u00bc1\nciq\n\nT\ni z2i\n\n\u00f07:26\u00de\n\n7.3 Decentralized Adaptive Backstepping Control for Attitude \u2026 173\n\n\n\nThe above equation can be rewritten as\n\n_V1 \u00bc ?\nXn\ni\u00bc1\n\nciqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\neTij eij\nXn\ni\u00bc1\n\nciq\nT\ni z2i\n\n?\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\ncij 1? _Tij\n? ?? ciqbij\n\n? ?2\n4 ciqaij ? cij\n? ?\n\n2\n64\n\n3\n75 qj t ? Tij? ?? ?T qj t ? Tij? ?? ?\n\n\u00f07:27\u00de\n\nwhere\n\neij \u00bc\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nciqaij ? cij\n\nq\nqi ?\n\nciqbij\n2\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\nciqaij ? cij\n\np qj t ? Tij? ?? ? \u00f07:28\u00de\nNote that (7.23) yields\n\ncij 1? _Tij\n? ?? ciqbij\n\n? ?2\n4 ciqaij ? cij\n? ? ? 0 \u00f07:29\u00de\n\nThus, combining (7.27) with (7.29) leads to\n\n_V1 \u00bc ?\nXn\ni\u00bc1\n\nqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\neTij eij \u00fe\nXn\ni\u00bc1\n\nciq\nT\ni z2i \u00f07:30\u00de\n\nClearly, if z2i \u00bc 0, then _V1 \u00bc ?\nPn\ni\u00bc1\n\nqiq\nT\ni qi ?\n\nPn\ni\u00bc1\n\nPn\nj\u00bc1\n\neTij eij and z1i is guaranteed to\n\nconverge to zero asymptotically.\nStep (2) Synchronization of the full rigid-body models:\nFrom (7.21), it follows that\n\nz2i \u00bc ~xi ? ai \u00bc ~xi \u00fe qpi qi \u00fe\nXn\nj\u00bc1\n\nqaijqi ? qbijqj t ? Tij\n? ?? ? \u00f07:31\u00de\n\nBy using (6.12) and (6.13) and the above equation, it is obtained that\n\nJi _z2i \u00bc ?x?i Jixi \u00fe Ji ~x?i R ?qi\u00f0 \u00dexdi ? R ?qi\u00f0 \u00de _xdi\n? ?\u00fe ui\n\n\u00fe 1\n2\nqiJiS ?qi\u00f0 \u00de~xi \u00fe\n\n1\n2\nJi\nXn\nj\u00bc1\n\nqaijS ?qi\u00f0 \u00de~xi ? qbijS ?qj t ? Tij\n? ?? ?\n\n~xj t ? Tij\n? ?h i\n\n\u00f07:32\u00de\n\n174 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nFollowing the approach in (Ahmed et al. 1998), the following relationship holds\n\nJix \u00bc L x\u00f0 \u00debi \u00f07:33\u00de\n\nwhere x \u00bc x1 x2 x3\u00bd ?T and\n\nL\u00f0x\u00de \u00bc\nx1 0 0 0 x3 x2\n0 x2 0 x3 0 x1\n0 0 x3 x2 x1 0\n\n2\n4\n\n3\n5 \u00f07:34\u00de\n\nand bi 2 R6 represents the unknown constant parameters of inertia matrix, and is\ndefined as\n\nbi \u00bc Ji;11 Ji;22 Ji;33 Ji;23 Ji;13 Ji;12\u00bd ?T \u00f07:35\u00de\n\nBy using (7.33), (7.32) can be rewritten as\n\nJi _z2i \u00bc Fi ?qi; ~xi;xd; _xd\u00f0 \u00debi \u00fe ui t\u00f0 \u00de\u00fe di t\u00f0 \u00de \u00f07:36\u00de\n\nwhere Fi ?qi; ~xi;xd; _xd\u00f0 \u00de is given by\n\nFi \u00bc ?x?i L xi\u00f0 \u00de\u00fe L ~x?i R ?qi\u00f0 \u00dexd ? R ?qi\u00f0 \u00de _xd \u00fe\n1\n2\nqiS ?qi\u00f0 \u00de~xi\n\n\n ?\n\n\u00fe L 1\n2\n\nXn\nj\u00bc1\n\nqaijS ?qi\u00f0 \u00de~xi ? qbijS ?qj t ? Tij\n? ?? ?\n\n~xj t ? Tij\n? ?h i( ) \u00f07:37\u00de\n\nThe adaptive control law for the ith satellite is designed as follows\n\nui t\u00f0 \u00de \u00bc ?ciqi ? Kiz2i ? Fi ?qi; ~xi;xd; _xd\u00f0 \u00deb?i ? D?i sgn z2i\u00f0 \u00de \u00f07:38\u00de\n_?bi \u00bc Ci Fi ?qi; ~xi;xd; _xd\u00f0 \u00de\u00bd ?Tz2i \u00f07:39\u00de\n\n_?Di \u00bc Ui z2ik k \u00f07:40\u00de\n\nwhere Ki and Ci are positive definite matrices, Ui is a positive constant, b?i and D?i are\n\nestimates of bi and Di, respectively. sgn z2i\u00f0 \u00de \u00bc sgn z12i\n? ?\n\nsgn z22i\n? ?\n\nsgn z32i\n? ?? ?T ,\n\nz j2i; j \u00bc 1; 2; 3 is the ith component of z2i.\nChoose the candidate of Lyapunov function as\n\nV2 \u00bc V1 \u00fe 12\nXn\ni\u00bc1\n\nzT2iJiz2i \u00fe\n1\n2\n~bTi C\n\n?1\ni\n~bi \u00fe\n\n1\n2\n~DTi U\n\n?1\ni\n\n~Di \u00f07:41\u00de\n\nwhere ~bi \u00bc bi ? b?i and ~Di \u00bc Di ? D?i.\n\n7.3 Decentralized Adaptive Backstepping Control for Attitude \u2026 175\n\n\n\nThe derivative of V2 is\n\n_V2 \u00bc\nXn\ni\u00bc1\n\nciq\nT\ni z2i ? qiqi ?\n\nXn\nj\u00bc1\n\nqaijqi ? qbijqj t ? Tij\n? ?? ?\" #\u00fe Xn\n\ni\u00bc1\nzT2iJi _z2i \u00fe ~bTi C?1i _~bi \u00fe ~DTi U?1i _~Di\n\n? ?\nXn\ni\u00bc1\n\nciqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\neTij eij \u00fe\nXn\ni\u00bc1\n\nzT2i ciqi\u00feFibi \u00fe ui \u00fe di\u00f0 \u00de\u00fe ~bTi C?1i _~bi \u00fe ~DTi U?1i _~Di\n\n? ?\nXn\ni\u00bc1\n\nciqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\neTij eij ?\nXn\ni\u00bc1\n\nzT2iKiz2i\n\n\u00fe\nXn\ni\u00bc1\n\nzTi Fi~bi ? D?i sgn z2i\u00f0 \u00de\u00fe di\n? ?\n\n\u00fe ~bTi C?1i _~bi \u00fe ~DTi U?1i _~Di\n\n? ?\nXn\ni\u00bc1\n\nciqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\neTij eij ?\nXn\ni\u00bc1\n\nzT2iKiz2i\n\n\u00fe\nXn\ni\u00bc1\n\n~DTi U\n?1\ni Ui z2ik k ? _?Di\n? ?\n\n\u00fe\nXn\ni\u00bc1\n\n~bTi C\n?1\ni CiF\n\nT\ni z2i ? _?bi\n\nh i\n\u00f07:42\u00de\n\nSubstituting (7.39) and (7.40) into the above equation yields\n\n_V2 \u00bc ?\nXn\ni\u00bc1\n\nciqiq\nT\ni qi ?\n\nXn\ni\u00bc1\n\nXn\nj\u00bc1\n\neTij eij ?\nXn\ni\u00bc1\n\nzT2iKiz2i ? 0 \u00f07:43\u00de\n\nThe following stability results based on this scheme can be derived\n\nTheorem 7.2 Consider attitude synchronization and tracking systems described by\n(6.11)\u2013(6.13) with application of controller (7.38) and the parameter update laws\n(7.39) and (7.40). If Assumptions 6.1, 6.6 and 7.1, 7.2 are valid and the control\nparameters satisfy the constraints in (7.22) and (7.23), then the attitude synchro-\nnization and tracking problem in Definition 6.1 is asymptotically solved.\n\nProof From (7.43), it is established that V2 is non-increasing. Therefore, it follows\nthat z1i; z2i 2 L1, and b?i; D?i 2 L1. Thus, ui 2 L1 and _z1i, _z2i are all bounded.\nIntegrating _V gives the results that z1i; z2i 2 L2. Hence, using the corollary of\nBarbalat\u2019s Lemma in (Sastry and Bodson 1989), it follows that lim\n\nt!1 z1i t\u00f0 \u00de \u00bc 0 and\nlim\nt!1 z2i t\u00f0 \u00de \u00bc 0. Thus, it follows that limt!1 qi t\u00f0 \u00de \u00bc 0 and limt!1 ~xi t\u00f0 \u00de \u00bc 0 by (7.31). ?\n\nRemark 7.8 The smoothing control technique introduced in Sect. 6.4.3 can also be\ndeployed to avoid the chattering of control input in (7.38).\n\nTheorem 7.2 is a general conclusion which always takes effect as long as the\ninter-satellite communication time delays satisfy Assumption 7.2, which means that\nif Assumption 7.2 is valid, then controller (7.38) is competent, whether the time\ndelays are large or small, and whether the variables of the entire system change\nquickly or slowly. In fact, if the time delays in the communication links are small\nenough, or the attitude states of the whole formation are so slowly time varying that\n\n176 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nthe effects of the delays can be ignored, then some extended results can be obtained\nas presented in the following.\n\nCorollary 7.1 Consider attitude synchronization and tracking systems described\nby (6.11)\u2013(6.13) with application of the following control law and the parameter\nupdating laws.\n\nui t\u00f0 \u00de \u00bc ?ciqi ? Kiz2i ? Fi ?qi; ~xi;xd; _xd\u00f0 \u00deb?i ? D?i sgn z2i\u00f0 \u00de \u00f07:44\u00de\n_?bi \u00bc Ci Fi ?qi; ~xi;xd; _xd\u00f0 \u00de\u00bd ?Tz2i \u00f07:45\u00de\n\n_?Di \u00bc Ui z2ik k \u00f07:46\u00de\n\nwith\n\nz2i \u00bc xi \u00fe qpi qi \u00fe\nXn\nj\u00bc1\n\nqaijqi ? qbijqj\n? ?\n\n\u00f07:47\u00de\n\nFi \u00bc ?x?i L xi\u00f0 \u00de\u00fe L ~x?i R ?qi\u00f0 \u00dexd ? R ?qi\u00f0 \u00de _xd \u00fe\n1\n2\nqiS ?qi\u00f0 \u00de~xi\n\n\n ?\n\n\u00fe L 1\n2\n\nXn\nj\u00bc1\n\nqaijS ?qi\u00f0 \u00de~xi ? qbijS ?qj\n? ?\n\n~xj\nh i( ) \u00f07:48\u00de\n\nIf Assumptions 6.1, 6.6, and 7.1, 7.2 are valid and the control parameters satisfy\nthe constraints in (7.22) and\n\nqbij ?\nffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffiffi\n4cij ciq\n\na\nij ? cij\n\n? ?.\nc2i\n\nr\n\u00f07:49\u00de\n\nthen the attitude synchronization and tracking problem in Definition 6.1 is\nasymptotically solved.\n\nFollowing the stability proof of Theorem 7.2, the stability proof of corollary can\nbe obtained straightforwardly.\n\nRemark 7.9 The smoothing control technique introduced in Sect. 6.4.3 can also be\ndeployed to avoid the chattering of control input (7.44).\n\n7.4 Numerical Results\n\nSimulation results are presented in this section to illustrate the performance and\nstability characteristics of the proposed decentralized adaptive control laws. Two\nscenarios with four satellites are considered in the simulations. In the first scenario,\n\n7.3 Decentralized Adaptive Backstepping Control for Attitude \u2026 177\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nthe four satellites communicate via a directed line topology as shown in Fig. 7.1a,\nwhile a ring topology, shown in Fig. 7.1b, is used in the second scenario. Note that\nalthough both communication graphs have a spanning tree, the proposed control\nlaw is valid even when there is no spanning tree. The corresponding weighted\nLaplacian matrices for the topologies are\n\nLa \u00bc\n1 ?1 0 0\n0 1 ?1 0\n0 0 1 ?1\n0 0 0 0\n\n2\n664\n\n3\n775; Lb \u00bc\n\n1 ?1 0 0\n0 1 ?1 0\n0 0 1 ?1\n?1 0 0 1\n\n2\n664\n\n3\n775 \u00f07:50\u00de\n\nThe following two subsections present simulation results of decentralized\nadaptive sliding mode control and adaptive backstepping control for attitude syn-\nchronization and tracking, respectively.\n\n7.4.1 Decentralized Adaptive Sliding Mode Control\n\nThe simulation parameters, such as the actual and nominal inertia matrices of the\nsatellites, the external disturbances, the initial attitude tracking errors, the initial\nangular velocity errors, and the desired attitude and angular velocity, are the same\nas in Sect. 6.6.1. Simulation results of adaptive sliding mode control for Scenario 1\nand Scenario 2 are given as follows.\nScenario 1: line communication topology\nThe controller parameters in the first scenario are chosen with C \u00bc I3, bi \u00bc 1,\n/i \u00bc 0:1, Ki \u00bc 0:01I3 and the parameters of the adaptation law (7.9) are chosen\nwith ?ji;0 \u00bc 0:1, ?ji;1 \u00bc ?ji;2 \u00bc 0:2, for i \u00bc 1; . . .; 4 and c?0i;0 \u00bc c?0i;1 \u00bc c?0i;2 \u00bc 0, where\n\nFig. 7.1 Inter-satellite directed communication topology for satellite attitude synchronization.\na Line topology for in-track\\in-plane formation. b Ring topology for circular-like formation\n\n178 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nc?0i;0; c?\n0\ni;1; c?\n\n0\ni;2 are the initial values of c?i;0; c?i;1; c?i;2, respectively. The control\n\nparameters of inter-satellite synchronization are chosen as a12 \u00bc 1, a23 \u00bc 1, a34 \u00bc 1\nand all other aij \u00bc 0.\n\nFigures 7.2 and 7.3 show the respective attitude errors and control torques of the\n1st satellite using the control law (7.10), respectively. For ease of interpretation,\nattitude errors are expressed in Euler angles converted from unit quaternion.\nAttitude errors and control torques of the other satellites are similar to those of the\n1st satellite, and are not plotted here due to space constraint. Figures 7.4 and 7.5\nshow relative attitude errors of the 2nd with respect to the 1st satellite and the 1st\nwith respect to the 4th satellite, respectively. Relative attitude errors between other\npairs of satellites are similar to those of the above two. For comparison, Figs. 7.7,\n7.8, and 7.9 show attitude errors, control torques, and relative attitude errors when\nthere is no coupling between neighbors [i.e., aij \u00bc 0; i; j \u00bc 1; 2; 3; 4 in (7.10)]. As\nobserved from simulation results, relative attitude errors between satellites, espe-\ncially the steady-state values, in the case with coupling between neighbors are\nsmaller as compared to the case without coupling. Note that the magnitudes of\nsteady-state control torques for the two cases are almost identical, as can be seen in\nFigs. 7.2 and 7.7. The adaptive parameter b?1 defined in (7.11) with the control law\n(7.10) is bounded as shown in Fig. 7.6, thus the efficacy of the proposed adaptation\nlaw (7.9) is verified.\n\nFig. 7.2 Attitude tracking error of the 1st satellite under decentralized robust adaptive control\nwith directed communication topology\n\n7.4 Numerical Results 179\n\n\n\nFig. 7.3 Control torque of the 1st satellite under decentralized robust adaptive control with\ndirected communication topology\n\nFig. 7.4 Relative attitude error between the 1st and the 2nd satellites under decentralized robust\nadaptive control with directed communication topology\n\n180 7 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nScenario 2: ring communication topology\nAll the controller parameters in the second scenario are identical to those in the first\nscenario except that a41 \u00bc 1 in the second scenario. Figures 7.10 and 7.11 show\nrelative attitude errors between the 1st and 2nd satellites and between 4th and 1st\nsatellites, respectively. As observed from Figs. 7.4, 7.5, 7.10 and 7.11, relative\nattitude errors in the ring topology are slightly smaller than those in the line\ntopology, because additional coupling between 4th to 1st satellites is introduced in\n\nFig. 7.5 Relative attitude error between the 4th and the 1st satellites under decentralized robust\nadaptive control with directed communication topology\n\nFig. 7.6 Adaptive parameter\nb?1 of the 1st satellite under\ndecentralized robust adaptive\ncontrol with directed\ncommunication topology\n\n7.4 Numerical Results 181\n\n\n\nFig. 7.7 Attitude tracking error of the 1st satellite without coupling between neighbors under\ndecentralized robust adaptive control with directed communication topology\n\nFig. 7.8 Control torque of the 1st satellite without coupling between neighbors under\ndecentralized robust adaptive control with directed communication topology\n\n182 7 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nFig. 7.9 Relative attitude error between the 1st and the 2nd satellites without coupling between\nneighbors under decentralized robust adaptive control with directed communication topology\n\nFig. 7.10 Relative attitude error between the 1st and the 2nd satellites under decentralized robust\nadaptive control with the unidirectional ring topology\n\n7.4 Numerical Results 183\n\n\n\nthe ring topology. Thus, the simulation results validate the effectiveness of the\nproposed control law under a unidirectional ring communication topology.\n\n7.4.2 Decentralized Adaptive Backstepping Control\n\nThe inter-satellite communication topology used in this example is the ring\ntopology for circular-like formation as in Fig. 7.1b.\n\nThe actual inertiamatrices of the satellites and the external disturbances are the same\nas in Sect. 6.6.1. The desired angular velocities of the satellites are xdi t\u00f0 \u00de \u00bc\n0; 0:2; 0\u00bd ?T rad/s, and the initial desired attitudes are ?gdi 0\u00f0 \u00de \u00bc 1 0 0 0\u00bd ?T , where\ni \u00bc 1; 2; 3; 4. The initial angular velocities of the satellites are chosen as zero, and the\ninitial attitude tracking errors are chosen as\n\n?q1\u00f00\u00de \u00bc 0:9849 ?0:1 0:1 ?0:1\u00bd ?T ; ?q2\u00f00\u00de \u00bc 0:9763 0:1 0:15 ?0:12\u00bd ?T ;\n?q3\u00f00\u00de \u00bc 0:9605 0:15 ?0:15 0:18\u00bd ?T ; ?q4\u00f00\u00de \u00bc 0:9750 0:10 ?0:15 0:13\u00bd ?T :\n\n\u00f07:51\u00de\n\nIn order to validate the robustness against model uncertainties of the proposed\ncontrol laws, it is assumed that the inertia matrices of the satellites are known as\n\nFig. 7.11 Relative attitude error between the 4th and the 1st satellites under decentralized robust\nadaptive control with the unidirectional ring topology\n\n184 7 Decentralized Control for Attitude Synchronization \u2026\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\n\n\nJ1 \u00bc diag( 40; 34; 30\u00bd ?T\u00dekgm2\nJ2 \u00bc diag( 44; 38; 30\u00bd ?T\u00dekgm2\nJ3 \u00bc diag\u00f0 36; 30; 34\u00bd ?T\u00dekgm2\nJ4 \u00bc diag( 36; 40; 30\u00bd ?T\u00dekgm2\n\n\u00f07:52\u00de\n\nwhich are set as the initial values of the adaptation laws (7.39).\nFor comparison, two cases are considered. In this first case, it is assumed\n\ninter-satellite coordination is not available, i.e., all qaij and q\nb\nij are equal to zero. In\n\nthe second case, the inter-satellite coordination corresponding to the communica-\ntion topology in Fig. 7.1b is used.\n\nA. Attitude synchronization without Inter-satellite coordination\n\nThe control law parameters for the first case are chosen as Ci \u00bc diag( 100\u00bd\n1001001; 0002501; 000?T\u00de, ci \u00bc 0:1, Ki \u00bc 5I3, k2;i \u00bc 0:3, qi \u00bc I3 qaij \u00bc 0, qbij \u00bc 0,\nUi \u00bc 0:2 and /i \u00bc 0:01, where i \u00bc 1; 2; 3; 4; j \u00bc 1; 2; 3; 4; j 6\u00bc i.\n\nThe response of the closed-loop system of the 1st satellite for the first case is\nshown in Figs. 7.12, 7.13, and 7.14. For ease of interpretation, attitude errors are\nexpressed by Euler angles converted from unit quaternion. It is observed that\nattitude tracking of the 1st satellite is achieved despite the presence of external\ndisturbances and large model uncertainties. The parameter estimations of inertia\nmatrix are bounded, as shown in Fig. 7.14. The responses of the closed-loop sys-\ntems of other satellites are similar and are not plotted here due to space constraint.\n\nFig. 7.12 Attitude tracking error of the 1st satellite without coupling between neighbors under\ndecentralized adaptive backstepping control with the unidirectional ring topology\n\n7.4 Numerical Results 185\n\n\n\nFig. 7.13 Control torque of the 1st satellite without coupling between neighbors under\ndecentralized adaptive backstepping control with the unidirectional ring topology\n\nFig. 7.14 Inertia matrix estimation of the 1st satellite without coupling between neighbors under\ndecentralized adaptive backstepping control with the unidirectional ring topology\n\n186 7 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nThe relative attitudes of the 2nd with respect to the 1st satellite and the 1st with\nrespect to the 4th satellite are plotted in Figs. 7.15 and 7.16, respectively.\n\nFig. 7.15 Relative attitude errors of the 2nd with respect to the 1st satellite without coupling\nbetween neighbors under adaptive backstepping control with the unidirectional ring topology\n\nFig. 7.16 Relative attitude errors of the 1st with respect to the 4th satellite without coupling\nbetween neighbors under decentralized adaptive backstepping control with the unidirectional ring\ntopology\n\n7.4 Numerical Results 187\n\n\n\nB. Attitude Synchronization with Inter-Satellite Communication\n\nThe control parameters of inter-satellite synchronization for the second case are\nchosen as qa12 \u00bc 1:2; qb12 \u00bc 1, qa23 \u00bc 1:2; qb23 \u00bc 1, qa34 \u00bc 1:2; qb34 \u00bc 1, qa41 \u00bc 1:2;\nqb41 \u00bc 1 and all other qaij, qbij are zero. All the inter-satellite communication delays are\nassumed to be identical and equal to Tij \u00bc 1\u00fe 0:1 sin 0:2 t\u00f0 \u00de seconds. The assumed\ncommunication delay comprises constant time delay 1 s and time-varying delay\n0:1 sin 0:2 t\u00f0 \u00de second. In order to validate the effectiveness of the proposed control law\nin the presence of communication delay, the assumed time delay is larger than the case\nin practice. Other control parameters are identical with the first case.\n\nSimulation results of the second case are shown in Figs. 7.17, 7.18, 7.19, 7.20.\nFigure 7.17 shows attitude tracking error of the 1st satellite. Attitude errors of the\nother satellites are similar to that of the 1st satellite. Figures 7.18 and 7.19 show the\nattitude tracking errors of the 2nd with respect to the 1st satellite and the 1st with\nrespect to the 4th satellite. Relative attitude errors between other pairs of satellites\nare similar to those of the above two. As observed from Figs. 7.15, 7.16 and 7.18\nand 7.19, relative attitude errors among satellites are reduced, especially\nsteady-state relative attitude errors. Although steady-state relative attitude errors are\ngreatly reduced in the second case, the control torques in the steady-state process\nfor the two cases are almost identical, as can be shown in Figs. 7.13 and 7.20. Thus,\nsimulation results validate the effectiveness of the proposed decentralized adaptive\nbackstepping control law for satellite attitude tracking synchronization problem\nwith communication delay.\n\nFig. 7.17 Attitude tracking error of the 1st satellite under decentralized adaptive backstepping\ncontrol with the unidirectional ring topology\n\n188 7 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nFig. 7.18 Relative attitude error from the 1st to the 2nd satellite under decentralized adaptive\nbackstepping control with the unidirectional ring topology\n\nFig. 7.19 Relative attitude error from the 4th to the 1st satellite under decentralized adaptive\nbackstepping control with the unidirectional ring topology\n\n7.4 Numerical Results 189\n\n\n\n7.5 Conclusions\n\nIn this chapter, the attitude synchronization and tracking problem in satellite for-\nmation under a general directed communication topology is addressed using unit\nquaternion parameterization. Firstly, a decentralized adaptive sliding mode control\nlaw is designed by introducing appropriate multi-satellite sliding mode vector,\nwhich includes attitude error and angular velocity error of individual satellite, as\nwell as relative attitude errors and relative angular velocity errors between satellites.\nAn adaptive mechanism to estimate the model uncertainty and external disturbance\nbound was presented. Convergence of the tracking errors was established using\ngraph theoretic formulation. Then, an adaptive backstepping control law is pro-\nposed for a general directed communication topology with communication time\ndelay. Numerical simulations are performed to validate the robust performance of\nthe proposed control laws in the presence of model uncertainties, disturbances, and\ncommunication delay (for the second control law). Simulation results demonstrate\nthat each individual satellite converges to the desired attitude and angular velocity\nwith acceptable control magnitude. Furthermore, relative attitude errors between\nsatellites, especially the steady-state values, are reduced by including the relative\nattitude errors and relative angular velocity errors in the proposed control laws.\n\nFig. 7.20 Control torque of the 1st satellite under decentralized adaptive backstepping control\nwith the unidirectional ring topology\n\n190 7 Decentralized Control for Attitude Synchronization \u2026\n\n\n\nReferences\n\nAhmed J, Coppola VT, Bernstein DS (1998) Adaptive asymptotic tracking of spacecraft attitude\nmotion with inertia matrix identification. J Guid Control Dyn 21(5):684\u2013691. doi:10.2514/2.\n4310\n\nAli I, Radice G, Kim J (2010) Backstepping control design with actuator torque bound for\nspacecraft attitude maneuver. J Guid Control Dyn 33(1):254\u2013259. doi:10.2514/1.45541\n\nBo\u0161kovic JD, Li S, Mehra RK (2001) Robust adaptive variable structure control of spacecraft\nunder control input saturation. J Guid Control Dyn 24(1):14\u201322. doi:10.2514/2.4704\n\nCrassidis JL, Vadali SR, Markley FL (2000) Optimal variable-structure control tracking of\nspacecraft maneuvers. J Guid Control Dyn 23(3):564\u2013566. doi:10.2514/2.4568\n\nJin E, Sun Z (2009) Robust attitude synchronisation controllers design for spacecraft formation.\nControl Theory Appl 3(3):325\u2013339. doi:10.1049/iet-cta:20070240\n\nKristiansen R, Nicklasson PJ, Gravdahl JT (2009) Satellite attitude control by quaternion-based\nbackstepping. Trans Control Syst Technol 17(1):227\u2013232. doi:10.1109/TCST.2008.924576\n\nKrsti? M, Kokotovi? PV, Kanellakopoulos I (1995) Nonlinear and adaptive control design, vol\nBook. Whole, United States\n\nKrstic M, Tsiotras P (1999) Inverse optimal stabilization of a rigid spacecraft. IEEE Trans Autom\nControl 44(5):1042\u20131049. doi:10.1109/9.763225\n\nLo SC, Chen Y (1995) Smooth sliding-mode control for spacecraft attitude tracking maneuvers.\nJ Guid Control Dyn 18(6):1345\u20131349. doi:10.2514/3.21551\n\nSastry S, Bodson M (1989) Adaptive control: stability, convergence, and robustness. Pretnice Hall,\nNew Jersey\n\nVanDyke MC, Hall CD (2006) Decentralized coordinated attitude control within a formation of\nspacecraft. J Guid Control Dyn 29(5):1101\u20131109. doi:10.2514/1.17857\n\nWu B, Wang D, Poh EK (2011) Decentralized robust adaptive control for attitude synchronization\nunder directed communication topology. J Guid Control Dyn 34(4):1276\u20131282. doi:10.2514/1.\n50189\n\nReferences 191\n\nhttp://dx.doi.org/10.2514/2.4310\nhttp://dx.doi.org/10.2514/2.4310\nhttp://dx.doi.org/10.2514/1.45541\nhttp://dx.doi.org/10.2514/2.4704\nhttp://dx.doi.org/10.2514/2.4568\nhttp://dx.doi.org/10.1049/iet-cta:20070240\nhttp://dx.doi.org/10.1109/TCST.2008.924576\nhttp://dx.doi.org/10.1109/9.763225\nhttp://dx.doi.org/10.2514/3.21551\nhttp://dx.doi.org/10.2514/1.17857\nhttp://dx.doi.org/10.2514/1.50189\nhttp://dx.doi.org/10.2514/1.50189\n\n\nChapter 8\nConclusions\n\n8.1 Summary\n\nThe primary motivation for satellite formation flying is that multiple small satellites\ncan work together in a group to accomplish the mission of a larger, usually more\nexpensive, satellite. Operating multiple satellites in the formation offers benefits of\n(i) flexibility because the operator can reconfigure and reposition the individual\nsatellites to perform different tasks, (ii) graceful degradation of performance in the\nevent of single satellite failure which will not result in total mission failure due to\nhigher redundancy, and (iii) a more cost effective solution including cheaper and\nsimpler bus designs and faster build times. These attributes have engendered\nsatellite formation flying for many interesting missions in the areas of astronomy,\ncommunications, meteorology, and environmental monitoring.\n\nThe control of satellite formation flying can conceptually be realized in two\nways:\n\n\u2022 Ground-based or Space-based Leader-Follower centralized control\u2014In\nground-based control, the respective measurements are sent by each satellite on\nthe formation to a ground control center that will generate control commands to\nenable these satellites to maneuver into the appropriate position in the formation.\nThis approach is adequate for formations with separation between spacecraft on\nthe order of kilometers without requiring dynamic adjustment of their orbits.\nThe interval between adjustment maneuvers is usually done over months.\nSimilarly, the leader-follower approach is another form of centralized control\nsolution in which the leader is a single point of failure for the entire formation.\n\n\u2022 Autonomous decentralized control\u2014In autonomous flying formations, the\nindividual satellite measurements are broadcasted between spacecraft, allowing\nthem to compute their relative positions in the formation and use the Attitude\nand Orbit Control Systems (AOCS) to maneuver into the desired position and\nattitude orientation. This approach is necessary for close satellite formations that\nrequire frequent adjustment of their relative positions and orientation. This\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5_8\n\n193\n\n\n\napproach is technically more difficult and challenging since unforeseen distur-\nbances and collision risks can potentially lead to loss of control or destruction of\nthe spacecraft.\nIndeed, advanced satellite formation flying concepts have become more real-\nizable mainly due to the development of autonomous decentralized control\ncapability. With an onboard computer, satellites will be able to autonomously\nposition and orientate themselves into desired formation without requiring\nground control intervention to continuously adjust each satellite to maintain\nformation. As such, satellites are able to arrive at and maintain formations with\nfaster response time and have the ability to change the formation to meet\nmission requirements even in the presence of environmental disturbances and\nsystem uncertainties. Also, satellites may be launched from different launchers\nand maneuvered to rendezvous on specific orbit. This is true particularly for\nsatellite cluster formation with satellites operating in a dense (relatively tightly\nspaced) arrangement. The resulting formations are best suited for\nhigh-resolution interferometry and Digital Elevation Measurement. The\nTechSat-21 is an example of satellite cluster formation flying.\n\nThis book has made further contribution in this areas of centralized and\ndecentralized control for satellite formation flying. We reviewed common relative\nsatellite motion models which are needed for satellite formation control design and\nproposed a novel dynamic model for satellite relative motion for precise satellite\nformation design, guidance, and control. Unlike earlier work, we obtain an exact J2\nnonlinear relative model which ensures high satellite orbit fidelity and accuracy\nrequired for precise long-duration satellite formation control and maintenance.\nA simpler first order J2 linear relative model is also derived with reduced com-\nputational requirement and is suitable for periodic short-term formation maneuver\nand keeping.\n\nPassive and periodic satellite formation (Sabol et al. 2001) is another interesting\nproblem discussed in this book. Such formation is attractive as it eliminates, or at\nleast minimizes, the thruster propellant needed for maintenance and thus improves\nthe useable duration of the mission. We extend earlier results which ignore J2\ngravitational perturbations on the satellite orbits. Under this condition, it is shown\nthat there are two classes of passive and periodic relative trajectories: (i) one with\nall satellites flying in the critical inclination and (ii) all satellites flying in the same\nregressing orbital plane. The respective exact conditions for these two trajectories\nare established and proved.\n\nThe problem of precise decentralized satellite formation control using low-thrust\nelectric propulsion system is also addressed. Recent advances in electric propulsion\nsystem which promises precise thrust output and consume less propellant have\nmade it an attractive solution (Polzin 2011). Furthermore, using the exact J2 non-\nlinear relative model developed earlier in this book, a nonlinear optimal control\nproblem is formulated to design fuel-optimal trajectories for satellite formation\nmaneuver using low-thrust continuous propulsion. The Legendre pseudospectral\nmethod is applied to solve the optimization problem with desired terminal\n\n194 8 Conclusions\n\n\n\nformation geometry requirements and collision avoidance constraints using\nlow-thrust propulsion system.\n\nFormation keeping strategy is necessary to ensure that desired satellite formation\nflying is maintained in the presence of various environmental perturbations such as\ngravitational perturbation and atmospheric drag. Two methods of optimal\ncontrol-based satellite formation keeping strategies are presented. The first\napproach develops a real-time fuel-optimal control law for a leader-follower\narchitecture which maintains the formation despite various orbital perturbations.\nThe second solution adopts a decentralized formation control approach using only\nlocal relative measurement. This latter methodology is completely scalable as it\ndoes not require full communication among all the formation satellites.\n\nAttitude synchronization among satellites is beneficial for practical uses such as\nsatellite surveillance, pointing control, formation flying, and space-based interfer-\nometry (Li and Kumar 2012).\n\nThis book discusses decentralized control for attitude synchronization using both\nundirected, i.e., bidirectional, and directional inter-satellite communication topol-\nogy. With undirected communication topology, a coordinated attitude control law\nwithout velocity measurement is derived to solve the attitude tracking synchro-\nnization problem. In practice, the inter-satellite communication topology may be\nrestricted to be directed, such as in unidirectional satellite laser communication\nsystem. Hence, controller synthesis solutions were also developed which are robust\nagainst inertia matrix uncertainties, external disturbances and communication time\nlatency.\n\n8.2 Trends and Challenges\n\nIn recent years, there have been a growing number of small satellite missions, in\nvarious stages of development, for formation flying missions. In particular, small\nnano-satellites, weighing between 1 and 8 kg, are particularly attractive for for-\nmation flying missions because of their modular nature and low cost. These small\nsatellites can be configured to serve as distributed instruments for atmospheric\nsampling, construct a large distributed antenna platform, or constitute a large dis-\ntributed aperture for imaging and surveillance applications.\n\nIn Bandyopadhyay et al. (2015), a survey review of state-of-the-art satellite\nformation flying missions, using multiple small satellites, was presented. The\nthirty-nine missions were also categorized based on their mission type, mission\nstatus, and number of satellites. It was concluded that Earth science-related mis-\nsions are the most popular. Six missions target to demonstrate formation flying\ncapability using two to three small satellites while another 2 missions plan to use\nfour or more small satellites. The rest of the multi-satellite missions require a\nconstellation.\n\nIn essence, the primary technical challenges for satellite formation control design\nand implementation includes the following:\n\n8.1 Summary 195\n\n\n\n\u2022 Controlling the nonlinear dynamics in satellite formation flying in the presence\nof environmental disturbances with autonomous control algorithms.\n\n\u2022 Balancing the requirements between satellite maneuver for satellite formation\nkeeping and fuel consumption\n\n\u2022 Developing sub-millimeter accuracy sensors to determine the relative position of\nsatellites and maturing actuator technology to enhance orbital position control\nfor small satellites.\n\n\u2022 Overcoming robustness challenges for inter-satellite communication.\n\nIn this book, we have addressed the first two technologies but not the navigation,\nsensors, actuators and communication hardware required for formation flying\nmissions. Some studies have suggested the use of Global Navigation Satellite\nSystem (GNSS) for relative navigation of near-Earth formation flying missions.\nHowever, GNSS is not suitable for precision relative navigation in formation flying\nbeyond low Earth orbits. Also, full collaboration and communication architecture\namong the formation satellites is not preferable for some flying missions due to high\noperational cost and technology immaturity. These remain interesting and active\nareas of research and development.\n\nReferences\n\nBandyopadhyay S, Subramanian GP, Foust R, Morgan D, Chang SJ, Hadaegh F (2015) A review\nof impending small satellite formation flying missions, 53rd AIAA aerospace sciences meeting,\nAIAA SciTech\n\nLi JQ, Kumar KD (2012) Decentralized fault tolerant control for satellite attitude synchronization.\nIEEE Trans Fuzzy Syst 20(3):572\u2013586\n\nPolzin KA (2011) Comprehensive review of planar pulsed inductive plasma thruster research and\ntechnology. J Propul Power 27(3):513\u2013531\n\nSabol C, Burns R, McLaughlin CA (2001) Satellite formation flying design and evolution.\nJ Spacecr Rocket 38(2):270\u2013278\n\nSmall Spacecraft Technology Sate of the Art, NASA Ames Research Center (2014) Moffett Field,\nCA. http://www.nasa.gov/sites/default/files/files/Small_Spacecraft_Technology_State_of_the_\nArt_2014.pdf\n\n196 8 Conclusions\n\nhttp://www.nasa.gov/sites/default/files/files/Small_Spacecraft_Technology_State_of_the_Art_2014.pdf\nhttp://www.nasa.gov/sites/default/files/files/Small_Spacecraft_Technology_State_of_the_Art_2014.pdf\n\n\nAppendix A\nAlgebraic Graph Theory\n\nThe necessary results from algebraic graph theory (Merris 1994; Chung 1997) are\nintroduced in this section to address the decentralized formation keeping and\ncooperative attitude synchronization problems. A directed communication topology\ncan be described by directed graph. A directed graph Gn consists of a finite set of\nvertices, denoted V, and a set of arcs A ? V2, where a \u00bc ?a; ?b? ? 2 A and ?a; ?b 2 V.\nThe arc ?a; ?b\n\n? ?\ndenotes that vertex ?b can obtain the information of vertex ?a. In\n\ndecentralized control problem for satellite formation, the arc a; b\u00f0 \u00de denotes that\nsatellite ? can measure relative state of satellite ? with respect to satellite ?. In\nattitude synchronization application, the arc ?a; ?b\n\n? ?\ndenotes that satellite ?b can\n\nobtain attitude information of satellite ?a. It is assumed that the graph has no\nself-loops, meaning that \u00f0?a; ?b\u00de 2 A implies ?a 6\u00bc ?b. If every possible arc exists, the\ngraph is said to be complete.\n\nA path on Gn of length N from ?a1 to ?aN\u00fe 1 is an ordered set of distinct vertices\n?a1; . . .; ?aN\u00fe 1f g such that ?ai?1; ?ai\u00f0 \u00de 2 A for all i 2 2; . . .;N \u00fe 1\u00bd ?. A graph in which\n\na path exists from any vertex to any other vertex is said to be strongly connected.\nA spanning tree in Gn is a graph in which exists a vertex ?a such that there is a\ndirected path from vertex ? to every other vertex in Gn.\n\nThe adjacency matrix of Gn denoted A is a square matrix of size n with entries\n\nai; j [ 0 if ?aj; ?ai\n? ? 2 A\n\nai; j \u00bc 0 otherwise\n?\n\n?ai; ?aj 2 V\n? ? \u00f0A:1\u00de\n\nwhere the non-negative ai;j is subsequently chosen to be the control weight\nparameter between the ith and jth satellite. For decentralized formation keeping,\nwi;j ai;j can be used to balance fuel consumption among satellites. Note that ai;i \u00bc 0\nfrom (A.1).\n\nThe in-degree matrix of Gn is the diagonal matrix D with diagonal entries\n\ndi;i \u00bc\nXn\n\nj\u00bc1; j 6\u00bci\nai;j; i \u00bc 1; . . .; n \u00f0A:2\u00de\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5\n\n197\n\n\n\nFollowing Merris (1994), the Laplacian L 2 Rn?n of the graph Gn is defined as\nfollows:\n\nL \u00bc D? A \u00f0A:3\u00de\n\nNote that a graph with the property that for any ?a; ?b\n? ? 2 A, the arc ?b; ?a? ? 2 A\n\nas well is said to be undirected. In the satellite formation application, this corre-\nsponds to having bidirectional relative measurement or communication. It is valid\nto assume ai;j \u00bc aj;i in the case of the undirected communication\\sensing topology.\nUnder this assumption, the Laplacian L is a symmetrical matrix, which simplifies\nthe stability analysis of cooperative control system. However, in the case of directed\ncommunication\\sensing topology, L is generally not symmetric because ai;j \u00bc aj;i\ndoes not hold.\n\nThe following results are used in Chaps. 6 and 7 to derive stability proof for the\nproposed controllers design.\nProposition A.1 (Merris 1994) Zero is an eigenvalue of L. The associated\neigenvector is all the ones vector 1T .\n\nProposition A.2 (Merris 1994) For a digraph with N vertices, all the eigenvalues\nof L have nonnegative real part less than or equal to 2\u00f0N ? 1\u00de (use Gershgorin\u2019s\ntheorem). Moreover, except for the eigenvalue zero, the real part of all other\neigenvalues is positive.\n\nProposition A.3 (Merris 1994) If GnGn is undirected, then all the eigenvalues of L\nare real. Moreover, the least nonzero eigenvalue k2 of L grows monotonically with\nthe number of arcs. More precisely, adding edges never decreases k2.\n\nProposition A.4 (Ren et al. 2005) If and only if Gn has a spanning tree, zero is an\neigenvalue of algebraic multiplicity one for the Laplacian L. The associated\neigenvector is all the ones vector 1Tn . The associated left eigenvector is\nv1; v2; . . .; vn\u00bd ?, where\n\nPn\ni\u00bc1 vi \u00bc 1, and vi ? 0; i \u00bc 1; 2; . . .; n.\n\n198 Appendix A: Algebraic Graph Theory\n\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_6\nhttp://dx.doi.org/10.1007/978-981-10-2383-5_7\n\n\nAppendix B\nOptimal Guaranteed Cost Control\n\nThis section introduces a control method called the optimal guaranteed cost control,\nwhich is applied to a linear norm-bound uncertain system; details are given in Li\n(1985).\n\nConsider a class of linear uncertain systems described by the following\nstate-space equation:\n\n?x0 h\u00f0 \u00de \u00bc ?A\u00feD?A\u00f0 \u00de?x h\u00f0 \u00de\u00fe ?B\u00feD?B\u00f0 \u00de?u h\u00f0 \u00de; ?x 0\u00f0 \u00de \u00bc ?x0 \u00f0A:4\u00de\n\nwhere ? is the free variable, ?x0 h\u00f0 \u00de is the derivative of the state variable ?x with respect\nto ?, ?A and ?B are known constant real matrices of appropriate dimensions, D?A, and\nD?B are matrix-valued functions representing time-varying parameter uncertainties\nin the system model. The parameter uncertainties considered here are assumed to be\nnorm-bounded and of the form:\n\nD?A D?B\u00bd ? \u00bc DF\u00f0h\u00de E1 E2\u00bd ? \u00f0A:5\u00de\n\nwhere D; E1and E2 are known constant real matrices of appropriate dimensions,\nwhich represent the structure of uncertainties. Suppose the uncertain matrix F\u00f0h\u00de is\nof the following block diagonal form:\n\nF h\u00f0 \u00de \u00bc diagfF1\u00f0h\u00de;F2\u00f0h\u00de; . . .;Fl\u00f0h\u00deg \u00f0A:6\u00de\n\nwhere Fk\u00f0h\u00de 2 Rik?jk and satisfies\n\nFTk \u00f0h\u00deFk\u00f0h\u00de? Ijk?jk ; k \u00bc 1; 2; . . .; l: \u00f0A:7\u00de\n\nwhere Ijk ? jk denotes the identity matrix of dimension jk . For\n\ne \u00bc e1; e2; . . .; el\u00bd ?; ek [ 0; k \u00bc 1; 2; . . .; l \u00f0A:8\u00de\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5\n\n199\n\n\n\nDefine\n\n~M \u00bc diagfe1Ii1?i1 ; e2Ii2?i2 ; . . .; elIil?ilg \u00f0A:9\u00de\n~N \u00bc diagfe?11 Ij1?j1 ; e?12 Ij2?j2 ; . . .; e?1l Ijl?jlg \u00f0A:10\u00de\n\nThen\n\nDF\u00f0h\u00de E1 E2\u00bd ? \u00bc D ~MF\u00f0h\u00de ~NE1 ~NE2\n? ? \u00f0A:11\u00de\n\nAssociated with the system in (A.4) is the following cost function, where ?Q and\n?R are given positive definite symmetric matrices.\n\nJ \u00bc\nZ1\n\n0\n\n?xT\u00f0h\u00de?Q?x\u00f0h\u00de\u00fe ?uT\u00f0h\u00de?R?u\u00f0h\u00de? ? dh \u00f0A:12\u00de\n\nDefinition A.1 Consider the uncertain system in (A.4), if there exists a control law\n?u?\u00f0h\u00de and a positive scalar J? such that for all admissible uncertainties, the\nclosed-loop system is stable and the closed-loop value of the cost function in (A.12)\nsatisfies J? J?, then J? is said to be a guaranteed cost and ?u?\u00f0h\u00de is said to be a\nguaranteed cost control law for the uncertain system in (A.4).\n\nThe objective of this section is to design a state-feedback guaranteed cost control\nlaw ?u\u00f0h\u00de \u00bc K?x\u00f0h\u00de for the uncertain system in (A.4) .\nTheorem A.1 (Li 1985) Given the system described (A.4) and the associated cost\nfunction in (A.12), if the following optimization problem\n\nmin\ne; W ; X; M\n\nTrace M\u00f0 \u00de \u00f0A:13\u00de\n\nsubject to\n\n?AX \u00fe ?BW \u00fe ?AX\u00fe ?BW\u00f0 \u00deT E1X\u00feE1W\u00f0 \u00deT X WT D ~M\nE1X\u00feE1W ?~N?1 0 0 0\n\nX 0 ??Q?1 0 0\nW 0 0 ??R?1 0\n~MDT 0 0 0 ? ~M\n\n2\n66664\n\n3\n77775\\0\n\n\u00f0A:14\u00de\n\nM I\nI X\n\n? ?\n[ 0 \u00f0A:15\u00de\n\n200 Appendix B: Optimal Guaranteed Cost Control\n\n\n\nhas a solution e?; W?; X? [ 0; M? [ 0, then the state-feedback control law is the\noptimal guaranteed cost controller as follows:\n\n?u\u00f0h\u00de \u00bc W? X?\u00f0 \u00de?1?x\u00f0h\u00de \u00f0A:16\u00de\n\nand the associated guaranteed cost is as follows:\n\n?J? trace X?1? ? \u00bc ?J? \u00f0A:17\u00de\nwhere W is matrix variable, and X;M are positive definite matrix variables.\n\nThe above problem is a convex optimization problem subject to linear matrix\ninequalities constraints and can be solved by using LMI toolbox in MATLAB.\n\nAppendix B: Optimal Guaranteed Cost Control 201\n\n\n\nAppendix C\nNomenclature\n\nSubscripts and superscript\n\nj The jth deputy satellite\nf Final value\n~r Scaled variable\n?r Secular part of orbit element variables\nrt Time-varying variables\n_r First derivative\n?\u2018r Second derivative\n? The ?th phase in the trajectory\n0 Initial value\n0 Reference or chief satellite\n\nThe following list of symbols is alphabetical\u2014lowercase and then upper case;\nArabic; and then Greek letters.\n\na Semimajor axis\na Control acceleration vector\nax Control acceleration in x direction in LVLH frame\nay Control acceleration in y direction in LVLH frame\naz Control acceleration in z direction in LVLH frame\nco cos(o)\nd Disturbance torque\n?d Distance between satellites\n?dmax Possible maximum relative distance during the maneuver\n?dsafe Assumed safe distance between satellites\ne Eccentricity\ne Euler axis\nf True anomaly\ng0 Sea-level acceleration due to gravity\n\n\u00a9 Springer Science+Business Media Singapore 2017\nD. Wang et al., Satellite Formation Flying, Intelligent Systems,\nControl and Automation: Science and Engineering 87,\nDOI 10.1007/978-981-10-2383-5\n\n203\n\n\n\nh Angular momentum vector\nh Magnitude of angular momentum vector\ni Inclination\ni Index (general)\nj Index (general)\nm Satellite mass\nq Relative position vector in LVLH frame\n?q Error quaternion\nq Vector part of error quaternion\nq0 Scalar part of error quaternion\nr Position vector of reference or chief satellite\nr Geocentric distance of reference or chief satellite\nso sin(o)\nsj The jth component of multi-satellite sliding vector\nt General time\nu Thrust direction\nu Control torque\nvjx Component of velocity vector of the jth member satellite in ECI frame\nvjy Component of velocity vector of the jth member satellite in ECI frame\nvjz Component of velocity vector of the jth member satellite in ECI frame\nx Radial difference between two objects in LVLH frame\nx? Unit vector along radial direction in LVLH frame\ny Along-track difference between two objects in LVLH frame\ny? Unit vector along along-track direction in LVLH frame\nz Cross-track difference between two objects in LVLH frame\nz? Unit vector along cross-track direction in LVLH frame\nD Reference frame for satellite reference attitude\nE Orbital energy\nFj Magnitude of constant thrust of the jth member satellite\nH Polar component of the orbital angular momentum\nIsp The specific impulse of the engine\nJ Inertia matrix of satellite\nJ2 Geopotential coefficient representing Earth\u2019s oblateness\nKj Kinetic energy of the jth member satellite\nR Rotation Matrix\nrcf Radius of circular formation\nRe Earth equatorial radius\nS Multi-satellite sliding vector\nS0 Reference satellite or chief satellite\nSj The jth member satellite\nLj Lagrangian of the jth member satellite\nL Laplacian matrix in algebraic graph theory\nM Satellite mean anomaly\nN Number of LGL points\nNs Number of deputy satellites\n\n204 Appendix C: Nomenclature\n\n\n\nT Nodal orbital period\nT Magnitude of constant thrust\nTc Period of chief satellite\nU Gravitational potential\nX? Unit vector in Earth-centered inertial (ECI) frame\n\nY? Unit vector in ECI frame\n\nZ? Unit vector in ECI frame\nax Satellite steering acceleration\naz Satellite orbital acceleration\n? Position vector in LVLH frame\n? Magnitude of position vector in LVLH frame\n? True latitude\n? Geocentric latitude of satellite\n? Euler angle\n?g Quaternion\n? Vector part of quaternion\ng0 Scalar part of quaternion\n? Geocentric latitude of satellite\n? Right ascension of ascending node\n? Vector of orbital angular velocity\n? Argument of perigee\n? Angular velocity\nxd Desired angular velocity\n~x Angular velocity error\nxx Component of orbital angular velocity\nxy Component of orbital angular velocity\nxz Component of orbital angular velocity\n? Earth gravitational constant\n? Eigenvalue\n\nReferences\n\nChung FR (1997) Spectral graph theory, regional conference series in mathematics number 92.\nAmerican Mathematical Society, Providence, RI\n\nLi Y (1985) Robust control: an LMI approach. Tsinghua University, Beijing, China\nMerris R (1994) Laplacian matrices of graphs: a survey. Linear Algebraic Appl 198:143\u2013176\nRen W, Beard RW, McLain TW (2005) Coordination variables and consensus building in multiple\n\nvehicle systems. In: Kumar V, Leonard NE, Morse AS (eds) Lecture notes in control and\ninformation sciences, Berlin, Cooperative Control, pp 171\u2013188\n\nAppendix C: Nomenclature 205\n\n\n\tContents\n\t1 Introduction\n\t1.1 Background\n\t1.1.1 Motivations\n\t1.1.2 Applications\n\t1.1.3 Challenges\n\n\t1.2 Objectives of This Book\n\t1.3 Preview of Chapters\n\tReferences\n\n\t2 Dynamic Models of Satellite Relative Motion Around an Oblate Earth\n\t2.1 Introduction\n\t2.2 Nonlinear Dynamic Model of Relative Motion\n\t2.2.1 J2 Reference Satellite Dynamics in LVLH Frame\n\t2.2.1.1 Properties of LVLH Frame\n\t2.2.1.2 J2 Dynamics of a Satellite in LVLH Frame\n\n\t2.2.2 Derivation of Exact J2 Nonlinear Relative Dynamics\n\t2.2.2.1 Lagrangian Formulation of Relative Motion\n\t2.2.2.2 Kinetic Energy\n\t2.2.2.3 Potential Energy\n\t2.2.2.4 Exact Nonlinear J2 Relative Dynamics\n\n\n\t2.3 Linearized Dynamic Models of Relative Motion\n\t2.4 Validation of Proposed Dynamic Models by Simulation\n\t2.5 Comparison Study of Relative Dynamic Models\n\t2.5.1 Comparison Method with Model Error Index\n\t2.5.2 Selected Dynamic Models for Comparison Study\n\t2.5.2.1 Clohessy-Wiltshire Model\n\t2.5.2.2 Tschauner-Hempel Model\n\t2.5.2.3 Unperturbed Nonlinear Model\n\t2.5.2.4 Schweighart-Sedwick Model\n\t2.5.2.5 Xu-Wang Model\n\n\t2.5.3 Case Studies\n\t2.5.3.1 Simulation Scenario\n\t2.5.3.2 Case 1: Error Index Versus Formation Size\n\t2.5.3.3 Case 2: Error Index Versus Eccentricity\n\t2.5.3.4 Case 3: Error Index Versus Inclination\n\t2.5.3.5 Case 4: Error Index Versus Semimajor Axis\n\n\n\t2.6 Summary\n\tReferences\n\n\t3 Passive and Periodic Satellite Formation Design Around an Oblate Earth\n\t3.1 Introduction\n\t3.2 Passive and Periodic Relative Motion Under J2 Perturbation\n\t3.3 Periodic and Quasi-periodic Relative Orbits at Critical Inclination\n\t3.3.1 Periodic Relative Orbit\n\t3.3.2 Quasi-periodic Relative Orbit\n\t3.3.3 Quasi-periodic Relative Orbit Conditions in Terms of Actual Orbit Variables\n\t3.3.4 Numerical Simulations\n\n\t3.4 In-Plane Satellite Formation in Eccentric Orbits\n\t3.4.1 Identical Anomaly In-Plane Formation\n\t3.4.2 Differential Anomaly In-Plane Formation\n\t3.4.3 Almost Constant Separation Formation\n\n\t3.5 Conclusions\n\tReferences\n\n\t4 Nonlinear Optimization of Low-Thrust Trajectory for Satellite Formation\n\t4.1 Introduction\n\t4.2 Nonlinear Relative Motion Dynamics\n\t4.3 Problem Formulation of Trajectory Optimization for Satellite Formation\n\t4.3.1 Initial Condition Constraints\n\t4.3.2 Final Condition Constraints\n\t4.3.3 Path Constraints\n\t4.3.4 Linking Constraints\n\n\t4.4 Introduction of Legendre Pseudospectral Method\n\t4.5 Computational Considerations of Nonlinear Programming Problem\n\t4.6 Scaling of Nonlinear Programming Problem\n\t4.6.1 Initial Guess\n\t4.6.2 Implementation\n\n\t4.7 Illustrative Examples\n\t4.7.1 Example 1: Scenario of Two Satellites, One Burn Phase\n\t4.7.2 Example 2: Scenario of Two Satellites, Two Phases: Coast\u2013Burn\n\t4.7.3 Example 3: Scenario of Two Satellites, Three Phases: Burn\u2013Coast\u2013Burn\n\t4.7.4 Example 4: Scenario of Two Satellites, Four Phases: Coast\u2013Burn\u2013Coast\u2013Burn\n\t4.7.5 Example 5: Scenario of Formation Reconfiguration Involving Four Satellites\n\t4.7.6 Example 6: Scenario of Collision Avoidance Validation\n\n\t4.8 Conclusions\n\tReferences\n\n\t5 Optimal Control for Satellite Formation Keeping\n\t5.1 Introduction\n\t5.1.1 Leader\u2013Follower Formation Keeping Approaches\n\t5.1.2 Decentralized Formation Keeping Approaches\n\n\t5.2 Real-Time Optimal Formation Keeping in Leader\u2013Follower Frame\n\t5.2.1 Real-Time Optimal Control Law Design\n\t5.2.2 Discretization Using Legendre Pseudospectral Method\n\t5.2.3 Computational Considerations of Quadratic Programming Problem\n\t5.2.4 Numerical Simulations\n\n\t5.3 Decentralized Formation Control Using Local Relative Measurements\n\t5.3.1 Problem Formulation of Decentralized Formation Control\n\t5.3.2 Decentralized Formation Control Design\n\t5.3.3 Optimal Guaranteed Cost Control Design\n\t5.3.4 Simulation Results\n\t5.3.4.1 Circular Formation\n\t5.3.4.2 In-Plane Formation\n\n\n\t5.4 Conclusions\n\tReferences\n\n\t6 Decentralized Control for Attitude Synchronization Under Undirected Communication Topology\n\t6.1 Introduction\n\t6.2 Satellite Attitude Dynamics\n\t6.3 Problem Formulation of Attitude Synchronization\n\t6.4 Decentralized Robust Adaptive Control for Attitude Synchronization\n\t6.4.1 Multi-satellite Sliding Manifold\n\t6.4.2 Decentralized Adaptive Sliding Mode Control Design\n\t6.4.3 Smoothing Control Law\n\n\t6.5 Velocity-Free Coordinated Attitude Control\n\t6.6 Simulation Studies\n\t6.6.1 Decentralized Adaptive Sliding Mode Control\n\t6.6.2 Velocity-Free Coordinated Attitude Control\n\n\t6.7 Conclusions\n\tReferences\n\n\t7 Decentralized Control for Attitude Synchronization Under Directed Communication Topology\n\t7.1 Introduction\n\t7.2 Decentralized Adaptive Robust Control for Attitude Synchronization\n\t7.2.1 Multi-satellite Sliding Manifold\n\t7.2.2 Decentralized Adaptive Sliding Mode Control Design\n\n\t7.3 Decentralized Adaptive Backstepping Control for Attitude Synchronization with Communication Delay\n\t7.4 Numerical Results\n\t7.4.1 Decentralized Adaptive Sliding Mode Control\n\t7.4.2 Decentralized Adaptive Backstepping Control\n\n\t7.5 Conclusions\n\tReferences\n\n\t8 Conclusions\n\t8.1 Summary\n\t8.2 Trends and Challenges\n\tReferences\n\n\tAppendix A Algebraic Graph Theory\n\tAppendix B Optimal Guaranteed Cost Control\n\tAppendix C Nomenclature\n\tReferences\n\n\n\n"}