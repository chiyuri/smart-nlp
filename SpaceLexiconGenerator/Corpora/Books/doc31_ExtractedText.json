{"content": "\nSpace Technology Library\n\nJames\u00a0Miller\n\nPlanetary \nSpacecraft \nNavigation\n\n\n\nSPACE TECHNOLOGY LIBRARY\nPublished jointly by Microcosm Press and Springer\n\nThe Space Technology Library Editorial Board\n\nManaging Editor: James R. Wertz (Microcosm, Inc., El Segundo, CA)\n\nEditorial Board: Roland Dor\u00e9 (Professor and Director International Space\nUniversity, Strasbourg)\nTom Logsdon (Senior member of Technical Staff,\nSpace Division, Rockwell International)\nF. Landis Markley (NASA, Goddard Space Flight Center)\nRobert G. Melton (Professor of Aerospace Engineering,\nPennsylvania State University)\nKeiken Ninomiya (Professor, Institute of Space & Astronautical\nScience)\nJehangir J. Pocha (Letchworth, Herts.)\nRex W. Ridenoure (CEO and Co-founder at Ecliptic Enterprises\nCorporation)\nGael Squibb (Jet Propulsion Laboratory, California Institute of\nTechnology)\nMartin Sweeting (Professor of Satellite Engineering, University\nof Surrey)\nDavid A. Vallado (Senior Research Astrodynamicist, CSSI/AGI)\nRichard Van Allen (Vice President and Director, Space Systems\nDivision, Microcosm, Inc.)\n\nMore information about this series at http://www.springer.com/series/6575\n\nhttp://www.springer.com/series/6575\n\n\nJames Miller\n\nPlanetary Spacecraft\nNavigation\n\n123\n\n\n\nJames Miller\nPorter Ranch\nCA, USA\n\nSpace Technology Library\nISBN 978-3-319-78915-6 ISBN 978-3-319-78916-3 (eBook)\nhttps://doi.org/10.1007/978-3-319-78916-3\n\nLibrary of Congress Control Number: 2018945424\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nThis work is subject to copyright. All rights are reserved by the Publisher, whether the whole or part of\nthe material is concerned, specifically the rights of translation, reprinting, reuse of illustrations, recitation,\nbroadcasting, reproduction on microfilms or in any other physical way, and transmission or information\nstorage and retrieval, electronic adaptation, computer software, or by similar or dissimilar methodology\nnow known or hereafter developed.\nThe use of general descriptive names, registered names, trademarks, service marks, etc. in this publication\ndoes not imply, even in the absence of a specific statement, that such names are exempt from the relevant\nprotective laws and regulations and therefore free for general use.\nThe publisher, the authors and the editors are safe to assume that the advice and information in this book\nare believed to be true and accurate at the date of publication. Neither the publisher nor the authors or\nthe editors give a warranty, express or implied, with respect to the material contained herein or for any\nerrors or omissions that may have been made. The publisher remains neutral with regard to jurisdictional\nclaims in published maps and institutional affiliations.\n\nThis Springer imprint is published by the registered company Springer Nature Switzerland AG\nThe registered company address is: Gewerbestrasse 11, 6330 Cham, Switzerland\n\nhttps://doi.org/10.1007/978-3-319-78916-3\n\n\nPreface\n\nThis book is based on my 50 years of experience in navigation of Earth entry vehi-\ncles, Minuteman ballistic missiles, and planetary spacecraft. At the Jet Propulsion\nLaboratory, I worked on the Mariner 6, Viking, Pioneer, Galileo, and Near Earth\nAsteroid Rendezvous missions. At KinetX Inc. I worked on the MESSENGER\nand New Horizons missions. In writing this book I have drawn on engineering\nmemoranda, conference papers, and publications I have written as well as many\nnotes that I have accumulated over many years. My purpose is to present a book\nthat will describe how navigation is done. The emphasis is on mathematics that\nhave been coded in computer programs used for mission operations. Therefore, the\nderivations are given in detail since relatively little mathematics actually makes it\ninto operational software. The mathematics that do are generally straightforward,\nbut the programs are large and complex and must be virtually error free. In writing\nthis book, I have frequently checked the mathematics by looking at computer code\nthat I am confident is correct.\n\nChapter 1 contains the equations of motion exclusive of the force models. Since\nnavigation is concerned with everything that moves, the equations of motion include\nthe kinetic theory of gasses and propagation of electromagnetic waves. The force\nmodels are given in Chap. 2. Since motion is in a straight line without force\nbeing applied, the force models enable spacecraft to go somewhere. Chapter 3\ndescribes the procedure for designing the trajectory a spacecraft will follow. A\ndetailed derivation of Kepler\u2019s equation and Lambert\u2019s theorem is given. Just\nabout all trajectory design is based on these two individuals\u2019 work aside from\nNewton of course. Trajectory optimization is described in Chap. 4. Most trajectory\noptimization is performed by developing an intuitive feel for the problem being\nsolved. Sometimes it is necessary to perform a detailed constrained parameter\noptimization when there are many more control parameters than constraints. The\nfirst constrained parameter optimization using a computer program was the Viking\norbit insertion maneuver. Previously, the trajectory designs were mostly Hohmann\ntransfers. Chapter 5 describes the probability and statistics needed for navigation\nanalysis. This is probably the most important navigation design function since it\nrelates directly to the probability of achieving mission success. Orbit determination\n\nv\n\n\n\nvi Preface\n\nis described in Chap. 6. At the beginning of planetary spacecraft navigation, orbit\ndetermination was a major problem. The Mariner class spacecraft had to contend\nwith orbit determination errors of several thousand kilometers. Missions were flown\nso we could do orbit determination, not science. Today, the orbit determination error\nat Mars is on the order of tens of kilometers. This progress may be attributed to the\nintroduction of VLBI. There is still the problem of orbit convergence and this prob-\nlem is addressed in some detail. The measurements and calibrations are described\nin Chap. 7. Navigation is primarily concerned with the physical quantity being\nmeasured and not the hardware required to perform the measurement. However,\nsome detailed knowledge of the measurement implementation is necessary to write\nnavigation software. The navigation system is described in Chap. 8. The navigation\nsystem and navigation operations procedures are constantly evolving. An overview\nis given that applies to all navigation systems. It is conservatively estimated that\nthere is at least one navigation system for each person doing navigation operations.\nThe final chapter is anecdotal and describes some navigation analyses I performed\nover the years. My purpose is to describe the type of analyses the reader would\nbe expected to perform if he or she pursued a career in navigation. I hope I have\nsucceeded in convincing the reader that navigation is a lot of fun.\n\nPlanetary spacecraft navigation is the result of the work of many individuals\nincluding the author of this book. The person who had the original idea is often not\nknown. I have mentioned some individuals in the text who I am aware of and made\nsome significant contribution. Some are contemporary and known personally, but\noften these individuals are mathematicians and have lived over a 100 years ago. I\nhave made little effort to search the literature and track down the original source.\nMost of my acknowledgments are anecdotal and the source is discussions in the\ncoffee room that have not been verified. There are a few who have contributed\ndirectly to the writing of this book. My wife, Dr. Connie Weeks, Professor Emeritus\nof Mathematics, Loyola Marymount University, is the source of a large amount of\nmy limited knowledge of mathematics. I cannot recall a question about mathematics\nwhere she did not have an immediate answer. The person most responsible for this\nbook being written is Dr. Gerald Hintz who teaches at the University of Southern\nCalifornia. I have known him for about 50 years and since I started writing this book\n20 years ago, he has kept encouraging me to finish. Writing this book has not been\nas difficult as I thought it would be, but rather an enjoyable experience. I must also\nacknowledge my mother, Eunice Miller, who thought it would be a good idea for\nme to be the first one on either side of my family to go to college. My sisters, Peggy\nJoyce, Nan Elizabeth, and Linda Lee, also got behind this major effort and I will be\nforever indebted to them.\n\nI am particularly indebted to the editors at Springer International Publishing.\nHannah Kaufman and Maury Solomon showed great patience in leading me\nthrough the process. The production people headed by Batmanadan Karthikeyan\ntransformed my manuscript into what I regard as a work of art.\n\nPorter Ranch, CA, USA James Miller\n\n\n\nContents\n\n1 Equations of Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.1 Introduction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.2 Particle Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1\n1.3 n-Body Equations of Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4\n1.4 Translational Variational Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6\n1.5 Rotational Equations of Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7\n1.6 Rotational Variational Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14\n1.7 Kinetic Theory of Gases . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 18\n1.8 General Relativity Equations of Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22\n\n1.8.1 Einstein Field Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 23\n1.8.2 Geodesic Equation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 24\n1.8.3 Isotropic Schwarzschild Coordinates . . . . . . . . . . . . . . . . . . . . . . . . . 27\n1.8.4 Mercury Perihelion Shift . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 29\n1.8.5 Radar Delay. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 30\n1.8.6 Light Deflection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 39\n\n1.9 Numerical Integration. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n1.9.1 Fundamental Theorem of Calculus . . . . . . . . . . . . . . . . . . . . . . . . . . . 41\n1.9.2 Runge-Kutta Numerical Integration . . . . . . . . . . . . . . . . . . . . . . . . . . 43\n\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 49\n\n2 Force Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n2.1 Rocket Equation. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 51\n2.2 Aerodynamic Forces . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 53\n2.3 Solar Pressure . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 54\n2.4 Gravity Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 56\n\n2.4.1 Harmonic Expansion Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 57\n2.4.2 Point Mass Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 58\n2.4.3 Pyramid Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 59\n2.4.4 Polyhedral Model. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 62\n2.4.5 Mass Distribution of an Irregularly Shaped Body . . . . . . . . . . . 63\n\nvii\n\n\n\nviii Contents\n\n2.4.6 Pyramid Gravity Model Comparison with Eros\nHarmonic Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 66\n\n2.4.7 Comparison of Gravity Model Mass Distributions . . . . . . . . . . 67\n2.4.8 Comparison of Density Distributions for Eros-Shaped\n\nGravity Models . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 69\n2.4.9 Comparison of Gravity Model Accelerations . . . . . . . . . . . . . . . . 71\n2.4.10 Comparison of Gravity Model Accuracy\n\nand Computational Speed . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 73\n2.4.11 Gravitational Variational Equations . . . . . . . . . . . . . . . . . . . . . . . . . . 75\n\n2.5 Shape Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n2.5.1 Triangular Plate Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 76\n2.5.2 Harmonic Expansion Shape Model. . . . . . . . . . . . . . . . . . . . . . . . . . . 77\n2.5.3 Gravity Harmonic Expansion from Shape Model . . . . . . . . . . . 79\n\n2.6 Comet Atmosphere. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 83\n2.6.1 Outgassing Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 84\n2.6.2 Jet Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 85\n2.6.3 Thermodynamic Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 87\n\n2.7 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 91\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 92\n\n3 Trajectory Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\n3.1 Restricted Two-Body Trajectories . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 95\n\n3.1.1 Elliptical Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 96\n3.1.2 Hyperbolic Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 104\n3.1.3 Injection Flight Plane Hyperbolic Trajectory . . . . . . . . . . . . . . . . 108\n3.1.4 Lambert\u2019s Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 110\n\n3.2 Interplanetary Transfer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 116\n3.2.1 Hohmann Transfer. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 117\n\n3.3 Three-Body Trajectory. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122\n3.3.1 Jacobi Integral . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 122\n3.3.2 Tisserand\u2019s Criterion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 124\n3.3.3 Gravity Assist Vector Diagram . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 126\n3.3.4 Cassini Trajectory Design. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 128\n\n3.4 Four-Body Trajectory . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 131\n3.4.1 Moon Capture of Projectile Launched from Earth . . . . . . . . . . . 133\n3.4.2 Angular Momentum and Energy Management . . . . . . . . . . . . . . 136\n3.4.3 Genesis Earth Return Trajectory. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 139\n3.4.4 Jacobi Integral and Capture . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 140\n\n3.5 NEAR Orbit Phase Trajectory Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 143\n3.5.1 Spacecraft and Mission Constraints . . . . . . . . . . . . . . . . . . . . . . . . . . 143\n3.5.2 Targeting Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 144\n3.5.3 Targeting Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 145\n3.5.4 NEAR Trajectory Design . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 147\n3.5.5 Approach Through 100 km Orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 148\n\n\n\nContents ix\n\n3.5.6 Subsolar Overfly Through 50 km Orbit . . . . . . . . . . . . . . . . . . . . . . 149\n3.5.7 Transfer to Southern Illuminated 35 km Orbit . . . . . . . . . . . . . . . 150\n3.5.8 Active POS Control, Polar Orbits, and Plane Flip . . . . . . . . . . . 151\n3.5.9 Northern Illuminated 50 km and 35 km Orbits . . . . . . . . . . . . . . . 153\n\n3.6 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 153\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 155\n\n4 Trajectory Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157\n4.1 Parameter Optimization. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 157\n4.2 Statement of Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 158\n4.3 Condition for Optimum Solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 159\n\n4.3.1 Lagrange Multipliers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 161\n4.3.2 Explicit Functions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 162\n4.3.3 Gradient Projection . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 163\n\n4.4 Sample Problem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 164\n4.4.1 Solution by Method of Lagrange Multipliers . . . . . . . . . . . . . . . . 165\n4.4.2 Solution by Method of Explicit Functions . . . . . . . . . . . . . . . . . . . 165\n4.4.3 Solution by Method of Gradient Projection . . . . . . . . . . . . . . . . . . 166\n\n4.5 Second-Order Gradient Search . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 167\n4.6 Inequality Constraints. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 169\n4.7 Mission to Mercury . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 171\n4.8 Multiple Encounter Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 174\n\n4.8.1 Multiple Encounter Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 176\n4.8.2 Trajectory Segment Optimization . . . . . . . . . . . . . . . . . . . . . . . . . . . . 179\n4.8.3 Multiple Encounter Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180\n\n4.9 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 180\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 184\n\n5 Probability and Statistics. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 187\n5.1 Normal Probability Distribution Function (PDF) . . . . . . . . . . . . . . . . . . . . . 187\n5.2 n-Dimensional Normal PDF . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 190\n5.3 Bivariate Normal PDF . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 191\n5.4 Rayleigh PDF . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 193\n5.5 Central Limit Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 194\n5.6 Monte Carlo Methods . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 195\n5.7 Binomial Theorem . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199\n\n5.7.1 Confidence Limits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 199\n5.7.2 Normal PDF from Binomial Coefficients . . . . . . . . . . . . . . . . . . . . 201\n5.7.3 Approximate Binomial Coefficients from Normal PDF . . . . . 203\n5.7.4 Stirling Approximation . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 204\n\n5.8 Maxwell\u2013Boltzmann Probability Distribution . . . . . . . . . . . . . . . . . . . . . . . . . 207\n5.8.1 Experimental Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 210\n\n5.9 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 213\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 215\n\n\n\nx Contents\n\n6 Orbit Determination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 217\n6.1 Kalman Filter Algorithm . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 218\n6.2 Weighted Least Squares . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 221\n6.3 Square Root Information Filter (SRIF) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 223\n\n6.3.1 Discrete Process Noise Update . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 225\n6.3.2 Solution Epoch . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 227\n6.3.3 Computed and Consider Covariance . . . . . . . . . . . . . . . . . . . . . . . . . 227\n6.3.4 Smoothing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 229\n\n6.4 Continuous Filter Equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 230\n6.4.1 Process Noise Term . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233\n6.4.2 Data Update Term . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 233\n6.4.3 Continuous Filter Differential Equations . . . . . . . . . . . . . . . . . . . . . 234\n\n6.5 Continuous SRIF with Discrete Data Update . . . . . . . . . . . . . . . . . . . . . . . . . . 237\n6.5.1 Process Noise Duality . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 237\n6.5.2 Numerical Integration of SRIF Matrix . . . . . . . . . . . . . . . . . . . . . . . 239\n\n6.6 Direct Orbit Determination . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 240\n6.6.1 Model of Doppler Data Signature . . . . . . . . . . . . . . . . . . . . . . . . . . . . 242\n6.6.2 Parameterization of Doppler Signature . . . . . . . . . . . . . . . . . . . . . . . 245\n6.6.3 Solution by Newton-Raphson. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 247\n6.6.4 Magellan Example . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 248\n\n6.7 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 251\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 253\n\n7 Measurements and Calibrations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 255\n7.1 Radiometric Tracking Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 255\n\n7.1.1 Doppler Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 256\n7.1.2 Doppler Measurement Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 256\n7.1.3 Data Noise . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 260\n7.1.4 One-Way Doppler Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 261\n7.1.5 Three-Way Doppler Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 262\n7.1.6 Range Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 263\n7.1.7 Very Long Baseline Interferometry. . . . . . . . . . . . . . . . . . . . . . . . . . . 265\n7.1.8 Differential Wide Band VLBI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 266\n7.1.9 Differential Narrow Band VLBI . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 267\n\n7.2 Radiometric Data Calibrations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 268\n7.2.1 Clock Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 269\n7.2.2 Troposphere Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 271\n7.2.3 Ionosphere Calibration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 272\n7.2.4 Earth Platform . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273\n7.2.5 Polar Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273\n7.2.6 Continental Drift . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 273\n7.2.7 Solid Earth Tide . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 274\n7.2.8 Plane Wave Propagation Through Ionized Gas . . . . . . . . . . . . . . 274\n7.2.9 Solar Plasma Time Delay . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 277\n\n\n\nContents xi\n\n7.3 Optical Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 278\n7.3.1 Optical Data Processing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 279\n7.3.2 Planetary and Stellar Aberration . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 280\n\n7.4 Altimetry . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 285\n7.4.1 Altimetry Data Measurement Model . . . . . . . . . . . . . . . . . . . . . . . . . 286\n7.4.2 Altimetry Variational Partial Derivatives . . . . . . . . . . . . . . . . . . . . . 289\n\n7.5 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 291\n\n8 Navigation Operations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 293\n8.1 Navigation System . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 294\n\n8.1.1 Deep Space Network . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 294\n8.1.2 Spacecraft . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 294\n\n8.2 Orbit Determination. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 295\n8.2.1 Orbit Determination Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 296\n8.2.2 Multiple Data Types . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 296\n8.2.3 Simulated Data . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 297\n\n8.3 Maneuver Targeting . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 298\n8.3.1 Interplanetary Maneuvers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 298\n8.3.2 In Orbit Maneuvers . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 299\n8.3.3 K Matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 299\n\n8.4 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 301\n\n9 Navigation Analysis . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 303\n9.1 Viking. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 304\n\n9.1.1 Planetary Quarantine . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 304\n9.1.2 Orbit Insertion Maneuver Design. . . . . . . . . . . . . . . . . . . . . . . . . . . . . 306\n\n9.2 Galileo . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 308\n9.2.1 Probe Delivery to Jupiter . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 308\n9.2.2 Gravity Focusing . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 309\n9.2.3 Probe Entry Dispersions . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 310\n9.2.4 Probe Entry Flight Path Angle . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 311\n9.2.5 Probe Entry Angle-of-Attack . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 312\n9.2.6 Trajectory Bending . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 313\n9.2.7 Jupiter Approach Orbit Determination . . . . . . . . . . . . . . . . . . . . . . . 314\n9.2.8 Relay Link . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 315\n9.2.9 Jupiter Orbit Insertion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 317\n9.2.10 Probe Entry Trajectory Reconstruction. . . . . . . . . . . . . . . . . . . . . . . 318\n\n9.3 Pioneer . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 319\n9.3.1 Orbit Determination Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 320\n9.3.2 Orbit Determination Results from 1980 . . . . . . . . . . . . . . . . . . . . . . 320\n9.3.3 Estimation of Drag . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 323\n9.3.4 Relating Drag ?V to Period Change . . . . . . . . . . . . . . . . . . . . . . . . . 324\n9.3.5 Covariance Analysis Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 328\n\n\n\nxii Contents\n\n9.4 Near Earth Asteroid Rendezvous . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 329\n9.4.1 Orbit Determination Strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 331\n9.4.2 Eros A Priori Physical Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 333\n9.4.3 Orbit Determination Solution . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 333\n9.4.4 Eros Results . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 336\n9.4.5 Shape Model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 337\n9.4.6 Gravity Harmonics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 338\n9.4.7 Polar Motion . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 341\n\n9.5 MESSENGER. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 343\n9.5.1 Initial Post-Launch Orbit Determination . . . . . . . . . . . . . . . . . . . . . 344\n9.5.2 Estimated Accelerations from Assumed Water Vapor . . . . . . . 349\n9.5.3 Curve Fitting with Exponential Functions . . . . . . . . . . . . . . . . . . . 352\n\n9.6 New Horizons . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 355\n9.6.1 Pluto and Charon Approach . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 356\n9.6.2 Pluto Approach Time-of-Flight Determination . . . . . . . . . . . . . . 357\n9.6.3 Pluto and Charon Approach Covariance Analysis . . . . . . . . . . . 361\n9.6.4 Spacecraft Orbit Reconstruction . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 365\n\n9.7 Phobos . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 366\n9.7.1 Phobos Inertial Properties . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 367\n9.7.2 Phobos Gravity Field . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 368\n9.7.3 Phobos Rotational Dynamics . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 369\n9.7.4 Analytic Approximation of Forced Libration . . . . . . . . . . . . . . . . 370\n\n9.8 Summary . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 375\nBibliography . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 377\n\nAnswers to Selected Exercises . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 379\n\nIndex . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 385\n\n\n\nChapter 1\nEquations of Motion\n\n1.1 Introduction\n\nThe equations of motion describe the path that a spacecraft, planet, satellite,\nmolecule, electromagnetic wave, or any body will follow. In space, the path that\na spacecraft follows is called a trajectory and for a planet it is called an ephemeris.\nFor the purpose of navigation, a planet is defined as any object that orbits the sun\nand, thus, includes comets and asteroids. A satellite is any body that orbits a planet.\nFlight operations are generally conducted using solutions of Newton\u2019s equation of\nmotion obtained by numerical integration. Analytic solutions of Newton\u2019s equation\nof motion provide some insight into trajectory design and navigation analysis, but\nthese solutions are seldom used in the conduct of flight operations. For spacecraft\nnear the Sun and Jupiter, and for the planet ephemerides, Newton\u2019s equations of\nmotion are augmented with terms from the n-body solution of General Relativity.\n\nIn this chapter, Newton\u2019s equations of motion are applied to molecules in a\ncontainer to obtain the kinetic theory of gasses and a rigid body to obtain the\nrotational equations of motion. Equations for the motion of a spacecraft and photon\nare developed from the equation of geodesics which describes motion in the vicinity\nof a massive body obtained from the general theory of relativity. Finally, numerical\nintegration of the equations of motion is described.\n\n1.2 Particle Dynamics\n\nA body in space will continue to move in a straight line at a constant velocity unless\nacted on by some external force. The same body in the atmosphere or on the surface\nof the Earth will move in a given direction at constant speed provided that there are\nno forces acting on the body. Since the Earth\u2019s gravity combined with atmospheric\ndrag will result in force components along the direction of motion and normal to\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_1\n\n1\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_1&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_1\n\n\n2 1 Equations of Motion\n\nthe direction of motion, the case of straight line or rectilinear motion can only be\napproximated. Newton\u2019s equation of motion describes the departure from rectilinear\nmotion of a body when acted on by external forces and is given by,\n\nF = m a (1.1)\n\nwhere m is the mass of the body, F is the applied force vector, and a is the resultant\nacceleration vector. Once the applied forces have been characterized, Newton\u2019s\nequation is the only equation that one needs to solve to determine the motion of\na body provided that the effects of General Relativity and quantum mechanics are\nsmall enough to be ignored.\n\nWhen one body exerts a force on another body, there is an equal and opposite\nreaction of the second body exerting the same force on the first body. This property\nof force results in the conservation of certain mathematical properties called\nenergy and momentum when Newton\u2019s equation of motion is applied. Consider the\ncollision of two elastic spheres. As the spheres collide, they are compressed by a\nforce that acts along the line joining their centers. As the spheres separate, this same\nforce acts like a spring and the spheres are returned to their previous spherical shape.\nThe geometry of the collision is shown in Fig. 1.1.\n\nThe spheres have velocities V1 and U1 before the collision and velocities V2 and\nU2 after the collision and receive incremental changes in velocity of ?V1 and ?U1,\nrespectively. The masses of the two bodies are mv and mu. The x coordinate axis is\nalong the line joining the centers at impact and V1 is in the x ? y plane. During the\ntime interval of contact, the motion is given by Eq. (1.1).\n\nFudt = mudU (1.2)\nFvdt = mvdV (1.3)\n\nFig. 1.1 Particle dynamics y\n\nx\n\nmu\n\nmv\n\nmv\n\nmu\n\nV2\n\nV1\n\nU2\n\nU1\n\n?U1?V1\n\n\n\n1.2 Particle Dynamics 3\n\nSince the forces are equal and opposite and Fu is the negative of Fv, the following\nresult is obtained by integrating Eq. (1.2) and Eq. (1.3) and adding the results,\n\nmu(U2 ? U1) + mv(V2 ? V1) = 0 (1.4)\n\nIf momentum is defined as the product of mass and velocity, Eq. (1.4) reveals that\nmomentum is conserved during impact. The momentum increase of one body is\nequal to the momentum decrease of the other body. An equally important result\nmay be obtained if the components of the vectors are examined. Before the impact,\nthe velocities are given by\n\nV1 = [Vx1, Vy1, 0]\nU1 = [Ux1, Uy1, Uz1]\n\nand after the impact the velocities are\n\nV2 = [Vx1 + ?Vx1, Vy1, 0]\nU2 = [Ux1 + ?Ux1, Uy1, Uz1]\n\nTaking the square of the velocity magnitudes before and after impact and\ndifferencing,\n\nV 22 ? V 21 = 2Vx1?Vx1 + ?V 2x1\nU22 ? U21 = 2Ux1?Ux1 + ?U2x1\n\nMultiplying the x component of Eqs. (1.2) and (1.3) by Ux and Vx , respectively, the\nfollowing equations are obtained.\n\nFu dx = mu Ux dUx (1.5)\nFv dx = mv Vx dVx (1.6)\n\nIntegrating the force over the distance traveled during the interval of contact and\nadding the results from Eqs. (1.5) and (1.6)\n\nmu\n\n[\n(Ux1 + ?Ux1)2\n\n2\n? U\n\n2\nx1\n\n2\n\n]\n+ mv\n\n[\n(Vx1 + ?Vx1)2\n\n2\n? V\n\n2\nx1\n\n2\n\n]\n= 0\n\nmu\n\n[\n2Ux1?Ux1 + ?U2x1\n\n2\n\n]\n+ mv\n\n[\n2Vx1?Vx1 + ?V 2x1\n\n2\n\n]\n= 0\n\nand\n\nmu\n\n[\nU22 ? U21\n\n2\n\n]\n+ mv\n\n[\nV 22 ? V 21\n\n2\n\n]\n= 0 (1.7)\n\n\n\n4 1 Equations of Motion\n\nwhich may also be written\n\n1\n\n2\nmu U\n\n2\n2 +\n\n1\n\n2\nmv V\n\n2\n2 =\n\n1\n\n2\nmu U\n\n2\n1 +\n\n1\n\n2\nmv V\n\n2\n1 (1.8)\n\nEnergy is defined as force acting over distance and Eq. (1.7) and Eq. (1.8) show that\nthe energy of a particle is one half of the product of mass and the magnitude of\nvelocity squared and reveals that energy is also conserved during impact.\n\nParticle impacts have been assumed to be impulsive. The force is assumed to be\nconstant over a small interval of time or distance. The integral is defined as the sum\nof an infinite number of impacts as the time interval approaches zero and is referred\nto as a Riemann sum. Consider the sum\n\nUn+1, Vn+1 = U1, V1 + ?U1,?V1 + ?U2,?V2 + ?U3,?V3 + \u00b7 \u00b7 \u00b7 ?Un,?Vn\nIf Ui+1, Vi+1 is the result of the velocity change from Ui , Vi , then Ui+1, Vi+1\n\nwill have the same energy and momentum as Ui , Vi and by extension Un+1, Vn+1\nwill have the same energy and momentum as U1, V1 even if the force vectors are\ndifferent for each interval. Thus, the conservation of momentum and energy may be\nextended to all collisions, electrostatic interactions, gravitational interactions, and\nelectromagnetic emanations. They all obey Newton\u2019s action equals reaction. When\nwe fire a rocket engine or hit a baseball with a bat or fall out of a tree, the energy is\nconserved by the molecules colliding with one another, the gravitational force on the\nmolecules or the electrostatic repulsion and attraction of the protons and electrons\ncomprising the molecule. This may be an oversimplified view of the universe but\nwill enable us to navigate anywhere in the solar system.\n\n1.3 n-Body Equations of Motion\n\nFor a system of n bodies, the resultant gravitational force on the i\u2019th body is the sum\nof the individual contributions from the other j bodies and\n\nFi = G\nn?\n\nj=1\nmimj\n\nrj ? ri\nr3ij\n\n+ mimj?Oi(rj ? ri) + mimj?Oj(ri ? rj) + O(?r3)\n\nwhere G is the gravitational constant, r and m are the position and mass of a body,\nand ?O refers to the oblateness. When i = j , the terms vanish and may be omitted.\nThe acceleration of body i is obtained by simply dividing through by mi .\n\nai = Gmj\nn?\n\nj=1\n\nrj ? ri\nr3ij\n\n+ ?Oi(rj ? ri) + ?Oj(ri ? rj) (1.9)\n\n\n\n1.3 n-Body Equations of Motion 5\n\nThe center of the coordinate system is at rest and may be determined from the\nfollowing equation.\n\nr0 = 1\nmt\n\nn?\ni=1\n\nmiri\n\nTaking the derivative with respect to time,\n\nr?0 = 1\nmt\n\nn?\ni=1\n\nmi r?i\n\nSince the exchange of momentum of body i with body j results in no change in\nthe sum, the total momentum exchange of all the bodies must be zero and the\nsummation terms remain constant as a function of time. Since mt is the total system\nmass and r0 is the center of mass, the center of mass may be stationary or move at\na constant velocity with respect to inertial space. The n-body equations of motion\ngiven by Eq. (1.9) are referred to as the barycentric formulation. The barycenter is\nthe center of mass of the system containing n bodies. These equations are generally\nintegrated numerically to obtain planetary and satellite ephemerides. Since the mass\nof one or more of the bodies may be assumed to be zero, a spacecraft or other point\nmass object may be included in the system of equations to be integrated. For high-\nprecision ephemerides, other force models and additional terms from the general\ntheory of relativity may be included in the integration.\n\nFor a spacecraft that is orbiting or flying close to a gravitating body, an\nalternative form of the n-body equations is often used. An increase in the accuracy\nof integration may be obtained if the coordinate system is located at the center\nof mass of the nearby dominant body. For this configuration, bodies that are far\naway from the spacecraft enter as a tidal acceleration that is differenced before\nthe integration thus potentially improving the numerical accuracy. This formulation\nis referred to as planetocentric and may be obtained by simply subtracting the\nbarycentric acceleration of the body that is close to the spacecraft from all the other\nbodies including the spacecraft. For convenience, assume that the spacecraft is body\nnumber one and the central body is body number 2.\n\na2 = 0 r2 = 0\n\na1 = Gmj\nn?\n\nj=2\n\n{\nrj ? r1\n\nr31j\n\n+ ?O1(rj ? r1) + ?Oj(r1 ? rj)\n}\n\n?Gmj\nn?\n\nj=2\n\n{\nrj\nr3j\n\n+ ?O1(rj) + ?Oj(?rj)\n}\n\n\n\n6 1 Equations of Motion\n\n1.4 Translational Variational Equations\n\nOrbit determination, trajectory optimization, trajectory design, and propulsive\nmaneuver design require partial derivatives of spacecraft state, planet ephemerides,\nand planet attitude with respect to constant dynamic parameters. The constant\nparameters (q) include initial conditions, gravity harmonics, solar pressure model\nparameters, propulsive maneuver model parameters, and other force model param-\neters. For orbit determination, the partial derivatives of measurements (Z) with\nrespect to q may be obtained by application of the chain rule.\n\n?Z\n\n?q\n= ?Z\n\n?(r, v)\n?(r, v)\n\n?q\n\nwhere r and v are the spacecraft position and velocity at some time t referred to\nas the spacecraft state. The partial derivative of Z with respect to spacecraft state\nis called the data partial. The measurement and data partials are a function of the\nspacecraft state and constant parameters (q). The partial derivatives of spacecraft\nstate with respect to q are called the variational partials. If Z is replaced by target\nparameters, the partial derivatives needed for trajectory design or optimization are\nobtained. If spacecraft state is replaced by planet state, the planetary variational\npartials are obtained. If spacecraft state is replaced by planet attitude, the rotational\nvariational partials are obtained.\n\nThe translational variational partial derivatives are obtained by integrating the\npartial derivatives of acceleration with respect to the dynamic parameters. The\nspacecraft acceleration is a function of spacecraft state and q.\n\nA = f (r, v, q)\n\nDifferentiating with respect to q, we obtain\n\n?A\n?q\n\n= ?A\n?r\n\n?r\n?q\n\n+ ?A\n?v\n\n?v\n?q\n\n+ ?A\n?q\n\n|r,v constant (1.10)\n\nThe acceleration (A) and the partial derivatives of A with respect to r , v, and q are\ndescribed below in the chapter on Force Models. The equations are given for A but\nare actually the force on the body when the acceleration is multiplied by the mass of\nthe body. Since, in the limit as the mass of the body goes to zero, the force also goes\nto zero, and the ratio is the acceleration, it is convenient to compute the acceleration\ndirectly for a spacecraft. The mass of the spacecraft is small relative to a planet and\ncan be ignored.\n\nThe partial derivatives of spacecraft state with respect to the dynamic parameters\nare obtained by numerical integration.\n\n\n\n1.5 Rotational Equations of Motion 7\n\n?r\n?q\n\n=\n? t\n\n0\n\n?v\n?q\n\ndt\n\n?v\n?q\n\n=\n? t\n\n0\n\n?A\n?q\n\ndt\n\nRecall that r0 and v0, the initial state, are the first six elements of q. Determination\nof the variational partial derivatives by numerical integration requires derivation of\npartial derivatives for many force models. The gravitational partial derivatives are\nparticularly difficult to derive and program. However, orbit determination requires\nprecise partial derivatives to assure convergence. Trajectory optimization can\nusually be performed with less accurate partial derivatives. Finite-difference partial\nderivatives may be obtained with a simple algorithm that only requires propagation\nof the initial state. For example, consider the case of a spacecraft launched from\nEarth with an initial condition r0, v0. The spacecraft state at some later time may be\nobtained by numerical integration or conic orbit element propagation of the initial\nstate.\n\nr, v = f (t, r0, v0, q)\n\nThe variational partial derivatives of spacecraft state at some later time with respect\nto state at the initial time or epoch may be computed by finite difference.\n\n?r, v\n?r0, v0\n\n=\n\n?\n??????????\n\nf (t, r0+?rx, v0, q)?f (t, r0,v0,q)\n?rx\n\nf (t, r0+?ry, v0, q)?f (t, r0,v0,q)\n?ry\n\nf (t, r0+?rz, v0, q)?f (t, r0,v0,q)\n?rz\n\nf (t, r0, v0+?vx, q)?f (t, r0,v0,q)\n?vx\n\nf (t, r0, v0+?vy, q)?f (t, r0,v0,q)\n?vy\n\nf (t, r0, v0+?vz, q)?f (t, r0,v0,q)\n?vz\n\n?\n??????????\n\nT\n\nThe 6 by 6 matrix in the brackets is called the state transition matrix.\n\n1.5 Rotational Equations of Motion\n\nA rigid body may be regarded as a collection of point masses that are constrained\nto not move with respect to one another. Newton\u2019s equation may be applied to\neach point mass with the appropriate constraints and summed or integrated over the\nbody to obtain the rotational equations of motion. Consider the rigid body shown\nin Fig. 1.2. The body is constrained to rotate about the z axis or axle and a force\n(F0) is applied in a direction tangential or perpendicular to the radius vector (R0)\ndrawn to the point of application. The force may be the result of a small thruster\n\n\n\n8 1 Equations of Motion\n\nFig. 1.2 Rotating body y\n\nx\n\ndm\n\nr\n\nwz\n\ndF0\n\nR0\n\nF0\n\nor a hand crank as long as it continues to act tangentially. The applied force is\ndistributed among all the mass elements that make up the rigid body. Since the axle\nconstrains the particles in the body to move only in the tangential or (F? ) direction,\nwe may disregard forces in the z and r directions since they result in no motion\nor energy transfer. A typical mass element is shown in Fig. 1.2 with mass dm and\nit is accelerated by a force dF? . The motion of this mass element is governed by\nNewton\u2019s equation of motion.\n\ndF? = dm a?\nMultiplying by the local tangential velocity (?zr) and substituting (??zr) for the\ntangential acceleration,\n\n?zr dF? = ?zr ??zr dm\n\nThe term on the left is the rate of accumulation of energy or power being applied\nto the mass element. Integrating over the entire body gives the total power being\napplied to the rigid body which must equal the externally applied power.\n\n?\n?zr dF? = ?z F0R0\n\nDividing out the ?z term and integrating,?\nr dF? = F0 R0 =\n\n?\nr2 dm ??z\n\n\n\n1.5 Rotational Equations of Motion 9\n\nThe applied moment is defined by\n\nMz =\n?\n\nr dF? = F0 R0\n\nand the moment of inertia about the z axis is defined by,\n\nIzz =\n?\n\nr2 dm =\n?\n\n? (x2 + y2) dV\n\nwhere ? is the density. The rotational equation of motion, where the motion is\nconstrained to a single axis, is thus\n\nMz = Izz ??z\nWhen the constraint on the axis of rotation is removed, the torque about the z axis\nwill cross couple into angular accelerations about axes normal to the z axis. These\nangular accelerations about the x and y axes are obtained by integrating along the z\naxis and the components of the force are resolved in the x and y directions.\n\n?zx dF? = ?zx (???xz) dm\n?z(?y dF? ) = ?zy ??yz dm\n\nProceeding as above,\n\nMz = Izx ??x + Izy ??y + Izz ??z\nwhere,\n\nIzx = ?\n?\n\nxz dm = ?\n?\n\n? xz dV\n\nIzy = ?\n?\n\nyz dm = ?\n?\n\n? yx dV\n\nIf an infinitesimal rotation is allowed over an interval of time dt , angular\nmomentum is accumulated which is analogous to linear momentum and is also\nconserved.\n\ndHz =\n?\n\nMz dt = Izx d?z + Izy d?z + Izz d?z\n\n\n\n10 1 Equations of Motion\n\nAfter an interval of time, angular momentum is accumulated and the one-\ndimensional result may be extended to three dimensions.\n\nH = I ?\n? = [?x, ?y, ?z]\nH = [Hx, Hx, Hx]\n\nI =\n?\n? Ixx Ixy IxzIyx Iyy Iyz\n\nIzx Izy Izz\n\n?\n?\n\nand the complete inertia tensor is defined by,\n\nIxx =\n?\n\n? (y2 + z2) dV\n\nIyy =\n?\n\n? (x2 + z2) dV\n\nIzz =\n?\n\n? (x2 + y2) dV\n\nIxy = Iyx = ?\n?\n\n? xy dV\n\nIxz = Izx = ?\n?\n\n? xz dV\n\nIyz = Izy = ?\n?\n\n? yz dV\n\nand\n\nH? = M\n\nThe coordinate axes are fixed on the body and the accelerations are given in\ninertial space. When the body fixed axes rotate, the inertia tensor or the accelerations\ncomputed with respect to body fixed axes must be allowed to vary. The standard\nconvention is to integrate in body fixed coordinates. Keeping the axes fixed on the\nbody makes the inertia tensor constant but requires the introduction of angles to\ndescribe the orientation of the body fixed axes in inertial space. The time derivative\nof angular momentum is the sum of two parts. The body fixed angular momentum\nand the time derivative of the coordinate axes given by,\n\nH? = H?x x? + H?y y? + H?z z? + Hx ??x + Hy ??y + Hz ??z\n\n\n\n1.5 Rotational Equations of Motion 11\n\nAn elementary property of vectors may be used for a more compact form of the\nequations.\n\n??x = ? \u00d7 x?\n??y = ? \u00d7 y?\n??z = ? \u00d7 z?\n\nSince,\n\nHx ? \u00d7 x? + Hy ? \u00d7 y? + Hz ? \u00d7 z? = ? \u00d7 (Hx x? + Hy y? + Hz z?) = ? \u00d7 H\nthe final form of Euler\u2019s equation is given by\n\nM = I ?? + ? \u00d7 H (1.11)\nThe selection of body fixed axes can result in a considerable simplification of\n\nEuler\u2019s equation. The initial selection of body fixed axes is arbitrary and often\ngoverned by other considerations such as the location of landmarks. Once the body\naxes have been defined and the inertia tensor obtained by integration or solution of\nthe gravity potential, it may be convenient to redefine the direction of the body fixed\naxes. Consider a new body fixed coordinate system defined by a simple orthogonal\nrotation (R). The new moment and angular momentum vectors are primed.\n\nM? = R M\n??\n\n? = R ??\n?? \u00d7 H? = R (? \u00d7 H)\n\nMaking the above substitutions into Eq. (1.11) gives\n\nRT M? = I RT ??? + RT (?? \u00d7 H?)\n\nand\n\nM? = [R I RT ] ??? + ?? \u00d7 H?\n\nThe matrix I is positive definite and so is the matrix in brackets. The inertia tensor\nmay be diagonalized by solving for its eigenvalues and the matrix of eigenvectors,\n\nI = [T ? T T ]\n\nand ? is a diagonal matrix of eigenvalues. If the rotation matrix R is selected to be\nthe transpose or inverse of T,\n\nM? = I ? ??? + ?? \u00d7 H? (1.12)\n\n\n\n12 1 Equations of Motion\n\nFig. 1.3 Transformation to\nplanetary body fixed\ncoordinates\n\ny\n\nPlanet\nequator\n\nEarth\nequator\n\nW\n\n90 \u2013 d\n\na + 90  \n\nPrime\nmeridianPole\n\n(a, d)\n\nx\n\nz\n\nThe new primed coordinates define principal axes and the inertia tensor is diagonal.\nThe principal axes are often used for body fixed axes and every rigid body has at\nleast one set of principal axes. For a sphere or a cube, every axis set is principal.\n\nThe choice to integrate the rotational equations of motion in body fixed axes\nrequires the introduction of angles to describe the orientation of the body fixed axes\nin inertial space. The conventional method for describing the attitude of a rotating\nbody is a set of Euler angles. The Euler angles define consecutive rotations about\nthe body fixed axes that transform a vector from a reference frame to body fixed\naxes. For a body in space, it is convenient to select the same Euler angle set as is\nused to define the pole and prime meridian of a planet. The Euler angles are right\nascension (?) and declination (?) of the pole and the angle W from the intersection\nof the body equator with the Earth\u2019s equator at epoch January 1, 2000 (J2000) to the\nprime meridian as shown in Fig. 1.3. The first rotation is a right-hand rotation about\nthe z axis through the angle right ascension (?). The second rotation is a right-hand\nrotation about the y axis through the angle 90? ? ? that places the z axis in the\ndirection of the pole. The third rotation is another right-hand rotation about the z\naxis through the angle 90? + W to place the x axis on the prime meridian of the\nbody.\nThe rotations from inertial space to body fixed axes are\n\nT =\n?\n? ? sin W cos W 0? cos W ? sin W 0\n\n0 0 1\n\n?\n?\n?\n? sin ? 0 ? cos ?0 1 0\n\ncos ? 0 sin ?\n\n?\n?\n?\n? cos ? sin ? 0? sin ? cos ? 0\n\n0 0 1\n\n?\n?\n\n\n\n1.5 Rotational Equations of Motion 13\n\nand may be combined to obtain\n\nT =\n\n?\n??????????\n\n? sin W sin ? cos ? ? sin W sin ? sin ? sin W cos ?\n? cos W sin ? + cos W cos ?\n\n? cos W sin ? cos ? ? cos W sin ? sin ? cos W cos ?\n+ sin W sin ? ? sin W cos ?\n\ncos ? cos ? cos ? sin ? sin ?\n\n?\n??????????\n\nThe body fixed spin rates are related to the Euler angle rates by\n\n?\n??????\n\n?x\n\n?y\n\n?z\n\n?\n?????? =\n\n?\n??????\n\nsin W cos ? ? cos W 0\n\ncos W cos ? sin W 0\n\nsin ? 0 1\n\n?\n??????\n\n?\n??????\n\n??\n\n??\n\nW?\n\n?\n??????\n\nA unit vector in the direction of each Euler angle rate is transformed to body fixed\naxes and the resultant vectors are assembled into the above transformation matrix.\nThis transformation is not orthogonal. The inverse transformation that relates the\nEuler angle rates to the body fixed spin rates is obtained by matrix inversion and is\ngiven by\n\n?\n??????\n\n??\n\n??\n\nW?\n\n?\n?????? =\n\n?\n??????\n\nsin W sec ? cos W sec ? 0\n\n? cos W sin W 0\n\n? sin W tan ? ? cos W tan ? 1\n\n?\n??????\n\n?\n??????\n\n?x\n\n?y\n\n?z\n\n?\n??????\n\nThe body fixed spin vector may be obtained by integration of Euler\u2019s equation.\nFirst, Euler\u2019s equation must be solved for the angular acceleration. Thus, we have\nfor Euler\u2019s equation,\n\n?? = I?1{M ? ? \u00d7 H} (1.13)\nH = I ?\n\nand the angular rates are obtained by integrating\n\n?(t) =\n?\n\n?? dt\n\n\n\n14 1 Equations of Motion\n\nThe attitude may be obtained as a function of time by integrating the Euler angle\nrates computed from the spin vector.\n\n?(t) =\n?\n\n?? dt\n\nThe attitude, shown here as the data vector ?, is defined by the Euler angles,\n\n? =\n?\n? ??\n\nW\n\n?\n?\n\nand the rates are\n\n?? =\n\n?\n??????\n\nsin W sec ? cos W sec ? 0\n\n? cos W sin W 0\n\n? sin W tan ? ? cos W tan ? 1\n\n?\n???????\n\n1.6 Rotational Variational Equations\n\nFrom the equations of motion, the angular acceleration may be obtained as an\nexplicit function of the attitude, spin rate, and dynamic parameters (q).\n\n?? = f\n?(?,?, q) (1.14)\n\nwhere the dynamic parameters (q) consist of the initial attitude and spin rate,\nmoments of inertia, and the applied moment.\n\nq = (?o,?o, Ie, M) (1.15)\n\nwhere Ie denotes a column matrix containing the six unique inertia tensor elements.\nThe Euler angle attitude rates may be explicitly related to the attitude and body fixed\nspin rate and are given by\n\n?? = f??(?,?) (1.16)\n\n\n\n1.6 Rotational Variational Equations 15\n\nThe variational equations are obtained by differentiating Equation 1.14 with respect\nto the dynamic parameters.\n\n???\n\n?q\n= ?f\n?\n\n??\n\n??\n\n?q\n+ ?f\n?\n\n??\n\n??\n\n?q\n+ ?f\n?\n\n?q\n(1.17)\n\n???\n\n?q\n= ?f??\n\n??\n\n??\n\n?q\n+ ?f??\n\n??\n\n??\n\n?q\n(1.18)\n\nThus, we have, for the case of free-body rotation or a constant applied moment in\nbody fixed coordinates,\n\n?f\n?\n\n??\n= 0 (1.19)\n\n?f\n?\n\n??\n= ?I?1\n\n??\n?\n?\n? 0 hz ?hy?hz 0 hx\n\nhy ?hx 0\n\n?\n? ?\n\n?\n? 0 ?z ??y??z 0 ?x\n\n?y ??x 0\n\n?\n? I\n\n??\n? (1.20)\n\n?f??\n\n??\n=\n\n?\n??????\n\nsinW sec ? cosW sec ? 0\n\n?cosW sinW 0\n\n?sinW tan ? ?cosW tan ? 1\n\n?\n?????? (1.21)\n\n?f??\n\n??\n=\n\n?\n????????\n\n0\n(?x sin W + ?y cos W) tan ?\n\ncos ?\n\n?x cos W ? ?y sin W\ncos ?\n\n0 0 ?x sin W + ?y cos W\n\n0\n??x sin W ? ?y cos W\n\ncos2 ?\n(??x cos W + ?y sin W) tan ?\n\n?\n????????\n(1.22)\n\nWith respect to attitude at epoch (q = ?o,?o)\nThe variational equations that relate the current attitude to the attitude at epoch are\ngiven by\n\n???\n\n??o\n= ?f??\n\n??\n\n??\n\n??o\n(1.23)\n\n???\n\n??o\n= ?f??\n\n??\n\n??\n\n??o\n+ ?f??\n\n??\n\n??\n\n??o\n(1.24)\n\n???\n\n??0\n= 0\n\n\n\n16 1 Equations of Motion\n\n???\n\n??o\n= ?f??\n\n??\n\n??\n\n??o\n(1.25)\n\nWe obtain these partial derivatives as a function of time by integrating as in\n\n??\n\n??o\n=\n\n?\n???\n\n??o\ndt (1.26)\n\n??\n\n??o\n=\n\n?\n???\n\n??o\ndt (1.27)\n\n??\n\n??o\n= 0 (1.28)\n\n??\n\n??o\n=\n\n?\n???\n\n??o\ndt (1.29)\n\nWith respect to elements of inertia tensor (q = Ie)\nThe variational equations for the elements of the inertia tensor are given by\n\n???\n\n?Ie\n= ?f??\n\n??\n\n??\n\n?Ie\n+ ?f??\n\n?Ie\n(1.30)\n\n???\n\n?Ie\n= ?f?\n\n??\n\n??\n\n?Ie\n+ ?f??\n\n??\n\n??\n\n?Ie\n(1.31)\n\nwhere Ie is a column matrix, restricted to the independent elements of I,\n\nIe =\n[\nIxx Iyy Izz Ixy Ixz Iyz\n\n]T\nThe matrix that defines the partial derivative of angular acceleration with respect to\nthe elements of the moment of inertia tensor may be obtained by differentiating the\nequations of motion (Eq. 1.13).\n\nI\n???\n\n?Ie\n+ ?I\n\n?Ie\n?? + ?(? \u00d7 H)\n\n?H\n?H\n?Ie\n\n= 0 (1.32)\n\nThe terms in the above matrix equation are given by\n\n?I\n\n?Ie\n?? =\n\n?\n? ??x 0 0 ??y ??z 00 ??y 0 ??x 0 ??z\n\n0 0 ??z 0 ??x ??y\n\n?\n?\n\n?(? \u00d7 H)\n?H\n\n=\n?\n? 0 ??z ?y?z 0 ??x\n\n??y ?x 0\n\n?\n?\n\n\n\n1.6 Rotational Variational Equations 17\n\n?H\n?Ie\n\n=\n?\n??x 0 0 ?y ?z 00 ?y 0 ?x 0 ?z\n\n0 0 ?z 0 ?x ?y\n\n?\n?\n\nThe above partial derivatives are obtained by performing the indicated matrix mul-\ntiplication to obtain the individual equations, differentiating, and then reassembling\nthe result in matrix form. Solving for the partial derivative of angular acceleration\nwith respect to the elements of the inertia tensor, we obtain\n\n?f\n?\n\n?Ie\n= ?I?1\n\n?\n? 0 ??z ?y?z 0 ??x\n\n??y ?x 0\n\n?\n?\n?\n??x 0 0 ?y ?z 00 ?y 0 ?x 0 ?z\n\n0 0 ?z 0 ?x ?y\n\n?\n?\n\n?I?1\n?\n? ??x 0 0 ??y ??z 00 ??y 0 ??x 0 ??z\n\n0 0 ??z 0 ??x ??y\n\n?\n? (1.33)\n\nThe inertia tensor partial derivatives as a function of time are obtained by integrating\nthe rates and\n\n??\n\n?Ie\n=\n\n?\n???\n\n?Ie\ndt (1.34)\n\n??\n\n?Ie\n=\n\n?\n???\n\n?Ie\ndt (1.35)\n\nWith respect to applied moment (q = M)\nThe variational equations for a constant body fixed applied moment are given by\n\n???\n\n?M\n= ?f\n?\n\n?\n\n\n??\n\n?M\n+ ?f\n?\n\n?M\n(1.36)\n\n???\n\n?M\n= ?f??\n\n??\n\n??\n\n?M\n+ ?f??\n\n?\n\n\n?\n\n\n?M\n(1.37)\n\nThe final matrix that is needed in the above variational equations defines the direct\neffect of the applied moment on the angular acceleration and is given by\n\n?f\n?\n\n?M\n= I?1 (1.38)\n\nWe obtain the applied moment partial derivatives as a function of time by integrating\nthe rates and\n\n??\n\n?M\n=\n\n?\n???\n\n?M\ndt (1.39)\n\n\n\n18 1 Equations of Motion\n\n??\n\n?M\n=\n\n?\n???\n\n?M\ndt (1.40)\n\nThe above rotational variational equations may be integrated with the equations of\nmotion to describe the body attitude state (Euler angle and spin vector) and partial\nderivatives of state with respect to initial attitude, moments of inertia, and applied\nmoments as a function of time.\n\n1.7 Kinetic Theory of Gases\n\nAn interesting application of Newton\u2019s equation of motion to a system of particles\nis the kinetic theory of gasses that results in the ideal gas law and several other\nlaws that govern the behavior of gasses. The motion of a gas molecule, neglecting\nrotations, may be described by assuming the molecules of gas to be rigid spheres.\nIt was postulated by Maxwell, Boltzmann, and others that the simplicity of the\nexperimental behavior of gasses implied simplicity on the molecular scale. An\nextension of the principals governing particle dynamics may be applied to molecules\nbouncing around in a container to obtain the gas laws. The motion of gas molecules\nis of interest to spacecraft navigation for two reasons. The rapid expulsion of gas\nmolecules from a rocket engine provides the thrust force that changes the velocity of\na spacecraft and the incidental expulsion of gas molecules from a spacecraft causes\nsmall accelerations that must be accounted for in solving for the trajectory of the\nspacecraft. The former is essential for the success of the mission and the latter is\na nuisance to navigation. An example of the latter is the venting from a parachute\nthat may be carried on a spacecraft or the expulsion of gas from propulsion system\nleaks.\n\nConsider a gas molecule of mass ? within a container that comes into contact\nwith a wall. The mass of the molecule is approximately the product of the molecular\nweight (M) times the mass of a proton or neutron (?0). The exact relationship\ninvolves the mass associated with the binding energy and as a standard ?0 is taken\nas one sixteenth of the mass of the O16 molecule. The molecular weight (M) is\ndimensionless and generally nearly an integer representing the total number of\nprotons and neutrons in a molecule. For a molecule moving in the vx direction,\nNewton\u2019s equation may be used to describe the motion during the time that the\nmolecule interacts with the wall.\n\nFi = ?i dvx\ndt? t+?t\n\nt\n\nFi dt = ?i\n? ?vx\n\nvx\n\ndvx\n\nFi?ti = ?2?ivx\n\n\n\n1.7 Kinetic Theory of Gases 19\n\nA thin layer of gas next to a wall of thickness ?x and area A will contain ?N\nmolecules moving at an average speed vx and half of these molecules will be moving\nin the plus vx direction and half will be moving in the ?vx direction. Thus, 12?N\nmolecules will strike the wall in the time interval ?t . Summing all the impacts over\nthe time interval ?t and volume A?x gives\n\n1\n\n2\n?N ?x Fi?ti = 1\n\n2\n?N (?2?i v2x) ?t\n\nvx = ?x\n?t\n\nOver the time interval ?t , the total force exerted by the gas on the wall must be\nopposite and equal to the total force exerted by the wall on the gas. This is a\ndirect consequence of the requirement that the momentum exchange at the surface\nof the wall must be zero. Consider a thin massless rigid coating that is applied to\nthe wall at the interface. The momentum of this coating, which is sum of the gas\nmolecules pushing outward and the container wall pushing inward, must be zero.\nThis momentum balance is given by\n\n1\n\n2\n?N Fi?ti = ?F?t\n\nwhich simplifies to\n\nF?x = ?N ?i v2x\nThe number density (N ) is the number of molecules per unit volume and is given by,\n\nN = ?N\nA?x\n\nand\n\nP = N ?i v2x\nF = PA\n\nThe square of the magnitude of the velocity is simply the sum of the squares of the\ncomponents.\n\nv2 = v2x + v2y + v2z\nDue to symmetry, the average magnitudes of the velocity components must be equal\nand vx = vy = vz. The gas law derived from kinetic theory is now,\n\nP = 1\n3\nN ?i v\n\n2 (1.41)\n\n\n\n20 1 Equations of Motion\n\nThe agreement with the ideal gas law derived from experimentation would be\ncomplete if the temperature of the gas is related to the kinetic energy of the gas\nmolecules. It may be argued from first principals that temperature is a measure of\nthe kinetic energy of the gas molecule. The liquid in a thermometer rises in response\nto the expansion of the liquid and this is directly proportional to the kinetic energy\nof the liquids molecules. It may be concluded that temperature is proportional to\nenergy of a gas molecule and the constant of proportionality is assumed to be 32k\nwhere k is Boltzmann\u2019s constant. The scaling of k by three halves is arbitrary and\ndesigned to yield a familiar form for the end result.\n\nE?\n\nT\n= 3\n\n2\nk\n\nE? = 1\n2\n?i v\n\n2\n\nMaking these substitutions, the kinetic theory description of an ideal gas becomes\n\nP = NkT\n\nThe number density N is simply the total number of gas molecules Nt enclosed\nwithin the volume (V ) divided by the volume.\n\nN = Nt\nV\n\nThe total number of molecules is equal to the total mass (m) dived by the mass of\none molecule.\n\nNt = m\nM?0\n\nMaking these substitutions, the gas law becomes\n\nPV = m\nM\n\nk\n\n?0\nT (1.42)\n\nThe conventional experimental form of the ideal gas law is\n\nPV = m\nM\n\nRT (1.43)\n\nor\n\nP = ?\nM\n\nRT (1.44)\n\n\n\n1.7 Kinetic Theory of Gases 21\n\nwhere the density is given by,\n\n? = m\nV\n\nThe kinetic theory gas constant and experimental gas constant are related by,\n\nR = k\n?0\n\nThe number of molecules contained in a sample of gas of mass m in grams equal\nto the molecular weight (M) is a constant (N0) called Avogadro\u2019s number. The\nreciprocal of Avogadro\u2019s number is numerically equal to ?0, one sixteenth of the\nmass of O16, or approximately the mass of atomic hydrogen. The ratio of the mass\nto the molecular weight is called the mole fraction (n) and Avogadro\u2019s number\nis simply the number of molecules in one mole. The relationship of Boltzmann\u2019s\nconstant to the universal gas constant is also given by,\n\nR = N0 k (1.45)\n\nA mixture of gases with different molecular weights will reach an equilibrium and\nall molecules will have the same energy and consequently the same temperature.\nMolecules of higher than average energy transfer energy to the walls of the container\nwhen they collide with the walls and conversely molecules of lower than average\nenergy will receive energy from the wall. As the gasses mix, they will converge to\nthe same average energy. Since the two groups of molecules with different masses\nhave the same temperature and move independently, the total pressure may be\nobtained by summing the pressures that each group of molecules would exert if\nit occupied the container alone. This observation of the behavior of gas mixtures is\ncalled Dalton\u2019s law of partial pressures.\n\nIf a container of gas is vented to space, the momentum of the gas molecules\nwill exert a force on the container which is transmitted to the spacecraft resulting\nin an acceleration of the spacecraft. From Newton\u2019s equation, we have for a small\nquantity of gas that is vented,\n\n?F = ?mdv\ndt\n\nThe average velocity of the gas molecules is constant and\n\nv2 = 3kT\n?i\n\n= 3R?0T\n?i\n\nand since ?i = M?0,\n\nv =\n?\n\n3RT\n\nM\n(1.46)\n\n\n\n22 1 Equations of Motion\n\nSince v may be assumed to be constant, Newton\u2019s equation of motion may be put in\nthe form,\n\nF =\n?\n\n3RT\n\nM\n\ndm\n\ndt\n(1.47)\n\nAnalysis of the propulsion system gas leaks for the 1975 Viking mission to Mars\nprovides a typical example of the application of the kinetic theory of gasses to\nnavigation of a spacecraft. The gas leak rate is specified to be less than 100 standard\ncubic centimeters of Helium per hour. The problem for navigation is to place an\nupper bound on the acceleration of the Viking spacecraft that may be expected. The\ndensity of helium at standard temperature and pressure is ? = 0.166 kg/m3, where\nP = 1.013 \u00d7 105 nt/m2 (1 atmosphere), M = 4, R = 8317 m2/s2K, and T = 293 K.\nThe velocity of the vented helium molecules, assuming that all molecules are vented\nin the same direction, is v = 1351 m/s. The mass flow rate is simply the density times\nthe volumetric flow rate.\n\ndV\n\ndt\n= 100 cm3/h = 2.78 \u00d7 10?8 m3/s\n\ndm\n\ndt\n= ? dV\n\ndt\n= 4.62 \u00d7 10?9 kg/s\n\nThe net force on the spacecraft is 6.25 \u00d7 10?6 nt. The acceleration of the spacecraft\nof mass msc = 3468 kg is given by\n\nasc = F\nmsc\n\n= 1.8 \u00d7 10?9 m/s2\n\nThe acceleration computed in this manner from the kinetic theory of gasses will\nyield a result that is a little high. The vented molecules do not all vent in the same\ndirection and there is some loss of energy as the molecules leave the container. These\ninefficiencies reduce the total acceleration.\n\n1.8 General Relativity Equations of Motion\n\nThe General Theory of Relativity, which includes Special Relativity, replaces\nclassical Newtonian theory. For spacecraft navigation, General Relativity enters into\nthe equations of motion and computation of measurements. The effect is small\nand generally could be ignored for trajectory design but can be observed when\nperforming orbit determination. For this reason, Generally Relativity is formulated\nas a perturbation to Newtonian theory. The effect of General Relativity on orbit\ndetermination is ubiquitous. The orbit of Mercury is perturbed, radio signals from\nthe spacecraft are bent and delayed if they pass near the sun, and clocks slow down\n\n\n\n1.8 General Relativity Equations of Motion 23\n\nif they are near a massive body or have significant velocity with respect to the\nsolar system barycenter. These perturbations may be determined by integrating the\nequation of geodesics or computed from simple formulas.\n\nThe details of the solution of the Einstein field equations are omitted here and\nthe solutions for the equations of motion are initiated from the metric tensor. The\nmetric tensor is the solution to the field equations. The equation of geodesics\noperates on the metric tensor to generate the equations of motion. The application of\nEinstein\u2019s summation notation is fairly straightforward. The resultant equations of\nmotion require no further understanding of relativity theory except for some simple\napplications of Special Relativity. A detailed understanding of General Relativity is\nnot needed to navigate spacecraft.\n\n1.8.1 Einstein Field Equation\n\nThe Einstein field equation relates the curvature of space to the distribution of mass,\nenergy, and stress. The mathematical statement of general relativity is simply\n\nG = 8? T\n\nThis equation replaces Newton\u2019s law of gravitation. G is the Einstein tensor\nthat describes the geometry and T is the stress energy tensor that describes the\ndistribution of mass, energy, and stress in the same coordinate system as the\ngeometry. The Einstein tensor is a specific description of curved space that is\nextracted from the general Riemann tensor in a way to satisfy the basic postulates\nof general relativity. The Einstein field equation has been solved exactly for the case\nof a particle moving in the spherically symmetric gravitational field of a body. For\nthis distribution of matter, the stress energy tensor inside the body is given by\n\nT =\n\n?\n???\n\np 0 0 0\n0 p 0 0\n0 0 p 0\n0 0 0 ?\n\n?\n???\n\nOutside the body, T is equal to zero. The variable ? is the scalar invariant density of\nmatter and the variable p is the pressure that is obtained in hydrostatic equilibrium.\nThe solution was obtained by Schwarzschild about a month after Einstein published\nthe theory of general relativity and is given by the following metric tensor.\n\ngij =\n\n?\n???\n\ng11 g12 g13 g14\n\ng21 g22 g23 g24\n\ng31 g32 g33 g34\n\ng41 g42 g43 g44\n\n?\n???\n\n\n\n24 1 Equations of Motion\n\nwhere\n\ng11 = grr = ? 1\nc2\n\n(\n1 ? 2m\n\nr\n\n)?1\n\ng22 = g?? = ? 1\nc2\n\nr2\n\ng33 = g?? = ? 1\nc2\n\nr2 sin2 ?\n\ng44 = gtt =\n(\n\n1 ? 2m\nr\n\n)\n\nm = ?\nc2\n\nand all the offdiagonal elements are zero. The metric tensor takes the place of the\npotential in classical theory.\n\n1.8.2 Geodesic Equation\n\nThe geodesic equation describes the acceleration of a particle in space-time\ncoordinates and takes the place of the gradient in classical theory.\n\nd2x?\n\nds2\n+ \n?uv\n\ndxu\n\nds\n\ndxv\n\nds\n= 0 (1.48)\n\nThe Christoffel symbols (\n?s) establish the connection between curved space\nand the observed world. For this reason, they are sometimes called connection\ncoefficients. The Christoffel symbols are obtained by integrating the line element\nbetween two points and then solving for the path that gives the minimum time which\nis the speed of light and a straight line in curved space. The Christoffel symbols are\ngiven by\n\n\nu?? = guv\nv??\n\n\nu?? = 1\n2\n\n(\n?gu?\n\n?x?\n+ ?gu?\n\n?x?\n? ?g??\n\n?xu\n\n)\n\nIn Einstein summation notation, raising both indices of the metric tensor is matrix\ninversion. The Christoffel symbols for the Schwarzschild solution are given by\n\n\nrrr = \n111 =\n?m\nr2\n\n(\n1 ? 2m\n\nr\n\n)?1\n\n\nr?? = \n133 = ?r\n(\n\n1 ? 2m\nr\n\n)\nsin2 ?\n\n\n\n1.8 General Relativity Equations of Motion 25\n\n\nrtt = \n144 =\nmc2\n\nr2\n\n(\n1 ? 2m\n\nr\n\n)\n\n\nr?? = \n122 = ?r\n(\n\n1 ? 2m\nr\n\n)\n\n\ntrt = \n414 =\nm\n\nr2\n\n(\n1 ? 2m\n\nr\n\n)?1\n\n\n?\nr? = \n313 =\n\n1\n\nr\n\n\n?\n?? = \n323 = cot ?\n\n\n?r? = \n212 =\n1\n\nr\n\n\n??? = \n233 = ? sin ? cos ?\n\nThe equations of motion are obtained by substituting the Christoffel symbols into\nthe geodesic equation. Since the motion is planar, we may rotate to a coordinate\nsystem such that the motion is in the x-y plane. The ? dependency is thus removed\nand for ? = 2? , we obtain from the geodesic equation\n\nd2r\n\nds2\n= m\n\nr2\n\n(\n1 ? 2m\n\nr\n\n)?1 (\ndr\n\nds\n\n)2\n+r\n\n(\n1 ? 2m\n\nr\n\n)(\nd?\n\nds\n\n)2\n? mc\n\n2\n\nr2\n\n(\n1 ? 2m\n\nr\n\n)(\ndt\n\nds\n\n)2\nd2?\n\nds2\n= 2\n\nr\n\ndr\n\nds\n\nd?\n\nds\n\nA clock carried on the particle will provide a measure of proper time defined by\nthe line element\n\nds2 = ?\n{\n(1 ? 2m\n\nr\n)?1 dr2 + r2 d?2 + r2 sin2 ? d?2\n\n}\n+ (1 ? 2m\n\nr\n) c2dt2\n\nFor ds2 = c2 d? 2, this equation yields\n(\n\ndt\n\nd?\n\n)2\n=\n\n(\n1 ? 2m\n\nr\n\n)?1\n+ 1\n\nc2\n\n(\n1 ? 2m\n\nr\n\n)?2 (\ndr\n\nd?\n\n)2\n+ r\n\n2\n\nc2\n\n(\n1 ? 2m\n\nr\n\n)?1 (\nd?\n\nd?\n\n)2\n\nSubstituting the metric equation into the geodesic equation gives the following\nequations of motion.\n\nd2r\n\nd? 2\n= ? ?\n\nr2\n+\n\n(\nr ? 3?\n\nc2\n\n)(\nd?\n\nd?\n\n)2\n(1.49)\n\n\n\n26 1 Equations of Motion\n\nd2?\n\nd? 2\n= ?2\n\nr\n\ndr\n\nd?\n\nd?\n\nd?\n(1.50)\n\n(\ndt\n\nd?\n\n)2\n=\n\n(\n1 ? 2m\n\nr\n\n)?1\n+ 1\n\nc2\n\n(\n1 ? 2m\n\nr\n\n)?2 (\ndr\n\nd?\n\n)2\n+ r\n\n2\n\nc2\n\n(\n1 ? 2m\n\nr\n\n)?1 (\nd?\n\nd?\n\n)2\n(1.51)\n\nThe trajectory of a photon differs from that of a particle or spacecraft moving\nat the speed of light even in the limit of very small mass for the spacecraft. The\ndifference arises because a photon has zero rest mass and thus there is no force of\ngravity acting on the photon that gives rise to Newtonian acceleration. The photon\nfollows the contour of curved space and the resulting path is the called the null\ngeodesic. Consider the metric associated with a particle traveling at the speed of\nlight\n\nds2 = 0 = ? 1\nc2\n\n{\n(1 ? 2m\n\nr\n)?1 dr2 + r2 d?2 + r2 sin2 ? d?2\n\n}\n+ (1 ? 2m\n\nr\n) dt2\n\nSince ds is zero, the geodesic equation degenerates to indeterminate forms that\nmust be evaluated in the limit as ds goes to zero. The indeterminate form ds/ds,\nwhich has the value of 1 for a spacecraft, has the value 0 for a photon in the limit as\nds approaches zero. We resolve the problem of ds approaching zero in the geodesic\nequation by introducing the affine parameter ? that acts like a clock on the photon.\nWe know from special relativity that an observer\u2019s clock on the photon will not\nregister any passage of time as the photon moves from point A to point B. However,\nwe may imagine a universe filled with clocks all running at a rate dependent on the\nlocal gravity field. The proper time associated with a photon is simply the integral of\nthese rates along the path of the photon. The difference of the affine parameter (? )\nbetween two points times the speed of light is the distance that one would measure\nwith a meter stick along the path of the photon. The equations of motion for a photon\nare given by\n\nd2r\n\nd? 2\n=\n\n(\nr ? 3?\n\nc2\n\n)(\nd?\n\nd?\n\n)2\n(1.52)\n\nd2?\n\nd? 2\n= ?2\n\nr\n\ndr\n\nd?\n\nd?\n\nd?\n(1.53)\n\n(\ndt\n\nd?\n\n)2\n= 1\n\nc2\n\n(\n1 ? 2m\n\nr\n\n)?2 (\ndr\n\nd?\n\n)2\n+ r\n\n2\n\nc2\n\n(\n1 ? 2m\n\nr\n\n)?1 (\nd?\n\nd?\n\n)2\n(1.54)\n\n\n\n1.8 General Relativity Equations of Motion 27\n\n1.8.3 Isotropic Schwarzschild Coordinates\n\nIn the Newtonian world, before general relativity, the trajectories of the planets were\nobserved through telescopes and the data fit to a model of the solar system based\non Newton\u2019s equations of motion. From this model, the gravitational constant of the\nsun and the planetary ephemerides were estimated to an accuracy consistent with\nthe measurement and model errors. With the introduction of general relativity to\nthe model, the data was refit and a new set of constants and planetary ephemerides\ndetermined. However, since the relativistic effects are small, the differences between\nthe numerical values associated with the curved space coordinates and the classical\ncoordinates are also small. This small difference often results in confusion of the\ntwo coordinate systems.\n\nIn order to make the classical system more nearly coincide with the relativistic\nsystem, a coordinate transformation or change of variable was devised to make the\nlocal curved space coordinates come into alignment with Euclidean coordinates.\nThis transformation makes the relativistic coordinates look more classical but does\nnot really change anything. The transformed coordinate system is called isotropic\nSchwarzschild coordinates and the transformation is given by\n\nr =\n(\n\n1 + ?\n2c2r?\n\n)2\nr?\n\n? = ??\nwhere r? and ?? are the isotropic coordinates. In order to obtain the isotropic form\nof the equations of motion, we simply substitute the above equation for r into the\nexact Schwarzschild equations. The exact isotropic Schwarzschild line element is\ngiven by\n\nds?2 =\n(\n\n1 ? ?\n2c2r?\n\n)2\n(\n\n1 + ?\n2c2r?\n\n)2 dt2 ? 1c2\n(\n\n1 + ?\n2c2r?\n\n)4 (\ndr?2 + r2d??2\n\n)\n\nand this is approximated by\n\nds?2 =\n(\n\n1 ? 2?\nc2r?\n\n)\ndt2 ? 1\n\nc2\n\n(\n1 + 2?\n\nc2r?\n\n)(\ndr?2 + r2d??2\n\n)\nThe exact isotropic Schwarzschild equations of motion for a spacecraft become\n\nd2r?\n\nd? 2\n= ? ?\n\nr?2\n\n(\n1 + ?\n\n2c2r?\n\n)?4 + (1 ? ?2\n4c4r?2\n\n)?1\n\n\u00d7\n{\n\n?3\n\n2c4r?5\n\n(\n1 + ?\n\n2c2r?\n\n)?4 ( dr?\nd?\n\n)2\n+\n\n[(\n1 + ?\n\n2c2r?\n\n)2\nr? ? 3?\n\nc2\n\n](\nd?\n\nd?\n\n)2}\n\n\n\n28 1 Equations of Motion\n\nd2??\n\nd? 2\n= ?\n\n(\n1 ? ?\n\n2\n\n4c4r?2\n\n)\n(\n\n1 + ?\n2c2r?\n\n)2 2r? dr?d? d??d?\n\nd2 t?\n\nd? 2\n=\n\n(\n1 + ?\n\n2c2r?\n\n)2\n(\n\n1 ? ?\n2c2r?\n\n)2 + 1c2\n(\n\n1 + ?\n2c2r?\n\n)6\n(\n\n1 ? ?\n2c2r?\n\n)2\n[(\n\ndr?\n\nd?\n\n)2\n+ r?2\n\n(\nd??\n\nd?\n\n)2]\n\nand these may be approximated by\n\nd2r?\n\nd? 2\n= ? ?\n\nr?2\n\n(\n1 ? 2?\n\nc2r?\n\n)\n+\n\n(\nr? ? 2?\n\nc2\n\n)(\nd?\n\nd?\n\n)2\n(1.55)\n\nd2??\n\nd? 2\n= ?\n\n(\n1 ? ?\n\nc2r?\n\n) 2\nr?\n\ndr?\n\nd?\n\nd??\n\nd?\n(1.56)\n\nd2 t?\n\nd? 2\n= 1 + 2?\n\nc2r?\n+ 1\n\nc2\n\n(\n1 + 4?\n\nc2r?\n\n)[(\ndr?\n\nd?\n\n)2\n+ r?2\n\n(\nd??\n\nd?\n\n)2]\n(1.57)\n\nThe exact isotropic Schwarzschild equations of motion for a photon become\n\nd2r?\n\nd? 2\n=\n\n(\n1 ? ?\n\n2\n\n4c4r?2\n\n)?1 { ??2\n2c4r?3\n\n(\ndr?\n\nd?\n\n)2\n+\n\n[(\n1 + ?\n\n2c2r?\n\n)2\nr? ? 3?\n\nc2\n\n](\nd?\n\nd?\n\n)2}\n\nd2??\n\nd? 2\n= ?\n\n(\n1 ? ?\n\n2\n\n4c4r?2\n\n)\n(\n\n1 + ?\n2c2r?\n\n)2 2r? dr?d? d??d?\nd2 t?\n\nd? 2\n= 1\n\nc2\n\n(\n1 + ?\n\n2c2 r?\n\n)6\n(\n\n1 ? ?\n2c2r?\n\n)2\n[(\n\ndr?\n\nd?\n\n)2\n+ r?2\n\n(\nd??\n\nd?\n\n)2]\n\nand these may be approximated by\n\nd2r?\n\nd? 2\n=\n\n(\nr? ? 2?\n\nc2\n\n)(\nd?\n\nd?\n\n)2\n(1.58)\n\nd2??\n\nd? 2\n= ?\n\n(\n1 ? ?\n\nc2r?\n\n) 2\nr?\n\ndr?\n\nd?\n\nd??\n\nd?\n(1.59)\n\nd2 t?\n\nd? 2\n= 1\n\nc2\n\n(\n1 + 4?\n\nc2r?\n\n)[(\ndr?\n\nd?\n\n)2\n+ r?2\n\n(\nd??\n\nd?\n\n)2]\n(1.60)\n\n\n\n1.8 General Relativity Equations of Motion 29\n\n1.8.4 Mercury Perihelion Shift\n\nIntegration of the classical equations of motion for the orbit of Mercury reveals\na shift in perihelion that cannot be accounted for with Newtonian theory. For\nnavigation, it is necessary to modify the equations of motion to account for\nperihelion precession which is caused by the relativistic curvature of space near\nthe sun. This may be accomplished by use of a well-known formula or numerical\nintegration of the relativistic equations of motion. The results obtained by numerical\nintegration of the relativistic equations of motion may be compared with this\nformula. The well-known formula is simply\n\n??0 = 6??s\nc2a(1 ? e2)\n\nwhere ?s is the gravitational constant of the sun, a is the semimajor axis of\nMercury\u2019s orbit, e is the orbital eccentricity, and c is the speed of light.\n\nA simple derivation of the precession of Mercury\u2019s periapsis may be obtained by\nassuming that all the additional potential energy from General Relativity goes into\nincreasing the period of the orbit. The addition of the General Relativity acceleration\ndoes not change the mean motion. After one revolution of the classical orbit, the\nperturbed orbit and the classical orbit have nearly the same angular orientation. At\nperiapsis on the classical orbit, the perturbed orbit is descending for an additional\n?P to its periapsis. The precession is thus given by\n\n??0 = 2? ?P\nP\n\n?P = 3P\n2a\n\n?a\n\n?a = a\n2\n\n?\n?C3\n\nand\n\n?? = 2?\nP\n\n3P\n\n2a\n\na2\n\n?\n?C3 = 3?a\n\n?\n?C3\n\nFrom the Schwarzschild isotropic equations of motion (Eq. 1.55), the radial accel-\neration is given by\n\nd2r?\n\nd? 2\n= ? ?\n\nr?2\n\n(\n1 ? 2?\n\nc2r?\n\n)\n\n\n\n30 1 Equations of Motion\n\nIntegrating the acceleration from r? to infinity yields the potential energy and the\nGeneral Relativity contribution is\n\n?Er = ?\n2\n\nc2r?2\n\nIf the average radius (r?2) is approximated by b2 = a2(1?e2), the energy addition is\n\n?C3 = 2?\n2\n\nc2a2(1 ? e2) = 2?Er\n\nCollecting terms, the Mercury precession is approximated by\n\n??0 = 2?\nP\n\n3P\n\n2a\n\na2\n\n?\n?C3 = 3?a\n\n?\n\n2?2\n\nc2a2(1 ? e2) =\n6??\n\nc2a(1 ? e2)\nThe equations of motion are integrated with the initial conditions computed from\n\nthe state vector of Mercury at perihelion. After one complete revolution of Mercury\nabout the sun, the integrated results are transformed to osculating orbit elements and\nthe argument of perihelion is computed. In order to remove the integration error, the\nNewtonian equations of motion are integrated by the same numerical integrator in\nparallel with the relativistic equations of motion. The arguments of perihelion are\ndifferenced and compared with the formula. The same integration is repeated, only\nthis time the isotropic form of the Schwarzschild equations of motion is compared.\nThe results are displayed below.\n\nMercury perihelion shift\n\nPerihelion shift formula 502.527 \u00d7 10?9 rad\nExact Schwarzschild integration 502.559 \u00d7 10?9 rad\nIsotropic Schwarzschild integration 502.267 \u00d7 10?9 rad\n\nThe above results indicate that the formula for perihelion shift is quite accurate.\nThe difference of 3 \u00d7 10?11 rad between the formula and the exact Schwarzschild\nintegration may be attributed to the formula or perhaps integration error. The\ndifference between the formula and the isotropic Schwarzschild integration is also\nsmall (26 \u00d7 10?11 rad). This difference may also be attributed to integration error\nbut may be the truncation error associated with the isotropic metric.\n\n1.8.5 Radar Delay\n\nThe transit time of a photon or electromagnetic wave between two points in space is\na measurement that is used to determine the orbits of the planets and spacecraft\n\n\n\n1.8 General Relativity Equations of Motion 31\n\nfor the purposes of navigation and science. Both the navigation of a spacecraft\nand science experiments, particularly associated with General Relativity, require\nprecise measurements of the transit time. Since the Deep Space tracking stations\ncan measure times to within 0.1 ns or about 3 cm, it is necessary to model the transit\ntime to this accuracy.\n\nThe transit time of a photon or electromagnetic wave between two points in\nspace is often referred to as the radar delay. This terminology originated with\nradar where a radio wave is transmitted and the delay in the reception of the\nreflected return is measured to determine the range. The time delay included that\nassociated with transmission media and the path length. Individual delay terms from\nthe troposphere, ionosphere, and solar plasma are identified and used to calibrate\nthe measured delay. For planetary spacecraft, the path length is computed from\nthe theory of General Relativity. For a round trip travel time, the additional delay\nattributable to the curved space of General Relativity, over what would be computed\nassuming flat space, can amount to approximately 250\u00b5s.\n\nds2 =\n(\n\n1 ? ?\n2c2r\n\n)2\n(\n\n1 + ?\n2c2r\n\n)2 c2dt2 ?\n(\n\n1 + ?\n2c2r\n\n)4 (\ndr2 + r2d?2 + r2 sin2 ?d?2\n\n)\n\nFor a photon, ds2 = 0 and the equation to be integrated for the elapsed coordinate\ntime (t) is obtained by transforming to Cartesian coordinates and solving for dt .\n\ndt = 1\nc\n\n(\n1 + ?\n\n2c2r\n\n)3\n(\n\n1 ? ?\n2c2r\n\n) (dx2 + dy2 + dz2) 12\n\nExpanding in a Taylor series and retaining terms of order c?5,\n\ndt = 1\nc\n\n(\n1 + 2?\n\nc2r\n+ 7\n\n4\n\n?2\n\nc4r2\n\n)[\ndx2 + dy2 + dz2\n\n] 1\n2\n\n(1.61)\n\nThe photon trajectory geometry is shown in Fig. 1.4. The motion is constrained\nto the y ? z plane and targeted from y1, z1 to y2, z2 such that the photon arrives at\nthe same y coordinate which is taken to be R. For this geometry, the x coordinate is\nzero and the y coordinate variation is much smaller than the z coordinate variation.\nSince for this problem dy\n\ndz\n? 10?4, the line element differentials may be expanded\n\nas a Taylor series,\n\n(\ndx2 + dy2 + dz2\n\n) 1\n2 ? dz + 1\n\n2\n\ndy2\n\ndz\n+ O(dy\n\n4\n\ndz3\n) (1.62)\n\n\n\n32 1 Equations of Motion\n\nChanging the y variable of integration to z and inserting Eq. (1.62) into Eq. (1.61),\n\ndt = 1\nc\n\n(\n1 + 2?\n\nc2r\n+ 7\n\n4\n\n?2\n\nc4r2\n\n)(\ndz + 1\n\n2\n\ndy2\n\ndz2\ndz + O(dy\n\n4\n\ndz3\n)\n\n)\n(1.63)\n\nFully expanded, there are nine terms in Eq. (1.63) and four of them are of order 1/c5\n\nor greater. Consider a photon grazing the surface of the Sun. A maximum error of\nabout 10 cm or 0.3 ns is desired. To achieve this accuracy, numerical integration of\nthe equation of geodesics reveals that only four of the terms in Eq. (1.63) need be\nretained and these are\n\nt2 ? t1 = 1\nc\n\n? z2\nz1\n\n[\n1 + 2?\n\nc2r\n+ 1\n\n2\n\ndy2\n\ndz2\n+ 7\n\n4\n\n?2\n\nc4r2\n\n]\ndz (1.64)\n\nIn carrying out the integration, care should be taken in geometrically interpreting\nthe results. A \u201cstraight line\u201d in curved space geometry, the shortest measured\ndistance between two points, is the photon trajectory and not the dashed line shown\nin Fig. 1.4. Consider the first term of Eq. (1.64)\n\n?tf = 1\nc\n\n? z2\nz1\n\ndz = 1\nc\n(z2 ? z1) (1.65)\n\nThis is called the flat space term. If the end points were in flat space, ?tf would\nbe the time a photon travels from point 1 in Fig. 1.4 to point 2. In curved space,\nthere is no such thing as a straight line that connects these two points. The\n\nY\n\n(y1, z1) (y2, z2)\n\nZ\n\nr\n\nPhoton\nTrajectorydf\n\nf\n\ndy\n\nR\n\nFig. 1.4 Photon trajectory geometry\n\n\n\n1.8 General Relativity Equations of Motion 33\n\nreal interpretation of the term given by Eq. (1.65) is the mathematical result of\nperforming the integration on the first term of Eq. (1.64).\n\nThe second term of Eq. (1.64) is called the logarithmic term for reasons that will\nbecome obvious.\n\n?t ?log =\n2?\n\nc3\n\n? z2\nz1\n\ndz\n\nr\n\nIntegration requires an equation for r as a function of z. An iterative solution may be\nobtained by assuming a solution for r and integrating to obtain a first approximation\nfor t and y as a function of z. This solution is inserted into the remainder term, the\ndifference between the assumed and actual function, and a second iterated solution\nmay be obtained for t and y. This method of successive approximations is continued\nuntil the required accuracy is achieved. As a starting function, \u201cstraight line\u201d motion\nis assumed. Making use of the approximation that\n\nr ?\n?\n\nz2 + R2\n\n?t ?log =\n2?\n\nc3\n\n? z2\nz1\n\n[\n1?\n\nz2 + R2 +\n(\n\n1\n\nr\n? 1?\n\nz2 + R2\n)]\n\ndz = ?tlog + ?trr\n(1.66)\n\nThe first term of Eq. (1.66) integrates to the well-known equation for the time delay.\n\n?tlog = 2?\nc3\n\nln\n\n?\n?z2 +\n\n?\nz22 + R2\n\nz1 +\n?\n\nz21 + R2\n\n?\n? (1.67)\n\nThe second term of Eq. (1.66), which will be referred to as the radial remainder term\n(?trr ), requires a more accurate equation for r to be evaluated.\n\nIn order to evaluate the terms associated with bending of the trajectory, an\nequation for y as a function of z is needed. The y coordinate is associated with\nthe bending of the photon trajectory. Consider two photons in the plane of motion\nseparated by ?R. The plane containing these two photons and perpendicular to the\nvelocity vector is the plane of the wave front. The bending is simply the distance\none photon leads the other divided by their separation.\n\n? = c?td\n?R\n\nIn the limit as ?R approaches zero, the equation for bending is\n\n? = c dtd\ndR\n\n\n\n34 1 Equations of Motion\n\nThe equation for the delay is taken to be the logarithmic term given by Eq. (1.67)\nand for simplicity the bending is computed starting at closest approach (z2 = 0) to\nthe origin.\n\ntd = 2?\nc3\n\nln\n\n[\nz + ?z2 + R2\n\nR\n\n]\n\nTaking the derivative with respect to R,\n\n? = c dtd\ndR\n\n= ? 2?\nc2R\n\nz?\nz2 + R2\n\nTherefore, the accumulated bending from z1 to z, expressed as differentials, is\ngiven by\n\ndy\n\ndz\n= ?f ? 2?\n\nc2R\n(\n\nz?\nz2 + R2 ?\n\nz1?\nz21 + R2\n\n) (1.68)\n\nwhere ?f is the initial angle between the photon velocity vector and the horizontal\nline shown in Fig. 1.4. Referring to Fig. 1.4, the y component of the photon is\n\ny = R + ?y\n\n?y(z) =\n? z\n\nz1\n\n?\n??f ? 2?\n\nc2R\n(\n\nz??\nz?2 + R2 ?\n\nz1?\nz21 + R2\n\n)\n\n?\n? dz?\n\nand\n\n?y = ?f (z ? z1) ? 2?\nc2R\n\n?\n??z2 + R2 ? zz1 + R2?\n\nz21 + R2\n\n?\n? (1.69)\n\nThe angle ?f may be determined by evaluating the bending over the interval from\nz1 to z2. The coordinates are rotated to target the photon to the point z = z2, where\n?y = 0 and the constant gravitational aberration angle ?f was determined as\n\n?f = 1\nz2 ? z1\n\n2?\n\nc2R\n\n?\n??z22 + R2 ? z2z1 + R2?\n\nz21 + R2\n\n?\n? (1.70)\n\nThe angle ?f simply rotates the coordinates of Fig. 1.4 such that y1 and y2 have the\nsame value R.\n\n\n\n1.8 General Relativity Equations of Motion 35\n\nThe geometrical part of the radial remainder term may be approximated by\nmaking use of\n\n1\n\nr\n? 1?\n\nR2 + z2 =\n1?\n\n(R + ?y)2 + z2\n? 1?\n\nR2 + z2 ?\n?R?y\n\n(R2 + z2) 32\n\nThe complete radial remainder term (?trr ) is then given by\n\n?trr =?2?\nc3\n\n? z2\nz1\n\nR\n\n(R2 + z2) 32\n\n?\n??f (z ? z1)? 2?\n\nc2R\n\n?\n??z2 + R2 ? zz1 + R2?\n\nz21 + R2\n\n?\n?\n?\n? dz\n\n?trr = 2?\nc3R\n\n??\n??f\n\n?\n?z1z2 + R2?\n\nz22 + R2\n?\n\n?\nz21 + R2\n\n?\n?\n\n? 2?\nc2\n\n?\n?arctan (z1\n\nR\n\n)\n? arctan\n\n(z2\nR\n\n)\n+ R(z2 ? z1)?\n\nz21 + R2\n?\n\nz22 + R2\n\n?\n?\n??\n?\n\n(1.71)\n\nThe third term of Eq. (1.64) is the direct contribution of the trajectory bending to\nthe time delay. This term is referred to as the bending term and is given by\n\n?tb = 1\n2c\n\n? z2\nz1\n\n(\ndy\n\ndz\n\n)2\ndz\n\nSubstituting Eq. (1.69) for the slope into the above equation gives\n\n?tb = 1\n2c\n\n? z2\nz1\n\n?\n??f ? 2?\n\nc2R\n(\n\nz?\nz2 + R2 ?\n\nz1?\nz21 + R2\n\n)\n\n?\n?\n\n2\n\ndz\n\nCarrying out the integration\n\n?tb = 1\n2c\n\n??\n??2f (z2 ? z1) ? 4?c2R?f\n\n?\n??z22 + R2 ? z1z2 + R2?\n\nz21 + R2\n\n?\n?\n\n+ 4?\n2\n\nc4R2\n\n[\nR2(z1 + z2) + 2z21z2\n\nR2 + z21\n? 2z1\n\n?\nz22 + R2\nz21 + R2\n\n+ R\n[\narctan\n\n(z1\nR\n\n)\n? arctan\n\n(z2\nR\n\n)]]}\n(1.72)\n\n\n\n36 1 Equations of Motion\n\nThe fourth and final term of Eq. (1.64) is the c5 approximation to the error in the\nmetric. This is a small term and contributes less than a nanosecond to the delay. The\nequation is given by\n\n?tm = 7\n4\n\n?2\n\nc5\n\n? z2\nz1\n\n1\n\nr2\ndz ? 7\n\n4\n\n?2\n\nc5\n\n? z2\nz1\n\n1\n\nR2 + z2 dz\n\nCarrying out the integration\n\n?tm ? 7\n4\n\n?2\n\nc5R\n\n[\narctan\n\n(z2\nR\n\n)\n? arctan\n\n(z1\nR\n\n)]\n(1.73)\n\nThe complete equation for the coordinate time delay of a photon moving from\n(y1, z1) to (y2, z2) is obtained by summing all the individual terms and\n\nt2 ? t1 = ?tf + ?tlog + ?trr + ?tb + ?tm (1.74)\n\nBefore evaluating the individual terms of Eq. (1.74), the parameters used in the\nindividual terms must be determined unambiguously from the end points of the\nphoton trajectory. If two arbitrary end points in the y?z plane are defined by (y?1, z?1)\nand (y?2, z?2), the vectors from the origin to these points are given by\n\nr1 = (0, y?1, z?1) and r2 = (0, y?2, z?2)\n\nand the vector from point 1 to point 2 is\n\nr12 = (0, y?2 ? y?1, z?2 ? z?1)\n\nThe angles between the vectors r1 and r2 and the vector r12 are computed from the\ndot products.\n\n?1 = arccos\n(\n\nr1 \u00b7 r12\nr2r12\n\n)\n, ?2 = arccos\n\n(\nr2 \u00b7 r12\nr2r12\n\n)\n\nThe parameters needed in Eq. (1.64), with the coordinates rotated as shown in\nFig. 1.4 are then given by\n\nR = r1 sin ?1 = r2 sin ?2\nz1 = r1 cos ?1, z2 = r2 cos ?2\n\n\n\n1.8 General Relativity Equations of Motion 37\n\nand the angle ?f is given by Eq. (1.70). The fully expanded equation for the transit\ntime is given by,\n\nt2 ? t1 ? 1\nc\n(z2 ? z1) + 2?\n\nc3\nln\n\n?\n?z2 +\n\n?\nz22 + R2\n\nz1 +\n?\n\nz21 + R2\n\n?\n?\n\n+ 2?\nc3R\n\n??\n??f\n\n?\n?z1z2 + R2?\n\nz22 + R2\n?\n\n?\nz21 + R2\n\n?\n?\n\n? 2?\nc2\n\n?\n?arctan (z1\n\nR\n\n)\n? arctan\n\n(z2\nR\n\n)\n+ R(z2 ? z1)?\n\nz21 + R2\n?\n\nz22 + R2\n\n?\n?\n??\n?\n\n+ 1\n2c\n\n??\n??2f (z2 ? z1) ? 4?c2R?f\n\n?\n??z22 + R2 ? z1z2 + R2?\n\nz21 + R2\n\n?\n?\n\n+ 4?\n2\n\nc4R2\n\n[\nR2(z1 + z2) + 2z21z2\n\nR2 + z21\n? 2z1\n\n?\nz22 + R2\nz21 + R2\n\n+ R\n[\narctan\n\n(z1\nR\n\n)\n? arctan\n\n(z2\nR\n\n)]]\n\n+ 7\n4\n\n?2\n\nc5R\n\n[\narctan\n\n(z2\nR\n\n)\n? arctan\n\n(z1\nR\n\n)]\n\nAfter simplification this equation takes the following form\n\nt2 ? t1 ? 1\nc\n(z2 ? z1)(1 + 1\n\n2\n?2f ) +\n\n2?\n\nc3\nln\n\n?\n?z2 +\n\n?\nz22 + R2\n\nz1 +\n?\n\nz21 + R2\n\n?\n?\n\n+ 2?\nc3R\n\n?f\n\n?\n? (z1z2 ? z22)\n\n?\nz21 + R2 + (z1z2 ? z21)\n\n?\nz22 + R2?\n\nz21 + R2\n?\n\nz22 + R2\n\n?\n?\n\n+ 2?\n2\n\nc5R2\n\n?\n?R2(z1 + z2) + 2z21z2\n\nz21 + R2\n? 2z2(z1z2 + R\n\n2)?\nz21 + R2\n\n?\nz22 + R2\n\n?\n?\n\n+ 15\n4\n\n?2\n\nc5R\n\n[\narctan\n\n(z2\nR\n\n)\n? arctan\n\n(z1\nR\n\n)]\n\n?f ? 1\nz2 ? z1\n\n2?\n\nc2R\n\n?\n??z22 + R2 ? z2z1 + R2?\n\nz21 + R2\n\n?\n? (1.75)\n\n\n\n38 1 Equations of Motion\n\nFig. 1.5 Time delay for solar graze\n\nEquation (1.75) is the time delay associated with a photon or electromagnetic wave\nthat passes through the gravitational field of a massive spherical body. The time\ndelay is a function of only the gravitational constant of the massive body and\nthe parameters z1, z2, and R which may be computed directly from the isotropic\nSchwarzschild coordinates of the end points.\n\nIn order to determine the veracity of Eq. (1.75), a comparison with the time\ndelay computed from numerical integration of the geodesic equations of motion was\nmade and the result plotted in Fig. 1.5. In carrying out the numerical integration, a\nphoton was initialized with a z coordinate of ?149,000,000 km and y coordinate of\n696,000 km. The y component of velocity was set to zero and the z component to\nc. The x coordinates of position and velocity were set to zero. Thus, the photon is\ninitialized with a velocity magnitude equal to the speed of light and parallel to the z\naxis about 1 A.U. from the sun and on a flight path that would graze the surface of\nthe Sun if there were no bending due to General Relativity. The polar coordinates of\nthe initial conditions were used to initialize the equations of motion and these were\nintegrated by a fourth-order Runge-Kutta integrator with fifth-order error control.\nThe integration was stopped at various times along the flight path and Eq. (1.75)\nwas evaluated. The required parameters were computed from the initial coordinates\nand the integrated coordinates at the time of the evaluation.\n\nAlso shown in Fig. 1.5 are some of the individual groupings of terms from\nEq. (1.64). The linear term has been omitted since this term would require an\nadditional 6 cycles of logarithmic scale. The dashed curve is the difference between\nthe time delay computed by Eq. (1.75) and the results of numerical integration. This\ndifference is attributed to error in the numerical integration algorithm. This was\nverified by setting the mass of the Sun to zero and integrating straight line motion\n\n\n\n1.8 General Relativity Equations of Motion 39\n\nin the same coordinate system. Unfortunately, the integration error masked the error\nin the metric. Therefore, Eq. (1.75) could only be verified to about 0.05 ns which\nis about the same level of error as the error in the metric. The integration error of\nabout 10?14 t is consistent with the error obtained integrating spacecraft orbits for\nnavigation. Observe that the radial remainder term and bending term cause errors\non the order of 10 ns or 37 cm.\n\n1.8.6 Light Deflection\n\nLight deflection is the bending of a photon or radio wave trajectory as it passes by a\nmassive object. An experiment performed during a solar eclipse in 1919 measured\nthe deflection of star light and was the first confirmation of General Relativity theory.\nFor this comparison, we integrate the equations of motion for a photon and compare\nit with an analytic formula. The analytic formula is for a photon arriving at the Earth\nfrom infinity. This formula has been adapted to provide a continuous measure of the\nbending between any two points and is given by\n\n?? = 2?\nc2R\n\n{(cos(90 + ?1) ? cos(90 + ?2)}\n\nwhere R is the closest approach to the sun, ?1 is the angle from the y axis to the\nsource, and ?2 is the angle from the y axis to the receiver. The y axis is in the\ndirection of closest approach as illustrated in Fig. 1.4. Einstein\u2019s formula for the\ntotal bending is simply\n\n??12 = 4?\nc2R\n\nwhere ?1 = ?90? and ?2 = 90?.\nAnother formula for the bending is derived in Sect. 1.8.5 for the radar delay and\n\nis given by Eq. (1.69).\n\n?f = 1\nz2 ? z1\n\n2?\n\nc2R\n\n?\n??z22 + R2 ? z2z1 + R2?\n\nz21 + R2\n\n?\n?\n\nIf we take the limit as z1 approaches minus infinity and z2 approaches plus infinity,\n?f is one half of the Einstein bending formula. Since the total bending is the sum\nof the approach and departure bending, which are equal, the ?f formula, when\nmultiplied by two, is the Einstein formula.\n\nComparison of the Einstein formula with numerical integration of the isotropic\nSchwarzschild equations of motion is a little tricky because we must define what is\nmeant by bending in curved space. The generally accepted definition is the angle\n\n\n\n40 1 Equations of Motion\n\nbetween the local tangent of the photon trajectory and the straight line path that\nthe photon would follow if the sun was removed. Thus, in isotropic Schwarzschild\ncoordinates the deflection is given by\n\n?? = tan?1\n(\n\nVr cos ? ? Vn sin ?\nVr cos ? + Vn sin ?\n\n)\n\nwhere\n\nVr = dr\nd?\n\nVn = r d?\nd?\n\nand the undeflected photon is assumed to move parallel to the z axis.\nThe equations of motion are initialized with the position and velocity of the\n\nphoton. We place the photon far from the sun on a trajectory that will graze the\nsurface of the sun. The initial state vector is given by\n\nr1 = 149, 001, 625 km\n?1 = ?89.73236?\ndr1\n\nd?\n= ?299, 789.729 km/s\n\nd?1\n\nd?\n= 9.3982872536 \u00d7 10?6 rad/s\n\nand the constants are\n\n? = 1.327124399 \u00d7 1011 km3/s2\nc = 299792.458 km/s\n\nThe equations of motion are integrated along a trajectory that grazes the sun and\nterminated at\n\n?2 = 954.901039554 s (affine parameter time)\nt2 = 954.901158130 s (coordinate time)\nr2 = 137, 274, 407 km\n?2 = 89.70998749?\n\ndr2\n\nd?\n= 299, 789.146 km/s\n\nd?2\n\nd?\n= 11.072650234 \u00d7 10?6 rad/s\n\n\n\n1.9 Numerical Integration 41\n\nA comparison of the total bending obtained by numerical integration with the\ntheoretical formula derived by Einstein gives\n\nTotal light deflection angle\n\nEinstein\u2019s formula 8.48622 \u00d7 10?6 rad\nExact Schwarzschild integration 8.48642 \u00d7 10?6 rad\n\n1.9 Numerical Integration\n\nIntegration of a function on a computer makes use of the definition of a derivative\nand some results that are associated with proof of the fundamental theorem of\ncalculus. The definition of an integral is a Riemann sum in the limit as the number of\nsums approaches infinity and the width of the interval approaches zero. A computer\ncannot deal with infinity so the Riemann sums must be finite. This does not impose\na limit on accuracy since given a required accuracy (?) the width of the Riemann\nsum intervals may be made small enough (?) to achieve this accuracy. Given an\nepsilon, there is a delta which is a refrain used by mathematicians in proving\ntheorems. The real limitation of accuracy on a computer is machine precision\nwhich may be overcome by computing in extended precision. Orbit determination\nsoftware is written in double precision which was a problem when computers\nwere expensive. Computation of the Doppler observable strains the limit of double\nprecision (64 bits).\n\n1.9.1 Fundamental Theorem of Calculus\n\nThe fundamental theorem of calculus involves performing two operations on an\narbitrary function (f ) and then showing that the resultant function is also f . The\ntwo operations are integration over an interval and differentiation. The integral is\ndefined as the area under the curve defined by f (s) and the s axis and the derivative\nis defined as the slope of f (s). The function (f(s)) is continuous and has continuous\nfirst and second derivatives. A continuous function is defined here as one that can\nbe drawn on graph paper without lifting the pencil and is the only kind of function\nneeded for navigation of spacecraft.\n\nd\n\ndx\n\n? x\n??\n\nf (s) ds = f (x)\n\n\n\n42 1 Equations of Motion\n\nFig. 1.6 Plot of function\n\nf (a*)\n\nf (a)\n\nf (x)\n\na* a\n\n?x\n\nx\n\ny\n\nm =\ndy\ndx\n\nFigure 1.6 shows a plot of the geometry. An intermediate evaluation value ? is\ndefined that is within an infinitesimal interval of the value x. The reason for doing\nthis is that the integral from ?? to ? will be a constant (not a function of x) and have\na derivative of zero.\nIn the limit as ?x approaches zero\n\nf (s) = f (?) + m (s ? ?)\n\nwhere\n\nm = df (s)\nds\n\n? f (x) ? f (?)\nx ? ?\n\nThe integral from ? to x is thus the area under that part of the curve which is the\nslim addition of width ?x. The big area from ?? to ? can be ignored because this\narea is not a function of x and will have a derivative of zero with respect to x.\n\n? x\n?\n\nf (s) ds = f (?) (x ? ?) + 1\n2\n\nm (x ? ?)2\n\nFrom the definition of the derivative, we have in the limit as ?x goes to zero.\n\nd\n\ndx\n\n[? x\n?\n\nf (s) ds\n\n]\n=\n\nlim\n?x?0\n\nf (?)(x ? ?) + 12 m(x ? ?)2 ? f (?)(x ? ? ? ?x) ? 12 m(x ? ? ? ?x)2\n?x\n\nd\n\ndx\n\n[? x\n?\n\nf (s) ds\n\n]\n= f (?) + m(x ? ?) = f (x)\n\n\n\n1.9 Numerical Integration 43\n\nThe proof would be complete if the slope or straight line in Fig. 1.6 was the same\nas the curve. The problem is the small area between the curve and the slope. In the\nlimit as ?x approaches zero, this small area vanishes. However, the triangle which\ndefines the change in the function also vanishes. We have to show that the small\narea vanishes faster than the triangle or the ratio of the small area to the triangle\napproaches zero. The integral is the infinite sum of the infinitely small triangles.\nThis is called a squeeze by mathematicians. If we assume that\n\nf (s) = f (?) + m (s ? ?) + c2(s ? ?)2 + \u00b7 \u00b7 \u00b7 cn(s ? ?)n\n\nand process this function as described above, we obtain\n\nf (x) = f (?) + m (x ? ?) + c2(x ? ?)2 + \u00b7 \u00b7 \u00b7 cn(x ? ?)n\n\nThe change in f (x) over the interval from ? to x is\n\n?f (x) = m (x ? ?) + c2(x ? ?)2 + cn \u00b7 \u00b7 \u00b7 (x ? ?)n\n\nDividing by (x ? ?)\n?f (x)\n\n(x ? ?) = m + c2(x ? ?) + \u00b7 \u00b7 \u00b7 cn(x ? ?)\nn?1\n\nIn the limit as (x ? ?) approaches zero,\n\nf (x) = f (?) + m(x ? ?)\n\nThis proof is a bit circular in that the fundamental theorem of calculus is probably\nneeded to prove that the function can be represented by a Taylor series over a small\ninterval. Tom Apostle provides two proofs of this theorem in his book on calculus.\nA third proof is given in Mathematical Analysis and this is probably the best proof.\nAll of his proofs involve elegant squeezes. Newton\u2019s proof is similar to the one\ngiven here but would probably not be accepted today by mathematicians. Newton\nand Leibnitz stated the theorem and thus get all the credit. The proof is secondary.\n\n1.9.2 Runge-Kutta Numerical Integration\n\nNumerical integration uses many of the ideas associated with proving the fundamen-\ntal theorem of calculus. The difference is that the fundamental theorem of calculus\nis an exact result and numerical integration is an approximation that is exact in\nthe limit as the integration interval goes to zero which can never be achieved on a\ncomputer. Numerical integration is in a sense more difficult because the result is\n\n\n\n44 1 Equations of Motion\n\nf (x)\n\nx\n\nh\nk1\n\nk2\n\nk3 k4\n\naverage slope\n\nt0\n\nFig. 1.7 Fourth-order Runge-Kutta\n\nunknown and the integration uses the result. Therefore, numerical integration is a\nboot strapping process. Given,\n\ndx\n\ndt\n= f (x, t)\n\nnumerical integration involves finding f (x, t) knowing only the derivative. We first\nobtain the following derivatives over the interval from t0 to t0 + h. The geometry is\nillustrated in Fig. 1.7.\n\nk1 = f (x(t0), t0)\n\nk2 = f\n(\n\nx(t0) + k1 h\n2\n, t0 + h\n\n2\n\n)\n\nk3 = f\n(\n\nx(t0) + k2 h\n2\n, t0 + h\n\n2\n\n)\n\nk4 = f (x(t0) + k3 h, t0 + h)\n\nThe average slope over the interval is a weighted average and x(t0 + h) is thus,\n\nx(t0 + h) = x(t0) + k1 + 2k2 + 2k3 + k4\n6\n\nh\n\n\n\n1.9 Numerical Integration 45\n\nEuler integration involves only one derivative evaluation. The derivative evalu-\nated at the left side of the integration interval and extended across the interval is\ngiven by,\n\nx(t0 + h) = x(t0) + f (x(t0), t0) h\n\nAn orbit was integrated around one full revolution of the sun to test various\nnumerical integrator accuracies. The orbit had a semi-major axis of 149.4\u00d7106 km,\nan eccentricity of 0.8, and orientation angles in the plane of the ecliptic. The\ngravitational constant for the sun was 0.132712440017987 \u00d7 1012 km3/s2 which\nis far more digits than required for the test. The orbit period is about 1 year and\nperiapsis is inside the Earth\u2019s orbit. The integration was started 11,805,133.8 s from\nperiapsis to avoid the symmetry associated with starting at periapsis. The results\nare tabulated below for the Euler integration error. The number of steps is tabulated\nalong with the position error, energy error, and momentum error. The integration\nstep size is the period of the orbit divided by the number of steps. Thus, 365 steps\nwould be about one day. The dimensionless errors are obtained by dividing the\nactual error by the parameter nominal value. Thus, 10?2 would be a one percent\nerror. The exponents indicate the number of decimal places of accuracy.\n\nEuler integration error\n\nSteps ? x ? y Energy Momentum\n\n36,500 10?1 10?1 10?1 10?1\n\n365,000 10?2 10?1 10?2 10?1\n\n3,650,000 10?3 10?2 10?3 10?2\n\n36,500,000 10?4 10?3 10?4 10?3\n\nThe Euler integration does not do very well. It takes a one second step size to\nget four-decimal place accuracy. However, a 100 s step size (step = 365,000) may\nbe accurate enough for some applications and only requires a few lines of computer\ncode to implement.\n\nThe classical fourth-order Runge-Kutta algorithm results are shown below. An\n864 s step size yields 11 decimal place accuracy which is sufficient for planetary\nspacecraft navigation. This algorithm was used for about 10 years by the author\nwithout any need for more accuracy. It was used in the Mars Orbit Insertion software\nfor the Viking mission to Mars in 1976. The original coding was to replace an analog\ncomputer integrator with digital computer code.\n\n\n\n46 1 Equations of Motion\n\nFourth-order Runge-Kutta integration error\n\nSteps ? x ? y Energy Momentum\n\n365 10?3 10?2 10?3 10?3\n\n3650 10?9 10?6 10?8 10?8\n\n36,500 10?11 10?11 10?13 10?12\n\n365,000 10?10 10?9 10?12 10?12\n\nThe integrator used today is the fifth-order Runge-Kutta-Fehlberg integrator with\nsixth degree error control. This integrator achieves 13-decimal place accuracy for an\n865 s step size and this integrator was used for the Near Earth Asteroid Rendezvous\nsoftware. It was necessary to tailor the error control for integrating spacecraft\nby planets. The variable step size had a tendency to miss planets or asteroids and\nflyby without reducing the step size enough.\n\nFifth-order Runge-Kutta-Fehlberg integration error\n\nSteps ? x ? y Energy Momentum\n\n365 10?2 10?1 10?4 10?3\n\n3650 10?9 10?7 10?8 10?8\n\n36,500 10?13 10?11 10?15 10?15\n\n365,000 10?13 10?11 10?13 10?13\n\nThe Fehlberg integrator is accurate enough to predict solar eclipses at the time of\nAlexander the Great.\n\n1.10 Summary\n\nThe equations of motion have been developed for motion that is relative to\nnavigation. Flight operations software is dominated by numerical integration of\nNewton\u2019s equations of motion. Energy and momentum are useful concepts for\nunderstanding motion but there are very few equations in operational software that\nexplicitly acknowledge their existence. One notable example is the momentum\nand energy supplied by springs as a probe separates from a spacecraft. Energy\nand momentum are more an artifact of Newton\u2019s second law. The equations of\nmotion describing particle collisions and the kinetic theory of gasses acknowledge\nenergy and momentum, but operational software does not explicitly integrate these\nequations. Therefore, a knowledge of Newton\u2019s equations of motion is just about all\none needs to navigate spacecraft.\n\nOne minor exception is the Theory of General Relativity. Clocks, the path of\nphotons near the Sun, and the precession of Mercury\u2019s orbit are affected by general\nrelativity and enter as corrections or calibrations of the data or equations of motion.\nSince these corrections can be seen in the data, they are included in the flight\n\n\n\nExercises 47\n\noperations software. However, sufficiently accurate navigation could be performed\nignoring General Relativity. Navigators, who conduct mission operations, generally\nregard General Relativity as a curiosity.\n\nSince the computer is used in the conduct of flight operations, understanding of\nthe mathematics of algorithms contained in computer software is needed. Numerical\nintegration algorithms and finite difference partial derivatives or difference equa-\ntions are examples. Analytic partial derivatives, that are in the provence of calculus\ntext books, are also needed for orbit determination.\n\nExercises\n\n1.1 A basketball is dropped on the floor from a height of 1.5 m and rebounds to a\nheight of 1.5 m neglecting energy loss. A golf ball also rebounds to the same height.\nThe golf ball is now held above the basketball and they are both dropped together.\nThe basketball rebounds and hits the golf ball. How high will the golf ball go? The\nbasketball weighs 560 g and the golf ball weighs 45 g. The acceleration is assumed\nto be uniform at 9.82 m/s2.\n\n1.2 The partial derivatives of the gravitational acceleration with respect to position\nis needed for the variational equations. If the gravitational acceleration is given by\n\na = ??\nr3\n\nr\n\ndetermine\n?a\n?r\n\nwhich is a 3\u00d73 matrix.\n1.3 The spin vector of the Earth precesses around the Ecliptic pole with a period\nof about 26,000 years. The applied moment is from the Sun and Moon gravity\ngradients. The applied moment is given by applying the result from Exercise 1.2.\n\nM = me ?a\n?r\n\n?r?rl\n\n?\n? sin(?)cos(?)\n\n0\n\n?\n?\n\nwhere me is the mass of the Earth, ?r is the separation of the dipole associated\nwith oblateness, and ?rl is the effective moment arm. Assume that the product\nme ?r ?rl is given by\n\nme?r ?rl = Izz ? (Ixx + Iyy)/2.\n\nDetermine an equation for the applied moment.\n\n1.4 For the purpose of computing gravity gradient torques, a body may be\nrepresented by dipole point masses distributed on the body fixed coordinate axes.\n\n\n\n48 1 Equations of Motion\n\nSince Izz = m k2z , two point masses may be located on the z axis at plus and minus\nkz. The torque may be calculated from the Ixx and Izz point masses by projecting\nthe positions of the point masses on to the moment arm and sun vector directions.\nShow that\n\nsin ? cos ? ?r?rl = sin ? cos ? (Izz ? Ixx)\n\nwhere ? is the complement of the angle between the sun vector and body fixed z\naxis.\n\n1.5 The precession contributed by the Sun is given by\n\n?? = M\n2?eIzz\n\nThe factor of two is needed to attenuate the vector magnitude by the average\nof sine function squared associated with the orbital motion and separation of\nprecession from nutation. Determine the precession rate for the sun contribution\nwhere (Ixx ? Iyy)/Izz = 3.27376 \u00d7 10?3, ?e = 7.292 \u00d7 10?5 s?1, GM =\n0.132712 \u00d7 1012 km3s?2, r = 0.149577 \u00d7 109 km, ? = 23.439?.\n1.6 Show that the partial derivative of angular acceleration with respect to the\ninertia tensor is given by\n\n?f\n?\n\n?Ie\n= ?I?1\n\n?\n? 0 ??z ?y?z 0 ??x\n\n??y ?x 0\n\n?\n?\n?\n??x 0 0 ?y ?z 00 ?y 0 ?x 0 ?z\n\n0 0 ?z 0 ?x ?y\n\n?\n?\n\n?I?1\n?\n? ??x 0 0 ??y ??z 00 ??y 0 ??x 0 ??z\n\n0 0 ??z 0 ??x ??y\n\n?\n? (1.76)\n\nThe elements of the inertia tensor are contained in a column matrix of dimension\nsix. Unless highly skilled in tensor algebra, this problem can be solved by expanding\nthe vectors and matrices as equations in terms of their elements, differentiating, and\nthen reassembling into the above matrices. The result in this form can be easily\nprogrammed on a computer.\n\n1.7 Determine the root-mean-square velocity of a nitrogen gas molecule (M = 14)\nat room temperature (72?F).\n\n1.8 A sample of air at standard temperature and pressure (0?C, 1.01325 nt/m2)\noccupies a volume of 22,421 cm3. A mole of any gas at standard temperature and\npressure will occupy a volume of 22,421 cm3 and contain Avogadro\u2019s number of\nmolecules (6.022 \u00d7 1023). Assume the air is an ideal gas with molecular weight of\n29 and the diameter of an air molecule is 3 \u00c5. Determine the mean free path length\nof a molecule between collisions and the number of collisions per second.\n\n\n\nBibliography 49\n\n1.9 On Jan 1, 65,000,000 12:00:00 BC, a tyrannosaurus rex sets his atomic watch\nat high noon. At the same time, a photon is emitted from a distant galaxy and sets\nhis identical watch to the same time. On Jan 1, 2017 12:00:00, the photon hits t rex.\nBoth watches gain 3 \u00d7 10?16 seconds for each second of elapsed time, the same\naccuracy as the atomic clocks used by the DSN. What time will both watches read?\n\n1.10 Perform Euler integration of the sine function from 0 to 90? assuming an\nintegration step size of 30? and evaluating the function at the right side of the\ninterval. Repeat evaluating the function in the middle of the interval. Repeat again\nonly assume an integration step size of 10?.\n\nBibliography\n\nBate, R. R., Mueller, D. D., and White, J. E., Fundamentals of Astrodynamics, Dover Publications,\nNew York, 1971.\n\nDavies, M. E., V. K. Abalakin, M. Bursa, T. Lederle, J. H. Lieske, R. H. Rapp, P. K. Seidelmann, A.\nT. Sinclair, V. G. Teifel, Y. S. Tjuflin 1986. Report of the IAU/IAG/COSPAR Working Group on\nCartographic Coordinates and Rotational Elements of the Planets and Satellites: Celest. Mech.\n39, 103\u2013113., 1985.\n\nGreenwood D. T. 1965, Principles of Dynamics, Prentice-Hall Inc., Englewood Cliffs, NJ.\nHellings, R. W., \u201cRelativistic Effects in Astronomical Timing Measurements,\u201d The Astronomical\n\nJournal, vol. 91, no. 3, pp. 650\u2013659, March 1986.\nIchinose, S. and Y. Kaminaga, \u201cInevitable ambiguity in perturbation around flat space-time,\u201d\n\nPhysical Review, Vol 40, N 12, pp 3997\u20134010, 15 December 1989.\nLass, H., Vector and Tensor Analysis, McGraw-Hill, New York, 1950.\nLlanos, P. J., Miller, J. K. and Hintz, G. R., \u201cTrajectory Dynamics of Gas Molecules and Galaxy\n\nFormation\u201d, Paper AAS 13-863. AAS/AIAA 2013 Astrodynamics Specialist Conference,\nHilton Head, SC, January 2013.\n\nLieske, J. H., \u201cImproved Ephemerides of the Galilean Satellites\u201d, Astronomy Astrophysics, Vol.\n82, pp. 340\u2013348, 1980.\n\nMcVittie, G. C., General Relativity and Cosmology, The University of Illinois Press, Urbana, 1965.\nMiller, J, K. and S. G. Turyshev, \u201cThe Trajectory of a Photon\u201d, AAS03-255, 13th AAS/AIAA\n\nSpace Flight Mechanics Meeting, Ponce, Puerto Rico, February 9, 2003.)\nMisner, C. W., Thorne, K. S., Wheeler, J. A., Gravitation, W. H. Freeman, New York, 1972.\nMoyer, T. D., \u201cTransformation from Proper Time on Earth to Coordinate Time in Solar System\n\nBarycentric Space-Time Frames of Reference: Parts 1 and 2,\u201d Celestial Mechanics, vol. 23, pp.\n33\u201308, January 1981.\n\nMoyer, T. D., Mathematical Formulation of the Double-Precision Orbit Determination Program,\nJPL Technical Report 32\u20131527, Jet Propulsion Laboratory, Pasadena, California, May 15, 1971.\n\nRichter, G. W. and Matzner, R. A., \u201cSecond-order contributions to relativistic time delay in the\nparameterized post-Newtonian formalism,\u201d Physical Review, Vol. 28, N 12, 15 December 1983.\n\nSokolnikoff, I. S., Tensor Analysis Theory and Applications to Geometry and Mechanics of\nContinua, John Wiley and Sons, New York, 1964.\n\nStandish, E. M., E. M. Keesey, and X. X. Newhall, \u201cJPL Development Ephemeris Number 96,\u201d\nTechnical Report 32\u20131603, Jet Propulsion Laboratory internal document, Pasadena, California,\n1976.\n\nVan De Kamp, P., Elements of Astromechanics, W. H. Freeman and Company, San Francisco, 1964.\nWeeks, C. J., J. K. Miller, B. G. Williams, \u201cCalibration of Radiometric Data for Relativity and\n\nSolar Plasma During a Solar Conjunction\u201d, Journal of the Astronautical Sciences, Vol. 49, No.\n4, pp. 615\u2013628, October-December, 2001.\n\n\n\nChapter 2\nForce Models\n\nThe acceleration of a spacecraft is proportional to the vector sum of all the forces\nacting on the spacecraft. Each component of the resultant force is computed by\nindividual force models. The required accuracy of force models is dependent on\nthe magnitude of the force and the observability of the force in orbit determination\nsoftware. By far the most important force model is gravity. Gravity force models are\nformulated as acceleration but this is only a matter of convenience because the mass\nof the spacecraft factors out of the equations of motion. Force models are generally\nindependent of motion. Even though solar pressure and rocket thrust involve motion\nof molecules and photons, the force on the spacecraft does not depend on its motion.\nA notable exception is atmospheric drag forces that are dependent on the velocity\nof the spacecraft relative to the atmosphere.\n\n2.1 Rocket Equation\n\nThe acceleration of a spacecraft from a rocket engine is accomplished by ejecting\ngas molecules at high velocity. The energy source can be gas stored in a container\nunder pressure. Cold gas rocket thrusters were used by early spacecraft for attitude\ncontrol. In order to attain the high thrust and high efficiency of modern rocket\nengines, the gas molecules are heated to a very high temperature by burning rocket\nfuel in a thrust chamber that directs the gas in a steady stream opposite to the\ndirection of acceleration. The acceleration of a spacecraft subject to the thrust T\nis given by,\n\ndv\n\ndt\n= T\n\nmsc\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_2\n\n51\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_2&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_2\n\n\n52 2 Force Models\n\nIf the rocket exhaust is throttled to flow at a constant velocity (u), the thrust is\ngiven by the rate of change of momentum as described above for particle impacts.\n\nT = u dm\ndt\n\nThe propellant is assumed to be an integral part of the spacecraft and the equation\nfor the velocity change of the total mass including spacecraft and propellant is\n\ndv = u dm\nm\n\nIntegrating gives what is known as the rocket equation,\n\n?v = u ln m0\nm\n\n(2.1)\n\nwhere ?v is the change in velocity of the spacecraft and m0 is the initial mass. The\npropellant burned is the difference between m and m0. The simplicity of the rocket\nequation belies its usefulness. Interpretation of the parameters of the rocket equation\nprovides considerable insight into the design of rocket engines. The key parameter\nis the rocket exhaust velocity. Historically, the designers of rocket engines have\nattempted to maximize the exhaust velocity and have devised a parameter called the\nspecific impulse (Isp) to provide a measure of efficiency. The specific impulse is\ndefined by,\n\nIsp = u\ng0\n\nThe constant g0 is the acceleration of Earth\u2019s gravity at sea level and appears to be\na relic from the time when pound mass was used instead of the slug which is the\ncurrent unit of mass in the English system. The unit of specific impulse is a second\nand provides a measure of the time a particle would fall near the surface of the Earth\nto attain the speed of the rocket exhaust which is a fairly meaningless concept. In\nthe modern era, the Isp is a measure of the overall efficiency of the rocket engine\nand has been incorporated into the rocket equation.\n\n?v = g0Isp ln m0\nm\n\n(2.2)\n\nThe specific impulse that is quoted for rocket engines is not directly proportional\nto the exhaust velocity. It factors in inefficiencies associated with the flow of\nthe exhaust gas and is adjusted to give the right performance when used in the\nrocket equation. The specific impulse associated with a cold gas rocket engine or\nwith discreet venting from a spacecraft may be computed from the ideal gas law\n(Eq. 1.46).\n\nIsp = 1\ng0\n\n?\n3RT\n\nM\n(2.3)\n\n\n\n2.2 Aerodynamic Forces 53\n\nObserve that the specific impulse and hence the overall efficiency of this type\nof rocket engine is only a function of the temperature and molecular weight of the\ngas that is expelled. For this reason, rocket engine designers tend to favor hydrogen\nas a fuel because of its low-molecular weight. Solid rocket motors use propellant\nwith a relatively high-molecular weight and attain specific impulses in the range of\n200 s. Liquid propellant rocket motors that use hydrogen as a fuel attain specific\nimpulses in the high 300\u2019s. The temperature of the fuel is also a major factor. Cold\ngas systems attain specific impulses in the 50 s range. In order to attain really high\ntemperatures for the gas molecules, the gas may be ionized and accelerated with an\nelectric field. Ion drive engines can obtain specific impulses of several thousand.\n\n2.2 Aerodynamic Forces\n\nA spacecraft moving through a planetary atmosphere or through the tail of a comet\nexperiences aerodynamic forces opposite to the direction of motion called drag and\nnormal to the direction of motion called lift or side slip. The drag force is generally\nbeneficial to spacecraft since it may be used to remove kinetic energy from the\nspacecraft. During descent to the planet\u2019s surface, the drag force acts in a direction\nto aid thrusters used for braking and in orbit the drag force may be used to circularize\nthe orbit. Consider a spacecraft that may be approximated by a flat plate oriented\nperpendicular to the velocity vector relative to an atmosphere. Since the moving\nspacecraft encounters atmospheric molecules at rest, a force must be applied by the\nspacecraft to accelerate the atmosphere molecules from rest to the velocity of the\nspacecraft. This force is given by,\n\nF = m dv\ndt\n\nThe rate of change of energy or power that must be supplied by the spacecraft to\naccelerate the gas molecules of mass m is given by,\n\nF v = mv dv\ndt\n\nOver an incremental distance (dx), the work (dE) done on the atmosphere is\n\ndE =\n? x+?x\n\nx\n\nF dx = F?x = m\n? v\n\n0\nv dv = mv\n\n2\n\n2\n\nThe mass of the atmosphere swept out is ?A?x where A is the cross section area of\nthe spacecraft and ? is the atmospheric density. Thus, we have\n\nF = A? v\n2\n\n2\n\n\n\n54 2 Force Models\n\nfor the force on the spacecraft. The force distributed over the spacecraft is the\npressure (q) times the area (F = qA). The pressure exerted on the spacecraft is\ncalled dynamic pressure and is given by,\n\nq = 1\n2\n?v2\n\nThe drag force is given by,\n\nFd = CdqA (2.4)\nwhere the drag coefficient Cd is a parameter computed by aerodynamicists to\naccount for the flow of the atmosphere around the spacecraft and has a maximum\nvalue of one. As the spacecraft moves through the atmosphere, the gas molecules\nthat are accelerated to the velocity of the spacecraft build up in front of the spacecraft\nand form a wedge that deflects some of the molecules encountered to flow around\nthe spacecraft. As a result, not all of the molecules are accelerated to the velocity of\nthe spacecraft and the drag coefficient is less than one. If the spacecraft is tilted by\nsome angle, aerodynamic forces are generated that are normal to the velocity vector\ncalled lift. For spacecraft navigation in an atmosphere, an aerodynamic model is\nrequired to enable the computation of all the force components as a function of q\nfor all the permissible attitudes into which the spacecraft may be maneuvered. The\naerodynamic coefficients are computed by an aerodynamicist or reduced from wind\ntunnel data and supplied to navigation enabling the trajectory of the spacecraft to be\ncomputed.\n\n2.3 Solar Pressure\n\nPhotons emanating from the sun impinge on the spacecraft resulting in a force that\naccelerates the spacecraft. The force results from the change in momentum as the\nphoton decelerates from the speed of light (c) to rest with respect to the spacecraft\nand is converted to heat assuming that the spacecraft is a black body. The force is\nrelated to the change in linear momentum given by,\n\nF = d(mc)\ndt\n\n(2.5)\n\nThe incremental energy required to decelerate the photon is\n\ndE = Fdx\n\nand the power supplied to the spacecraft is obtained by dividing by dt.\n\ndE\n\ndt\n= Fc (2.6)\n\n\n\n2.3 Solar Pressure 55\n\nOver the time interval dt , the photon moves an infinitesimal amount dx. The\nmathematics are a bit oversimplified, but if Eq. (2.5) is substituted into Eq. (2.6)\nwe get E = mc2 and this result is consistent with Special Relativity. The force of\nthe photons on the spacecraft creates a pressure over the exposed surface area (A)\nand the net force is obtained by integrating all the photons over the area (A) of the\nspacecraft.\n\nF = 1\nc\n\ndE\n\ndt\n\ndE\n\ndt\n= I A\n\nThe power supplied to the spacecraft per unit area (I ) may be computed from the\nsolar intensity measured at Earth (Ie) and scaled by the inverse square of the distance\nfrom the sun.\n\nI =\n(\n\nRe\n\nRs\n\n)2\nIe (2.7)\n\nCollecting terms and solving for the force on the spacecraft gives\n\nF = K A\nR2s\n\nK = 1\nc\nR2e Ie (2.8)\n\nwhere\n\nIe = 1, 353 w/m2, c = 2, 999, 793.458 m/s2, and Re = 149.4 \u00d7 109 m\n\nand\n\nK = 1.01 \u00d7 1017 kg m/s2 = 1.01 \u00d7 108 kg km3/m2 s2\n\nK is given in both MKS units and mixed units since area is generally given in\nm2 and distance in km. The solar pressure model used for navigation is more\ncomplicated than the simple flat plate black body model described above suggests.\nThe above result for the force assumes that all the photons are absorbed by the\nspacecraft and are directed radially away from the Sun. Some of the photons will be\nreflected from the spacecraft which will increase the solar pressure. If the spacecraft\nwere a perfect mirror, the force would be doubled. The incident and reflected\nmomentum exchange would be in the same direction. The reflected solar energy\nis composed of specular and diffuse radiation. For specular reflection, the angle of\nincidence is equal to the angle of reflection and for diffuse radiation, the energy\nis scattered by the cosine of the sun angle. The solar pressure model used for\n\n\n\n56 2 Force Models\n\nTable 2.1 Solar pressure\nmodel parameters\n\nFront side Cylindrical side Back side Antenna\nArea 8.92 m2 2.22 m2 11.25 m2 2.33 m2\n\n? 0.165 0.039 0.750 0.750\n\n? 0.742 0.101 0.100 0.107\n\n? ?0.112 0.400 0.400 0.398\n\nthe Near Earth Asteroid Rendezvous (NEAR) mission had three components. The\nspecular radiation component is ? , the diffuse radiation component is ?, and the\nthird component ? accounts for thermal reradiation. Table 2.1 gives the values of\nthese coefficients for each part of the spacecraft. A separate set of coefficients was\nspecified for the front side, cylindrical side, back side, and antenna.\n\n2.4 Gravity Models\n\nThe gravitational acceleration (A) of a point mass by a body may be obtained by\nintegrating Newton\u2019s inverse square law of gravity a(x, y, z) over the body and is\ngiven by,\n\nA =\n?\n\nV\n\na(x, y, z) dx dy dz = G?i\n??\ni=0\n\nri ? r?\n|ri ? r?|3 r\n\n2\ni cos ?i dri d?i d?i (2.9)\n\nwhere G is the gravitational constant and ? is the density. Equation (2.9) is a\nmathematical statement of Newton\u2019s law of gravity and requires no proof. The\nacceleration may be replaced by force per unit mass. Thus, a problem in dynamics is\nreplaced by a problem in statics which greatly simplifies the physics. We no longer\nneed to be concerned with the concept of energy and momentum. The vector r\nis from the center of the coordinate system to the mass element and the vector r?\nis to the spacecraft. The geometry is illustrated in Fig. 2.1. The right side of the\nabove equation is simply the definition of a volume integral transformed to spherical\ncoordinates. In the limit as the index (i) goes to infinity, the size of the volume\nelements goes to zero. The volume elements may be replaced by mass elements\ndefined by,\n\ndmi = ? r2i cos ?i dri d?i d?i\nThe sum of the mass elements is the total mass of the body. If ? equals one, the\nsum is the volume of the body. The density on the surface (?) may be defined by an\nexpansion of Legendre polynomials and associated functions as\n\n? =\n??\n\nn=0\n\nn?\nm=0\n\nP mn (sin ?)[Anm cos m? + Bnm sin m?] (2.10)\n\nAlternatively, the density could be given in a table as a function of latitude and\nlongitude.\n\n\n\n2.4 Gravity Models 57\n\nFig. 2.1 Planet or asteroid\nbody gravity geometry\n\nPOINT MASS\n\nBRILLOUIN SPHERE\n\ndm\n\nq x\n\ny\n\nr'\n\nr\n\nr\u2013r'\n\ny2\n\nr0 x2\n\n2.4.1 Harmonic Expansion Model\n\nThe gravitational acceleration given by Eq. (2.9) may be recast as the sum of inverse\nsquare relationships for each mass element,\n\nA =\n??\ni=0\n\n??i(r? ? ri )\n|r? ? ri |3 (2.11)\n\nwhere ?i = Gmi . Integrating the total acceleration term by term, we obtain the\nfollowing,\n\nU =\n??\ni=0\n\n?i\n\n|r? ? ri | (2.12)\n\nIf we take the derivatives of A term by term with respect to x?, y?, and z? and sum\nthem, we obtain after a little algebra,\n\n? \u00b7 A =\n??\ni=0\n\n3?i\n|r? ? ri |3 ?\n\n3?i\n|r? ? ri |5\n\n[\n(x? ? xi)2 + (y? ? yi)2 + (z? ? zi)2\n\n]\n= 0\n(2.13)\n\nSince the right side of Eq. (2.11) is the gradient of the right side of Eq. (2.12) and\nthe right side of Eq. (2.13) are the derivatives of the right side of Eq. (2.11) summed,\nthe same relationships hold for the left sides and\n\n\n\n58 2 Force Models\n\nA = ?U (2.14)\n\n?2U = ?\n2U\n\n?x?2\n+ ?\n\n2U\n\n?y?2\n+ ?\n\n2U\n\n?z?2\n= 0 (2.15)\n\nEquation (2.15) for the divergence of U may be solved for U . For U to be unique,\nthe boundary condition must be satisfied. The fundamental theorem of calculus will\nthen guarantee that the gradient of U will be the acceleration. For heat flow, the\nabove differential equation for U is the flow of energy across the faces of the volume\nelements. For electric charge, Michael Faraday, the father of electrical engineering,\npostulated a flux. The real mathematical basis for the divergence theorem is the\ninverse square relationship. Heat, gravity, and electric charge are all inverse square\nand obey Newton\u2019s action equals reaction and acceleration equals force divided by\nmass.\n\nSince Eq. (2.15) for the divergence is linear and homogeneous, it may be solved\nby separation of variables. It is interesting to note that Legendre\u2019s equation is\nobtained from the offset point mass given in Eq. (2.11). The solution for the potential\nis given by,\n\nU = ?\nr\n\n{\nC00 +\n\n??\nn=1\n\n( ro\nr\n\n)n n?\nm=0\n\nP mn (sin ?)[Cnm cos m? + Snm sin m?]\n}\n\n(2.16)\nThe acceleration is obtained by taking the gradient of U, which involves first\nderivatives of Legendre polynomials that are generally obtained by recursion\nrelationships. An explicit formula for the Legendre polynomials and associated\nfunctions that do not involve recursion relationships is given by Heiskanen and\nMoritz. For orbit determination, the partial derivatives of acceleration with respect\nto state and gravity coefficients are needed for the variational equations. These\npartials are difficult to derive because they involve second derivatives of Legendre\npolynomials and transformations back and forth between spherical and Cartesian\ncoordinates.\n\n2.4.2 Point Mass Model\n\nThe next gravity model to be considered is the point mass model. In Europe, this\nmodel is called the punctual model. In German, punc means point as we know from\nthe radios in Mercedes Benz manufactured by Blau Punc (blue dot). Equation (2.9)\nmay be modified by replacing the spherical volume element with the Cartesian\nvolume element.\n\nA = G\n??\ni=0\n\n?i\nri ? r?\n\n|ri ? r?|3 dxdydz (2.17)\n\n\n\n2.4 Gravity Models 59\n\nOn a computer, the body is divided into a large number of cubes or parallelepipeds\nthat define each volume element of size dx by dy by dz. The volume elements do not\nhave to be of the same size, but they must sum to the correct volume. No overlapping\nis allowed. An easy way to do this summing on a computer is to circumscribe the\nbody with a parallelepiped and then use a triple do loop to access all the volume\nelements of the parallelepiped. Volume elements outside the body are discarded or\nassigned a density of zero. This is the same technique used by Michelangelo. He\nsimply procured a large block of marble and chipped away the part that was not\nDavid\u2019s. Each volume element is assigned a density. One way of determining ? is to\ncompute the density as a function of latitude and longitude from the above harmonic\nexpansion. The density would thus be constant along any radius vector. This is the\ndensity distribution that will be exploited by a later gravity model.\n\nThe point mass model is singular when r? ? ri is equal to zero. This singularity\ncan only occur when the point where the gravitational acceleration is being\ncomputed (r?) is below the surface of the body. Of course, the actual acceleration\ncannot reach infinity, because there is no such thing as infinite density. When r? is\ninside a mass element, the mass element can be replaced with a sphere of equal\nvolume and density. The geometry is illustrated in Fig. 2.2. The radius of the sphere\nis given by,\n\nRo =\n[\n\n3 dx dy dz\n\n4?\n\n] 1\n3\n\nThe acceleration inside a sphere is zero at the center of gravity and the magnitude\nis linear from the center to the surface where the acceleration is Gm over R2o . The\nacceleration inside a little cave inside the mass element is simply,\n\nai = G4?\n3\n\n?i(ri ? r?)\n\n2.4.3 Pyramid Model\n\nThe acceleration of a point mass or spacecraft is determined by summing or inte-\ngrating the acceleration contribution of each mass element (dm) in a gravitationally\nattractive body. The mass of the spacecraft is assumed to be too small to affect\nthe gravity field of the attractive body. The geometry is illustrated in Fig. 2.1. The\nacceleration is\n\nA = G\n?\n\nV\n\nr ? r?\n|r ? r?|3 dm (2.18)\n\ndm = ? r2 cos ? dr d? d?\n\n\n\n60 2 Force Models\n\nFig. 2.2 Internal mass\nelement model\n\ndx\n\nRo\n\nr? \u2013 ri\n\nwhere V denotes the irregularly shaped body. The vector r is from the center of\nthe coordinate system to the mass element and the vector r? is to the spacecraft.\nThe density ? is defined by an expansion of Legendre polynomials and associated\nfunctions as defined by Eq. (2.10). The components of the vectors r and r? in\nCartesian coordinates are\n\nr = (r cos ? cos ?, r sin ? cos ?, r sin ?)\nr? = (x?, y?, z?)\n\nSubstituting the vector components into Eq. (2.18) gives\n\nA = G\n?\n\nV\n\n(r cos ? cos ? ? x?, r sin ? cos ? ? y?, r sin ? ? z?)[\n(r cos ? cos ? ? x?)2 + (r sin ? cos ? ? y?)2 + (r sin ? ? z?)2] 32 dm\n\n(2.19)\nBefore integrating with respect to r , a rotation of coordinates may be defined\n\nthat will simplify the integrand. The y2 axis is placed through the location of the\nspacecraft (r?) and the x2 axis is placed in the plane defined by the mass element\n(dm) and r?.\n\n?\n?x2y2\n\nz2\n\n?\n? = T\n\n?\n?xy\n\nz\n\n?\n?\n\n\n\n2.4 Gravity Models 61\n\nT =\n\n?\n???????????\n\nr? \u00d7 (r \u00d7 r?)\n|r? \u00d7 (r \u00d7 r?)|\n\nr?\n\n|r?|\nr \u00d7 r?\n|r \u00d7 r?|\n\n?\n???????????\n\nThe coordinates of the spacecraft r?2 and a mass element r2 in the rotated coordinate\nsystem are\n\nr?2 = (0, r ?, 0)\nr2 = (r cos ?, r sin ?, 0)\n\n? = 90 ? cos?1\n(\n\nr \u00b7 r?\nrr ?\n\n)\n\nand\n\nA = G\n?\n\nV\n\nT T\n[r cos ?, r sin ? ? r ?, 0]T[\n\n(r2 cos2 ? + (r sin ? ? r ?)2] 32 dm\nReplacing the mass element (dm) with ? r2 cos ?drd?d? gives\n\nA = G\n?\n\nS\n\n? T T\n? R\n\n0\n\n[cos ?, sin ? ? r\n?\n\nr\n, 0]T\n\n(\n(cos2 ? + (sin ? ? r\n\n?\n\nr\n)2\n) 3\n\n2\n\ndr cos ? d? d?\n\nwhere R is the radius of the body as a function of ? and ?. The density (?) and\ncoordinate transformation (T ) factor out of the r integration since they are only a\nfunction of latitude and longitude. Performing the r integration gives\n\nA = G\n?\n\nS\n\n? T T\n\n?\n?a2x(R) ? a2x(0)a2y(R) ? a2y(0)\n\n0\n\n?\n? cos ? d? d? (2.20)\n\na2x(r) = r\n2 cos2 ? + r ? sin2 ?(r sin ? ? r ?) + cos2 ?(2r ?2 ? 5rr ? sin ?)\n\ncos ?\n?\n\nr2 + r ?2 ? 2rr ? sin ?\n\n\n\n62 2 Force Models\n\n+ 3 cos ? sin ?r ? ln\n[\n\n2r ? 2r ? sin ? + 2\n?\n\nr2 + r ?2 ? 2rr ? sin ?\n]\n\na2y(r) = rr\n? cos2 ? + r2 sin ? ? 5rr ? sin ?2 + 3r ?2 sin ??\n\nr2 + r ?2 ? 2rr ? sin ?\n? r ?(1 ? 3 sin2 ?) ln\n\n[\n2r ? 2r ? sin ? + 2\n\n?\nr2 + r ?2 ? 2rr ? sin ?\n\n]\n\na2z = 0\n\nThe gravitational acceleration computed assuming constant density will generally\nnot yield sufficient accuracy for navigation of a spacecraft. Therefore, the density is\nvaried as a function of latitude and longitude. The density is assumed to be uniform\nfrom the surface to the center of mass of the body. This assumption enables the\ndensity to be factored out of the r integration, simplifying the mathematics. The\nresultant mass distribution does not model reality inside the body but provides an\nexact model of the external gravity field. The integral given in Eq. (2.20) may be\nevaluated by tiling the unit sphere with area patches that are nearly square and sum\nto exactly 4? over the unit sphere. The total acceleration is obtained by evaluating\nthe integrand of Eq. (2.20) at the center of each area patch, multiplying by the area\nand summing over all the area patches. Observe that the shape of the body (R) enters\nexplicitly through the limit of integration with respect to r . The shape of the object\nmay be obtained from a shape model or input directly from a table of radii as a\nfunction of latitude and longitude. The surface integral is not over the surface of the\nbody, but rather over the unit sphere. The integration is performed by an algorithm\ndeveloped for integration over the actual surface of a body and this algorithm is\ndescribed below under Shape Model Gravity.\n\n2.4.4 Polyhedral Model\n\nThe concept behind a polyhedral model is to pack polyhedrons inside a body and\nsum the gravitational acceleration from each polyhedra. An easy way to do this is\nto fill the body with cubes or parallelepipeds. This approach works fine for uniform\ndensity, provided that the cubes are small enough such that the error resulting from\nthe cubes overlapping the surface of the body is small. Another approach that may\nbe tried is to partition the equatorial plane into small squares and stack long thin\nparallelepipeds on the equatorial plane that reach the surface. A variable density may\nbe accommodated by assigning a different density to each column or parallelepiped.\nThis approach will not work because a sphere with a density gradient along the\ncolumn length will always have the center of gravity on the equatorial plane because\neach column has uniform density and the columns are parallel to each other.\n\n\n\n2.4 Gravity Models 63\n\nAnother approach which does work is to pack tetrahedrons into the body. If the\nsurface is defined by a triangular plate model, the base of the tetrahedron is on the\nsurface and the apex is at the center of the reference coordinate system which is\nusually the center of mass. For a parallelepiped shape of the body, the body can\nbe filled with 12 tetrahedrons by passing a diagonal through each of the six faces.\nThis polyhedra model was implemented by Werner and the numerical comparisons\nwith other models indicate that this model is exact for constant density. If the\ntriangles are made small enough and the apex of all the polyhedra are at the center,\nthis model would look like the pyramid model described above. Variable density\ncould probably be accommodated by assigning density as a function of latitude and\nlongitude as was done for the pyramid model. Since Werner\u2019s polyhedral model is\nexact for large tetrahedra, the final triangularly shaped model is exact. The pyramid\nmodel requires thousands of area patches to achieve the same accuracy but has other\nadvantages when applied to the problem of orbit determination. The problem of\nvariable density requires a large number of tetrahedrons and the pyramid model\nprobably requires less computation per tetrahedron.\n\n2.4.5 Mass Distribution of an Irregularly Shaped Body\n\nA cross section of the pyramid gravity model is shown in Fig. 2.3. The cross section\nof Eros is used as an example viewed looking down on the North pole with longitude\nmeasured counterclockwise, or East, from the x axis. The cross hatched segments\nhave uniform density from the surface defined by latitude and longitude to the\ncenter of mass. Each cross hatched segment may have a different density. In three\ndimensions, the cross hatched segments are actually pyramids with the apex at\nthe center of figure and the base defined by rectangular patches whose sides are\ndelimited by latitude and longitude. In the limit, as the size of the area patches\napproaches zero, the gravity potential on the surface is exact. If the surface gravity\npotential is exact, the resulting external gravity field in vacuum is exact. The internal\nmass distribution is of little interest for navigation since there is an infinity of mass\ndistributions that will yield the same external field. The mass distribution of the\npyramid model is selected because it is mathematically convenient.\n\nSince any object may be replaced by an infinite cluster of point masses, verifying\nthe pyramid model for a single point mass verifies the model for the object. The\nacceleration of a spacecraft that is outside the body is simply the sum of the\naccelerations from all the point masses. The geometry is illustrated in Fig. 2.4. The\nmass distribution is computed for two bodies. One has the shape of the asteroid Eros\nand the other is a sphere. Imagine that the two bodies are composed of a massless\nsurface shell filled with cotton candy and a small lump of uranium hidden inside.\nThe object is to compute a density distribution for the interior of the body that\nwill have the same external gravity field as the lump of uranium. Another sphere\nis defined that circumscribes the bodies and the acceleration of the point mass is\ncomputed at sample points that cover the larger sphere. A typical sample point is\n\n\n\n64 2 Force Models\n\ny\n\nx\n\nFig. 2.3 Irregular body cross section\n\nshown in the figure. The pyramid model acceleration is also computed for each\nsample point. As a first guess, the bodies are assumed to have uniform density\nand the mass is the same as the point mass. The magnitude of the acceleration\nis computed for the point mass and the body of interest. Using a square root\ninformation filter (SRIF), a least square solution is obtained for the density harmonic\ncoefficients which give the magnitude of the acceleration of a spacecraft at the\nsample point. If the acceleration magnitudes of the point mass and gravity model\nare equal on the sampled sphere, the gradient of the potential is equal and a solution\nis obtained for the density harmonic coefficients.\n\nThe observable used for obtaining a solution for the density harmonic coefficients\nis defined by\n\na2 = a2x + a2y + a2z\nand the required partial derivatives are\n\n?a\n\n?(Anm,Bnm)\n= ?a\n\n?(ax, ay, az)\n\n?(ax, ay, az)\n\n??\n\n??\n\n?(Anm,Bnm)\n(2.21)\n\nwhere\n\n?a\n\n??\n= ax\n\na\n\n?ax\n\n??\n+ ay\n\na\n\n?ay\n\n??\n+ az\n\na\n\n?az\n\n??\n\n?(ax, ay, az)\n\n??\n= G\n\n?\nS\n\nT T\n\n?\n? a2x(R) ? a2x(0)a2y(R) ? a2y(0)\n\n0\n\n?\n? cos ?d?d?\n\n\n\n2.4 Gravity Models 65\n\ntypical\nsample point\n\nmodel\nacceleration\n\ntypical\npyramids\n\nactual\nacceleration\n\npoint\nmass\n\nspherical\nshape\n\n100\n\nEros\nshape\n\nx\n\ny\n\nFig. 2.4 Surface density of point mass\n\n??\n\n?Anm\n= P mn (sin ?) cos m?\n\n??\n\n?Bnm\n= P mn (sin ?) sin m?\n\nThe above partial derivatives and the difference between the observed acceleration\nand computed acceleration are packed into a square root information matrix which\nis inverted after all the sample points have been processed to obtain the solution for\nthe density harmonic coefficients.\n\nA simple test to verify the pyramid theory involves computing the pyramid\ndistribution for a point mass offset from the center of the coordinate system. The\npoint mass is located at 10? longitude, 10? latitude, and 6 km from the center of the\nsphere. The radius of the sphere is 8.43259 km which is sized to equal the volume of\nEros. The geometry is illustrated in Fig. 2.4. Accelerations of a spacecraft from the\npoint mass and the pyramid model are computed at various sample points that cover\na sphere of radius 18 km. A plot of the surface density is shown in Fig. 2.5 for the\n\n\n\n66 2 Force Models\n\nFig. 2.5 Surface density on sphere from point mass\n\nsphere. Since the gravity field is spherically symmetrical about the point mass, one\nwould expect the contours of constant density on the sphere to be circles centered\nat the point on the surface of the sphere closest to the point mass. Figure 2.5 shows\nthe maximum density at 10? latitude and 10? longitude and the contours of constant\ndensity are circles with a minimum density 180? from the maximum density. The\nspacecraft acceleration from the pyramid model and point mass are equal to very\nhigh precision.\n\n2.4.6 Pyramid Gravity Model Comparison with Eros Harmonic\nModel\n\nA comparison of the pyramid model with the gravity of Eros may be obtained by\nprocessing real data from an orbiting spacecraft in an orbit determination program.\nA high-quality set of data is available for the NEAR spacecraft orbiting the asteroid\nEros. For 1 month, the spacecraft was in a 25-km polar orbit and nearly continuous\nDoppler data was obtained. Processing this data with the pyramid gravity model\nwould require some modification of existing orbit determination software. However,\nwe have a harmonic expansion of the gravity field obtained during Eros flight\noperations. This harmonic expansion closely replicated an independent gravity\nmodel obtained by integrating a laser altimetry derived shape model over the\nsurface assuming constant density. This verification of the pyramid gravity model\nfor constant density provided confidence in its use for Eros landing.\n\nAs a substitute for real data, the Eros harmonic expansion was used to compute\nacceleration at sample points on the 18-km sphere defined above. These acceleration\ndata points were processed in a square root information filter to obtain surface\ndensity harmonic coefficients. Figure 2.6 shows the result of this simulation and\nprovides insight into the possible nonuniformity of the Eros mass distribution.\n\n\n\n2.4 Gravity Models 67\n\nFig. 2.6 Surface density of Eros from harmonic expansion\n\nInspection of Fig. 2.6 indicates that a large object may be buried at 260? longitude\nand 0? latitude. This conclusion is a bit premature since further analysis indicated\nthat the Eros shape model is shifted about 100 m along the y axis. This apparent\ndiscrepancy was also observed when comparing the LIDAR shape model with the\noptical shape model derived independently by Peter Thomas. It should also be noted\nthat this discrepancy is small compared to the mean density of Eros and did not\naffect the Eros landing trajectory.\n\n2.4.7 Comparison of Gravity Model Mass Distributions\n\nA mass distribution is defined for a parallelepiped or brick that encloses the asteroid\nEros. The density is scaled such that the mass of the brick is equal to the mass\nof Eros. As a result, the mean density of the brick is less than the mean density\nof Eros. The brick is 32 km long, 18.48 km wide, and 11.28 km high. The density\nvaries from 10% below the mean density at the bottom or south pole to 10% above\nthe mean density at the top or north pole. The brick and Eros are thus layered with\nlayers of constant density parallel to the equatorial plane.\n\nA gravity field is computed for the brick, the cross section shown on the left\nside of Fig. 2.7, using the point mass model which is assumed to be exact. The\ngravitational acceleration is computed from the point mass model as a function of\nlatitude and longitude distributed over a sphere of radius 18 km. At each latitude\nand longitude, the acceleration is also computed on the surface. These accelerations\nare treated as measurements and packed into a SRIF modified to provide a simple\nleast square solution. The SRIF matrix is inverted to determine the coefficients\nof Legendre polynomials and associated functions that define the density of the\npyramid gravity model as a function of latitude and longitude. A cross section of\nthe pyramid model through the center of the coordinate system is shown on the\nright side of Fig. 2.7. Because of symmetry, all cross sections through the center\nwill look the same.\n\n\n\n68 2 Force Models\n\nLayered Parallelepiped Cross Section Pyramid Model Cross Section\n\nFig. 2.7 Parallelepiped and pyramid gravity model mass distributions\n\nThe equal sign between the layered parallelepiped on the left and the radially\ndistributed density on the right indicates that the external gravity field of these\ntwo parallelepipeds are the same. This counterintuitive result suggests that attempts\nto determine internal structure of planets or asteroids or the Moon by gravity\nmeasurements are highly suspicious. The first degree coefficients of a harmonic\nexpansion provide the location of the center of mass, which gives some insight\ninto mass distribution. The second degree coefficients give the ratios of inertia\ntensor elements and provides additional insight into mass distribution. However,\na key piece of information, namely the trace of the inertia tensor, is missing from\ngravity measurements. The trace can be determined by observation of non-principal\naxis rotation as was attempted on the NEAR mission. Unfortunately, Eros and\nmost other bodies are nearly in principal axis rotation. Direct comparison of the\ngravity coefficients determined by orbit determination tracking measurements and\ncomputed from a shape model from laser altimetry measurements revealed that the\nharmonic coefficients through degree six were very nearly the same. This result\nindicated that Eros was very nearly constant density and provided a valuable set of\ncoefficients that were used as a priori for subsequent orbit solutions.\n\nIn the above discussion, the gravity fields of two bodies were computed using\ndifferent gravity models. The pyramid model uses a universal mass distribution\nthat will produce the same gravity field as for any actual mass distribution. This\nproperty of the pyramid model enables the production of two bodies with radically\ndifferent internal mass distributions that have the same gravity field outside the\nbodies. With a 3D printer, one can actually go down into his or her basement and\nmanufacture these bodies. However, it is easier to do this on a computer. We select\nthe parallelepiped shape for a numerical demonstration. Eros shape models may\nnot be readily available for those who may want to repeat this demonstration. The\nshape has a Cartesian coordinate system centered at the geometric center with the\nx axis along the length from ?16 km to +16 km, the y axis along the width from\n?9.24 km to +9.24 km, and the z axis along the height from ?5.64 km to +5.64 km.\n\n\n\n2.4 Gravity Models 69\n\nThe total acceleration is obtained by summing the acceleration associated with each\nmass element given by,\n\nAi = G?avg vi\n(\n\n1 + riz\nrmaxz\n\n??\n\n)\nri ? r?\n\n|ri ? r?|3\n\nThe average density times G is G?avg = 6.5826 \u00d7 10?8, the volume of the\nmass element is vi , the z component of the mass element is riz, the maximum\nz component is rmaxz = 5.64 km, and the density variation is ?? = 0.1. The\nvolume of the parallelepiped is 6670.54 km3 and thus the GM of the body is\nGM = G?avg \u00d7 6670.54 = 4.3909 \u00d7 10?4 km3/s2 which is the GM of Eros. For\na parallelepiped divided into 200\u00d7100\u00d775 = 1,500,000 mass elements, the volume\nof each mass element is vi = 4.447 \u00d7 10?3 km3.\n\nFor the second mass distribution, the same point mass model is used to compute\nthe gravity and the density distribution is computed from the expansion of Legendre\npolynomials and associated functions determined by the pyramid model. The\nacceleration is thus given by,\n\nAi = G?i vi ri ? r\n?\n\n|ri ? r?|3\n\nG?i =\n??\n\nn=0\n\nn?\nm=0\n\nP mn (sin ?)[Anm cos m? + Bnm sin m?]\n\n? = arctan riz?\nri2x + ri2y\n\n? = arctan riy\nrix\n\nThe harmonic coefficients, Anm and Bnm, are given in Table 2.2 through degree\nand order eight. Observe that the A00 term is G times the average density. When\nmultiplied by the volume of the parallelepiped, the GM of the parallelepiped is\nobtained, 4.3909\u00d710?4 km3/s2, which is the same as for Eros. The assumed density\nof the parallelepiped was scaled to give this result. For any position vector (r ?), the\ncomputed accelerations from the two mass distributions are equal.\n\n2.4.8 Comparison of Density Distributions for Eros-Shaped\nGravity Models\n\nThe density of the asteroid Eros is assumed to be uniform as a comparison of\nshape-derived gravity harmonic coefficients with tracking data gravity harmonic\ncoefficients indicates. They are essentially the same. If a layered mass distribution\n\n\n\n70 2 Force Models\n\nTable 2.2 Parallelepiped density harmonic coefficients\n\nis imposed on Eros where the density uniformly varies from 10% below the mean at\nthe south pole to 10% above the mean at the north pole, the resultant surface density\nis shown in Fig. 2.8. The contour plot makes it difficult to discern the geometry. A\ncross section parallel to the x-z plane or y-z plane would show horizontal lines and\na cross section parallel to the x-y plane would show constant density. The density\nharmonic coefficients for the pyramid model are computed as described above for\nthe parallelepiped.\n\nFigure 2.9 shows the density distribution of the modified Eros for the pyramid\ngravity model. Recall that for the pyramid model, the density is uniform from\nthe surface to the center of Eros. The apparent mass concentrations do not exist.\nThey are artifacts of the gravity modeling. Figure 2.8 is the assumed actual mass\ndistribution. For extreme mass distributions, the modeled density may be negative.\nThis is not a problem. If we constructed an Eros with a mass distribution indicated\nby the pyramid model, the external gravity field would be the same as for the real\nEros. If the density is negative, we simply fill those places with some anti matter.\nThe pyramid model makes no assumption about the actual mass distribution.\n\n\n\n2.4 Gravity Models 71\n\nFig. 2.8 Assumed Eros surface density\n\nFig. 2.9 Eros surface density-pyramid gravity model\n\n2.4.9 Comparison of Gravity Model Accelerations\n\nThe output from the various gravity models of real interest is the acceleration of\na point mass above the surface of the body. Contours of constant acceleration\nor potential are often plotted as a function of latitude and longitude. Since the\ndifference in the models are small, the contours of constant acceleration would\n\n\n\n72 2 Force Models\n\n6 \u00a5 10\u20136\n\n5 \u00a5 10\u20136\n\n4 \u00a5 10\u20136\n\n3 \u00a5 10\u20136\n\n2 \u00a5 10\u20136\n\n1 \u00a5 10\u20136\n\n0\n\n\u20131 \u00a5 10\u20136\n0 5 10 15\n\nRadial Distance \u2013 km\n\nsurface\n(landing site)\n\nmaximum radius\n\nharmonic\nexpansion\nerror\n\nA\ncc\n\nel\ner\n\nat\nio\n\nn \n\u2013 \n\nkm\n/s\n\n2\n\n20 25 30\n\ntotal\nacceleration\n\nFig. 2.10 Eros acceleration magnitude as function of radial distance\n\nbe nearly the same and thus not meaningful. The acceleration of most interest is\nat the NEAR landing site since a spacecraft was actually there and a great deal\nof high-quality data was obtained. In Fig. 2.10, the magnitude of the acceleration\nis displayed as a function of radial distance from the center of Eros. The model\nof Eros includes the 20% variation in density from the south pole to the north\npole. The radial line segment passes through the NEAR landing site and extends\nto 30 km. The total acceleration is computed from the pyramid gravity model,\nwhich was selected as an arbitrary reference. The landing site radius and sphere\nof maximum radius are also shown in the figure. An interesting result is that the\npeak acceleration occurs about a kilometer above the landing site. At the landing\nsite, the gravitational acceleration from the ends of Eros tend to cancel each other.\nInside Eros, the acceleration magnitude is nearly linear. It is linear for a sphere.\nInside Eros, the acceleration is really the acceleration of an object in a small cave\nor mine and is not related to the pressure of the compressed body. The differences\nbetween other model accelerations and the pyramid model are shown in Fig. 2.10\nand the differences are small and can be easily explained.\n\nFigure 2.11 shows the bottom part of Fig. 2.10 with the scale expanded by\na factor of ten. Plotted is the difference between the pyramid model and other\nmodels as labeled. The curve labeled harmonic expansion represents the error in\nthe harmonic expansion model obtained on the NEAR mission. The error increases\ndramatically as the spacecraft moves inside the sphere of maximum radius. During\nthe NEAR mission, the spacecraft entered this region only once on landing. For orbit\ndetermination, the harmonic expansion error is significant out to 30 km, which is not\nobvious from the figure. Orbit determination is sensitive to acceleration errors down\nto 10?12 km/s2. The curve labeled constant density was obtained from Werner\u2019s\npolyhedral model. This difference may be completely attributed to the assumption\n\n\n\n2.4 Gravity Models 73\n\n6 x 10\u20137\n\n4 x 10\u20137\n\n2 x 10\u20137\n\n0\n\n\u20132 x 10\u20137\n\n\u20134 x 10\u20137\n\n\u20136 x 10\u20137\n0 5 10 15\n\nRadial Distance \u2013 km\n\npoint mass\n\nconstant\ndensity\n\nmaximum radius\n\nA\ncc\n\nel\ner\n\nat\nio\n\nn \n\u2013 \n\nkm\n/s\n\n2\n\n20 25 30\n\nharmonic\nexpansion\nerror\n\nsurface\n(landing site)\n\nFig. 2.11 Eros acceleration magnitude model errors\n\nof constant density and vanishes if the density of Eros is assumed to be uniform.\nThe point mass curve matches the pyramid model down to a kilometer above the\nsurface. Here, the resolution of the pyramid model or the number of mass elements\nin the point mass model introduces error. If the resolution of the pyramid model and\npoint mass model is increased, this difference vanishes. Inside Eros, the problem is\nmagnified. A random error associated with the mass element that contains the point\nwhere the acceleration is being determined is introduced, depending on how far the\nevaluation point is from the center of the mass element. If we are unlucky and we hit\nthe exact center, the error can go to infinity. This error source may be ameliorated\nby assuming a spherical mass distribution for this mass element.\n\n2.4.10 Comparison of Gravity Model Accuracy\nand Computational Speed\n\nThe harmonic expansion model used for NEAR navigation operations about the\nasteroid Eros was sufficiently accurate for orbital operations down to 25 km radial\ndistance from Eros. The time to make an orbit determination run, map the solution to\n10 days in the future, and compute maneuvers could be about 20 min if time critical.\nSince the round trip light time was about 40 min and several days were allocated\nfor navigation operations, computer run time was not a major consideration. For\ntime critical missions, ground-based navigation operations cannot be performed\nfaster than the round trip light time so 20 min for an orbit determination run\nis a good target for program design. During NEAR operations, a 12? and order\nharmonic expansion was used. This involved solving for 169 harmonic coefficients\nevery 10 days and provided about 20? resolution. The pyramid model and Werner\u2019s\n\n\n\n74 2 Force Models\n\npolyhedral model were used for computing the landing trajectory. The shape model\nhad 7700 triangular plates which provided about 5? resolution. This was more\nthan adequate for propagating trajectories but would not have sufficed for orbit\ndetermination if the spacecraft were tracked inside the sphere of maximum radius.\nThere was no orbit determination below 25 km radius. Future missions could require\norbit determination at altitudes around 5 km which would require about 1? resolution\nfor the gravity model.\n\nThe harmonic expansion model clearly would not be satisfactory for close\norbital operations around a small body. One degree resolution would require a 200?\nand order harmonic expansion involving about 40,000 coefficients. A 40,000 by\n40,000 matrix would have to be inverted. The computer run time would also be\nprohibitive. The point mass model would require about eight million mass elements\nand eight million acceleration computations for each total acceleration to achieve 1?\nresolution. The computer run time would be prohibitive. However, the point mass\nmodel is useful as a research tool because it is simple to implement and is exact both\ninside and outside the body. Polyhedral models are exact for any polyhedron shape\nthat assumes constant density such as the triangular plate model used for NEAR\noperations. However, for variable density and 1? resolution, about 40,000 polyhedra\nwould be required. A seamless transition in resolution would require changing the\nnumber of polyhedra and would be difficult to implement in computer code.\n\nThe pyramid model appears to be the best option for satisfying all accuracy\nand speed requirements. The resolution of the surface integration increases as the\nsquare of the number of function evaluations while the resolution of the point mass\nmodel increases as the cube. The number of computations required for one area\npatch is probably considerably less than required for one polyhedra. The polyhedra\nmodel computes an exact acceleration for every polyhedron. The base and edges\nrequire considerable computation and thus limits the polyhedral model to about\n10,000 polyhedra. The pyramid model uses an approximation for each area patch\nand is exact only in the limit as the number of area patches approaches infinity. The\npyramid model can be thought of as a porcupine quill model. A quill pierces the\ncenter of each area patch and has a cross section area proportional to the square\nof the radius. The mass per unit length of the quill increases as the square of the\ndistance from the center. The mean value theorem gives a good approximation of\nthe integrand over the integration interval but is exact only in the limit. Recall that\n? is also not exact on a computer and is only known to several hundred decimal\nplaces. Several hundred is a long way from infinity. Therefore, any mathematical\nequation becomes an approximation on a computer.\n\nAnother consideration related to computational speed is the ability to vary the\nresolution or accuracy of the gravity model as a function of the accuracy needed.\nFor example, numerical integrators used for trajectory propagation vary the step\nsize depending on the acceleration. Near a gravitating body where the trajectory\ncurvature is great, the integration step size is reduced to minutes or hours. Far\nfrom a gravitating body, where the spacecraft moves in nearly a straight line, the\nstep size may be several days. The pyramid model permits a simple adjustment of\naccuracy and computational speed by changing the size of the surface integration\narea patches. A similar adjustment of speed and accuracy for the polyhedral model\n\n\n\n2.4 Gravity Models 75\n\ncould be achieved by increasing the number of triangles that comprise the shape\nmodel. A simple way to do this is to add additional vertices at the centroid of each\ntriangle and thus replace each triangle with three smaller triangles.\n\nA further consideration related to complexity and therefore computational speed\nis the need to compute variational partial derivatives for orbit determination. The\npartial derivatives of acceleration with respect to density harmonic coefficients and\nspacecraft position are needed. Consider that the exact solution for the potential of\na parallelepiped requires about one page of Fortran code and there probably is not a\nmore efficient language than Fortran for this application. The acceleration requires\nan additional differentiation of this potential function with respect to each coordinate\naxis and results in several pages of Fortran code. The variational partial derivatives\nwould require many more pages of Fortran code. The variational partial derivatives\nfor the harmonic expansion model have been derived and are available in computer\ncode, either Fortran or C. This code could be modified to provide variational partial\nderivatives for the pyramid model. This job is much easier because the pyramid\nmodel does not require a potential function to be determined.\n\n2.4.11 Gravitational Variational Equations\n\nFor orbit determination, the partial derivatives of acceleration with respect to the\ndynamic parameters are required. Recall that the translational variational equations\nare obtained by integrating\n\n?A\n?q\n\n= ?A\n?r\n\n?r\n?q\n\n+ ?A\n?v\n\n?v\n?q\n\n+ ?A\n?q\n\n|r,v constant\n\nConsider the following subset of constant dynamic parameters that pertain to\nspecific columns of the above matrix.\n\nq = (r0, v0, Cn,m, Sn,m)\n\nThe gravitational variational equations are\n\n?A\n?r\n\n= ?A\n?Ab\n\n?Ab(x, y, z)\n?Ab(r, ?, ?)\n\n?Ab(r, ?, ?)\n?rb(r, ?, ?)\n\n?rb(r, ?, ?)\n?rb(x, y, z)\n\n?rb\n?r\n\n?A\n?v\n\n= 0\n?A\n\n?(Cnm, Snm)\n= ?A\n\n?Ab\n\n?Ab(x, y, z)\n?Ab(r, ?, ?)\n\n?Ab(r, ?, ?)\n?(Cnm, Snm)\n\nThe ?rb\n?r is simply the orthogonal transformation matrix from inertial EME\n\nJ2000 coordinates to body fixed coordinates from the Rotational Equations of\n\n\n\n76 2 Force Models\n\nMotion described in Chap. 1. The ?A\n?Ab\n\nis simply the inverse of this transformation\nand transforms acceleration from body fixed to inertial coordinates. Similarly, the\nmatrices ?rb(r,?,?)\n\n?rb(x,y,z)\nand ?Ab(x,y,z)\n\n?Ab(r,?,?)\ntransform from Cartesian to spherical coordinates\n\nand back from spherical coordinates to Cartesian coordinates.\nThe ?Ab(r,?,?)\n\n?rb(r,?,?)\nis dependent on the particular gravity model whose partial\n\nderivatives are being computed. For the harmonic expansion model, we have\n\n?Ab(r, ?, ?)\n?rb(r, ?, ?)\n\n= ??U\n?rb(r, ?, ?)\n\n=\n\n?\n??????\n\n??U\n?r\n\n1\nr cos(?)\n\n?U\n??\n\n1\nr\n\n?U\n??\n\n?\n??????\n\n2.5 Shape Model\n\nThe shape of an asteroid or comet nucleus may be determined by optical observation\nof landmarks and laser altimetry measurements. Optical observations must be\nstereoscopic which is achieved by imaging landmarks from different points in the\nspacecraft orbit around the body. Laser altimetry determines the distance from the\nspacecraft to the surface by measuring the round trip light time. From the attitude\ncontrol system pointing angles, a vector may be determined that goes from the\nspacecraft to a point on the surface of the body. The vector from the center of the\nbody to a point on the surface may be determined by simply adding the spacecraft\nposition vector to the laser altimetry vector.\n\n2.5.1 Triangular Plate Model\n\nThe vectors from the center of mass of the body to the surface are called vertices.\nA shape model may be determined by fitting a surface to these vertices. A simple\nway to do this is to connect a mosaic of polygons to the vertices. This process is\ncalled tessellation. A convenient way to do this is with rectangles. The problem with\nrectangles, or any polygon with more than three sides, is that the vertices are not in\nthe same plane and the volume, moments of inertia, and gravity model parameters\ncomputed from the shape model are not exact. For this reason, a triangular plate\nmodel is used for navigation. Figure 2.12 shows a triangular plate model in the\nshape of the asteroid Eros.\n\nThis triangular plate model has 3872 vertices and 7740 plates. The vertices are\nnumbered and written to a file. The plates are also written to the same file and are\ndefined by three integer vertex numbers. An interesting relationship, determined\nby Euler and probably many mathematicians from antiquity, relates the number of\n\n\n\n2.5 Shape Model 77\n\nFig. 2.12 Eros shape model\n\nplates (p) and edges (e) to the number of vertices (v).\n\np = 2v ? 4 (v > 3)\ne = 3v ? 6 (v > 3)\n\nA triangular shape model can be designed to accurately represent any shape\nprovided that the triangles are small enough. Consider a cube or a parallelepiped.\nA triangular shape model can be obtained by passing a diagonal through each face.\nSince there are six faces, the triangular shape model has 12 plates. The number of\nvertices is eight which is the same as for the cube. The number of edges is 18, 12\nfor the cube plus six for the diagonals that were added. Thus, the formulas work for\na cube or parallelepiped. The resolution of the triangular plate model is inversely\nproportional to the number of plates. One degree resolution would require 41,253\nplates. Therefore, the resolution of the shape model shown in Fig. 2.12 is about\n41,253/p or 5.33?.\n\n2.5.2 Harmonic Expansion Shape Model\n\nThe triangular plate model is useful for creating images and precision analysis of\ninertial properties but is not amenable to use for orbit determination. There are too\nmany parameters for an orbit determination filter to assimilate. A more convenient\nsurface can be defined by an expansion of Legendre polynomials and associated\nfunctions.\n\n\n\n78 2 Force Models\n\nR =\n??\n\nn=0\n\nn?\nm=0\n\nP mn (sin ?)[Anm cos m? + Bnm sin m?] (2.22)\n\nR is the radius of a point on the surface at longitude ? and latitude ?. The harmonic\ncoefficients are obtained by integrating over the unit sphere.\n\nAnm =\n??\n\nS\n\nP mn (sin ?) cos (m?) R d? d?\n\nBnm =\n??\n\nS\n\nP mn (sin ?) sin (m?) R d? d?\n\nThe integration is performed on a computer using an algorithm developed for\ndetermining the out-gassing acceleration of a spacecraft near a comet. The surface\nintegral is not over the surface of a body, but rather over the unit sphere. This\nalgorithm is also used to determine gravity harmonic coefficients of an irregularly\nshaped body and other applications that require surface integration. The idea behind\nthis surface integration algorithm is to first cover the surface of the unit sphere with\narea patches whose sides are great circle lines of constant longitude or small circle\nlines of constant latitude. An exact tiling of the unit sphere is given by a soccer ball\nwhich is a dodecahedron projected onto a sphere. It is not possible to tile a unit\nsphere with small spherical rectangles or other polygons with more sides than the\ndodecahedron. We only need the area patches to have nearly the same area and sum\nto exactly 4? . In the limit as the area patches approach zero, it is not necessary for\nthe area patches to have the exact size and shape. The procedure used here is to\ndivide the northern and southern hemispheres into bands defined by small circles\nof constant latitude which define latitude bands. The width of the latitude bands\ndetermines the resolution. The latitude bands are divided into equal area patches as\nclose to being square as possible. When we get to the poles, the small circle around\nthe pole is divided into four equally shaped spherical triangles. For 1? resolution,\nthere will be 41,253 area patches and they will sum to exactly 4? . In the limit as the\nresolution goes to zero and the number of patches goes to infinity, we get an exact\nsurface integral. The reader may be troubled by summing a bunch of area patches of\ndifferent sizes and shapes and getting a result that is exact. The fundamental theorem\nof calculus does not require that the width of all integration intervals be the same.\nThe only requirement is that the width of all the intervals approaches zero as the\nnumber of intervals approaches infinity.\n\nA spherical harmonic shape model for the asteroid Eros was obtained by\nintegrating over the surface of the triangular plate model shown in Fig. 2.12.\nThe degree and order of the expansion was 34. The resultant surface is shown\nin Fig. 2.13. The low degree and order coefficients were determined with high\nprecision. Since orbit determination is most sensitive to coefficients below degree\nand order six, this model provided valuable a prior gravity harmonic coefficients\nduring the NEAR mission. The higher degree and order coefficients tend to average\nout and do not contribute much to orbit determination accuracy.\n\n\n\n2.5 Shape Model 79\n\nFig. 2.13 Eros shape model (34\u00d734 harmonic expansion)\n\n2.5.3 Gravity Harmonic Expansion from Shape Model\n\nThe gravity field and inertial properties that are needed for analysis may be\ndetermined from the shape model of an irregularly shaped body. The volume,\nmoments of inertia, and gravity harmonic coefficients are obtained by integrating\nover the volume of the body assuming constant density. It will be convenient to first\ndetermine the volume and center of mass of the body and then shift coordinates to\nthe center of mass before determining the inertia tensor and gravity harmonics by\nanother integration. Since the center of mass and inertia tensor place constraints on\nthe gravity harmonic coefficients, these relationships may be used as a check on the\nnumerical integration.\n\nThe mass is first determined by integration over the volume of the body and is\ngiven by\n\nM =\n???\n\nV\n\n?(r, ?, ?) dV (2.23)\n\nwhere ? is the density and the surface R is defined by the function\n\nR = f (?, ?)\n\nThe volume integral may be performed numerically on a computer by dividing the\nbody into a finite number of concentric shells and then by partitioning the outer\nsurface of each shell into a finite number of area patches. The volume within a given\nshell that is under a given area patch comprises an individual volume element. The\nvolume integral is obtained by simply summing the value of the function evaluated\nat the center of each volume element over all the volume elements.\n\n\n\n80 2 Force Models\n\nIn order to obtain a reasonable accuracy, the body must be partitioned into a\nvery large number of volume elements. For 1? resolution, each shell contains about\n40,000 volume elements. With the assumption of uniform density, the number of\nfunction evaluations can be greatly reduced by extracting a spherical core from the\ncenter of the body and performing the volume integral from the outer surface of\nthis core of radius rc to the surface of the body (R). Thus, we have for the mass of\nthe body\n\nM = 4\n3\n???r3c +\n\n??? R\nrc\n\n?(r, ?, ?) dV\n\ndV = r2 cos ? drd?d?\n\nThe amount of computation may also be reduced by performing the integration\nwith respect to r analytically and then integrating over the unit sphere. Thus, we\nalso have for the mass of the body\n\nM = ??\n??\n\nS\n\nR3\n\n3\nd\n (2.24)\n\nd\n = cos ? d? d?\n\nThe center of mass is defined by the following three integrals.\n\nx? = 1\nM\n\n???\nV\n\nx ?(r, ?, ?) dV\n\ny? = 1\nM\n\n???\nV\n\ny ?(r, ?, ?) dV\n\nz? = 1\nM\n\n???\nV\n\nz ?(r, ?, ?) dV (2.25)\n\nwhere\n\nx = r cos ? cos ?\ny = r sin ? cos ?\n\nz = r sin ?\n\nFor the case of constant density, we may perform the integration with respect to r\nanalytically as described above for the mass and we have\n\n\n\n2.5 Shape Model 81\n\nx? = ??\nM\n\n??\nS\n\ncos ? cos ?\nR4\n\n4\nd\n\n\ny? = ??\nM\n\n??\nS\n\nsin ? cos ?\nR4\n\n4\nd\n\n\nz? = ??\nM\n\n??\nS\n\nsin ?\nR4\n\n4\nd\n\n\nThe inertia tensor and gravity harmonic coefficients may be defined with respect\nto any origin. However, the dynamics of the translational and rotational motion of\nthe body are best described with the origin at the center of mass. The true center of\nmass is the assumed center of the planetocentric coordinate system as determined by\nobservation of spacecraft motion and the body translational and rotational dynamics.\nThus, the center of mass determined directly from the figure of the body assuming\nconstant density provides some insight as to the internal mass distribution. This\ninterpretation of the data may be facilitated by transforming to the center of mass\ndetermined from the figure. The primed coordinates are defined with respect to the\ncenter of figure and we have for the translation from planetocentric coordinates to\nfigure-centered coordinates\n\nx? = r cos ? cos ? ? x?\ny? = r sin ? cos ? ? y?\n\nz? = r sin ? ? z?\n\nr ? =\n?\n\nx?2 + y?2 + z?2\n\n?? = sin?1 z\n?\n\nr ?\n\n?? = tan?1 y\n?\n\nx?\n\nThe elements of the inertia tensor with respect to the center of figure are defined\nby the following integrals:\n\nIxx =\n???\n\nV\n\n(y?2 + z?2) ?(r ?, ??, ??) dV ?\n\nIyy =\n???\n\nV\n\n(z?2 + x?2) ?(r ?, ??, ??) dV ?\n\n\n\n82 2 Force Models\n\nIzz =\n???\n\nV\n\n(x?2 + y?2) ?(r ?, ??, ??) dV ?\n\nIxy = ?\n???\n\nV\n\nx?y? ?(r ?, ??, ??) dV ?\n\nIyz = ?\n???\n\nV\n\ny?z? ?(r ?, ??, ??) dV ?\n\nIxz = ?\n???\n\nV\n\nx?z? ?(r ?, ??, ??) dV ?\n\nPerforming the integration with respect to r analytically, we obtain\n\nIxx = ??\n??\n\nS\n\n(sin ??2cos ??2 + sin ??2) R\n?5\n\n5\nd\n?\n\nIyy = ??\n??\n\nS\n\n(cos ??2cos ??2 + sin ??2) R\n?5\n\n5\nd\n?\n\nIzz = ??\n??\n\nS\n\ncos ??2 R\n?5\n\n5\nd\n?\n\nIxy = ??\n??\n\nS\n\ncos ??2 sin ?? cos ?? R\n?5\n\n5\nd\n?\n\nIyz = ??\n??\n\nS\n\nsin ?? sin ?? cos ?? R\n?5\n\n5\nd\n?\n\nIxz = ??\n??\n\nS\n\ncos ?? sin ?? cos ?? R\n?5\n\n5\nd\n?\n\nThe unnormalized gravity harmonic coefficients are computed in a similar manner.\nThe coefficient generating functions are given by the following volume integrals:\n\nCn0 = 1\nM\n\n???\nV ?\n\n(\nr ?\n\nro\n\n)n\nPn(sin ?\n\n?) ?(r ?, ??, ??) dV ?\n\nCnm = 2\nM\n\n(n ? m)!\n(n + m)!\n\n???\nV ?\n\n(\nr ?\n\nro\n\n)n\nP mn (sin ?\n\n?) cos m?? ?(r ?, ??, ??) dV ?\n\nSnm = 2\nM\n\n(n ? m)!\n(n + m)!\n\n???\nV ?\n\n(\nr ?\n\nro\n\n)n\nP mn (sin ?\n\n?) sin m?? ?(r ?, ??, ??) dV ?\n\nThese volume integrals may also be converted to integrations over the unit sphere\nfor the case of constant density by performing the r integration analytically.\n\n\n\n2.6 Comet Atmosphere 83\n\nCn0 = ??\nM\n\n??\nS?\n\n1\n\nn + 3\n\n(\nR?n+3\n\nron\n\n)\nPn(sin ?\n\n?) d\n?\n\nCnm = 2??\nM\n\n(n ? m)!\n(n + m)!\n\n??\nS?\n\n1\n\nn + 3\n\n(\nR?n+3\n\nron\n\n)\nP mn (sin ?\n\n?) cos m?? d\n?\n\nSnm = 2??\nM\n\n(n ? m)!\n(n + m)!\n\n??\nS?\n\n1\n\nn + 3\n\n(\nR?n+3\n\nron\n\n)\nP mn (sin ?\n\n?) sin m?? d\n?\n\nThe second degree gravity harmonics and elements of the inertia tensor share the\nsame integrals and are thus not independent. The differences in the inertia tensor\nelements may be determined as a function of the second degree gravity harmonics.\nSince there are five differences and six parameters, a third equation is needed.\nThis third equation could be the trace of the inertia tensor which would enable\ndetermining the inertia tensor and gravity harmonics as functions of each other and\nthus save six parameters that need to be estimated. Twelve parameters that are well\nunderstood would be replaced by six parameters that are not so well understood. A\nbetter approach is to estimate all twelve parameters and place an a prior constraint\non the relationship between the parameters. This is accomplished by processing five\ndummy measurements with zero measurement error. The equations of constraint are\n\nIxx ? Iyy = ?4Ma2C22\nIyy ? Izz = Ma2(C20 + 2C22)\nIzz ? Ixx = ?Ma2(C20 ? 2C22)\n\nIxy = ?2Ma2S22\nIyz = ?Ma2S21\nIxz = ?Ma2C21\n\n2.6 Comet Atmosphere\n\nThe comet nucleus is a source of a stream of dust and gas molecules that accelerate\nthe spacecraft away from the nucleus. Although the actual size and mass of comets\nare generally unknown, most short-period comets considered for missions have\nestimated radii between 1 and 5 km. The solar radiation input to the surface of\na comet nucleus heats an outer mantle of dust and debris that is generally a\nfew centimeters thick. Heat is conducted through the mantle and results in the\nsublimation of ice and other volatile compounds that are covered by the mantle.\nGas produced by sublimation, which is comprised mainly of water vapor, percolates\nthrough the mantle and escapes to the vacuum of space. The expanding gas\n\n\n\n84 2 Force Models\n\nmolecules attain a velocity of several hundred meters per second immediately on\nleaving the surface and flow radially outward from the comet. A spacecraft orbiting\nthe comet nucleus will experience dynamic pressure with a resultant force that is\nnearly radial. Since the spacecraft velocity is much smaller than the gas molecule\nvelocity, the normal dynamic pressure attributable to the spacecraft motion may\nbe neglected. The aerodynamics of a spacecraft orbiting a comet nucleus are more\nanalogous to a sail boat than to an airplane.\n\nAs the comet approaches the sun and the mantle is heated to higher temperatures,\nthe percolation of gas through the mantle becomes so intense that large pieces\nof the mantle are sloughed off exposing the bare ice to direct solar radiation\nand the vacuum of space. The local activity becomes very intense and huge jets\nappear where the surface activity is perhaps an order of magnitude greater than the\nsurrounding surface covered by the mantle. The model of comet nucleus outgassing\nmust accommodate several discrete jets in addition to the normal background\noutgassing of the comet.\n\nA spacecraft orbiting a comet nucleus will experience a force from the pressure\nof expanding gas and dust that varies widely depending on the position of the\nspacecraft relative to the comet, the distance of the comet from the Sun, and the\nactivity of the local comet surface in response to solar energy input. For navigation,\na model must be developed that takes all of these factors into account but is simple\nenough to be incorporated into existing navigation software.\n\nA simplified two-part empirical model of accelerations on the spacecraft due to\ncomet nucleus outgassing and dust emissions is defined. The first part describes the\naccelerations acting on the spacecraft from the comet outgassing that results from\nthe solar radiation input. For this model, the spacecraft acceleration is assumed to be\ndirected radially from the comet nucleus and varies with the cosine of the sun angle\nand inversely with the square of the distance. The second part describes the behavior\nof a gas vent or jet and the spacecraft acceleration is described in the same manner\nas for the outgassing, except that the acceleration is directed away from a specific\nregion on the comet nucleus surface. Thus the outgassing model could be interpreted\nas the integration of many gas and dust jets over the entire surface of the comet.\n\n2.6.1 Outgassing Model\n\nThe outgassing model assumes that the spacecraft acceleration is directed radially\nfrom the comet nucleus and varies with the cosine of the sun angle and inversely\nwith the square of the distance. It is defined by three variables AD , AT , and\nAN , which represent acceleration magnitudes acting on a spacecraft, each at the\nreference radius rref = 10 km from the center of the comet. AD is the acceleration\nmagnitude directly over the subsolar point (the position on the comet directly under\nthe sun). AT , the acceleration magnitude over the terminator, which is the edge of\nthe sunlit side of the comet, was assumed to be 0.5 AD . AN is the acceleration over\nthe anti-subsolar point, the position on the night side of the comet directly opposite\n\n\n\n2.6 Comet Atmosphere 85\n\nFig. 2.14 Empirical\noutgassing model SUN\n\nS/C\n\nDAY\nSIDE\n\n?\nNIGHT SIDE\n\nCOMET\nNUCLEUS\n\nANrc\n\nr\n\nrref AD\n\nAT\n\nto the subsolar point. AN was assumed to be 0.1 AD . Intermediate accelerations are\ndefined as follows, using the angle ? measured from the anti-subsolar direction.\n\nA = (AT ? AD) cos ? + AT for 90 < ? < 180\nA = (AN ? AT ) cos ? + AT for 0 < ? < 90\n\ncos ? = r \u00b7 rc\nr rc\n\nThe acceleration vector of the spacecraft due to outgassing is thus given by\n\nA = A r2ref\nr\nr3\n\n.\n\nFigure 2.14 displays the comet outgassing geometry.\n\n2.6.2 Jet Model\n\nThe vent or gas jet model follows the steady gas pressure model with some minor\nrevisions. Here, the acceleration of the jet Aj is described as a function of the\nangle ? and represents the acceleration from a region surrounding the body fixed\ncoordinates of the jet. The activity of the jet is thus determined by its exposure to\nthe sun attaining a maximum when the sun is directly over head and decreasing to a\nminimum on the dark side of the comet. The geometry is illustrated in Fig. 2.15.\n\n\n\n86 2 Force Models\n\nSUN\n\nS/C\n\n?\n\nCOMET\nNUCLEUS\n\nANrc\n\nrj\n\nrj\n\nAj\n\nr\n\nr -\n\n10 km\n\n?JET\n\nFig. 2.15 Internal mass element model\n\nThe body fixed position of the jet is first converted to inertial coordinates:\n\nrj = T T rjb\nwhere T is the transformation matrix describing the attitude of the comet in inertial\nspace. The angle ? describes the location of the jet and is given by\n\ncos ? = rj \u00b7 rc\nrj rc\n\n.\n\nIntermediate acceleration magnitudes due to the jet are defined as follows, using the\nangle ?:\n\nAj = (ATj ? ADj ) cos ? + ATj for 90 < ? < 180\nAj = (ANj ? ATj ) cos ? + ATj for 0 < ? < 90\n\nwhere the parameters ATj , ADj , and ANj are defined in a similar manner to the\ncorresponding definitions of the parameters AT , AD , and AN for the outgassing\nmodel. The position of the spacecraft relative to the gas jet is described by the angle\n? given by\n\ncos ? = (r ? rj ) \u00b7 rj\nrj |r ? rj |\n\nand the acceleration of the spacecraft is directed away from the jet and given by\n\nAj = Aj r2ref cos ?\nr ? rj\n\n|r ? rj |3 .\n\n\n\n2.6 Comet Atmosphere 87\n\n2.6.3 Thermodynamic Model\n\nThe thermodynamic model of the nucleus of a comet relates the surface temperature\nand gas production rate to the solar energy input. The heat equation describes\nthe flow of heat within the core and mantle where the heat transfer is dominated\nby conduction. Heat transfer into the nucleus can be modeled by partitioning\nthe nucleus into a set of concentric shells surrounding a central core and then\npartitioning each shell into individual volume elements so that a heat equation can be\nwritten for each element. The thickness of these shells depends on the conductivity\nand heat capacity.\n\nThe governing equation of the heating rate per unit area of the dust that comprises\nthe mantle is given by:\n\ncm?m?rmT?surf = (1 ? A)In ? (1 ? A)?bT 4surf ?\n2kd(tsurf ? T sub)\n\n?rm\n(2.26)\n\nwhere cm, ?m, and ?rm are the specific heat, density, and thickness of the mantle. A\nis the albedo, In is the incident solar intensity, ?b is the Stefan-Boltzmann constant,\nand kd is the constant of proportionality for heat conduction. Tsub is the temperature\nof the comet mantle below the top layer of ice. The first term on the right of\nEq. (2.26) is the input solar energy, the second term is the heat radiation to space, and\nthe third term is the conduction into the mantle. The heating rate, T?surf , is given by\n\nT?surf = (1 ? A)\ncm?m?rm\n\nIn ? (1 ? A)\ncm?m?rm\n\n?bT\n4\nsurf ?\n\n2kd(tsurf ? T sub)\ncm?m?r2m\n\nIn = Is\n(\n\nrearth\n\nrcomet\n\n)2\nr?comet \u00b7 r?n\n\nwhere Is is the solar energy flux at the Earth, rearth is the distance from the Earth to\nthe Sun, rcomet is the distance from the comet to the Sun, and r?comet and r?n are unit\nvectors from the comet to the sun and normal to the surface of the nucleus.\n\nThe heat equation must be integrated with respect to both space and time. In\norder to compute the variation of temperature as a function of space and time, we\nneed to compute the Laplacian ?2T . The Laplacian is an operator that appears\nin many engineering applications and states that the volumetric accumulation of\nsome physical quantity is equal to the flow across the boundary of an elementary\nvolume element. This physical quantity is conserved in this process and the flow is\nproportional to the gradient of a scalar potential function. In our case, the physical\nquantity is heat and the scalar potential function is temperature. In Cartesian\ncoordinates, the Laplacian is given by:\n\n?2T = ?\n2T\n\n?x2\n+ ?\n\n2T\n\n?y2\n+ ?\n\n2T\n\n?z2\n= 0 (2.27)\n\n\n\n88 2 Force Models\n\nFig. 2.16 Volume elements\n\nFig. 2.17 Volume element\ncross section\n\n(i-1/2,j)\n\n(i,j+1/2)\n\n(i+1/2,j)\n\n(i,j-1/2)\n\n(i+1,j)\n\n?y\n\n?x\n\n(i,j)\n\n(i,j+1)\n\n(i-1,j)\n\n(i,j-1)\n\nA computer solution of this equation can be achieved by breaking the comet\nnucleus into many cubical volume elements and developing the required second\npartial derivatives by finite differences. When using this approach, the volume\nelements must be very small or varied in size to accommodate variations in the\ngradient of temperature. For a comet nucleus, ideally we could use small volume\nelements near the surface, where the thermal gradients are relatively large, and large\nvolume elements near the center, where the thermal gradients are not so large. A\nsimple algorithm for defining these volume elements is to enclose the comet in a\nparallelepiped as illustrated in Fig. 2.16.\n\nThe coordinates of the volume elements x, y, and z may be related to the indices i,\nj, and k. In computer terms, a triple-indexed do loop may be programmed to access\neach of the volume elements individually. Those volume elements outside of the\ncomet surface are discarded. The required partial derivatives are computed by finite\ndifference. Figure 2.17 shows a typical cross section of volume elements.\nThe thermal gradient with respect to the x coordinate is\n\n\n\n2.6 Comet Atmosphere 89\n\n?T\n\n?x(i ? 12 , j, k)\n= Ti,j,k ? Ti?1,j,k\n\n?x\n\n?T\n\n?x(i + 12 , j, k)\n= Ti+1,j,k ? T i, j, k\n\n?x\n\nand\n\n?2T\n\n?x2\n= Ti+1,j,k ? 2Ti,j,k + Ti?1,j,k\n\n?x2\n\n?2T\n\n?y2\n= Ti,j+1,k ? 2Ti,j,k + Ti,j?1,k\n\n?y2\n\n?2T\n\n?z2\n= Ti,j,k+1 ? 2Ti,j,k + Ti,j,k=1\n\n?z2\n\nThe heating rate of the comet nucleus is then given by\n\nT? = kd\ncm?m\n\n[\n?2T\n\n?x2\n+ ?\n\n2T\n\n?y2\n+ ?\n\n2T\n\n?z2\n\n]\n\nsubject to the boundary condition that T = Tsub on the surface of the nucleus.\nFor navigation, the temperature variation of the nucleus is of interest over a\n\ntime interval of several weeks to several years. The temperature of the surface,\nwhich controls the amount of outgassing, varies periodically with respect to a\nbaseline which evolves over hundreds of years. In order to establish this baseline, the\nthermodynamic model must be integrated over hundreds of years. This integration\nwas performed for the asteroid Eros and the results are illustrated in Fig. 2.18.\n\nFig. 2.18 Eros surface temperature distribution\n\n\n\n90 2 Force Models\n\nFig. 2.19 Eros surface temperature distribution\n\nFor this integration, the temperature was integrated using the known shape, orbit,\nand attitude of Eros. The diurnal temperature variation was averaged over a single\nrevolution of Eros as a function of the Sun\u2019s latitude. Given the direction of Eros\u2019s\nspin axis, the poles are warmer than the equatorial regions as shown in Fig. 2.18.\n\nDuring the NEAR mission, Eros was extensively mapped in the infrared.\nFigure 2.19 shows a map of Eros infrared spectral parameters for the northern\nhemisphere. The southern hemisphere was dark during the time that the data was\nacquired. In Fig. 2.19, longitude is defined as positive West. Navigation coordinate\nsystems are right handed and longitude is defined positive East. The warm region\nlocated at 80? North and 60? East in Fig. 2.18 corresponds to the high-spectral\nintensity located at 80? North and 300? West in Fig. 2.19. The cooler regions of\nPsyche and Himeros located at 30? North also correspond.\n\nIn order to compute acceleration of the spacecraft, the thermodynamic model\ncan be interfaced with the empirical jet model. It is envisioned that in navigation\noperations a number of models would be available that vary in accuracy and number\nof parameters that need to be estimated. These would range from simple empirical\nmodels that would suffice during approach to a comet to high-precision physical\nmodels that may be needed for low-altitude orbits. Integration of the thermodynamic\nmodel with the jet model involves integration over the surface of the comet.\nSince the albedo varies as a function of location on the surface, an expansion of\nLegendre polynomials and associated functions may be employed. The coefficients\nof this expansion would be parameters to be determined by the orbit determination\nsoftware.\n\n\n\nExercises 91\n\n2.7 Summary\n\nForce models are accessed by the numerical integrator in order to compute the\nacceleration of the spacecraft required by the equations of motion. Since the\nequations of motion use the vector sum of all the force models, each force model\nmay be packaged in a separate subroutine. For convenience, the force is divided\nby the mass of the spacecraft and acceleration vectors are computed. In addition,\nthe partial derivatives of acceleration with respect to spacecraft position, velocity,\nand constant parameters are included in the subroutine. If there are a large number\nof force models, the number of constant parameters may be too many for the\norbit determination filter to process. The NEAR mission had over 600 parameters.\nTherefore, the force models must be designed to provide only the number of\nparameters to accurately model the acceleration. The accuracy of the required force\nmodel will depend on the mission phase. For example, the gravity model requires\none coefficient when the spacecraft is far from the central body but may require\nseveral hundred coefficients when in a close orbit.\n\nThe solar pressure model is needed for long-term orbit prediction during cruise.\nIn orbit, the solar pressure is overwhelmed by gravity harmonic uncertainties and\ndoes not have much effect on short-term predictions. Atmospheric drag models are\nonly needed when the spacecraft is in an atmosphere. Propulsion system models\ngenerally use the rocket equation and assume constant thrust. Another consideration\nin designing force models is computation of the partial derivatives. These partial\nderivatives are needed for integration of the variational equations and can impose a\nsignificant burden on computer time.\n\nExercises\n\n2.1 A small unguided rocket weighs 26 pounds of which 4.86 pounds is fuel. The\nIsp of the fuel is 120 s. Determine the range and maximum altitude if it is launched\nat an angle ? = 25? with respect to the local horizontal plane. Assume that the\nvelocity is applied as an impulse and the trajectory is a parabola. The range (R) and\nmaximum altitude (H) are given by\n\nR = ?v\n2\n0 sin(2?)\n\ng0\nH = ?v\n\n2\n0 sin\n\n2(?)\n\n2g0\n\n2.2 The rocket in Exercise 2.1 is 2.75 in in diameter and the burn time was 5 s.\nDetermine the thrust and drag force at burn out. The density of air is 2.508 \u00d7\n10?3 slugs/ft3 and the drag coefficient is 0.6. Navigation receives input from many\nsources that work in different systems of units. Engineers working in wind tunnels\nmeasuring drag like to work in English units. Making conversions is an important\npart of navigation operations.\n\n\n\n92 2 Force Models\n\n2.3 Derive the equations of motion of the rocket in Exercise 2.1, determine the\nrange and maximum altitude, and show that the trajectory is a parabola.\n\n2.4 A spent rocket is found that weighs 30 pounds and is 6 ft long and 3 in in\ndiameter. It is estimated that the fuel would weigh 5 pounds and probably have\nan Isp of 200 s. Determine the maximum range for this rocket assuming a launch\nangle of 45?. This was a real problem.\n\n2.5 The rocket in Exercise 2.1 was planned to be fired at a hillside that is 1042 ft\ndownrange and 275 ft high. The target is at an elevation of 250 ft above the launch\nsite. Determine the launch angle. Just before the launch, the launcher was moved\n225 ft back so the range was now 1267 ft. Determine the new launch angle. Where\ndoes the rocket go if the correction to the launch angle is not made and the rocket\nis launched with the original launch angle for the 1042 ft range. This was also a real\nproblem and the actual rocket went as predicted. Hint, the hill was only 275 ft high\nand there was ocean behind it but no fisherman.\n\n2.6 A spacecraft is in a circular orbit about the sun with a radius of 1 AU (149 \u00d7\n106 km). A solar sail is unfurled with an area of 800 m2 and oriented facing the\nsun. The spacecraft weighs 500 kg and the solar sail is a perfect specular reflector.\nDetermine the orbit of the spacecraft which is a conic section.\n\n2.7 Determine the size of a solar sail in Exercise 2.6 that would enable the\nspacecraft to escape from the sun. Assume that the total mass remains at 500 kg.\nNeglecting general relativity, determine the size of a sail that would leave the solar\nsystem at one tenth the speed of light.\n\n2.8 A spacecraft is maneuvered into a circular orbit about an asteroid. The plane\nof the spacecraft orbit faces the sun and the spacecraft is 10 km from the asteroid\ncenter. The asteroid is 1 AU from the sun and has a radius of 5 km and specific\ngravity of three. The universal gravitational constant is 6.674\u00d710?20 km3 kg?1 s?2.\nThe spacecraft is a black body with an area of 10 m2 and mass of 500 kg. Determine\nthe orbit of the spacecraft and the period of the orbit.\n\n2.9 The integrand of the volume integral for the second degree gravity harmonic\ncoefficients may be expressed as Cartesian components of the volume elements.\nShow that Iyy ? Izz = Ma2(C20 + 2C22).\n\nBibliography\n\nBalmino, G., B. Moynot J. Geophys. Res. 87, 9735, 1982.\nBordi, J. J., P. G. Antreasian, J. K. Miller and B. G. Williams, \u201cAltimeter Range Processing\n\nAnalysis for Spacecraft Navigation about Small Bodies\u201d, AAS00-165, AAS/AIAA Space\nFlight Mechanics Meeting, Clearwater FL, January 23, 2000.\n\nBordi, J. J., J. K. Miller, B. G. Williams, R. S, Nerem and F. J. Pelletier, \u201cThe Impact of Altimeter\nRange Observations on NEAR Navigation\u201d, AIAA 2000\u20134423, AIAA/AAS Astrodynamics\nSpecialist Conference, Denver, CO, August 14, 2000\n\n\n\nBibliography 93\n\nGarmier, R.and J. P. Barriot, Ellipsoidal Harmonic Expansions of the Gravitational Potential:\nTheory and Application. Celes. Mech. and Dyn. Astron. (in press),2000.\n\nHeiskanen, W.A. and H. Moritz 1967. Physical Geodesy. W.H. Freeman and Company, San\nFrancisco, CA.\n\nKaula, W.M. 1966. Theory of Satellite Geodesy. Blaisdell, Waltham, MA.\nLlanos, P. J., J. K. Miller and G. R. Hintz, \u201cComet Thermal Model for Navigation\u201d, AAS 13\u2013259,\n\n23rd Space Flight Mechanics Meeting, Kauai, Hawaii, February 10, 2013.\nMiller, J. K., P. J. Llanos and G. R. Hintz, \u201cA New Gravity Model for Navigation Close to Comets\n\nand Asteroids\u201d, AIAA 2014\u20134144, AIAA/AAS Astrodynamics Specialist Conference, San\nDiego, CA, 2014.\n\nMiller, J. K. and G. R. Hintz, \u201cA Comparison of Gravity Models used for Navigation Near Small\nBodies\u201d, AAS17-557, 2017 AAS/AIAA Astrodynamics Specialist Conference, Stevenson,\nWA, 2017.\n\nMiller, J. K., \u201cPlanetary and Stellar Aberration\u201d, EM 312-JKM-0311, Jet Propulsion Laboratory,\nJune 16, 2003.\n\nWeeks, C. J. and Miller, J. K., \u201cA Gravity Model for Navigation Close to Asteroids and Comets\u201d,\nThe Journal of the Astronautical Sciences, Vol 52, No 3, July-September 2004, pp 381\u2013389.\n\nWeeks, C. J., \u201cThe Effect of Comet Outgassing and Dust Emission on the Navigation of an Orbiting\nSpacecraft\u201d, AAS 93\u2013624, AIAA/AAS Astrodynamics Specialist Conference, Victoria B.C.,\nCanada, August 16, 1993.\n\nWerner, R. A., \u201cThe Gravitational Potential of a Homogeneous Polyhedron or Don\u2019t Cut Corners\u201d,\nCelestial Mechanics & Dynamical Astronomy, Vol 59, 1994, pp 253\u2013278.\n\n\n\nChapter 3\nTrajectory Design\n\nThe problem of trajectory design requires the determination of spacecraft position\nand velocity as a function of time that satisfy design constraints. The constraints\nthat must be satisfied are supplied to the trajectory designer as parameters that are\ngenerally functions of the Cartesian state. Thus, the main interest in developing\nsolutions of the equations of motion for navigation is to enable computation of\nparameters that satisfy mission constraints and state vectors that may be used\nto initialize numerical integration for further refinement of the trajectory design.\nAnalytic solutions of the equations of motion are of intrinsic interest because of\ntheir mathematical elegance. However, when applied to trajectory design, solutions\nare sought that enable the full Cartesian state to be determined with high precision\nand these solutions are numerical.\n\n3.1 Restricted Two-Body Trajectories\n\nThe solution of the equations of motion for a point mass that is accelerated by a\nspherical central body was first obtained by Kepler. The trajectory is an ellipse,\nhyperbola, circle, or parabola depending on the initial conditions. Kepler\u2019s solution\nreveals that the trajectory shape is dependent on the energy and angular momentum\nof the spacecraft. Since the circle and parabola are limiting cases of an ellipse or\nhyperbola, only the solution for the ellipse or hyperbola is needed. Circular orbits\nare generally avoided because of singularities in determining the orbit and parabolic\norbits are generally encountered only during the transition between elliptical and\nhyperbolic motion when the spacecraft is being accelerated by propulsive thrust or\natmospheric drag. The solution of the equations of motion could be obtained by\nnumerical integration from an initial state vector. Since there are six degrees of\nfreedom associated with the initial conditions, six orbit parameters are required to\ndescribe the trajectory in addition to the central body gravity constant. Since there\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_3\n\n95\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_3&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_3\n\n\n96 3 Trajectory Design\n\nare many parameters that describe an ellipse or hyperbola and its orientation in\nspace, a set of parameters is desired that will permit determination of the Cartesian\nstate at various points along the trajectory and thus obtain the same result as could\nbe obtained by numerical integration. Two of these parameters must be shape\nparameters, three are needed to orient the orbit in space, and an additional parameter\nis needed to specify the position of the point mass or body in the orbit at a particular\ntime.\n\n3.1.1 Elliptical Orbit\n\nThe equations of motion are first developed for an ellipse. The state vector (X), or\nstate column matrix to be more precise, is comprised of the elements or components\nof the position and velocity vectors.\n\nX = [x, y, z, x?, y?, z?]T\nr = (x, y, z)\nv = (x?, y?, z?)\n\nThe magnitudes of the position and velocity vectors are\n\nr =\n?\n\nx2 + y2 + z2\n\nv =\n?\n\nx?2 + y?2 + z?2\n\nThe angular momentum vector, which is also the pole of the orbit plane, is given by,\n\nh = r \u00d7 v\n\nThe magnitude of the angular momentum vector (h) is the angular momentum orbit\nparameter. The energy parameter is obtained by summing the kinetic and potential\nenergy.\n\nC3 = v2 ? 2GM\nr\n\n(3.1)\n\nThe actual energy is obtained by multiplying C3 by one half of the mass of the\nbody. Since the body is assumed to be a point mass, the body mass is assumed to\nbe zero or small compared to the central body mass. Since the acceleration is the\nratio of force to body mass, in the limit as the body mass approaches zero, it cancels\nfrom the acceleration. The force equation contains the product of the central body\n\n\n\n3.1 Restricted Two-Body Trajectories 97\n\nmass and body mass leaving GM instead of GMm for the gravity parameter. The\nfactor of one half, that accounts for acceleration from rest to v, is omitted from the\nenergy parameter. The spacecraft mass is also removed from the angular momentum\nparameter.\n\nh = r2?? (3.2)\n\nwhere ? is the true anomaly or polar angle that specifies the angular position of\nthe body in the plane of the orbit. The angle ? is measured counterclockwise from\nperiapsis in the plane of the orbit. The velocity magnitude (v) may be computed\nfrom the radial and azimuthal components of velocity and is given by\n\nv2 = r?2 + r2??2 (3.3)\n\nSubstituting Eq. (3.3) into Eq. (3.1), the vis viva equation is obtained.\n\nr?2 + r2??2 = C3 + 2GM\nr\n\n(3.4)\n\nThe time parameter may be eliminated from the vis viva equation by substituting ??\nfrom Eq. (3.2) and making use of\n\nr? = dr\nd?\n\n??\n\nyielding\n\nh2\n\nr4\n\n(\ndr\n\nd?\n\n)2\n+ h\n\n2\n\nr2\n= C3 + 2GM\n\nr\n(3.5)\n\nThe vis viva equation may be put into an integrable form by substituting\n\ndr\n\nd?\n= ?r2\n\nd(\n1\n\nr\n)\n\nd?\n\nand\n\nd? =\nd\n\n(\nh\n\nr\n\n)\n?\n\nC3 + 2 GM\nr\n\n? h\n2\n\nr2\n\n(3.6)\n\n\n\n98 3 Trajectory Design\n\nCompleting the square in the denominator,\n\nd? =\nd\n\n(\nh\n\nr\n\n)\n?(\n\nC3 + GM\n2\n\nh2\n\n)\n?\n\n(\nh\n\nr\n? GM\n\nh\n\n)2\n\nA change of variable to ? defined by\n\n? = h\nr\n\n? GM\nh\n\nd? = d\n(\n\nh\n\nr\n\n)\n\ngives\n\nd? = d??(\nC3 + GM\n\n2\n\nh2\n\n)\n? ?2\n\nThe solution is the vis viva integral.\n\ncos ? = ??\nGM2\n\nh2\n+ C3\n\nReplacing the dummy variable ? and solving for r , the equation of an ellipse in\npolar coordinates is obtained.\n\nr =\nh2\n\nGM\n\n1 +\n?\n\n1 + h\n2C3\n\nGM2\ncos ?\n\n(3.7)\n\nThe equation for an ellipse in polar coordinates is given by,\n\nr = p\n1 + e cos ? (3.8)\n\nComparing Eq. (3.7) and Eq. (3.8), the parameter of orbit (p) and eccentricity (e)\nmay be written from inspection.\n\n\n\n3.1 Restricted Two-Body Trajectories 99\n\np = h\n2\n\nGM\n(3.9)\n\ne =\n?\n\n1 + h\n2C3\n\nGM2\n(3.10)\n\nFrom the geometry shown in Fig. 3.1, the following geometric parameters may be\ncomputed.\n\ne =\n?\n\n1 ? b\n2\n\na2\n\nrp = p\n1 + e\n\nra = p\n1 ? e\n\nc = ae\np = a(1 ? e2)\n\nThese geometric parameters have names that describe the geometry of an ellipse.\nThese names can be found in the geometry literature and can be derived by\ninspection of Fig. 3.1. Since the same names are applied to different geometrical\nparameters for a hyperbola that share the same equations for a two-body orbit,\nit is left as an exercise for the reader to sort out all the possible orbit elements.\nIntroducing the results obtained by integration of the vis viva integral, some\nadditional parameters that are of interest may be determined.\n\nC3 = ?GM\na\n\ncos ? = p ? r\nre\n\n(3.11)\n\nr? = e\n?\n\nGM\n\np\nsin ?\n\nThe radial component of velocity may be obtained from the dot product of the\nposition and velocity vectors yielding an equation for sin ?.\n\nsin ? = r \u00b7 v\nre\n\n?\np\n\nGM\n(3.12)\n\nThe true anomaly (?) is obtained from a four-quadrant arctangent evaluation of sin ?\nand cos ?. The quadrants are selected from the signs of the sine and cosine functions.\n\n? = tan?1(sin ?, cos ?) (3.13)\n\n\n\n100 3 Trajectory Design\n\nFig. 3.1 Elliptical orbit\ngeometry\n\nSpacecraft\n\nPeriapsis\nApoapsis\n\nOrbit\n\nCircle\n\nE\nc rp\n\nx\n\ny\n\nh\n\na\n\np\n\nb\n\nThe two shape parameters, p and e, are selected for inclusion in the set of six\nparameters that are used to describe the orbit. The third parameter that is needed\nto define the orbit solution is the time elapsed from the last periapsis passage to the\nepoch of the point in the orbit defined by the Cartesian state vector. The equation for\ntrue anomaly as a function of time is not integrable with simple functions. A change\nof variable to the angle E, referred to as the eccentric anomaly, yields an equation\nthat can be integrated and the resulting equation is called Kepler\u2019s equation. From\nthe geometry shown in Fig. 3.1, the following equation relates r and cos ? to cos E.\n\nr cos ? = a cos E ? ae (3.14)\n\nSubstituting Eq. (3.1.1) into (3.14), another equation for r as a function of E is\nobtained.\n\nr = a ? ae cos E (3.15)\n\nSquaring Eqs. (3.14) and (3.15) and subtracting gives an equation that relates r and\nsin ? to sin E,\n\nr sin ? = b sin E\n\nAn equation that may be integrated for time as a function of E may be obtained by\neliminating r from the vis viva integral. The vis viva integral may be put into a form\nthat involves only r , r? , and constant parameters.\n\nr2r?2 = ? r\n2GM\n\na\n+ 2GM r ? GM a(1 ? e2) (3.16)\n\n\n\n3.1 Restricted Two-Body Trajectories 101\n\nDifferentiating Eq. (3.15) with respect to time gives\n\nr? = ae sin E E? (3.17)\n\nSubstituting Eqs. (3.17) and (3.15) into Eq. (3.16) gives, after many cancelations,\n\na3\n\nGM\n(1 ? e cos E)2 E?2 = 1 (3.18)\n\nand\n\ndt =\n?\n\na3\n\nGM\n(1 ? e cos E) dE (3.19)\n\nThe integral from periapsis, E = 0, to the point in the orbit of interest is Kepler\u2019s\nequation.\n\nt ? tp =\n?\n\na3\n\nGM\n(E ? e sin E) (3.20)\n\nThe period of the orbit may be obtained by integrating over one complete revolution\nand\n\nP = 2?\n?\n\na3\n\nGM\n(3.21)\n\nThe parameter tp is the epoch of periapsis passage and is selected as the third\nparameter to characterize the orbit solution. The final set of parameters are the\nlongitude of the ascending node (\n), inclination (i), and argument of periapsis\n(?). The geometry is shown in Fig. 3.2. The longitude of the ascending node\nand inclination may be determined from the components of the pole or angular\nmomentum vector.\n\n\n = tan?1\n(\n\nhx\n\n?hy\n)\n\n(3.22)\n\ni = tan?1\n?\n?\n?\n\nh2x + h2y\nhz\n\n?\n? (3.23)\n\nThe argument of periapsis is obtained by first computing the argument of latitude\n(?n), the angle from the nodal crossing to the orbit point, and subtracting the true\nanomaly. A coordinate system is defined with x?1 in the direction of the ascending\nnode and z?1 in the direction of the orbit pole.\n\n\n\n102 3 Trajectory Design\n\nFig. 3.2 Orbit orientation in\nspace\n\nSpacecraft\n\nPeriapsis\n\nOrbit\n\nOrbit\nPole\n\ny\n\nx\u2013y Plane\n\ni\n\ni\n\nz\n\nx\n\nh\n\nw\n\n?\n\nx?1 = z? \u00d7 h\nh\n\ny?1 = h \u00d7 x?1\nh\n\nThe angle ?n is defined by the components of the position vector (r) and\n\n?n = tan?1\n(\n\nsin ?n\ncos ?n\n\n)\n= ? + ?\n\nwhere\n\nsin ?n = y?1 \u00b7 r?\ncos ?n = x?1 \u00b7 r?\n\nand\n\n? = ?n ? ? (3.24)\n\nThe orbit element set that has been derived to describe two-body motion is\n\nOc = [p, e, tp,\n, i, ?] (3.25)\n\nand these elements may be obtained as a function of the state at some point in the\norbit. The orbit element set (Oc) will be referred to here as classical orbit elements.\nIn the literature, the semimajor axis (a) is often specified in place of the parameter\nof orbit (p).\n\n\n\n3.1 Restricted Two-Body Trajectories 103\n\nOc(t) = fc(X,GM, t) (3.26)\nX = (r, v)\n\nThe inverse function may be obtained by solving the above equations for the state\nas a function of the orbit elements. Starting with Kepler\u2019s equation, the eccentric\nanomaly (E) may be obtained from the time of periapsis (tp) and the time (t). A\nclosed form solution for Kepler\u2019s equation in terms of elementary functions cannot\nbe obtained. Therefore, it is necessary to iterate using Newton\u2019s method to obtain\nE as a function of t and tp. The true anomaly (?) and radius (r) are then computed\nfrom the eccentric anomaly and orbit elements p and e. The position and velocity is\ndetermined in the orbit plane coordinate system with x2 in the direction of periapsis\nand z2 in the direction of the orbit pole (see Fig. 3.2). The position of the body in\nthe plane of the orbit coordinate system is\n\nr2 = (r cos ?, r sin ?, 0)\n\nand the velocity may be obtained by differentiating r2.\n\nv2 = (?\n?\n\nGM\n\np\nsin ?,\n\n?\nGM\n\np\n(e + cos ?), 0)\n\nThe position and velocity in the reference coordinate system is obtained by rotating\nthrough the angles defined in Fig. 3.2.\n\nr = RTc r2\nv = RTc v2\n\nRc =\n?\n? cos ? sin ? 0? sin ? cos ? 0\n\n0 0 1\n\n?\n?\n?\n?1 0 00 cos i sin i\n\n0 ? sin i cos i\n\n?\n?\n?\n? cos \n sin \n 0? sin \n cos \n 0\n\n0 0 1\n\n?\n?\n\nThe inverse function permits transformation of the classical orbit element set into\nthe state (X) at t .\n\nX(t) = f ?1c (Oc,GM, t)\n\nThe function fc and its inverse permit a one to one mapping from state vector to\nclassical orbit elements and back to state vector. These functions may be coded into\nsubroutines on a computer and used to propagate a spacecraft trajectory from some\ntime t1 to a later time t2. For example, the orbit elements may be computed from the\nstate vector at t1\n\nOc(t1) = fc(X(t1),GM, t1)\n\n\n\n104 3 Trajectory Design\n\nThe time is advanced to t2 and X(t2) is computed from the inverse function.\n\nX(t2) = f ?1c (Oc,GM, t2)\n\nTrajectory propagation is thus accomplished with two calls to subroutines which\ncan be accomplished with three lines of Fortran code or several lines of C code.\n\n3.1.2 Hyperbolic Orbit\n\nThe transformation of a state vector to classical orbit elements for an ellipse may\nbe modified to transform to a hyperbola. The eccentric anomaly is replaced by the\nhyperbolic eccentric anomaly (F ) defined by\n\nsinh F = r sin ?\nb\n\ncosh F = (a + r)\nae\n\nand\n\nF = ln(sinh F + cosh F)\n\nKepler\u2019s equation for the hyperbola becomes\n\nt ? tp =\n?\n\na3\n\nGM\n(e sinh F ? F) (3.27)\n\nFor the inverse transformation from classical orbit elements to state vector, it is\nnecessary to solve Kepler\u2019s equation for the hyperbola by iteration.\n\nThe classical orbit elements (Oc) are not convenient for describing a hyperbolic\ntrajectory during flyby of a planet or other celestial body. A different set of six\nelements are defined for this purpose. The geometry is illustrated in Fig. 3.3 in the\nplane of the orbit. The parameters are essentially the same as for an ellipse. The\nclassical shape parameters p and e are replaced by the hyperbolic impact parameter\n(b), which is also the semiminor axis of the hyperbola, and the hyperbolic excess\nvelocity (V?).\n\nb = ?ap\nV? =\n\n?\nC3\n\nThe orientation of the hyperbola in space is defined with respect to the approach\nasymptote (S) and pole of the orbit plane. In the plane of the orbit, the limiting true\n\n\n\n3.1 Restricted Two-Body Trajectories 105\n\nSpacecraft\n\ny\n\nx\n\nS\n\nc\n\na\n\nb\n\nb\n\nh\n\nr\n\nh\n\nh \u2013 hl\n\nhl\n\nr\u00b4 \u2021\n\u2021\n\nFig. 3.3 Hyperbolic orbit geometry\n\nanomaly as the body goes to infinity is\n\n?l = cos?1\n(\n\n1\n\ne\n\n)\n\nThe direction of the approach asymptote, see Fig. 3.3, is given by the following\nvector sum,\n\nS? = (h? \u00d7 r?) sin(? ? ?l) ? r? cos(? ? ?l)\n\nThe T coordinate axis is perpendicular to S and in the x ? y plane of the reference\ncoordinate system. The unit vector in the direction of T is given by,\n\nT? = S? \u00d7 z?|S? \u00d7 z?|\nand the unit vector in the direction of the R coordinate axis, that completes the\nright-hand system, is given by,\n\n\n\n106 3 Trajectory Design\n\nPLANE ? TO\nINCOMING\n\nASYMPTOTE\n\nTARGET\nBODY S\n\nINCOMING\nASYMPTOTE\nDIRECTION\n\nHYPERBOLIC PATH\nOF SPACECRAFT\n\nERROR\nELLIPSE\n\nERROR ELLIPSE\nORIENTATION\n\nTRAJECTORY\nPLANE\n\n^\n\n^\n\n^\n\nTR?\n\nT\n\nR?\n^ ^ ^R = S x T\n\n^\n\n^\n\nS = INCOMING APPROACH ASYMPTOTE\n\n\u2013\n\n\u2013\n\nT? = PARALLEL TO JUPITER EQUATOR PLANE\n      AND ? TO  S\n\nB = TARGET PARAMETER\n\n\u2013B\n\nq = ORIENTATION OF B\n\nq\n\nFig. 3.4 B-plane definition\n\nR? = S? \u00d7 T?\n\nThe orientation of the hyperbola in space is shown in Fig. 3.4. The B-plane is defined\nperpendicular to the approach asymptote and passes through the center of the central\nbody. The orientation of the plane of the orbit is defined by the angle ? between\nthe T coordinate axis and the B vector that is in the plane of the orbit. The angle\n? is determined from a four-quadrant arctangent function where the signs of the\nnumerator and denominator are used to place the angle in the proper quadrant.\n\n? = tan?1\n(\n\nT? \u00b7 h?\n?R? \u00b7 h?\n\n)\n\nThe direction of the approach asymptote is defined by the right ascension (??) and\ndeclination (??). The four-quadrant arctangent is used to place ?? in the proper\nquadrant.\n\n\n\n3.1 Restricted Two-Body Trajectories 107\n\n?? = tan?1\n(\n\nS?y\n\nS?x\n\n)\n\n?? = sin?1 S?z\nA modified orbit element set has been derived to describe two-body hyperbolic\n\nmotion.\n\nOh = [b, ?, tp, V?, ??, ??]\n\nOh may also be obtained as a function of the state at some point in the orbit as was\ndone for the classical orbit element set.\n\nOh(t) = fh(X,GM, t)\n\nThe inverse function for the hyperbola is obtained by solving the above equations\nfor the state as a function of the orbit elements as was done for the ellipse. Kepler\u2019s\nequation is solved by iteration to obtain F as a function of t and tp. The true\nanomaly (?) and radius (r) are then computed from F and the orbit elements p\nand e. The elements p and e may be computed from b and V?. The position and\nvelocity in the plane of the orbit are computed as for the classical elements. The\nfinal transformation from orbit plane coordinates to the reference coordinate system\nis given by,\n\nr = RTh r2\nv = RTh v2\n\nand\n\nRh =\n?\n? sin ?l 0 cos ?l? cos ?l 0 sin ?l\n\n0 1 0\n\n?\n?\n?\n? cos ? sin ? 0? sin ? cos ? 0\n\n0 0 1\n\n?\n?\n\n?\n?1 0 00 sin ?? ? cos ??\n\n0 cos ?? sin ??\n\n?\n?\n?\n? sin ?? ? cos ?? 0cos ?? sin ?? 0\n\n0 0 1\n\n?\n?\n\nFrom the inverse function, the state may be computed as a function of the hyperbolic\norbit elements and GM .\n\nX(t) = f ?1h (Oh,GM, t)\n\nFor interplanetary trajectory design, the outgoing hyperbolic asymptote is often\nneeded. A modified set of hyperbolic orbit elements may be defined that has the\n\n\n\n108 3 Trajectory Design\n\noutgoing departure asymptote direction as part of the set of orbit elements replacing\nthe incoming approach asymptote direction. For the conversion of a state vector\nto the modified hyperbolic elements, the following procedure may be used. First,\nchange the direction of the velocity vector and compute the incoming hyperbolic\nelements.\n\nOhi = fh(Xi,GM, t)\nXi = [x, y, z,?x?,?y?,?z?]\n\nOhi = [bi, ?i, tpi, V?i , ??i , ??i]\n\nThe outgoing elements may then be computed from the incoming elements.\n\nOho = [bo, ?o, tpo, V?o, ??o, ??o]\n\nwhere the direction of the outgoing asymptote is\n\n??o = 180 ? ??i\n??o = ???i\n\nThe remaining outgoing parameters are the same as the incoming parameters. The\ninverse function may be obtained by simply reversing the procedure defined above.\nIn summary, the hyperbolic elements with respect to the outgoing asymptote as a\nfunction of the state and the inverse function are given by,\n\nOho(t) = fho(X,GM, t)\nX(t) = f ?1ho (Oho,GM.t)\n\n3.1.3 Injection Flight Plane Hyperbolic Trajectory\n\nThe design of the Earth departure hyperbola must be interfaced with the launch\nvehicle ascent trajectory design. The interface point is generally defined shortly\nafter final stage burnout and the spacecraft position and velocity at this point are\nreferred to as injection conditions. The injection conditions are described by a\nconvenient set of parameters called injection flight plane coordinates. The departure\nhyperbolic orbit elements are also used to design Earth departure trajectories.\nHowever, hyperbolic orbit elements do not relate very well to the launch vehicle\nascent trajectory and are generally not used for describing the trajectory when the\nposition of the spacecraft near the Earth is of interest. The injection flight plane\ncoordinates are shown schematically in Fig. 3.5. The departure hyperbola is shown\npropagated back from the injection point defined by the vector r to the Earth\u2019s\n\n\n\n3.1 Restricted Two-Body Trajectories 109\n\n90 \u2013 Az\n\nx\n\nz\n\ny\n\nr\n\ni\n\nfl\n\n?\n\n?i\n\n?x\n\n?\n\n?lat\n\nFig. 3.5 Orbit injection geometry\n\nequator. This two-body conic trajectory does not pass through the launch site but\nflies over the latitude of the launch site (?l) as shown in the figure. At the launch\nsite latitude overfly point, the azimuth angle (Az) is defined by measuring clockwise\nfrom north in the local tangent plane. In Fig. 3.5, Az is shown with respect to the\nlocal East vector. The hyperbolic trajectory continues from launch latitude overfly\nto the injection point. The central angle (?x) from launch site latitude overfly to\ninjection is the third injection flight plane coordinate. The remaining parameters are\nthe velocity magnitude (Vi), the flight path angle (?i), and the inertial longitude (?i).\nThe flight path angle is the angle between the velocity vector and local horizontal\nplane. The inertial longitude is measured from the vernal equinox to the projection\nof the injection vector on the Earth\u2019s equator. This unusual set of coordinates was\ndevised by General Dynamics to interface Atlas launch vehicle trajectories with\ninjected payloads and has continued in use to the present time.\n\nThe rationale behind the selection of injection flight plane parameters is related to\nlaunch vehicle constraints. The individual parameters are a function of both position\nand velocity at injection. In the design of interplanetary trajectories, it is necessary\nto separate position from velocity. The spacecraft velocity is sought that results\nin a trajectory between two positions determined by the location of the planets.\nThus, the injection flight plane parameters must be separable into parameters that\nare related to position and are fixed and parameters that are related to velocity and\nare permitted to vary. For design of interplanetary trajectories, the fixed parameters\nare r , ?i and either ?x or Az and the variable parameters are V , ?i and either ?x\n\n\n\n110 3 Trajectory Design\n\nor Az. The choice of fixing either ?x or Az depends on the type of launch vehicle\nascent trajectory that is used. The launch vehicle ascent trajectory may be direct or\ninto a parking orbit. For a direct ascent, the launch vehicle rises vertically until it\nclears the gantry and is then tipped a fixed angle to start a gravity turn. For a gravity\nturn, the launch vehicle is accelerated in the direction of the velocity vector and is\nslowly turned by gravity. The initial horizontal direction is roughly in the direction\nof the launch azimuth (Az). The detailed launch vehicle trajectory design must take\ninto account the rotation of the Earth and the actual Earth fixed azimuth differs some\nfrom the inertial azimuth. During the launch vehicle ascent, the trajectory traverses a\ncentral angle of ?x which is a characteristic of the launch vehicle and corresponds to\nabout 3000 km downrange from the launch site which is assumed to be the Kennedy\nspace center. For a direct ascent, ?x is fixed. For some launch vehicles, the ability\nexists to shut down the rocket engine at the instant a circular orbit is achieved. The\nspacecraft and upper stage may coast in a parking orbit for some fraction of an orbit\nand restarted. For a parking orbit ascent, Az is fixed and ?x is permitted to vary.\nThe injection flight path angle (?i) is determined by the launch vehicle performance\nand is generally small to take advantage of the Earth\u2019s rotation. The parameter ?i is\nused to control the direction of departure from the Earth in the ecliptic plane. The\ndirection of departure is controlled by simply selecting the time of day to launch\nor the launch window. The launch azimuth and coast time are used to control the\nvelocity component out of the Ecliptic plane.\n\nThe injection flight plane coordinates may be computed as a function of the\nCartesian state at injection. The classical elements Oc and hyperbolic elements\nOh and their inverses may be used to propagate the spacecraft along the ascent\nhyperbola and determine state vectors at launch site overfly and injection. From\nthese state vectors, the injection flight plane parameters may be computed.\n\nOi(ri) = fi(X,GM) (3.28)\n\nwhere\n\nOi = [?l, ri , ?x,Az, V, ?i, ?i]\n\nAlso, the state at injection may be computed from the inverse relationships as a\nfunction of the injection flight plane parameters.\n\nX(ri) = f ?1i (Oi,GM) (3.29)\n\n3.1.4 Lambert\u2019s Problem\n\nAn important problem relating to the determination of orbits and design of\ninterplanetary trajectories was defined by Lambert and Euler. Given the flight\ntime between two position vectors, Lambert\u2019s problem is to determine the orbit\n\n\n\n3.1 Restricted Two-Body Trajectories 111\n\nthat transfers from the first position vector to the second in the given flight time.\nLambert\u2019s problem is fundamental to interplanetary trajectory design since the\nposition vectors of interest are generally the ephemerides of two planets and the\nproblem is to design a trajectory that will go from one planet to another in a specified\ninterval of time. Problems of this type are referred to as two-point boundary value\nproblems. In the current age of computers, Lambert\u2019s problem may be easily\nsolved by targeting the second position vector. The velocity at the first position\nvector is varied iteratively using Newton\u2019s method until the propagated trajectory\nintersects the second position vector at the time specified. The partial derivatives\nrequired by the three-parameter search can be computed by finite difference and the\ntrajectory propagation performed by solution of the two-body equations of motion\nas described in Sects. 3.1.1 and 3.1.2.\n\nAn analytic solution of Lambert\u2019s problem was provided by Lagrange, who\nwas proud of this accomplishment as well he should be, and showed his solution\nto Lambert about a year before he died. Since that time, a considerable amount\nof research has been expended identifying singularities and developing efficient\nalgorithms for digital computers. Even in the modern era of high-speed computers,\nwhere analytic methods have generally given way to much simpler numerical\nmethods, analytic solutions of Lambert\u2019s problem are often preferred for designing\nlarge numbers of trajectories that are required for surveying possible missions to the\nplanets and other celestial bodies.\n\nFigure 3.6 shows the geometry of Lambert\u2019s problem. A trajectory is sought that\ntransfers a spacecraft from position r1 at time t1 to position r2 at time t2. The transfer\ntime is given by solution of Kepler\u2019s equation at the two end points.\n\nt2 ? t1 =\n?\n\na3\n\nGM\n[(E2 ? E1) ? e(sin E2 ? sin E1)]\n\nMaking use of the identity\n\ncos\n\n(\nE1 + E2\n\n2\n\n)\nsin\n\n(\nE2 ? E1\n\n2\n\n)\n= 1\n\n2\n(sin E2 ? sin E1)\n\nt2 ? t1 =\n?\n\na3\n\nGM\n\n[\n(E2 ? E1) ? 2e cos\n\n(\nE1 + E2\n\n2\n\n)\nsin\n\n(\nE2 ? E1\n\n2\n\n)]\n\nLagrange defined two angles, ? and ?, for his solution and these are related to the\neccentric anomaly at the end points by\n\n? ? ?\n2\n\n= E2 ? E1\n2\n\nand cos\n\n(\n? + ?\n\n2\n\n)\n= e cos\n\n(\nE2 + E1\n\n2\n\n)\n\nKepler\u2019s equation becomes\n\n\n\n112 3 Trajectory Design\n\nx\n\na\n\nb\n\nc\n\nh2\n\nh1\n\ny\n\nr1\n\nr2\n\nqt\n\nFig. 3.6 Orbit transfer geometry\n\nt2 ? t1 =\n?\n\na3\n\nGM\n\n[\n? ? ? ? 2 cos\n\n(\n? + ?\n\n2\n\n)\nsin\n\n(\n? ? ?\n\n2\n\n)]\n\nt2 ? t1 =\n?\n\na3\n\nGM\n[(? ? sin ?) ? (? ? sin ?)] (3.30)\n\nThe solution involves developing equations for ? and ? as a function of known\nparameters and a, the semimajor axis, and iterating on a using Newton\u2019s method\nuntil the desired transfer time (t2 ? t1) is achieved. From the geometry shown in\nFig. 3.6, the law of cosines may be applied to the triangle and\n\nc2 = r21 + r22 ? 2r1r2 cos ?t\n\nc2 = (r1 + r2)2 ? 4r1r2 cos2\n(\n\n?t\n\n2\n\n)\n\nThe chord may also be obtained by simply differencing the position vectors and\ncomputing the magnitude.\n\nc = |r2 ? r1| (3.31)\n\nIt can be shown from the geometry that\n\nr1 + r2 + c = 2a(1 ? cos ?)\nr1 + r2 ? c = 2a(1 ? cos ?)\n\n\n\n3.1 Restricted Two-Body Trajectories 113\n\nand\n\nsin2\n(?\n\n2\n\n)\n= r1 + r2 + c\n\n4a\n(3.32)\n\nsin2\n(\n\n?\n\n2\n\n)\n= r1 + r2 ? c\n\n4a\n(3.33)\n\nBefore Eq. (3.30) can be solved iteratively for the semimajor axis (a) of the\ntransfer orbit, the quadrant of the angles ? and ? must be determined. The pole\nof the orbit is computed by taking the cross product of the two position vectors.\nIn order to resolve the transfer angle, it is assumed that the orbit is direct and the\nspacecraft goes from r1 to r2. If a retrograde orbit is desired, the solution is obtained\nfor the direct orbit in the opposite direction and the resulting inclination and node are\nadjusted to give the desired retrograde orbit. With this assumption, the pole vector\n(P ) is opposite to the cross product of the position vectors. If this cross product\nis in the southern hemisphere, the transfer angle (?t ) is assumed to be greater than\n180?. For a direct orbit, the pole vector is in the northern hemisphere. The pole\nvector and transfer angle for the cross product of the position vectors in the northern\nhemisphere is given by\n\nP = r1 \u00d7 r2 (3.34)\n\n?t = cos?1\n(\n\nr1 \u00b7 r2\nr1r2\n\n)\n\nand for the cross product of the position vectors in the southern hemisphere,\n\nP = ?r1 \u00d7 r2 (3.35)\n\n?t = 360 ? cos?1\n(\n\nr1 \u00b7 r2\nr1r2\n\n)\n\nThe quadrant of the angle ? is assigned following the convention determined by\nBattin.\n\n0 ? ? ? ? for ?t ? ?\n?? ? ? ? 0 for ?t ? ?\n\nThe inclination and longitude of the ascending node are computed in the usual\nmanner from the pole vector which is in the same direction as the angular\nmomentum vector.\n\n\n = tan?1\n(\n\nPx\n\n?Py\n)\n\n(3.36)\n\n\n\n114 3 Trajectory Design\n\ni = tan?1\n?\n?\n?\n\nP 2x + P 2y )\nPz\n\n?\n? (3.37)\n\nEquation (3.30) is solved iteratively for a. Some experimentation may be\nrequired to determine the quadrant of ? and select either the hyperbolic or\nelliptical version of Kepler\u2019s equation. Once a solution is found, the energy may be\ndetermined from a. This effectively proves Lambert\u2019s theorem but the solution is in\nterms of parameters that are not convenient. The angular momentum, or parameter\nof orbit (p), requires some further solution of the orbit. The following identities\nmay be determined from the geometry. One could draw an ellipse and spot the\npositions r1 and r2 on the ellipse and verify these identities by direct measurement.\nFor example, one could measure a and b and compute e from its definition.\n\np\n\n(\nr1 + r2\nr1r2\n\n)\n= 2 + 2e cos\n\n(\n?2 + ?1\n\n2\n\n)\ncos\n\n(\n?2 ? ?1\n\n2\n\n)\n(3.38)\n\n?\nr1r2 cos\n\n(\n?t\n\n2\n\n)\n= 2a sin ?\n\n2\nsin\n\n?\n\n2\n(3.39)\n\n?\nr1r2 cos\n\n(\n?2 + ?1\n\n2\n\n)\n= a\n\ne\ncos\n\n(\n? + ?\n\n2\n\n)\n? ae cos\n\n(\n? ? ?\n\n2\n\n)\n(3.40)\n\nMultiplying Eq. (3.40) by e, adding Eq. (3.39), and replacing a(1 ? e2) by p gives\n\ne\n?\n\nr1r2 cos\n\n(\n?2 + ?1\n\n2\n\n)\n= p cos\n\n(\n? ? ?\n\n2\n\n)\n? ?r1r2 cos\n\n(\n?t\n\n2\n\n)\n(3.41)\n\nSubstituting Eq. (3.41) into Eq. (3.38) and solving for p,\n\np =\n2r1r2 sin2\n\n(\n?t\n\n2\n\n)\n\nr1 + r2 ? 2?r1r2 cos\n(\n\n?t\n\n2\n\n)\ncos\n\n(\n? ? ?\n\n2\n\n) (3.42)\n\nand the eccentricity is given by\n\ne =\n?\n\n1 ? p\na\n\nFrom the geometry, a compact formula for p can be derived.\n\np = 4ar1r2\nc2\n\nsin2\n(\n\n? + ?\n2\n\n)\nsin2\n\n(\n?t\n\n2\n\n)\n(3.43)\n\n\n\n3.1 Restricted Two-Body Trajectories 115\n\nThe true anomaly may then be computed using the four-quadrant arctangent\n\n?1 = tan?1 (sin ?1, cos ?1) (3.44)\n\nwhere\n\ncos ?1 = p ? r1\nr1e\n\ncos ?2 = p ? r2\nr2e\n\nsin ?1 = cos?1 cos ?t ? cos ?2\nsin ?t\n\nThe argument of periapsis ? is the angle from the ascending node (?) to periapsis.\nThe true anomaly (?1) is the angle from periapsis to the position vector (r1). We\nneed the angle from the ascending node to r1. The ascending node vector is given\nby the cross product of the z axis with the pole vector.\n\n? = z? \u00d7 P\n\nthe angle from the ascending node to r1 is\n\n?n = tan?1 (sin ?n, cos?n)\nsin ?n = ?PxPzr1x + PyPzr1y + (P 2x + P 2y )r1z\n\ncos ?n = ?r1xPy + r1yPx\nThe argument of periapsis is then\n\n? = ?n ? ?1 (3.45)\n\nThe final parameter needed to describe the transfer orbit is the time of periapsis\npassage.\n\ntp = t1 ?\n?\n\na3\n\nGM\n(E1 ? e sin E1) (3.46)\n\nThe solution of Lambert\u2019s problem yields a classical set of orbit elements (Ol)\ndefined as a function of the time and position vectors of two points relative to a\ncentral body with gravitational parameter GM .\n\nOl(t1) = fl(t1, r1, t2, r2,GM) (3.47)\nOl = [p, e, tp,\n, i, ?] (3.48)\n\n\n\n116 3 Trajectory Design\n\nThe solution of Lambert\u2019s theorem was coded into a subroutine by the author in\n1966. This subroutine, along with subroutines previously described for transforming\norbit elements into state vectors and state vectors into orbit elements, was coded\nin Fortran 2. At that time, the aerospace industry operated with closed shops for\ncomputer programming so the work was done under the table. These subroutines\nhave been incorporated into many programs for analysis and flight operations and\nare in their original form except for some minor corrections. The archaic \u201cif\u201d\nstatements are still in the code. An important principle of computer programming is\nnot to tamper with a program that works.\n\nAn alternative to the above mathematical solution is to solve Lambert\u2019s problem\nby targeting. Lambert\u2019s problem reduces to finding the velocity at t1 that results\nin the desired position at t2 when the trajectory is propagated from t1 to t2. The\ncomplete state (r1, v1) can then be converted to the required orbit elements (Ol)\nusing the subroutine described earlier. The targeting procedure involves first making\nan initial guess for v1. The velocity vector in a circular orbit passing through r1\nprovides an initial guess, but zero velocity also works. The state at t1 is converted to\nthe orbit elements Oc(t1) as described in Sect. 3.1.1. The trajectory is propagated to\nt2 by computing the inverse at t2.\n\nX(t2) = O?1c (t2)\n\nThe position at t2 is compared with the desired position. If they do not agree, a\nNewton Raphson iteration is performed. The state transition matrix is obtained as\ndescribed in Sect. 1.4 only conic propagation of the trajectory is used. The upper-\nright 3\u00d73 partition of the state transition matrix is inverted and multiplied by\nthe position miss at t2 to obtain a correction to the velocity at t1. After several\niterations, the miss goes to zero. When compared with the mathematical solution,\nthe targeted solution agreed within ten decimal places. The advantage of the targeted\nsolution is the avoidance of complexity associated with resolving issues associated\nwith transfer angles, energy, and direction that plagues the mathematical solution.\nA solution to Lambert\u2019s problem may be obtained by using the orbit element\ntransformation subroutines exclusively.\n\n3.2 Interplanetary Transfer\n\nThe problem of interplanetary trajectory design is initially concerned with finding\na trajectory that will transfer a spacecraft from one planet to another where the\ncalendar date is specified at the beginning and end. This problem is a two-point\nboundary value problem where the two points are the positions of the first planet at\nthe start time and the second planet at the end time.\n\n\n\n3.2 Interplanetary Transfer 117\n\n3.2.1 Hohmann Transfer\n\nThe existence of two-body transfer orbits solves only part of the interplanetary\ntrajectory design problem. The transfer trajectory is generally initiated by a large\nrocket motor burn at the first planet, the Earth, and terminated by a large rocket\nmotor burn at the target planet that inserts the spacecraft into orbit. For a planetary\nflyby, the second motor burn is omitted. For preliminary trajectory design, the two\nrocket motor burns are generally computed as impulsive burns and a trajectory is\ndesired that minimizes the magnitudes of the velocity changes at the end points\nto achieve transfer. The velocity change is from the orbital velocity of the planets\nto the velocity of the spacecraft and is generally specified in terms of the energy\nparameter (C3) associated with the hyperbolic departure and approach conic orbits.\nThis interplanetary orbit transfer problem is referred to as the optimum two-impulse\ntransfer problem and a solution was first obtained by the German rocket engineer\nWalter Hohmann in 1925.\n\nThe geometry of the Hohmann transfer orbit is shown in Fig. 3.7 for a transfer\norbit from Earth to Mars. The Hohmann transfer orbit is tangential to the Earth\norbit at launch and tangential to Mars orbit at encounter. The transfer angle is\n180?. The optimality appears obvious from Fig. 3.7 since energy is added in the\ndirection of the Earth\u2019s orbital velocity and subtracted in the direction of Mars\norbital velocity. The proof of optimality is a bit mathematically tedious and is best\ndemonstrated numerically by obtaining the Hohmann transfer orbit as a solution\nto the problem of constrained trajectory optimization which is described in a\nlater chapter. The opportunity for a Hohmann transfer from Earth to Mars occurs\nwhen the planets have the alignment shown in Fig. 3.7. This alignment occurs at a\nfrequency determined by the difference of Earth and Mars angular orbital rates or\nabout every 1.64 years. The launch opportunity occurs on the day when Mars is at\na particular angle with respect to the Earth. The spacecraft must be launched at the\ntime that the transfer orbit will encounter Mars at the encounter time. Thus, Mars\nmust lag the encounter point by an angle of about 136? at the time of launch. The\nlag angle may be computed from the periods of the spacecraft and Mars orbits.\n\nA problem with the Hohmann transfer orbit is that the solution is at a singular\npoint associated with elliptic transfer orbits. A 180? orbit transfer trajectory must be\nin the plane of the Earth, Mars, and Sun. If Mars is slightly out of the ecliptic plane,\nas it generally is except at the nodal crossings, the transfer orbit must also be out\nof the ecliptic plane. For Mars, near the 180? transfer point, the transfer orbit plane\nmay be far out of the ecliptic plane requiring an enormous expenditure of rocket\nfuel to make the plane change. For some cases, the Hohmann transfer trajectory is\nover the Sun\u2019s ecliptic pole. One simple remedy is to introduce a small midcourse\nplane change maneuver and another remedy is to simply avoid the singularity. For\nmost interplanetary trajectory designs, the latter remedy is used and the launch and\nencounter dates are biased a few days. Fortunately, since the optimum solution is\nobtained for launch and encounter dates where the derivative of the cost function\nis zero with respect to these times, substantial deviations from optimality may be\nmade with a small performance penalty.\n\n\n\n118 3 Trajectory Design\n\nLag Angle\nSun\n\nMars at Encounter\n\nEarth at Launch Mars at Launch\n\nFig. 3.7 Earth\u2013Mars Hohmann transfer\n\nOnce the launch date and encounter date are determined, a preliminary trajectory\ndesign may be implemented using the tools described in Sects. 3.1.1 through 3.1.4.\nThe design process involves interfacing the interplanetary transfer trajectory with\ndeparture and approach hyperbolic trajectories that satisfy design constraints at\nEarth and the target planet. The Earth injection hyperbola must be achievable by\nthe launch vehicle and the encounter hyperbola must result in the desired geometry\nat the target. A simple method to design an interplanetary trajectory is by patched\nconics. The principal behind patched conics is that the motion of the spacecraft may\nbe computed by including the acceleration of only the dominant central body and\nignoring the tidal accelerations associated with all other bodies. The error introduced\nby ignoring tidal acceleration is generally small enough that the resulting trajectory\nmay be used to evaluate other mission constraints and to provide an initial guess for\nprecision targeting programs that are employed for the final design.\n\nFigure 3.8 illustrates schematically the patched conic design process for an Earth\nto Mars trajectory. In order to initialize the process, the Earth position vector at the\nEarth injection time (ti) and the Mars position vector at the Mars encounter time\n\n\n\n3.2 Interplanetary Transfer 119\n\nare obtained from a planetary ephemeris file. The conic Earth ephemeris and Mars\nephemeris orbit elements are computed as described is Sect. 3.1.\n\nOce(ti) = fc(Xe(ti),GMs, ti)\nOcm(tm) = fc(Xm(tm),GMs, tm)\n\nFrom Lambert\u2019s orbit transfer solution, a two-body sun-centered conic is computed\nfrom the center of Earth to the center of Mars.\n\nOl = fl(te, re, tmrm,GMs)\nThe position vectors re and rm are obtained from the inverse conic element\ntransformations O?1ce and O?1cm . Two patch points are defined at t1 and t2 about\n2.5 days from Earth injection and 2 days from Mars encounter. At these times,\nthe spacecraft is about 2 million km from the planets where the tidal acceleration\nof the Sun is about equal to the central body acceleration of the planets. The tidal\nacceleration of the Sun is simply the difference between the Sun\u2019s acceleration of the\nspacecraft and the Sun\u2019s acceleration of the planet. The state vector of the spacecraft\nand planets are computed at the patch points.\n\nX(t1) = f ?1c (Ol,GMs, t1)\nXe(t1) = f ?1c (Oce,GMs, t1)\nX(t2) = f ?1c (Ol,GMs, t2)\n\nXm(t2) = f ?1c (Ocm,GMs, t2)\n\nThe hyperbolic orbit elements of the spacecraft are computed with respect to Earth\nand Mars at the patch points from the planet relative state vectors. The incoming\nasymptote is computed for Mars and the outgoing asymptote for Earth.\n\nOhi = fhi(X(t2) ? Xm(t2),GMm, t2)\nOho = fho(X(t1) ? Xe(t1),GMe, t1)\n\nThe encounter conditions at Mars (bi, ?i) are set equal to the target encounter\nconditions (b?i , ??i ) and the outgoing encounter conditions at Earth (bo, ?o) are set\nequal to the injection conditions (b?o, ??o ). For the initial iterations, the injection\nconditions at Earth are b?o = 20,000 km and ??o = 180?. Planet relative state\nvectors are then computed at the patch points and another Lambert transfer orbit\nis computed connecting the new patch points.\n\nX1(t1) = fho(Oho,GMe, t1)\nX2(t2) = fhi(Ohi,GMm, t2)\n\nOl = fl(t1, r(t1) + re(t1), t2, r(t2) + rm(t2),GMs)\n\n\n\n120 3 Trajectory Design\n\nr2(t2)\n\nr1(t1)\nre(ti)\n\nti\n\nt2\n\nt1\n\nrm (tm)\ntm\n\ninterplanetary ellipse or hyperbola\n(Sun centered)\n\nencounter hyperbola\n(Mars centered)\n\nPatch Point 1Earth\n\nSun\n\nMars\n\nPatch Point 2\n\ninjection hyperbola\n(Earth centered)\n\ninjection\n\nFig. 3.8 Earth\u2013Mars trajectory design schematic diagram\n\nNew Sun-centered state vectors are computed and the above process is repeated\nseveral times until the solution converges to the target encounter conditions. The\nEarth departure hyperbola target conditions are then modified to bring the injection\nposition into alignment with the launch vehicle ascent trajectory as specified\nby injection flight plane coordinates. The true anomaly of the injection point is\ncomputed from the defined injection radius (ri). From the true anomaly and the\ndeparture hyperbolic orbit elements, the eccentric anomaly is computed and the\ntime of injection is determined from Kepler\u2019s equation. The injection state vector is\nthen computed from,\n\nXi = fho(Oho,GMe, ti)\n\nThe injection flight plane coordinates are then computed from the injection state\nvector (Eq. 3.28).\n\nOi = fi(X,GM)\n\nThe injection flight plane coordinates are then replaced with the target values. For\nexample, the injection flight path angle may be set equal to the target value (?i = ? ?i )\nand the central angle from the launch site to injection is set equal to its target value\n(?x = ??x) to define O?i . The injection state vector and new outgoing hyperbolic\nencounter target parameters are then computed.\n\n\n\n3.2 Interplanetary Transfer 121\n\nTable 3.1 Earth\u2013Mars trajectory design iterations\n\nEarth injection flight plane Mars encounter hyperbola\n\n?x\na ?i\n\na Vi Az ?i b\na ?a V? ?? ??\n\ni (deg) (deg) (km/s) (deg) (deg) (km) (deg) (km/s) (deg) (deg)\n\n1 32.68 28.74 10.94 127.97 113.54 2219.34 43.72 3.00 253.96 ?14.64\n2 21.10 23.26 10.99 133.79 119.00 28887.02 257.29 3.44 254.24 ?12.19\n3 19.53 22.44 10.99 134.43 119.37 10633.94 253.18 3.45 254.17 ?11.72\n4 19.32 22.33 10.99 134.50 119.40 6965.54 235.98 3.45 254.18 ?11.66\n5 19.29 22.31 10.99 134.51 119.41 6489.04 233.95 3.45 254.18 ?11.66\n6 19.29 22.31 10.99 134.51 119.41 6429.07 233.65 3.45 254.18 ?11.65\n7 19.29 22.31 10.99 134.52 119.41 6421.31 233.62 3.45 254.18 ?11.65\n8 19.29 22.31 10.99 134.52 119.41 6420.32 233.61 3.45 254.18 ?11.65\n9 19.29 22.31 10.99 134.52 119.41 6420.20 233.61 3.45 254.18 ?11.65\n10 15.92 18.00 10.99 134.75 112.99 6420.18 233.61 3.45 254.18 ?11.65\n11 16.01 17.98 10.99 134.77 112.78 6479.39 233.95 3.46 254.18 ?11.65\n12 16.06 18.00 10.99 134.77 112.77 6428.60 233.65 3.46 254.18 ?11.65\n13 16.06 18.00 10.99 134.77 112.77 6421.32 233.62 3.46 254.18 ?11.65\n14 16.06 18.00 10.99 134.77 112.77 6420.34 233.61 3.46 254.18 ?11.65\na Target parameters\n\nXi2 = f ?1i (O?i , GMe)\nO?ho = fho(Xi2,GMe, ti)\n\nThe outgoing hyperbola target parameters are reset to correspond to the desired\ninjection flight plane coordinates. After several iterations, the solution converges to\nthe target injection coordinates at Earth and the encounter parameters at the target\nplanet.\n\nAn example of the design of an interplanetary trajectory is the Mars Odyssey\nspacecraft launched on April 7, 2001 and arrived at Mars on October 24, 2001.\nThe flight time of 199.4 days is considerably less than the nominal Hohmann\ntransfer time of about 258 days. The transfer angle of 140.2? is also considerably\nless than the 180? Hohmann transfer angle. The odyssey spacecraft was launched\nabout 3 months later than the Hohmann optimum transfer time. Launches late in\nthe launch period, surrounding the optimum transfer time of Jan 11, 2001, require\nadditional launch energy to achieve the required injection conditions. However,\nthe cost savings associated with shortening the flight time and consequently\nmission operations time may well offset the additional launch energy cost provided\nthat the launch vehicle has the additional capability. Table 3.1 shows the result\nof implementing the interplanetary trajectory design procedure described above.\nTabulated are the injection conditions at Earth and encounter conditions at Mars\nfollowing each iteration cycle. The converged solution agrees reasonably well with\nthe trajectory that was actually designed. The velocities at injection and at encounter\nagree within about 50 m/s.\n\n\n\n122 3 Trajectory Design\n\n3.3 Three-Body Trajectory\n\nGravity assist trajectories are an important class of trajectories that have been used\nby Voyager, Galileo, Cassini, and other missions to tour the solar system. The\naccessibility of a target planet, particularly those beyond the orbit of Jupiter, depends\non finding a transfer orbit with energy relative to the Earth, within the capability of\nthe launch vehicle. The use of gravity assist to increase the transfer orbit energy has\nopened up the exploration of planets that otherwise would not be accessible with\ncurrent launch vehicle capability.\n\nMost interplanetary and planetary orbiter mission trajectories, since the begin-\nning of the space age, have used Keplerian two-body motion in their design.\nMissions requiring three-body transfers are generally limited to those involving\nthe satellites of the major planets, for example, missions to Lagrange points in\nthe Earth\u2013Moon system. Even though gravity assist trajectories can be designed\nby repeated application of two-body theory, they are included in the three-body\nclassification because the gravity assist requires a simultaneous exchange of energy\namong three bodies. The three-body theory employed for the design of gravity assist\ntrajectories involves the use either of vectors defining the approach and departure\nhyperbolic asymptotes with respect to the gravity assist planet or of Tisserand\u2019s\ncriterion which pertains to the interplanetary Keplerian orbits connecting the launch,\ngravity assist, and target planets. It will be shown that while both design techniques\nfollow from the Jacobi integral, they yield significantly different results, since they\nrepresent different approximations of the true equations of motion.\n\n3.3.1 Jacobi Integral\n\nAn important integral describing constraints on energy transfer for the restricted\nthree-body problem was discovered by Carl Gustav Jacob Jacobi in the Nineteenth\ncentury. A point mass moving in the vicinity of two massive bodies in circular orbits\nabout their barycenter will conserve a certain function of the state and gravitational\nparameters of the massive bodies referred to as Jacobi\u2019s integral. The constant of\nintegration is called Jacobi\u2019s constant. The equations of motion for a spacecraft near\ntwo massive bodies are given by,\n\nx? = GM1 x1 ? x\nr31\n\n+ GM2 x2 ? x\nr32\n\ny? = GM1 y1 ? y\nr31\n\n+ GM2 y2 ? y\nr32\n\nz? = GM1 z1 ? z\nr31\n\n+ GM2 z2 ? z\nr32\n\n(3.49)\n\n\n\n3.3 Three-Body Trajectory 123\n\nThe two massive bodies rotate around the barycenter and the rotation rate is simply\n2? divided by the period of the orbit,\n\n? =\n?\n\nGM1 + GM2\n?3\n\n(3.50)\n\nwhere ? is the distance separating the two massive bodies. The geometry is\nillustrated in Fig. 3.9. The primed coordinate system (x?, y?, z?) represents a rotating\ncoordinate system in which the two massive bodies lie on the x? axis, with\n\nx = x? cos ?t ? y? sin ?t\ny = x? sin ?t + y? cos ?t\n\nz = z? (3.51)\n\nAfter differentiating Eq. (3.51) twice and substituting into Eq. (3.49), the following\nresult is obtained. The sine and cosine terms are elimination by first rotating\nEq. (3.51) its alignment with the rotating frame.\n\nx?? ? 2?y?? ? ?2x? = ?GM1 x\n?\n1 ? x?\nr31\n\n? GM2 x\n?\n2 ? x?\nr32\n\ny?? + 2?x?? ? ?2y? = ?\n(\n\nGM1\n\nr31\n\n+ GM2\nr32\n\n)\ny?\n\nz?? = ?\n(\n\nGM1\n\nr31\n\n+ GM2\nr32\n\n)\nz? (3.52)\n\nEquation (3.52) may be put into a form that can be integrated by defining the\nfunction\n\nU = 1\n2\n?2(x?2 + y?2) + GM1\n\nr1\n+ GM2\n\nr2\n(3.53)\n\nand substituting into Eq. (3.52).\n\nx??x?? ? 2?x??y?? = x?? ?U\n?x?\n\ny??y?? + 2?x??y?? = y?? ?U\n?y?\n\nz??z?? = z?? ?U\n?z?\n\n(3.54)\n\nAdding Eqs. (3.54),\n\n\n\n124 3 Trajectory Design\n\nFig. 3.9 Restricted two-body\ngeometry\n\npoint mass\n\ny\ny'\n\nx'\n\nx\n\nwt\n\nm1\n\nr2\n\nm2\n\nr2\n\nr1\n\nr1\n\nr\n\nx??x?? + y??y?? + z??z?? = x?? ?U\n?x?\n\n+ y?? ?U\n?y?\n\n+ z?? ?U\n?z?\n\n= dU\ndt\n\n(3.55)\n\nThe integral of Eq. (3.55), called the Jacobi integral, is\n\nx??2 + y??2 + z??2 = 2U ? C\n\nor\n\nx??2 + y??2 + z??2 = ?2x?2 + ?2y?2 + 2GM1\nr1\n\n+ 2GM2\nr2\n\n? C (3.56)\n\nwhere C is the constant of integration.\n\n3.3.2 Tisserand\u2019s Criterion\n\nFrancois Felix Tisserand was a nineteenth century astronomer who discovered a\nunique application of Jacobi\u2019s integral to identify comets. In the restricted three-\nbody problem, a certain function of the orbit elements before and after a planetary\nencounter is conserved. If this function is computed for two comet observations on\ndifferent orbits and the results are the same, one may conclude that the observations\nare of the same comet and the comet has encountered a planet between the\nobservations. This may be confirmed by propagating the orbits forward or backward\nin time to see if they encountered a planet.\n\nIn the application of Tisserand\u2019s criterion to gravity assist trajectory design, the\nprocedure is reversed. Transfer trajectories from the launch planet to the intermedi-\nate planet and from the intermediate planet to the target planet are computed using\n\n\n\n3.3 Three-Body Trajectory 125\n\nLambert\u2019s theorem. These trajectories are matched based on Tisserand\u2019s criterion\nto identify viable launch and encounter opportunities. Tisserand\u2019s criterion follows\ndirectly from Jacobi\u2019s integral. The Jacobi integral is transformed back to inertial\ncoordinates (the unprimed coordinates in Fig. 3.9).\n\nx?2 + y?2 + z?2 = 2?(xy? ? yx?)+\n\n2\nGM1\n\nr1\n+ 2GM2\n\nr2\n? C (3.57)\n\nFor GM1 much greater than GM2, the z component of the angular momentum vector\nis given by,\n\nxy? ? yx? = hz = h cos i (3.58)\nh =\n\n?\nGM1 a(1 ? e2)\n\nand from the vis viva integral the energy is given by,\n\nx?2 + y?2 + z?2 = GM1( 2\nr1\n\n? 1\na\n) (3.59)\n\nSubstituting Eqs. (3.58) and (3.59) into Eq. (3.57) gives\n\nGM1(\n2\n\nr1\n? 1\n\na\n) ? 2?\n\n?\nGM1 a(1 ? e2) cos i =\n\n2\nGM1\n\nr1\n+ 2GM2\n\nr2\n? C\n\nSubstituting Eq. (3.50) for ? and for small GM2 compared with GM1,\n\nC ? GM1\na\n\n+ 2GM1\n?\n\na(1 ? e2)\n?3\n\ncos i (3.60)\n\nIn the literature, Tisserand\u2019s criterion is often developed in dimensionless coordi-\nnates and the Jacobi constant modified to remove constant parameters. If a is divided\nby ? to define a? and Eq. (3.60) is multiplied through by ? and divided by GM1,\nTisserand\u2019s criterion in dimensionless coordinates becomes\n\nC?\n\nGM1\n? 1\n\na?\n+ 2\n\n?\na?(1 ? e2) cos i\n\nIf the first observation of a spacecraft or comet has orbit elements a1, e1, and i1 and\nthe second observation after a planetary encounter has orbit elements a2, e2, and i2,\nthen\n\n\n\n126 3 Trajectory Design\n\n1\n\na1\n+ 2\n\n?\na1(1 ? e21)\n\n?3\ncos i1 ?\n\n1\n\na2\n+ 2\n\n?\na2(1 ? e22)\n\n?3\ncos i2\n\n3.3.3 Gravity Assist Vector Diagram\n\nFigure 3.10 shows the encounter geometry in the vicinity of the intermediate planet\nthat supplies the gravity assist energy boost to the spacecraft. The incoming velocity\nof the spacecraft (V1) is subtracted from the planet velocity (Vp) to obtain the planet\nrelative approach velocity (vi) as shown in the upper vector diagram in Fig. 3.10.\nThe lower vector diagram shows the same relationship for the outgoing velocity\nvectors. If the incoming and outgoing velocities are computed far from the planet yet\nclose enough to the planet that the heliocentric energy may be assumed constant, the\nvelocities vi and vo are approximately the v? vectors associated with the two-body\nhyperbola about the planet. In the limit of two-body motion assumed for patched\nconic trajectories, vi and vo are equal in magnitude. Since the planet velocity is\nalso assumed to be constant during the relatively short-time interval of the planet\nencounter, the outgoing vector diagram may be superimposed on the incoming\nvector diagram as shown in Fig. 3.10. The outgoing heliocentric spacecraft velocity\nmagnitude is greater than the incoming velocity magnitude and the spacecraft has\nacquired additional orbit energy relative to the Sun. The energy acquired by the\nspacecraft comes from the Sun and the planet.\n\nConsider the triangle formed by the spacecraft and planet heliocentric velocity\nvectors and the incoming velocity vector. From the law of cosines,\n\nv2i = V 2p + V 21 ? 2VpV1 cos A (3.61)\n\nThe orbit of the planet about the Sun may be approximated by a circle with velocity\nmagnitude given by,\n\nVp =\n?\n\nGMs\n\n?\n\nThe heliocentric orbit of the spacecraft may be regarded as a two-body conic. The\nvelocity magnitude is given by\n\nV1 =\n?\n\n2GMs\n?\n\n? GMs\na1\n\n\n\n3.3 Three-Body Trajectory 127\n\nV2\nV0\n\nVp\n\nVp\n\nVp\n\nPlanet\n\nSun\n\nV0\n\nV2 V1\nvi\n\nFig. 3.10 Gravity assist vector diagram\n\nIn the plane of the orbit, the angle A is simply the flight path angle (? ). For the\ngeneral case, the angle A is a function of ? and the inclination of the spacecraft\norbit plane with respect to the planet orbit plane i1 and\n\ncos A = cos ? cos i1\n\ncos ? =\n?\n\nGMsa1(1 ? e21)\nV1r1\n\nMaking these substitutions into Eq. (3.61) gives\n\nv2i =\n2GMs\n\n?\n? GMs\n\na1\n+ GMs\n\n?\n?\n\n2V1\n\n?\nGMs\n\n?\n\n?\nGMsa1(1 ? e21)\n\n?2V 21\n\ncos i1\n\nThe energy of the spacecraft relative to the planet, the potential energy of the\nspacecraft relative to the Sun and the velocity of the planet relative to the sun may\nbe regarded as constant. Collecting these \u201cconstant\u201d terms on the left side gives\n\n\n\n128 3 Trajectory Design\n\nC ? 3GMs\n?\n\n? v2i\n\n? GMs\na1\n\n+ 2GMs\n?\n\na1(1 ? e21)\n?3\n\ncos i1 (3.62)\n\nEquation (3.62) provides an interesting insight into the geometrical meaning of\nJacobi\u2019s constant in the limit where one of the gravitating bodies is much more\nmassive than the other. The terms in the Jacobi integral are related to the velocity\nvector diagram of the participating bodies.\n\n3.3.4 Cassini Trajectory Design\n\nThe Cassini mission to Saturn provides an example of the application of Tisserand\u2019s\ncriterion to the design of a gravity assist trajectory. The segments of the Cassini\ntrajectory that are of interest are from Earth to Jupiter and from Jupiter to Saturn.\nThe first step is to determine the encounter times at Jupiter and Saturn. An initial\nguess of the encounter times of Jupiter and Saturn is made based on the approximate\nflight times associated with a Hohmann transfer. Point-to-point conic solutions\nfor the trajectory segments from Earth to Jupiter and from Jupiter to Saturn are\ncomputed using the solution of Lambert\u2019s theorem. A point to point conic solution\nassumes zero mass for the planets and only the gravity of the sun is included. The\nsolution of Lambert\u2019s theorem gives the two-body conic connecting two position\nvectors where the flight time is known. The two position vectors are obtained from\nthe planetary ephemerides and the conic trajectory is computed from planet center\nto planet center as shown in Fig. 3.11.\nThe next step is to compute the velocity vectors relative to Jupiter, one for the\nincoming trajectory segment (vi) and one for the outgoing trajectory (vo). If the\nJacobi constants for the trajectory segments do not match, then the following\nprocedure can be used to find potentially viable encounter time solutions. The\nencounter time of Jupiter is fixed and the encounter times of Earth and Saturn\nare permitted to vary over a suitable range of times. For each pair of Earth\u2013\nJupiter encounter times and Jupiter\u2013Saturn encounter times, a Lambert solution is\ncomputed and the Jacobi constant is computed from the orbit elements. The Jacobi\nconstants for the two interplanetary trajectory legs are matched and the results are\ncross plotted in Fig. 3.12. Several approximations may be used for computing the\nJacobi constant. Results for Tisserand\u2019s criterion and the Jupiter energy criterion\nare shown in Fig. 3.12 as dashed lines. The Jupiter energy criterion (Eq. 3.62) is\nequivalent to matching the incoming and outgoing velocity magnitudes relative to\nJupiter. A criterion is used that matches the average of Tisserand\u2019s criterion and the\nJupiter energy criterion and is shown in Fig. 3.12 as the solid line. The equation for\nthis criterion, after simplification to remove constant parameters, is given by,\n\n\n\n3.3 Three-Body Trajectory 129\n\nFig. 3.11\nEarth\u2013Jupiter\u2013Saturn\nencounter\n\nSun\n\nJupiter\n\nVo\n\nVi\n\nSaturn\n\nEarth\n\nInterplanetary leg 1\nC1=f(a,e,i)\n\nInterplanetary leg 2\nC2=f(a,e,i)\n\n1\n\na1\n+ 2\n\n?\na1(1 ? e21)\n\n?3\ncos i1 ? v\n\n2\ni\n\nGMs\n\n? 1\na2\n\n+ 2\n?\n\na2(1 ? e22)\n?3\n\ncos i2 ? v\n2\no\n\nGMs\n(3.63)\n\nFor a given pair of Earth launch and Saturn encounter times indicated in\nFig. 3.12, the approach and departure velocity vectors at Jupiter are obtained and\nthe hyperbolic conic relative to Jupiter is computed. A preliminary assessment of the\nviability of the Jupiter centered hyperbola is performed. A trajectory that intersected\nthe surface of Jupiter, for example, or hits one of Jupiter\u2019s satellites would not be\nviable. Next, the encounter conditions at Earth and Saturn are examined for viability.\nIf the energy at Earth or Saturn is unacceptable, the trajectory is not viable. If a\nviable trajectory is not found for all the launch date encounter date pairs indicated\nby Fig. 3.12, the above procedure is repeated for another Jupiter encounter time.\n\nOnce a viable set of encounter times has been determined, a patched conic\ntrajectory is designed that connects Earth, Jupiter, and Saturn. The procedure\ninvolves computing the approach and departure velocity vectors at the patch points\n\n\n\n130 3 Trajectory Design\n\n2005\n\n2004\n\n2003\nJune 1 Jun 29\n\nEq.3.63\nCassini design\npoint Tisserand locus\n\n? Patched conic\n   solution\n\n?\n\n?\n0\n\n?\n\nJul 27\n\nEarth Encounter Date - 1999\n\nS\nat\n\nur\nn \n\nE\nnc\n\nou\nnt\n\ner\n D\n\nat\ne\n\nAug 24 Sep 21\n\nJupiter encounter\nDec 30, 2000\n\nJupiter energy \nlocus\n\nFig. 3.12 Earth\u2013Jupiter\u2013Saturn loci\n\nshown in Fig. 3.13 from the point-to-point conic solution. The two-body hyperbolic\ntrajectory is then computed with respect to each of the participating planets. For\nEarth and Saturn, the departure and approach target plane positions are given. A\nnew set of patch point positions relative to the Sun are computed. The states relative\nto Earth, Jupiter, and Saturn are added to the respective planetary ephemerides at\nthe appropriate times. The patch point times are selected such that the spacecraft\nposition is near the sphere-of-influence of the planets. The planetary ephemerides\nmay be computed from two-body orbit elements with respect to the Sun. This\nprocedure is repeated several times for the new patch points until a ballistic\ntrajectory is obtained from Earth to Saturn. It will be necessary to allow the Saturn\nencounter time to vary a small amount from the point-to-point solution. The results,\nshown in Fig. 3.12 for three launch dates, compare favorably with the point-to-\npoint solutions. Also, the Cassini design point, obtained by numerical integration, is\nshown in Fig. 3.12 for comparison.\n\nThe patched conic solution is used as a starting point for targeting an integrated\ntrajectory. A comparison of the Cassini integrated trajectory and the patched conic\nsolution is shown in Fig. 3.14. State vectors are computed from the patched conic\ntrajectory and differenced with state vectors obtained from the integrated Cassini\nephemeris. The magnitude of the position difference is plotted as a function of\ntime and the heliocentric range of the spacecraft is also plotted for comparison.\nThe maximum error is less than one percent of the heliocentric range. Since the\nperiod of the Saturn orbit is 29 years, an error of several months in the predicted\nencounter time at Saturn from the point-to-point conic solutions should be expected.\nThis error in computing the encounter times is exacerbated by accelerations from the\n\n\n\n3.4 Four-Body Trajectory 131\n\nJupiter\n\nSun\n\nEarth\n\nInterplanetary Leg 2\n\nInterplanetary Leg 1\n\nPatch Point 4\n\nPatch Point 3\n\nPatch Point 2\n\nPatch Point 1\n\nEncounter hyperbola\n(Earth centered)\n\nEncounter hyperbola\n(Jupiter centered)\n\nEncounter hyperbola\nSaturn centeredSaturn\n\nFig. 3.13 Earth\u2013Jupiter\u2013Saturn encounter\n\nthird body that has been ignored for the two-body computations. However, a design\nerror of only one percent enables a fairly accurate assessment of mission design\nconstraints from the conic solution.\n\n3.4 Four-Body Trajectory\n\nAn early investigation of flight to the Moon by V. A. Egorov in 1958 identified\nseveral problems relating to the design and navigation of translunar trajectories.\nThese included hitting the Moon, circumnavigation of the Moon with a return to\nEarth at a flat entry angle, using the Moon\u2019s gravity for assist in reaching the\nplanets, and the possibility of the Moon capturing a projectile launched from the\nEarth. Based on consideration of the three-body problem and its associated Jacoby\nintegral, solutions can be demonstrated for these problems with the exception of the\nMoon capturing a projectile launched from Earth. For the problem of lunar capture,\nEgorov concluded that the Moon could not possibly capture a projectile launched\nfrom the Earth on the first circuit of the trajectory no matter what initial conditions\nare specified. This conclusion was based on analysis of the three-body problem and\ndid not consider the Sun\u2019s gravity.\n\n\n\n132 3 Trajectory Design\n\n1E+010\n\n1E+009\n\n1E+008\n\n1E+007\n\n1E+006\n\n100000\n\n10000\n-2E+007 2E+007\n\nEarth\nEncounter\n\nSaturn\nEncounter\n\nJupiter\nEncounter\n\nConic Position Error\n\nRange to Spacecraft\n\n6E+007\n\nTime - seconds from Jan 1, 2000 12:00:00\n\nR\nan\n\ng\ne \n\nan\nd\n\n P\no\n\nsi\nti\n\no\nn\n\n E\nrr\n\no\nr \n\n- \nkm\n\n1E+008 1.4E+008\n\nFig. 3.14 Cassini conic design error\n\nThe first example of a ballistic trajectory of a spacecraft launched from the Earth\ninto orbit about the Moon was discovered in 1990 while analyzing a plan to salvage\nthe Muses A (Hiten) spacecraft in a highly eccentric orbit about the Earth. The\nkey to the discovery was the utilization of the Sun\u2019s gravity to affect the transfer\nto a lunar capture orbit. The result was a numerical solution to the restricted four-\nbody problem of the Earth, Moon, Sun, and a point mass spacecraft. Lunar transfer\ntrajectories that require analysis that goes beyond that provided by three-body theory\nand the Jacobi integral are referred to as four-body trajectories. Examples are Hiten,\nLunar A, and the Genesis return trajectory from the vicinity of the Moon to Earth.\nThese trajectory designs cannot be fully explained or analyzed using three-body\ntheory and the Jacobi integral. As is the case for the three-body problem, a complete\nanalytic solution of the four-body problem has not been obtained. Furthermore,\nan integral relationship similar to the Jacobi integral has not been found for the\nfour-body problem and the prospects for finding such an integral are dim. Current\ntheories, such as Weak Stability Theory, are explanatory and not predictive and\nthus cannot be used for design of trajectories that require a simultaneous four-body\nsolution without some intervention by the trajectory designer.\n\nIn the absence of a predictive four-body theory, the trajectory designer may use\nthe existing solution of the two-body problem and the Jacobi integral to piece\ntogether trajectory segments and achieve the desired result. Indeed, most lunar\ntransfer trajectory designs are obtained by patching together conic orbits where the\nEarth\u2019s gravity dominates to conic orbits where the Moon\u2019s gravity dominates. By\nextension, the trajectory segment dominated by the Earth, Moon, and spacecraft\nJacobi integral may be pieced together with the trajectory segment dominated by the\n\n\n\n3.4 Four-Body Trajectory 133\n\nSun, Earth, and spacecraft Jacobi integral to obtain continuous ballistic trajectories\nthat connect Earth departure or arrival with capture orbits about the Moon and the\nnearby Lagrange points.\n\n3.4.1 Moon Capture of Projectile Launched from Earth\n\nA spacecraft in a lunar capture orbit will approach the Moon in a nearly circular orbit\nabout the Earth that is just inside the Moon\u2019s orbit or just outside the Moon\u2019s orbit.\nAs the spacecraft approaches the Moon, the Moon\u2019s gravity provides the necessary\nacceleration to slow down or speed up the spacecraft depending on whether the\napproach orbit is inside or outside the Moon\u2019s orbit. If the spacecraft has just the\nright approach velocity, it is drawn into orbit about the Moon. The orbital mechanics\nof capture orbits are well documented in the literature. A spacecraft is placed in an\norbit that is loosely bound to the Moon and whose semimajor axis is just inside\nthe Moon\u2019s sphere of influence. The lunar periapsis is directed toward the Earth and\napoapsis is therefore directed away from the Earth. The orbit is integrated for several\nrevolutions about the Moon and if it remains captured the apoapsis altitude is raised\nslightly. A convenient orbit parameter for raising apoapsis is the eccentricity which\nwill tend to keep the energy of the orbit about the Moon constant. After several trys,\nthe spacecraft will escape from the Moon and enter into an orbit about the Earth.\nSince the equations of motion are reversible, a capture trajectory can be obtained by\nrepeating the above procedure only integrating the equations of motion backward.\n\nThe resulting capture orbits are generally nearly circular about the Earth and\neither inside or outside the Moon\u2019s orbit. For a critical value of the starting\neccentricity of the orbit about the Moon, the spacecraft will just escape the Earth\u2013\nMoon system and go into orbit about the Sun. Raising the eccentricity slightly\nwill result in an eccentric orbit with a periapsis radius relative to the Earth that\nis inside the Moon\u2019s orbit. The results of generating several capture orbits are\nshown in Fig. 3.15. For a range of starting eccentricities from 0.94151 to 0.943,\nmost of the capture orbits either escape from the Earth\u2013Moon system or fall into an\nuninteresting eccentric orbit about the Earth with periapsis radius less than that of\nthe Moon\u2019s orbit. This behavior of capture orbits including the reduction in periapsis\nradius with respect to the Earth has been observed and is common knowledge.\n\nA remarkable result was obtained during study of the Hiten trajectory during\nMemorial day weekend of 1990. If the starting eccentricity of the Moon\u2019s orbit was\nadjusted to 0.94171, the spacecraft falls into a highly eccentric orbit that returns\nto Earth as shown in Fig. 3.15. This was a surprising result, but Ed Belbruno was\nnot surprised because of his work with weak stability theory. Previous studies of the\npossibility of the Moon capturing a projectile launched from the Earth indicated that\nthis result was very improbable. Analysis by Fesenkov based on the Jacobi integral\nconcluded that this result was impossible. Egorov introduced a term not considered\nby Fesenkov that opened the possibility of capture after more than one circuit. He\nacknowledged that the Sun may provide a perturbation that could enable capture.\n\n\n\n134 3 Trajectory Design\n\nFig. 3.15 Examples of lunar\ncapture orbits\n\n-1.25 -0.75 -0.5 -0.25\n\n-0.5\n\n0.5\n\n1.0\n\n1.5\n\nY\n\nX\n\nCAPTURE\n\nEARTH\n\nSPACECRAFT\n\ne = 0.94151\n\ne = 0.94171\n\ne = 0.943\n\nSCALE = 1:1,000,000 km\n\nMOON\n\n0.25-1.0\n\nThe discovery of a capture orbit was not made by systematically perturbing\neccentricity, as suggested by Fig. 3.15, until the result was observed. The approach\nused in finding this orbit was from a different direction. In attempting to design\na trajectory for the Hiten spacecraft to get to the Moon, a bielliptic transfer was\nattempted. The idea was to design a capture orbit that escapes from the Earth\u2013Moon\nsystem and intersects a direct trajectory from Earth orbit. The capture trajectory was\nintegrated backward and the trajectory from Earth orbit was integrated forward. At\nthe intersection, a maneuver was performed to join the two trajectory segments.\nIt was soon discovered that an escape trajectory would not work. The velocity\ncorrection required at the intersection was too big. It was also observed that the\nminimum velocity at the intersection point near the boundary of escape to orbit\nabout the sun was about 250 m/s. While fine-tuning the eccentricity of the capture\norbit, it was observed that the velocity change began to drop. It became apparent\nthat the minimum velocity change was zero and the result was an orbit similar to the\norbit shown in Fig. 3.15.\nAttempts to extend the result shown in Fig. 3.15 to other initial orbit conditions\nrevealed a strong dependence on the location of the Sun relative to the Earth and\nMoon. Clearly, the tidal acceleration of the Sun was the vehicle for transforming a\nnearly circular orbit coincident with the Moons orbit into a highly eccentric orbit\nthat intersects the Earth. The affect of the Sun on the transfer trajectory can be seen\n\n\n\n3.4 Four-Body Trajectory 135\n\n-0.5 -0.5 1\n\n0.5\n\n0.5\n\n1\n\nY\n\nX\n\nAT CAPTURE\n\nCAPTURE\n\nSUN\n\nAT EARTH\nINJECTION\n\nEARTH\n\nSPACECRAFT\n\nSCALE\nSPACECRAFT 1:1,000,000 km\n\nMOON 1:1,000,000 km\nSUN 1:100,000,000 km\n\nMOON\n\n1\n\n1.5\n\n-1.0 1.5\n\nFig. 3.16 Earth\u2013Moon ballistic transfer\n\nfrom inspection of Fig. 3.16. Shown is an Earth to Moon ballistic transfer trajectory\nwith the orbit of the Sun in Earth-centered inertial coordinates superimposed. The\nSun\u2019s orbit has been reduced by a scale factor of 100. As the backward integrated\ntrajectory spirals outward from the Moon, the Sun is on the opposite side of the Earth\nfrom the spacecraft. The spacecraft is in the second quadrant near apoapsis while\nthe Sun is in the fourth quadrant. The net effect of the solar tide is to reduce the\nangular momentum sufficiently to lower periapsis radius to the radius of the Earth.\nReversing the direction of integration gives the desired lunar capture trajectory.\n\nThe lunar transfer trajectory from the Earth\u2019s surface to capture by the Moon\nmay be modified slightly to enable transfer from a variety of Earth orbits to lunar\ncapture. Also, Fig. 3.16 suggests that capture orbits may be designed to escape from\nthe Earth to the Sun\u2013Earth Lagrange points. With a little imagination, these capture\norbits may be pieced together with the Earth transfer trajectory to design orbits that\ngo from near Earth orbit to the Lagrange points briefly capturing the Moon along\nthe way. An example of a lunar capture transfer trajectory with modified initial\nconditions near Earth orbit is shown in Fig. 3.17. The spacecraft is launched into\nan elliptic staging orbit about the Earth with apoapsis radius that reaches the orbit\nof the Moon. The spacecraft remains in the staging orbit until the Sun is in the right\nposition for a lunar capture orbit. The spacecraft is timed to arrive at the Moon for a\n\n\n\n136 3 Trajectory Design\n\nlaunch\nAugust 20, 1997\n\nmoons orbit\napogee\n\nx\n\ny\n\nearth\nlunar orbit insertion\nFeb.1st, 1998\n\nfour and a half\nrevolutions\n\n1st lunar swingby\nOct. 10, 1997\n\nFig. 3.17 Proposed Lunar A Mission transfer trajectory\n\ngravity assist that places the spacecraft on the capture orbit. Figure 3.17 displays the\ncharacteristic kidney shape often associated with the 3-month variety of the capture\norbit.\n\n3.4.2 Angular Momentum and Energy Management\n\nAn important tool for design of lunar capture orbits is the management of angular\nmomentum. Raising of the periapsis radius of the Earth-centered orbit from near\nthe surface of the Earth to the radius of the Moon\u2019s orbit requires the addition of\nangular momentum to the orbit. This requires placing the spacecraft in a region\nof space where the angular momentum rate of increase from the solar tide can\nraise the angular momentum to that required for capture. The energy and angular\nmomentum management is accomplished by starting from a lunar capture orbit\nwith the correct angular momentum and energy (approximately the same as the\nMoon) and integrating backward to a region of space where the angular momentum\nis reduced to a small enough value to intersect the Earth\u2019s surface. The spacecraft\nthen falls back to the Earth and the energy required is supplied by the launch vehicle\nwhen the direction of integration is reversed.\n\nThe angular momentum of the orbit relative to the Earth is given by\n\nh = ?p GMe (3.64)\n\n\n\n3.4 Four-Body Trajectory 137\n\nwhere p is the parameter of orbit and GMe is the Earth\u2019s gravitational constant.\nFor a spacecraft launched from the Earth that nearly escapes the Earth\u2013Sun system,\nthe orbit is nearly parabolic and p is approximately twice the radius of the Earth\n(12,000 km). At lunar capture, p is approximately the radius of the Moon\u2019s orbit\n(384,000 km). Equation (3.64) requires raising the angular momentum (h) from\n69,000 km2/s to 390,000 km2/s, a net increase of 321,000 km2/s.\n\nThe angular momentum orbit parameter (h) is the magnitude of the angular\nmomentum vector given by,\n\nh = r \u00d7 v\n\nConsider an Earth-centered rotating coordinate system with the x axis pointing at\nthe Sun and the z axis in the direction of the orbit angular momentum vector. The\ngeometry is shown in Fig. 3.18. Neglecting the rotation about the Sun and the tidal\nacceleration of the Moon, the rate of change of angular momentum is given by\n\nh? = r? \u00d7 v + r \u00d7 v? (3.65)\n\nwhere\n\nr = (x, y, 0)\nr? = v = (x?, y?, z?)\n\nv? = (ax, 0, 0)\n\nCarrying out the indicated substitutions, the angular momentum rate is approxi-\nmately\n\nh? = ?y ax (3.66)\n\nThe tidal acceleration (ax) is approximately in the x direction since the Sun is far\nfrom the Earth at the scale shown in Fig. 3.18. The tidal acceleration of the Sun is\nsimply the difference between the acceleration of the spacecraft and the acceleration\nof the Earth caused by the Sun\u2019s gravity and\n\nax = GMs\n(rs + x)2 ?\n\nGMs\n\nr2s\n\nwhich may be approximated by\n\nax = ax(x = 0) + dax\ndrs\n\n?x\n\nax = 2GMs\nr3s\n\nx\n\n\n\n138 3 Trajectory Design\n\n2E+006\n\n1E+006\n\n-1E+006\n\n-2E+006\n-2E+006 -1E+006 0\n\nY\n\nX\nEarth Sun\n\n.25\n\n.25-.25\n\n-.25\n.20\n\n.20-.20\n\n-.20\n.15\n\n.15-.15\n\n-.15\n.10\n\n.10-.10\n\n-.10\n\n.05\n\n.05\n-.05\n\n-.05\n\n1E+006 2E+006\n\nDistance from Earth along Sun line - km\n\nD\nis\n\nta\nnc\n\ne \nfr\n\nom\n E\n\nar\nth\n\n n\nor\n\nm\nal\n\n to\n S\n\nun\n li\n\nne\n -\n\n k\nm\n\n0\n\nFig. 3.18 Sun\u2013Earth angular momentum transfer contours\n\nSubstituting into the equation for angular momentum rate (Eq. 3.66) yields\n\nh? = ?2GMs\nr3s\n\nx y (3.67)\n\nEquation (3.67) is the equation for a hyperbola as a function of x and y. A family of\nhyperbolas are plotted in Fig. 3.18 for various values of the angular momentum rate\nin the units of km2/s2. As an example of the application of the angular momentum\ncontours, consider a spacecraft launched from Earth into the second or fourth\nquadrant of Fig. 3.18 where the angular momentum rate attributable to the solar\ntide is positive. At coordinate x = 1, 400, 000 km and y = ?750, 000 km, the\nangular momentum rate of increase is 0.084 km2/s2. In order to raise the periapsis\nradius from the Earth surface to the radius of the Moon\u2019s orbit, an increase in\nangular momentum of 321,000 km2/s is required. Thus, the spacecraft would need\nto dwell near the indicated coordinates for 3,821,000 s or about 44 days. The actual\ntime required to achieve the required angular momentum increase can be obtained\nby performing a line integral along the actual flight path and include the tidal\nacceleration of the Moon. For an actual trajectory integration, the average value\nof the angular momentum rate would be about half the value used in this example\nand the Moon\u2019s tidal acceleration contribution would be small. The total flight time\nis therefore approximately 90 days.\n\n\n\n3.4 Four-Body Trajectory 139\n\n1E+006\n\n-1E+006\n1.5E+006\n\n500000\n\n-500000\n\n-500000 500000\n\nX - km\n\nY\n -\n\n k\nm\n\n0\n\nGenesis\n\nBallistic\nCapture\n\nFig. 3.19 Ballistic capture and angular momentum contours\n\n3.4.3 Genesis Earth Return Trajectory\n\nThe Genesis return trajectory starts from a Lagrange point and flies by the orbit of\nthe Moon on a trajectory that is nearly captured and proceeds on a transfer orbit\nto the Earth. The portion of the orbit from near the Moon\u2019s orbit to the Earth is an\nexample of a four-body transfer. The Genesis return trajectory is plotted in Fig. 3.19\nalong with the ballistic capture trajectory. The coordinate frame is the same as\nshown in Fig. 3.18 with the Earth at the center and the Sun in the +x direction. Both\ntrajectories go from the vicinity of the Moon\u2019s orbit to the Earth. In the rotating\ncoordinate system, both trajectories execute a slow loop in the first quadrant where\nthe maximum rate of angular momentum removal is about 0.1 km2/s2 as indicated\nby the hyperbolic contours shown in Fig. 3.18. The Genesis trajectory experiences\na higher rate of angular momentum removal in the first quadrant which is partially\nrestored in the fourth quadrant where the sign changes to positive. The total angular\nmomentum removal is about the same for both trajectories which is characteristic\nof the four-body transfer.\n\nSince the trajectories shown in Fig. 3.19 are initiated at different times, the\nposition of the Moon in its orbit relative to the Genesis trajectory is not clear.\nThe ballistic capture orbit originates at the Moon. The Genesis trajectory in the\nvicinity of the Moon\u2019s orbit comes under significant influence of the Moon\u2019s gravity.\nThe boundary between domination by Earth\u2013Sun gravity and domination by Earth\u2013\nMoon gravity is a region of space that has been referred to as the Weak Stability\nBoundary.\n\n\n\n140 3 Trajectory Design\n\n1E+006\n\n-1E+006\n\n-1.5E+006\n-1.6E+006 -1.2E+006 -800000 -400000\n\nX - km\n\nEarth Moon\n\nGenesis\n\nBallistic\nCapture\n\nY\n -\n\n k\nm\n\n4000000\n\n500000\n\n-500000\n\n0\n\nFig. 3.20 Comparison of genesis orbit with ballistic capture\n\nIn order to gain some insight into the behavior of the trajectory dynamics near\nthe Moon\u2019s orbit, a coordinate transformation is performed to a rotating coordinate\nsystem centered at the Moon with the +x axis in the direction of the Earth\u2013Moon\nvector and the z axis in the direction of the angular momentum vector. The Genesis\nreturn trajectory and the ballistic capture orbit4 are plotted in this coordinate system\nas shown in Fig. 3.20. The departure from the vicinity of the Moon of the two\ntrajectories are essentially the same. The motion near the Moon requires further\ninvestigation. The ballistic capture orbit enters into a close capture orbit of the Moon\nand the Genesis trajectory comes within 300,000 km of the Moon and executes a\nstrange loop.\n\n3.4.4 Jacobi Integral and Capture\n\nWhen the spacecraft comes close to the Moon, the tidal perturbation from the Sun\nis small compared to the perturbations from the Moon and Earth. In this region\nof space, the trajectory may be analyzed using restricted three-body theory. In the\nrotating primed coordinates, a certain integral relating to the energy of the point\nmass, referred to as the Jacobi Integral, is constant. The Jacobi integral in the\nrotating coordinate frame is given by\n\nx??2 + y??2 + z??2 = ?2x?2 + ?2y?2 + 2GM1\nr1\n\n+ 2GM2\nr2\n\n? C (3.68)\n\n\n\n3.4 Four-Body Trajectory 141\n\nFig. 3.21 Jacobi zero velocity contours\n\nConsider a point mass or spacecraft moving with zero velocity relative to the\nmassive bodies. In inertial space, the rotation of both massive bodies about each\nother is ?. For zero velocity relative to the massive bodies, the Jacoby integral\nreduces to\n\n?2x?2 + ?2y?2 + 2GM1\nr1\n\n+ 2GM2\nr2\n\n= C (3.69)\n\nA spacecraft moving with velocity or kinetic energy that is small compared to the\ngravitational potential energy will tend to move in a direction that keeps C constant.\nThus, contours of constant C will describe the motion in the rotating coordinate\nframe. Contours of constant C, referred to as Jacobi zero velocity contours or Hill\u2019s\nsurfaces, may be plotted in rotating coordinates as shown in Fig. 3.21. The familiar\nzero velocity contours are for two massive bodies that are of the same order of\nmagnitude in mass. The five stable Lagrange points are labeled as L1 through L5.\nA spacecraft placed at one of the stable Lagrange points will stay there unless\nperturbed by some external force. The zero velocity contours suggest other stable\n\n\n\n142 3 Trajectory Design\n\n600000\n\n400000\n\n200000\n\n\u2013200000\n\n\u2013400000\n\n\u2013600000\n\u2013200000 \u2013100000\n\nL5 Region\n\nL4 Region\n\nGenesis\n\nBallistic\nCapture\n\n100000 2000000\nX \u2013 km\n\nY\n \u2013\n\n k\nm\n\n0\n\nFig. 3.22 Genesis and ballistic capture orbits with Jacobi contours\n\ntrajectories such as circular orbits about the massive bodies, a circular orbit about the\ncenter of mass and outside the orbits of the massive bodies, and circumnavigation of\none massive body and return to the other on a free return trajectory. It also appeared\nto Fesenkov and Egorov that a direct trajectory from one body to a close orbit about\nthe other would not be possible because of the stricture near L1.\n\nThe zero velocity contours for the Earth\u2013Moon system are highly distorted from\nthe contours shown in Fig. 3.21. Since the Earth is about 80 times more massive than\nthe moon, the teardrop regions around L4 and L5 encircle the Earth and are joined\nthrough L3. A spacecraft in orbit near L4 or L5 can migrate back and forth between\nL4 and L5 through L3 without encountering the Moon. A trajectory of an asteroid\nin the Earth\u2013Sun system has been recently discovered that exhibits this motion.\n\nThe actual zero velocity contours for the Earth\u2013Moon system in the vicinity of\nthe Moon are shown in Fig. 3.22. Also, plotted are the Genesis return trajectory\nand a ballistic capture orbit. As both orbits approach zero velocity relative to the\nEarth\u2013Moon rotating frame, they fall onto the same Jacobi contour indicating that\nthe orbits have essentially the same Jacobi constant or energy. The bifurcation that\nseparates the two trajectories on departure from the Moon\u2019s orbit is a property of\nchaotic trajectories.\n\n\n\n3.5 NEAR Orbit Phase Trajectory Design 143\n\n3.5 NEAR Orbit Phase Trajectory Design\n\nTrajectory design of the orbit phase of the Near Earth Asteroid Rendezvous (NEAR)\nmission involves procedures that depart significantly from those used for previous\nmissions. On previous missions, the trajectory design involved finding a flight path\nthat satisfied a rigid set of spacecraft and mission design constraints. A precise\nspacecraft trajectory was designed well in advance of arrival at the target body.\nFor NEAR, the uncertainty in the dynamic environment did not permit a precise\nspacecraft trajectory to be defined in advance of arrival at Eros. The principal cause\nof this uncertainty is limited knowledge of the gravity field and rotational state of\nEros. As a result, the concept for NEAR trajectory design was to define a number\nof rules for satisfying spacecraft and mission constraints and to apply these rules to\nvarious assumptions for the model of Eros.\n\n3.5.1 Spacecraft and Mission Constraints\n\nThe spacecraft constraints that apply to Eros trajectory design include limits on\nfuel consumption, solar panel illumination, and momentum wheel management.\nOther constraints define the flexibility and speed with which mission operations may\nbe conducted. Probably the most important spacecraft constraint is to perform the\nprime mission within the allocated propellant budget. The propellant consumption\nconstraint translates into about a 50\u2013100 m/s delta velocity change during the orbit\nphase of the primary mission. This was a fairly generous allocation and was not\ndifficult to satisfy.\n\nThe most difficult spacecraft constraint to satisfy relates to solar panel illumi-\nnation. Since the science instruments are fixed with respect to the spacecraft body,\nit is necessary to tum the spacecraft to point these instruments at Eros. In order\nto satisfy spacecraft power requirements, the solar panels cannot be turned more\nthan about 30? off the Sun-line. If the angle between the line to nadir and the plane\nperpendicular to the Sun-line is greater than 30?, the nadir point cannot be imaged\nwithout turning the spacecraft more than 30?. A coordinate frame is defined with the\nz axis pointing away from the Sun and the equatorial or x-y plane perpendicular to\nthe Sun-line and is referred to as the Sun Plane-Of-Sky (POS) coordinate frame. In\nthe Sun POS coordinate frame, orbits with inclination less than 30? direct or greater\nthan 150? retrograde will not violate the solar panel constraint permitting imaging\nof nadir from any point in the orbit.\n\nAnother important constraint relates to the time to conduct mission operations.\nIn order to conduct the mission smoothly without resorting to round the clock\noperations, the minimum time between spacecraft propulsive maneuvers is limited\nto 1 week. The real limitation is the time to compute accurate orbit determination\nsolutions in support of propulsive maneuvers that are required to keep the spacecraft\non course. The differential velocity change resulting from maneuver execution\n\n\n\n144 3 Trajectory Design\n\nerrors corrupts the orbit solution. A rapid redetermination of the orbit places a\nlarge amount of pressure on the Mission Operations team to deliver accurate data\nand process this data into reliable solutions for the spacecraft orbit. By allowing a\nminimum of 1 week between maneuvers, this pressure is considerably reduced. A\nfurther benefit is that the amount of data available for the orbit solution is increased\nand the data quality is increased. The more maneuvers that are performed, the\nmore the orbit is corrupted and the more the quality of science is compromised.\nIn addition, more risk to the mission is incurred because of poor trajectory control.\n\nA trajectory design constraint related to orbit stability is that all low-inclination\norbits retrograde with respect to the asteroid equator. Retrograde orbits are more\nstable because the faster relative motion of the spacecraft with respect to the asteroid\ntends to average out the effects of gravity harmonics. For this reason, synchronous\ndirect orbits are particularly unstable since the spacecraft lingers over the same point\non the asteroid\u2019s surface and may exchange enough energy to escape from or collide\nwith the asteroid. In low orbit, even retrograde synchronous orbits may be unstable.\n\nScience constraints on the trajectory design take the form of desires to obtain\nsome particular orbital geometry and are generally not easily quantified. The\nrequirement of the gamma ray spectrometer to obtain low-altitude orbits drove the\ntrajectory design to achieve these orbits in a timely manner. The plan to stage the\ntrajectory through a series of successively smaller circular orbits seems to satisfy\nmost science and navigation requirements and makes the trajectory relatively simple\nto design. The general plan is to spend a specified amount of time in a series of\ncircular orbits of predetermined radius. This keeps the mission on schedule and\nenables a general imaging or mapping plan to apply for any Eros gravity field that\nmay be encountered. Transfer orbits between the circular orbits may also provide\na unique opportunity for science observations from a perspective different from the\ncircular orbits. However, the need to get to desired circular orbits may also make\nthe transfer orbits unattractive for science. In any event, the transfer orbits need to\nbe designed to achieve circular orbits and only limited science constraints can be\naccommodated in these orbits.\n\n3.5.2 Targeting Strategy\n\nThe general approach to the targeting strategy is to develop a broad set of objectives\nand compute a series of propulsive maneuvers that will steer the spacecraft in the\ndirection of satisfying these objectives. This differs substantially from the traditional\napproach of defining a number of constraints and searching for the trajectory that\nglobally maximizes some performance index. The NEAR approach is to compute a\nmaneuver that satisfies a local set of constraints and then propagate the trajectory\ninto the future. At the appropriate time, a minimum of 1 week in the future, the\nconstraints are reevaluated and another maneuver is computed. This strategy is\nrepeated until all the science objectives are achieved.\n\n\n\n3.5 NEAR Orbit Phase Trajectory Design 145\n\nThe spacecraft is first placed in an orbit that is in the Sun POS. The solar panel\nillumination constraint dictates that the spacecraft remain close to this plane for\nmost of the mission. Otherwise, the solar panels would have to be turned too far\noff the Sun-line in order to image nadir. Also, staying in this plane for the first few\nweeks of the mission will minimize the effect of solar pressure on the trajectory and\non the attitude control momentum management. This is particularly important at\nhigh altitudes where the solar pressure acceleration is a large contributor to the total\nacceleration and is much easier to model when the spacecraft is pointed directly at\nthe Sun.\n\nAt the time of arrival at Eros, the spin axis of Eros is pointed away from the\nSun. Since the Sun POS coordinate frame z axis also points away from the Sun, a\nretrograde orbit in the Sun POS will also retrograde in the asteroid equator. This\nis the direction that is established for the initial orbits. As Eros moves in its orbit\nabout the Sun, the Eros spin axis first points away from the Sun, then perpendicular\nto the Sun-line, and then toward the Sun. The spin axis, which remains essentially\nfixed in inertial space, appears to rotate in the Sun POS frame. During the time that\nthe spin axis is pointed almost directly away from the Sun, a retrograde orbit in the\nasteroid equator will be close to being in the Sun POS and thus suitable for imaging\nEros without turning far off the Sun-line. Retrograde equatorial orbits are generally\nvery stable and thus the orbit altitude may be lowered to 35 km for gamma ray\nspectrometer observations. As the Eros spin axis aligns perpendicular to the Sun-\nline, the Sun POS orbit results in a polar orbit with respect to Eros. This is also a\nstable orbit. A problem occurs when the Eros spin axis is about 45? off the Sun-\nline. For these orbits, the node of the orbit plane with respect to the asteroid equator\nprecesses at a fast rate sometimes approaching 5? per day. During this transition\nzone, the spacecraft orbit must be actively controlled with maneuvers to keep the\nspacecraft within 30? inclination of the Sun POS. As Eros spin axis rotates from\nperpendicular to the Sun POS to near alignment with the direction toward the Sun, it\npasses through another transition region and then is placed in a retrograde equatorial\norbit for the second time. This orbit is direct with respect to the Sun POS. Therefore,\nat the time the spacecraft is in the polar orbit and the Eros spin axis crosses the Sun\nPOS, it is necessary to execute a \u201cplane flip\u201d maneuver sequence to reverse the\ndirection of the Sun POS orbit from retrograde to direct. When this sequence is\ncompleted, the Eros equator orbit remains polar.\n\n3.5.3 Targeting Algorithm\n\nThe trajectory design is accomplished by transforming the targeting strategy into a\nspecific step-by-step procedure referred to as the targeting algorithm. The general\napproach is first to translate spacecraft and science constraints to geometrical param-\neters that may be computed directly from the spacecraft trajectory about Eros. When\nnecessary, propulsive maneuvers are targeted to these trajectory-related geometrical\nparameters and spacecraft and science constraints are implicitly satisfied. Therefore,\n\n\n\n146 3 Trajectory Design\n\nthe success of the targeting strategy depends on the ability to define geometrical\nparameters that relate directly to mission constraints. The geometric parameters of\ninterest that may be closely related to mission constraints are distances from Eros\nand angular positions of various celestial bodies with respect to Eros. A problem\nwith these angles and distances is that they vary rapidly as the spacecraft orbits Eros\nand are thus difficult to target. For the targeting to be successful, a set of parameters\nthat vary slowly with time need to be defined. A convenient set of parameters\nare classical orbit elements. The classical elements describe the size, shape, and\norientation of a spacecraft orbit about a central body that may be represented as\na point mass. As long as the spacecraft acceleration is dominated by the central\ngravity, the classical orbit elements do not vary significantly. This was true during\na large part of the NEAR mission. In high orbits, the solar pressure becomes a\nsignificant perturber relative to the central body gravity and in low orbits the gravity\nharmonics cause the classical orbit elements to osculate. However, we may use\nthe osculating orbit elements as short-term predictors of spacecraft motion and\nthus control the trajectory and satisfy mission constraints by targeting to these\nparameters.\n\nThe classical orbit parameters of interest for targeting the NEAR trajectory may\nbe separated into several general categories. The first category describes the size\nand shape of the orbit which relates directly to energy and angular momentum.\nThe radius of periapsis and radius of apoapsis may be used to control the size and\nshape of the orbit. These parameters also implicitly control the period of the orbit.\nThe second category describes the orientation of the orbit in inertial space. The\nlongitude of the ascending node, argument of periapsis, and inclination orient the\norbit in inertial space. These angles may be computed in either the Sun POS or\nasteroid equator coordinate frames. The solar panel illumination constraint may be\nsatisfied by keeping the inclination in the Sun POS coordinate frame less than 30?.\nThe asteroid equator coordinate frame may be used to target polar or low-inclination\norbits. The final category of orbit parameters, obtained by solution of Kepler\u2019s\nequation, are the times that the spacecraft arrives at various points in the orbit.\nThe true anomaly of the spacecraft, which is the angle measured from periapsis,\nis also included in this category. These points are candidate maneuver placements.\nThe times of periapsis, apoapsis, and crossings of the line of nodes or reference\nplanes are of interest for maneuver placement. In addition to the classical elements,\nthe Cartesian components of position and velocity in various coordinate frames may\nbe used as target parameters. Also, the Cartesian components may be mixed with\nclassical elements to define target parameter sets.\n\nThe first step of the targeting algorithm is to determine the time of the next\npropulsive maneuver. The spacecraft orbit is propagated into the future and the\nvalues of the target parameters are computed. If a constraint is violated or a point is\nreached in the mission where it is desirable to change the orbit size or orientation, a\ncomplete set of orbit elements is displayed which describes the local region of the\ntrajectory. We assume that the orbit elements are osculating slow enough that the\nconic trajectory propagation is sufficiently accurate. The conic orbit propagation is\ngenerally good for several orbits. A suitable maneuver placement point is selected\n\n\n\n3.5 NEAR Orbit Phase Trajectory Design 147\n\nwhich is normally at periapsis, apoapsis, or the crossing of some reference plane.\nA precision trajectory is propagated to the nominal maneuver time obtained by\nsolution of Kepler\u2019s equation. The osculating orbit elements are reevaluated and a\nfew iterations may be required to determine the precise time of maneuver placement.\n\nThe next step is to select three target parameters that describe the post maneuver\norbit. These parameters must be independent and include the maneuver point on\nthe post maneuver orbit. The independence of the parameters may be verified by\ndetermining that the Jacoby matrix is nonsingular. For example, the parameters\nperiapsis radius, apoapsis radius, and eccentricity would not be independent because\neccentricity may be determined from the other two. However, the parameters\nperiapsis radius, apoapsis radius, and inclination are independent and would be\nsuitable for targeting. The inclusion of the maneuver point on the post maneuver\norbit is a subtle condition to satisfy. An example would be transfer to a 35 km\ncircular orbit from a maneuver placement at 50 km. Clearly, this would not be\npossible because the 35 km orbit would not contain any point at 50 km. A more\nsubtle example would be transfer to zero inclination. For this target parameter to\nconverge, the maneuver placement point would have to be in the reference plane.\n\nThe third step is to determine the time to evaluate the target parameter con-\nstraints. Most of the time, this is immediately after the maneuver. However, for\nsome orbits that are osculating severely, the constraints may be evaluated sometime\nin the future where it is desired to control some parameter of particular interest.\nFor example, if we are trying to control the precise periapsis radius, the constraint\nmay be evaluated at the nominal time of periapsis passage several orbits after the\nmaneuver thus forcing the minimum radius to occur at this time.\n\nThe final step is to determine the finite burn velocity correction that satisfies\nthe constraint parameters. The matrix of partial derivatives that relate the target\nparameters to the maneuver velocity components is computed by finite difference\nfrom precision trajectory propagations. This 3 by 3 matrix is inverted and multiplied\ntimes the required target parameter correction to obtain the delta velocity correction.\nThe Newton-Raphson iteration is repeated several times until the desired target\nparameters are achieved.\n\n3.5.4 NEAR Trajectory Design\n\nThe design of the NEAR orbit phase trajectory involves repeated application of the\nabove targeting algorithms. The orbit phase begins after a series of rendezvous burns\nthat slow the spacecraft down from an approach speed of about 1 km/s\u20135 m/s. The\nNEAR orbit phase trajectory is divided into 27 segments beginning with the Eros\nOrbit Insertion (EOI) maneuver (segment 0). Each segment begins with an OCM\nand the final segment ends on February 6, 2000, the nominal end of the mission.\n\n\n\n148 3 Trajectory Design\n\n3.5.5 Approach Through 100 km Orbit\n\nAn orbit insertion maneuver is performed at closest approach to transfer the\nspacecraft from an approach hyperbola with a periapsis radius of 1000 km to a\nhighly eccentric ellipse with a periapsis radius of 400 km as shown in Fig. 3.23.\nWhen the spacecraft arrives at 400 km radius, a maneuver is executed to transfer\nthe spacecraft to an orbit with a periapsis radius of 200 km. At 200 km radius, the\norbit is circularized and science observations are carried out for about 9 days. Two\nmore maneuvers are executed to lower the spacecraft orbit to 100 km. The projection\nof the spacecraft orbit into the Sun POS coordinate frame is shown in Fig. 3.23\nfor the initial orbits through 100 km radius. The view is from behind Eros looking\ntoward the Sun. The spacecraft moves in a retrograde (clockwise) direction while\nthe Eros rotation is counterclockwise when viewed from this direction. The initial\norbit following the orbit insertion burn is in the Sun POS with a radius of periapsis\nof 400 km. The approach trajectory is targeted to cross the Sun POS at a radius of\n1000 km periapsis on the side of Eros that results in a retrograde orbit. The orbit\ninsertion bum is placed at the point where the approach hyperbola pierces the Sun\nPOS; that is, the plane perpendicular to the Sun-line that passes through the center\nof Eros. The target parameters are radius of periapsis, true anomaly, and inclination\nin the Sun POS.\n\nThe target parameter constraints are computed on Jan 20, 1999 16:00:00. This\ntargeting strategy provides a 10-day separation between maneuvers and results in\nthe spacecraft arriving at a periapsis radius of 400 km on January 20 in an orbit with\nan inclination of 178? in the Sun POS. A 178? inclination orbit with respect to the\nSun POS is 2? inclination retrograde or very nearly in the Sun POS. By targeting\nto orbit elements evaluated on January 20, 1999, the effect of solar pressure on the\norbit elements was mitigated.\n\nThe first orbit correction maneuver (OCM) is placed at periapsis of the initial\ntransfer orbit. This maneuver is targeted to a periapsis radius of 200 km, apoapsis\nradius of 400 km, and inclination of 177? in the Sun POS. OCM 2 is also performed\nat periapsis using the same targeting strategy and circularizes the orbit at 200 km\nradius.\n\nAfter 9 days, which is about one revolution in the 200 km orbit, a transfer orbit\nis computed to lower the spacecraft orbit to 100 km. At this time, the Sun POS\ninclination is about 171?. Recall that the Sun POS coordinate frame rotates as Eros\norbits about the Sun and the orbit plane tends to remain fixed with respect to inertial\nspace. In order to keep the spacecraft in the Sun POS, we must perform the orbit\ncircularization maneuver at 100 km in the Sun POS. This may be accomplished by\nbiasing the transfer orbit to a periapsis altitude of 84 km such that the spacecraft is\nat 100 km radius when the spacecraft crosses the Sun POS. This little trick saves a\nmaneuver and the spacecraft orbit is circularized with another maneuver placed at\nthe point where the spacecraft crosses the Sun POS at 100 km. In order to maintain 1\nweek separation between maneuvers, the spacecraft remains in the 200 km by 84 km\ntransfer orbit for 2 and one half revolutions about Eros. The period of this transfer\norbit is 5 days.\n\n\n\n3.5 NEAR Orbit Phase Trajectory Design 149\n\n800\n\n600\n\n400\n\n200\n\n0\n\n-200\n\n-400\n-1200 -1000 -600 -400 -200 0 200 400-800\n\nFig. 3.23 Approach through 100 km orbit\n\n3.5.6 Subsolar Overfly Through 50 km Orbit\n\nAn important science objective is to obtain infrared images of Eros at low phase\nangle. In order to obtain these images, it is necessary to place the spacecraft in\nan orbit that overflies the subsolar point. This may be accomplished by raising the\ninclination in the Sun POS coordinate frame to 90?. A convenient time to perform\nthis over flight is early in the mission from the 100 km orbit. After the subsolar\noverfly, the spacecraft is parked in an elliptical transfer orbit for a week before\nthe orbit is circularized at 50 km radius. Figure 3.24 shows the projection of the\nspacecraft trajectory in the Sun POS for the subsolar overfly through the initial\n50 km circular orbit.\n\nOCM 5 is targeted for overfly of the subsolar point. An orbit that flies over\nthe subsolar point will also fly over the point opposite from the subsolar point or\nthe anti-subsolar point. Therefore, if left in this overfly orbit, the spacecraft will\nfly through the shadow of Eros and violate an important spacecraft constraint to\nkeep the solar panels illuminated. In order to avoid flying through the shadow and\nmaintain 1 week separation between maneuvers, the spacecraft is placed in an orbit\nthat flies over the subsolar point at a radius of about 150 km and continues out to an\napoapsis altitude of about 500 km. The apoapsis radius is selected to give an orbit\nperiod of 2 weeks. After 1 week, at the point where the spacecraft crosses the Sun\nPOS, OCM 6 is targeted for an elliptical return trajectory in the Sun POS and at a\nperiapsis radius of 100 km. The periapsis radius of the return trajectory is selected\nto be 100 km in order to avoid being on an impact trajectory should the maneuver\nexecution error associated with OCM 6 exceed the required accuracy. On return\nto periapsis, the spacecraft is parked in a 170 km by 50 km elliptical orbit for 1\nweek. This orbit is a compromise that enables the circular 50 km orbit to return to\n\n\n\n150 3 Trajectory Design\n\n200\n\n100\n\n-100\n\n0\n\n-200\n\n-300\n\n-400\n\n-500\n\n-600\n-500 -400 -200 -100 0 100 200 300 400 500-300\n\nFig. 3.24 Subsolar overfly through 50 km orbit\n\nthe Sun POS and avoids some of the rapid precession of the nodes associated with\nthe 50 km orbit at this time. The spacecraft is then placed in a circular 50 km orbit\nwhere it remains until the Eros spin vector comes into favorable alignment for an\nequatorial orbit about Eros with a low inclination in the Sun POS. OCMs 6 through\n9 are all targeted to radius of periapsis, radius of apoapsis, and inclination in the Sun\nPOS.\n\n3.5.7 Transfer to Southern Illuminated 35 km Orbit\n\nA major science objective of the NEAR mission is to obtain low altitude gamma\nray and x-ray spectrometer measurements of Eros. From a 35 km orbit, Eros fills\nthe field of view and long integration times are required to obtain the data needed\nto characterize the composition of Eros. Figure 3.25 shows the projection of the\nspacecraft orbit on the Sun POS for the transfer orbit from 50 Ian to 35 km and the\n35 km orbit.\n\nOCM 9 is targeted for an elliptic transfer orbit from the 50 km circular orbit to a\n35 km circular orbit. The actual dimensions of the nominal transfer orbit is 54 km by\n32 km. For these low orbits, the conic elements are osculating such that the actual\ndimensions of the orbit vary in a complicated way. The dimensions of the orbit\nare contained by targeting the energy and angular momentum. The orbit elements\nperiapsis and apoapsis radius are used to control energy and angular momentum.\nThe orbital distances and velocity are controlled implicitly by managing energy and\nangular momentum. Even the energy and angular momentum are not conserved with\nrespect to the two-body motion of the spacecraft about Eros. The gravity harmonics\n\n\n\n3.5 NEAR Orbit Phase Trajectory Design 151\n\nFig. 3.25 Transfer to southern illuminated 35 km orbit\n\nact to exchange energy between the spacecraft orbit and Eros\u2019s rotation. In some\ncases, the gravity harmonics may act to eject the spacecraft from Eros orbit. The\nspacecraft actually receives a gravity assist from the gravity harmonics and the\nrotation of Eros. The basket weave appearance of the orbit shown in Fig. 3.25 is\ncaused by the rapid precession of the spacecraft orbit about Eros in inertial space\nand not by some artifact of a rotating coordinate system. After one month in the\nelliptic transfer orbit, the orbit is circularized at 35 km radius with OCM 10. For the\ntransfer orbit and 35 km circular orbit, the target parameters are radius of periapsis,\nradius of apoapsis, and inclination in the Eros equatorial coordinate frame.\n\n3.5.8 Active POS Control, Polar Orbits, and Plane Flip\n\nThe projection of the spacecraft orbit on the Sun POS for the period of active POS\ncontrol through the polar orbits and plane flip maneuver are shown in Fig. 3.26.\n\nAs Eros moves in its orbit about the Sun, the Eros equatorial plane rotates from\nalignment with the Sun POS to being perpendicular to the Sun POS and back to\nalignment. This rotation of the planes with respect to one another occurs because\nthe Eros spin axis remains fixed in inertial space while the Sun POS coordinate\nframe slowly rotates with Eros in its orbit around the Sun. During the time of the\n35 km equatorial orbits, these planes are nearly aligned. As they change to an angle\ngreater than about 30?, it is no longer possible to stay in an Eros equatorial orbit and\nat the same time satisfy the Sun constraint defined in the Sun POS. During the time\nthat the angle between these planes is about 30\u201360?, the precession of the orbit about\n\n\n\n152 3 Trajectory Design\n\n200\n\n100\n\n\u2013100\n\n0\n\n\u2013200\n\n300\n\n400\n\n500\n\n\u2013600 \u2013500 \u2013400 \u2013200 \u2013100 0 100 200 300 400\u2013300\n\nFig. 3.26 Active POS control, polar orbits, and plane flip\n\nthe Eros equator causes the Sun constraint to be violated if left unattended. Active\nPOS control must be executed to prevent the Sun constraint from being violated.\nEventually, the angle between the planes approaches 90? and the spacecraft orbit\nmay be transferred to a polar orbit with respect to Eros and at the same time satisfy\nthe Sun constraint. In the polar orbit, the mission is once again interrupted for\nanother overfly of the subsolar point. During this overfly sequence of maneuvers,\nthe direction of the orbit in the Sun POS is reversed from retrograde to direct. This\nsequence of maneuvers is referred to as the plane flip.\n\nOCM 11 transfers the spacecraft from the 35 km circular orbit to a 55 km by\n35 km elliptical transfer orbit. The apoapsis radius of 55 km is set in anticipation of\ncircularizing the orbit at 50 km and returning to the Sun POS. OCM 12 circularizes\nthe orbit a week later at 50 km and the plane of the orbit remains in the Eros\nequatorial plane. A week later, the orbit plane is transferred to the Sun POS with\nOCM 13 and the period of active plane of sky control begins. Precession of the line\nof nodes with respect to Eros equator causes a break in the longitude of ascending\nnode and a gradual increase in inclination as observed in the Sun POS. One week\nlater or at the time the inclination reaches 30?, a maneuver is performed to flip the\nline of nodes in the Sun POS by 180?. The target parameters for this maneuver are\nperiapsis radius, apoapsis radius, and the z component of velocity in the Sun POS.\nReversing the z component of velocity is a device to flip the line of nodes 180?.\nThis strategy will result in the inclination with respect to the Sun POS decreasing\nfrom 30? to 0? and then increasing again to 30? as the node precesses with respect\nto the Eros equatorial plane. This strategy is repeated several times through OCM\n17 where the plane flip maneuver sequence is executed. The strategy for the plane\nflip sequence is the same as executed previously for the subsolar point overfly only\nthe spacecraft returns in a direct orbit. After the plane flip sequence is completed,\nthe spacecraft returns to a polar orbit about Eros.\n\n\n\n3.6 Summary 153\n\n60\n\n40\n\n20\n\n0\n\n\u201320\n\n\u201320 20 40 60 800\n\n\u201340\n\n\u201340\n\u201360\n\n\u201360\u201380\n\nFig. 3.27 Northern illuminated 50 km and 35 km orbits\n\n3.5.9 Northern Illuminated 50 km and 35 km Orbits\n\nFollowing the polar orbits, the spacecraft is placed in a 50 km by 45 km orbit for\nseveral weeks and active POS control is performed to keep the spacecraft from\nviolating the Sun constraint. The targeting strategy is the same as used previously.\nWhen the north pole of Eros comes within 30? of alignment with the Sun direction, a\ntransfer to a 35 km equatorial orbit is executed. The spacecraft remains in the 35 km\ncircular orbit until the end of the mission. The projection of the spacecraft orbit into\nthe Sun POS for these orbits is illustrated in Fig. 3.27.\n\n3.6 Summary\n\nThe objective of the design of a spacecraft trajectory is to determine the initial state\nthat will result in satisfying navigation and mission design constraints when the\ntrajectory is integrated to the end of the mission. With experience, the spacecraft\ninitial state can sometimes be guessed and a search conducted to satisfy constraints.\nIn space, the spacecraft motion is usually dominated by the acceleration from the\nmost massive nearby body. This motion was determined by Kepler and is either\nan ellipse or a hyperbola. Therefore, a very good approximation to the desired\ntrajectory may generally be obtained by patching together the conic solutions with\nrespect to the planet or satellite that is dominant. This is referred to as a two-body\nsolution.\n\nWhen the spacecraft is in a region of space where the gravitational accelerations\nfrom two nearby bodies are nearly equal, such as the Earth and Moon, it is more\n\n\n\n154 3 Trajectory Design\n\ndifficult to patch together two-body conic trajectories. These trajectories are referred\nto as three-body or restricted three-body if one of the bodies has very little mass.\nAnother example of three-body motion is gravity assist trajectories where the three\nbodies are the sun, a planet, and the spacecraft. If the time the spacecraft is in limbo\nbetween two massive bodies is short, a reasonably accurate initial orbit may be\nobtained by patching two-body conics together. By extension, a four-body trajectory\ninvolves a spacecraft and three bodies with nearly equal gravitational accelerations.\nThe best example is the Sun, Earth, Moon, and spacecraft orbit that was used to\nnavigate the Hiten, Genesis, and other spacecraft from the Earth to Lunar orbit.\nFour-body trajectories can be obtained by patching together three-body orbits.\n\nPerhaps, the easiest trajectories to design are orbits about planets, asteroids, or\nsatellites of planets. The orbits are easy to design, but satisfying all the mission\nconstraints can result in a lot of complicated maneuvering. The solution is to just\nstay in orbit a long time until everybody gets the data they want. The Viking and\nNEAR missions are a good examples of this design process.\n\nExercises\n\n3.1 For a hyperbolic orbit, the argument F in Kepler\u2019s equation can be computed\nby F = ln(sinh(F ) + cosh(F )) for positive F and F = ? ln(cosh(F ) ? sinh(F ))\nfor negative F. Why are two formulas, which are mathematically the same, needed.\n\n3.2 The flight path angle (? ) is defined as the angle between the velocity vector and\nthe local horizontal plane. Derive the flight path angle for a spacecraft in an elliptical\norbit.\n\n3.3 When a spacecraft flies by a target body, errors in the trajectory are amplified by\nthe target body and are corrected by a maneuver performed shortly after encounter.\nAn error in energy after the encounter is particularly troublesome. The energy error\nis directly related to the error in the magnitude of the B vector (?b). Show that the\n?V correction is given by\n\n?V = 2V\n3? GM\n\nGM2 + b2 V 4?\n?b\n\n3.4 Show that the following identity (Eq. 3.38) is true by making use of Eq. (3.8).\n\np\n\n(\nr1 + r2\nr1r2\n\n)\n= 2 + 2e cos\n\n(\n?2 + ?1\n\n2\n\n)\ncos\n\n(\n?2 ? ?1\n\n2\n\n)\n\n3.5 Show that the following identity (Eq. 3.39) is true.\n\n?\nr1r2 cos\n\n(\n?t\n\n2\n\n)\n= 2a sin ?\n\n2\nsin\n\n?\n\n2\n\n\n\nBibliography 155\n\n3.6 Determine an equation for the lag angle required for a Hohmann transfer and\nthen compute the time between launch opportunities for an Earth\u2013Mars transfer.\n\n3.7 In Eq. (3.57) and Eq. (3.58), show that\n\n?2x?2 + ?2y?2 = 2?(xy? ? yx?)\n\nBibliography\n\nBattin, R. H., \u201cAn Introduction to the Mathematics and Methods of Astrodynamics\u201d, American\nInstitute of Aeronautics and Astronautics, Inc., Reston, VA, 1999.\n\nBelbruno, E. A., J. K. Miller, \u201cSun-Perturbed Earth-to-Moon Transfers with Ballistic Capture\u201d,\nVol 16, No. 4, Journal of Guidance, Control and Dynamics, July-August 1993.\n\nEgorov, V. A., \u201cCertain Problems of Moon Flight Dynamics,\u201d in The Russian Literature of\nSatellites, Part 1, International Physical Index, Inc., New York, 1958.\n\nEhricke, K. A., \u201cSpace Flight\u201d, D. Van Nostrand, Princeton, NJ, 1960.\nFesenkov, V. G., Journal of Astronomy, 23, No. 1, 1946.\nHintz, G. R., \u201cOrbital Mechanics and Astrodynamics\u201d, Springer International Publishing, Switzer-\n\nland, 2015\nMiller, J. K., C. J. Weeks, and L. J. Wood, Orbit Determination Strategy and Accuracy for a Comet\n\nRendezvous Mission. Journal of Guidance, Control and Dynamics 13, 775\u2013784., 1990\nMiller, J. K., E. A. Belbruno, \u201cA Method for the Construction of a Lunar Transfer Trajectory Using\n\nBallistic Capture\u201d, AAS 91\u2013100, AAS/AIAA Spaceflight Mechanics Meeting, Houston, TX,\nFebruary 11, 1991.\n\nMiller, J. K., E. Carranza, C. E. Helfrich, W. M. Owen, B. G. Williams, D. W. Dunham, R. W.\nFarguhar, Y. Guo and J. V. McAdams, \u201cNear Earth Asteroid Rendezvous Orbit Phase Trajectory\nDesign\u201d, AIAA 98\u20134286, AAS/AIAA Astrodynamics Specialist Conference, Boston, MA,\nAugust 10, 1998.\n\nMiller, J. K. and C. J. Weeks, \u201cApplication of Tisserand\u2019s Criterion to the Design of Gravity Assist\nTrajectories\u201d, AIAA 2002\u20134717, AAS/AIAA Astrodynamics Specialist Conference, Monterey,\nCA, August 5, 2002.\n\nMiller, J. K., \u201cLunar Transfer Trajectory Design and the Four Body Problem\u201d, AAS 03\u2013144, 13th\nAAS/AIAA Space Flight Mechanics Meeting, Ponce, Puerto Rico, February 9, 2003.\n\nMiller, J. K. and G. R. Hintz, \u201cWeak Stability Boundary and Trajectory Design\u201d, AAS paper 15\u2013\n297, AAS/AIAA Astrodynamics Specialist Conference, Vail, CO, August 9, 2015.\n\nRoy, A, E., Orbital Motion, Adam Hilgar Ltd., Bristol, UK., 1982\nStrange, N. J. and J. A. Sims, \u201cMethods for the Design of V-Infinity Leveraging Maneuvers\u201d, AAS\n\npaper 01\u2013437., 2001.\nStrange, N. J. and J. M. Longuski, \u201cGraphical Methods for Gravity-Assist Trajectory Design\u201d,\n\nJournal of Spacecraft and Rockets, Vol. 39, No. 1, January-February 2002.\nYamakawa, H., Kawaguchi, J. and Nakajima, T., \u201cLUNAR-A Trajectory description, \u201d ISTS 94-c-\n\n30, 19th International Symposium on Space Technology and Science, Yokohama, Japan, May\n15\u201324, 1994.\n\nYamakawa, H., Kawaguchi, J., Ishii, N. and Matsuo, H., \u201cA Numerical Study of Gravitational\nCapture Orbit in the Earth-Moon System,\u201d AAS 92\u2013186, 1992.\n\n\n\nChapter 4\nTrajectory Optimization\n\nNavigation operations require the refinement of the design trajectory to obtain a\nhigh-precision trajectory for flight path control and science operations. The pre-\nliminary trajectory design often involves approximate solutions of boundary value\nproblems that provide sufficient accuracy for mission design but are not accurate\nenough for flight operations. The final precision trajectory is obtained by driving\na high-precision trajectory model with targeting and optimization algorithms that\nyield the final high-precision solution. The preliminary trajectory design provides\nan initial guess for starting the targeting algorithm. With experience, the preliminary\ndesign may sometimes be omitted and the trajectory design obtained directly by\ntargeting.\n\nTargeting algorithms can be separated into two classes: those that involve the\nsolution of a two-point boundary value problem with no optimization and those that\ntarget a reduced set of parameters and optimize some performance criterion such\nas fuel expenditure. The former is sometimes called shooting and the solution is\nobtained by first computing the partial derivatives of the target parameters with\nrespect to the initial condition or control parameters. These partial derivatives\nare used to compute a correction to the initial condition and control parameters\niteratively using the Newton\u2013Raphson technique. The latter type of algorithm is\ncalled an optimizer and performs a similar search for a solution that achieves the\ntarget and minimizes a performance criterion.\n\n4.1 Parameter Optimization\n\nWhen properly formulated, an optimizer may be used to solve a wide variety of\nproblems that extend far beyond navigation of spacecraft. For example, problems\nof the calculus of variations may be solved with an optimizer by parameterizing the\nsolution and solving for the parameters. Consider the problem of finding the shape of\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_4\n\n157\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_4&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_4\n\n\n158 4 Trajectory Optimization\n\na wire, strung between two points, that a bead will slide down in minimum time. This\nproblem is called the brachistochrone problem and was first posed by John Bernoulli\nin 1697. The shape of the wire may be represented by a polynomial, and the problem\nconverted to a parameter optimization problem where the independent parameters\nare the coefficients of the polynomial. The problem in trajectory optimization of\nfinding the optimum programmed thrust direction for a rocket may be solved in a\nsimilar fashion.\n\nAn optimization algorithm is described that solves the problem of constrained\noptimization by the method of explicit functions. This method was originally\ndevised to minimize propellant expenditure for the Viking mission to Mars.\nAdditional arbitrary constraint functions are adjoined to the given equations of\nconstraint to completely span the space of the independent parameters. The\nsearch is performed on the arbitrary constraint parameters to obtain the values of\nthese parameters that minimizes the performance criterion. First derivatives of the\nconstraint functions with respect to the independent parameters are used to drive the\ndependent constraint variables or target variables to satisfy the desired constraints,\nand second partial derivatives of the minimization criterion with respect to the same\nindependent parameters are used to drive the optimization condition to zero. The\nsearch is referred to as a second-order gradient search.\n\nThe partial derivatives that are required by the optimization algorithm may\nbe obtained analytically or by finite difference. Analytic partial derivatives are\noften not pursued because of the difficulty in obtaining the partial derivatives,\nparticularly the second derivatives. A problem with exact second derivative finite\ndifference equations is the large number of function evaluations that are required to\ncompute the derivatives for one iteration. These grow as the square of the number of\nparameters. Approximate techniques may be used to accelerate the computation of\nthe second derivatives, and a method along the lines suggested by Fletcher-Powell-\nDavidon was investigated. However, these acceleration techniques generally work\nwell only for the problems they were designed to solve and require modification for\nspecific problems making parameter optimization more of an art than a science.\n\nBecause of nonlinearity and ill-conditioned problems, a second order gradient\nsearch will often diverge. An algorithm is developed to enable inequality constraints\nto control the search for a solution. Constraining the dependent target variables to\nan interval permits the optimization algorithm to find a minimum solution within\nthe interval and prevents the search from diverging to a local maximum or inflection\npoint outside the interval.\n\n4.2 Statement of Problem\n\nA performance index (J ) is defined that is a function of N independent variables\n(U). We also have M equations of constraint (M < N ) that define the target\nvariables (ZC), and the equations of constraint are also functions of U. Thus we\nhave,\n\n\n\n4.3 Condition for Optimum Solution 159\n\nJ = f (U) (4.1)\nZC = g(U) (4.2)\n\nand\n\nJ = f (U1, U2, U3, . . . UN)\nZC1 = g1(U1, U2, U3, . . . UN)\nZC2 = g2(U1, U2, U3, . . . UN)\n\n\u00b7 \u00b7 \u00b7\nZCM = gM(U1, U2, U3, . . . UN)\n\nThe problem is to find a U? such that\n\nZC(U?) = C (4.3)\n\nwhere C are constant target parameters and J is a minimum for all U subject to the\nconstraint C.\n\n4.3 Condition for Optimum Solution\n\nA simple method, in principal, for solving the problem of constrained optimization\nis to solve the equations of constraint (g) for a selected subset of the independent\nparameters (UC) and substitute these expressions into the objective function (f ),\nthus reducing the number of unknowns from N to N ? M where M is the number\nof constraint functions. The partial derivative of J with respect to the remaining\nindependent parameters is obtained and set equal to zero. These equations are solved\nin conjunction with the equations of constraint. The selection of which independent\ncontrol parameters to include in UC is arbitrary. However, the choice may have some\neffect on performance when a numerical solution is sought.\n\nThe method of explicit functions carries this concept a step further. In place of the\narbitrary selection of control parameters, additional arbitrary constraint functions\n(ZF ) are defined to bring the total number of Z parameters to N. The ZF functions\nare not completely arbitrary in that a one to one mapping must exist between U\nand Z. At the solution point, any change in U holding ZC constant will increase\nJ . Since a one to one mapping must exist, any unique change in ZF holding ZC\nconstant will cause a unique change in U holding ZC constant and consequently\nincrease J . Mathematically, the partial derivative of J with respect to ZF holding\n\n\n\n160 4 Trajectory Optimization\n\nZC constant being set equal to zero is a necessary and sufficient condition for a\nstationary point which is a minimum if J is properly defined and ZC is properly\nconstrained. The performance criterion and augmented equations of constraint are\ngiven by,\n\nJ = f (U1, U2, U3, . . . UN)\nZC1 = g1(U1, U2, U3, . . . UN)\nZC2 = g2(U1, U2, U3, . . . UN)\n\n\u00b7 \u00b7 \u00b7\nZCM = gM(U1, U2, U3, . . . UN)\n\n\u00b7 \u00b7 \u00b7\nZF N = gN(U1, U2, U3, . . . UN)\n\nand the solution is obtained by solving\n\nZC = C (4.4)\n?J\n\n?ZF\n= 0 (4.5)\n\nObserve that the above solution reduces to direct elimination if ZF is taken to be\nidentically equal to a subset of U of dimension N minus M.\n\nBecause of the difficulty in obtaining the inverse functions analytically, direct\nsolution of the above equations is only practical for relatively simple systems of\nequations. For complex systems, solutions may be obtained by searching using\nNewton\u2019s method. The theory behind techniques currently in use such as Lagrange\nmultipliers and gradient projection follow directly from the method of explicit\nfunctions.\n\nThe method of explicit functions involves adjoining to the equations of constraint\nsome additional equations that define the parameters ZF . The ZF parameters replace\nthe independent parameters selected by the method of direct elimination for the\npurpose of minimizing J . An equation that relates the optimization condition to the\nindependent control parameters, equations of constraint, and performance criterion\nmay be obtained by application of the chain rule.\n\n?J\n\n?U\n= ?J\n\n?Z\n?Z\n?U\n\n(4.6)\n\nThe partial derivatives of Z with respect to the independent parameters U are\ncontained in a square matrix of dimension N by N. The partial derivatives of J with\nrespect to U and Z are row matrices also of dimension N. Partitioning the above\nmatrices separating the ZC dependent elements from the ZF dependent elements\nyields,\n\n\n\n4.3 Condition for Optimum Solution 161\n\n[\n?J\n\n?U\n\n]\n=\n\n[\n?J\n\n?ZC\n\n?J\n\n?ZF\n\n]???\n?ZC\n?U\n?ZF\n?U\n\n?\n?? (4.7)\n\nThe above partitioned matrices may be factored to further separate those submatri-\nces dependent on ZC from those dependent on ZF and after rearranging terms the\nfollowing equation is obtained.\n\n?J\n\n?U\n? ?J\n\n?ZC\n\n?ZC\n?U\n\n= ?J\n?ZF\n\n?ZF\n?U\n\n(4.8)\n\nEquation (4.8) provides a fundamental relationship that may be used to tie together\nvarious methods of constrained parameter optimization including the methods of\nLagrange multipliers, gradient projection, and explicit functions. Comparison of\nthese methods provides insight into which approach may work best depending on\nthe problem.\n\n4.3.1 Lagrange Multipliers\n\nThe classic solution of constrained parameter optimization was derived by the\neighteenth-century mathematician Joseph Luis Lagrange. This solution is particu-\nlarly appealing since a choice of independent parameters is not necessary. Referring\nto Eq. (4.8), at the solution point the right side is zero because the partial derivative\nof J with respect to the ZF must be zero as required by Eq. (4.5).\n\n?J\n\n?U\n? ?J\n\n?ZC\n\n?ZC\n?U\n\n= 0 (4.9)\n\nThe terms of Eq. (4.9) may be readily obtained from the equations of constraint and\nthe equation for the performance index with the exception of the partial derivative of\nJ with respect to the ZC . Lagrange\u2019s insight was to make the elements of this term\nparameters to be solved for in conjunction with the equations of constraint. These\nparameters are called Lagrange multipliers and are defined by\n\n? = ? ?J\n?ZC\n\n(4.10)\n\nThe sign of the Lagrange multipliers is arbitrary and it may be conjectured that\nLagrange selected the minus sign for convenience. He was certainly aware of\nEq. (4.8) but apparently did not consider the right side important since the computer\nhad not been invented in his time. The equations that must be solved to obtain an\noptimum are thus,\n\n\n\n162 4 Trajectory Optimization\n\nZC = C (M equations) (4.11)\n?J\n\n?U\n+ ??ZC\n\n?U\n= 0 (N equations) (4.12)\n\nThe method of Lagrange multipliers requires the solution of M+N equations\nfor N U parameters and M Lagrange multipliers. This method is well suited for\nobtaining analytic solutions since the equations of constraint need not be solved for\nthe independent U parameters as a function of the Z parameters. However, the need\nto solve for the Lagrange multipliers makes numerical solutions more complicated\nthan necessary.\n\n4.3.2 Explicit Functions\n\nThe methods of explicit functions and gradient projection use the right side of\nEq. (4.8) to obtain a solution and thus avoid the need to solve for Lagrange\nmultipliers. The method of explicit functions requires an equation for the partial\nderivative of J with respect to ZF . Application of the chain rule gives,\n\n?J\n\n?Z\n= ?J\n\n?U\n?U\n?Z\n\n(4.13)\n\nThe partial derivatives of U with respect to the dependent target parameters Z are\nobtained by matrix inversion.\n\n[\n?J\n\n?ZC\n?J\n\n?ZF\n\n]\n=\n\n[\n?J\n\n?U\n\n]???\n?ZC\n?U\n?ZF\n?U\n\n?\n??\n\n?1\n\n(4.14)\n\nwhere\n\n?U\n?Z\n\n=\n[\n\n?Z\n?U\n\n]?1\n=\n\n?\n??\n\n?ZC\n?U\n?ZF\n?U\n\n?\n??\n\n?1\n\nThe equations that must be solved to obtain an optimum are the equations of\nconstraint and the last N ? M columns of Eq. (4.14).\n\nZC = C (M equations) (4.15)\n?J\n\n?ZF\n= 0 (N ? M equations) (4.16)\n\n\n\n4.3 Condition for Optimum Solution 163\n\nThe method of explicit functions requires the solution of N equations for N control\nparameters U. This algorithm is well suited for obtaining numerical solutions on\na computer but not for analytic solutions since it involves matrix inversion of a\nmatrix with analytic functions for elements. Observe that the Lagrange multipliers\nare obtained as a by-product of Eq. (4.14) (the first M columns).\n\n4.3.3 Gradient Projection\n\nThe method of gradient projection is a special case of the method of explicit\nfunctions. The independent parameters are partitioned into what are referred to as\nstate parameters (UC) and decision parameters (UF ). The choice between which\nindependent parameters to designate as decision parameters is not unique. The\ndistinction between state and decision parameters is generally only a matter of\nconvenience. However, the decision parameters must determine the state parameters\nthrough the constraint relations. Expanding Eq. (4.14), separating the UC dependent\nelements from the UF dependent elements, yields,\n\n[\n?J\n\n?ZC\n\n?J\n\n?ZF\n\n]\n=\n\n[\n?J\n\n?UC\n\n?J\n\n?UF\n\n]???\n?ZC\n?UC\n\n?ZC\n?UF\n\n?ZF\n?UC\n\n?ZF\n?UF\n\n?\n??\n\n?1\n\n(4.17)\n\nThe ZF constraint relationships have yet to be specified. Depending on the choice of\nwhich U are included in UF , some reordering of the rows and columns of Eq. (4.17)\nmay be necessary. Since the selection of the ZF equations of constraint is arbitrary,\nZF may be made identically equal to UF . Equation (4.17) then reduces to,\n\n[\n?J\n\n?ZC\n\n?J\n\n?ZF\n\n]\n=\n\n[\n?J\n\n?UC\n\n?J\n\n?UF\n\n]?? ?ZC?UC\n?ZC\n?UF\n\n0 I\n\n?\n?\n\n?1\n(4.18)\n\nPerforming the indicated matrix inversion yields,\n\n[\n?J\n\n?ZC\n\n?J\n\n?ZF\n\n]\n=\n\n[\n?J\n\n?UC\n\n?J\n\n?UF\n\n]?? ?ZC?UC\n?1\n\n? ?ZC\n?UC\n\n?1 ?ZC\n?UF\n\n0 I\n\n?\n? (4.19)\n\nand\n\n?J\n\n?ZF\n= ?J\n\n?UF\n? ?J\n\n?UC\n\n?ZC\n?UC\n\n?1 ?ZC\n?UF\n\n= 0 (4.20)\n\n\n\n164 4 Trajectory Optimization\n\nEquation (4.20) is solved in conjunction with the equation of constraint to obtain an\noptimum as is done for the method of explicit functions. Observe that the Lagrange\nmultipliers are obtained as a by-product from both the method of explicit functions\nand gradient projection.\n\n? = ? ?J\n?ZC\n\n= ? ?J\n?UC\n\n?ZC\n?UC\n\n?1\n(4.21)\n\nEven though the Lagrange multipliers do no enter into the optimal solution, they are\nuseful for determining which bound is appropriate for inequality constraints.\n\n4.4 Sample Problem\n\nA sample problem is solved to illustrate the various methods of constrained\nparameter optimization. Consider an ellipse with semi-major axis a and semi-\nminor axis b oriented along the coordinate axes. The problem is to find the greatest\nrectangle with sides parallel to the coordinate axes that will fit inside the ellipse. The\ngeometry is illustrated in Fig. 4.1. The equation of constraint describes an ellipse and\nthe performance criterion is the area of the rectangle. The area in the first quadrant\nis multiplied by four and assigned a minus sign since we are seeking a maximum.\n\nZc = U\n2\n1\n\na2\n+ U\n\n2\n2\n\nb2\n= C = 1 (4.22)\n\nJ = ?4U1U2 (4.23)\n\nU2\n\nU1\n\nU1\n\n(U1U2)\n\n2 2\nZc =\n\nU2 = C = 1+\na2\n\nb\n\n2\n\na\n\nb\n\nb2\n\n2\na\n\nJ = \u20134U1U2\n\nFig. 4.1 Sample problem\n\n\n\n4.4 Sample Problem 165\n\n4.4.1 Solution by Method of Lagrange Multipliers\n\nThe method of Lagrange multipliers requires a solution of Eq. (4.12) in conjunction\nwith the equation of constraint (Eq. 4.22). For the sample problem\n\n?J\n\n?U\n= [?4U2 ?4U1 ] (4.24)\n\n?ZC\n?U\n\n=\n[\n\n2U1\na2\n\n2U2\nb2\n\n]\n(4.25)\n\nSubstituting into Eq. (4.12) gives the following two equations:\n\n?4U2 + ?2U1\na2\n\n= 0 (4.26)\n\n?4U1 + ?2U2\nb2\n\n= 0 (4.27)\n\nwhich may be solved in conjunction with the equation of constraint (Eq. 4.22) to\n\nobtain the solution, U1 = a?\n2\n\n, U2 = b?\n2\n\nand ? = 2ab.\n\n4.4.2 Solution by Method of Explicit Functions\n\nThe method of explicit functions requires a solution of Eq. (4.14) in conjunction\nwith the equation of constraint (Eq. 4.22). Since there are two independent param-\neters, an additional equation of constraint is needed to square up the system of\nequations. For numerical solutions, a good choice is a function that is nearly normal\nto the constraint function. A hyperbola is selected for ZF .\n\nZF = U\n2\n1\n\nc2\n? U\n\n2\n2\n\nd2\n(4.28)\n\nFor the sample problem, the terms of Eq. (4.14) are given by,\n\n?\n??\n\n?ZC\n?U\n?ZF\n?U\n\n?\n?? =\n\n?\n??\n\n2U1\na2\n\n2U2\nb2\n\n2U1\nc2\n\n?2U2\nd2\n\n?\n?? (4.29)\n\nThe required matrix inverse is\n\n\n\n166 4 Trajectory Optimization\n\n?\n??\n\n?ZC\n?U\n?ZF\n?U\n\n?\n??\n\n?1\n\n= 1\n4U1U2\n\n(\na2b2c2d2\n\na2d2 + b2c2\n)???\n\n2U2\nd2\n\n2U2\nb2\n\n2U1\nc2\n\n?2U1\na2\n\n?\n?? (4.30)\n\nSubstituting Eqs. (4.24) and (4.30) into Eq. (4.14) yields,\n\n[\n?J\n\n?ZC\n\n?J\n\n?ZF\n\n]\n= ?1\n\n4U1U2\n\n(\na2b2c2d2\n\na2d2 + b2c2\n)[\n\n8d2U21 + 8c2U22\nc2d2\n\n8a2U22 ? 8b2U21\na2b2\n\n]\n\n(4.31)\n\nThe equation\n\n8U22\nb2\n\n? 8U\n2\n1\n\na2\n= 0 (4.32)\n\nis solved in conjunction with Eq. (4.22) to obtain U1 = a?\n2\n\nand U2 = b?\n2\n\n. The\n\nLagrange multiplier, obtained from the first column of Eq. (4.31), is ? = 2ab.\nObserve that at the solution point, the constants c and d completely cancel from\nthe solution, as expected, verifying that Eq. (4.28) is arbitrary.\n\n4.4.3 Solution by Method of Gradient Projection\n\nThe method of gradient projection requires a solution of Eq. (4.21) in conjunction\nwith Eq. (4.22). For the sample problem, U1 is selected for UC and U2 for UF .\nBecause of symmetry, the selection of which independent parameter is a \u201cstate\u201d\nparameter and which is a \u201cdecision\u201d parameter is arbitrary.\n\n?J\n\n?UC\n= ?4U2 (4.33)\n\n?J\n\n?UF\n= ?4U1 (4.34)\n\n?ZC\n?UC\n\n= 2U1\na2\n\n(4.35)\n\n?ZC\n?UF\n\n= 2U2\nb2\n\n(4.36)\n\nSubstituting the above equations into Eq. (4.21) yields\n\n\n\n4.5 Second-Order Gradient Search 167\n\n[?4U1] ? [?4U2]\n[\n\na2\n\n2U1\n\n] [\n2U2\nb2\n\n]\n= 0\n\n?4U21 b2 + 4U22 a2 = 0 (4.37)\n\nwhich is solved in conjunction with Eq. (4.22) to obtain U1 = a?\n2\n\nand U2 = b?\n2\n\n.\n\nThe Lagrange multiplier, which is also obtained as a by-product, is given by\nsubstituting into Eq. (4.21).\n\n? = ?[?4U2]\n[\n\n2U1\na2\n\n]?1\n= 2ab (4.38)\n\n4.5 Second-Order Gradient Search\n\nParameter optimization problems with constraints, where the dependent parameters\nare obtained by numerical integration, are difficult if not impossible to solve\nanalytically. Numerical solutions may be obtained by searching using an iterative\ntechnique like Newton\u2019s method. For the explicit method, the equations that need to\nbe solved are\n\nZC = C (M equations) (4.39)\n\nand from the last N ? M columns of\n\n[\n?J\n\n?ZC\n\n?J\n\n?ZF\n\n]\n=\n\n[\n?J\n\n?U\n\n]???\n?ZC\n?U\n?ZF\n?U\n\n?\n??\n\n?1\n\n(4.40)\n\nthe following equation is extracted:\n\n?J\n\n?ZF\n= 0 (N ? M equations) (4.41)\n\nFrom the definition of the derivative, the following difference equations may be\nwritten:\n\n?ZC = ?ZC\n?U\n\n?U (4.42)\n\n?\n?J\n\n?ZF\n= ?\n\n2J\n\n?U?ZF\n?U (4.43)\n\n\n\n168 4 Trajectory Optimization\n\nThe search for a solution involves finding a change in the independent control\nparameters that will move the current values of the constraint parameters and\noptimization condition to their desired values. The desired changes in the constraint\nparameters and optimization condition are given by\n\n?ZiC = C ? ZiC (4.44)\n\n?\n?J i\n\n?ZF\n= 0 ? ?J\n\ni\n\n?ZF\n(4.45)\n\ncorresponding to a change in the control parameters from Ui to Ui+1,\n\n?U = Ui+1 ? Ui (4.46)\n\nSolving for Ui+1, an iterative equation is obtained for the ith iteration.\n\nUi+1 = Ui ?\n?\n??\n\n?ZC\n?U\n?2J\n\n?U?ZF\n\n?\n??\n\n?1 ?\n?ZiC ? C?J i\n\n?ZF\n\n?\n? (4.47)\n\nThe partial derivatives required by the second-order gradient search are obtained\nby finite difference. Computation of these finite difference partial derivatives\nrequires repeated evaluation of the functions f and g for the performance index\nand constraint parameters at each iteration.\n\n?J\n\n?Ui\n= f (U + ?Ui ) ? f (U ? ?Ui )\n\n2?Ui\n(4.48)\n\nThe ?Ui vector is zero except for the ith element that contains the partial derivative\nstep size. ?Ui is the ith element of ?Ui . The partial derivatives of the constraint\nparameters with respect to the independent control parameters are given by\n\n?Zj\n\n?Ui\n= gj (U + ?Ui ) ? gj (U ? ?Ui )\n\n2?Ui\n(4.49)\n\nThe matrix of second partial derivatives in Eq. (4.47) is a mixed tensor that is covari-\nant in U and contravariant in Z. It serves the same purpose as the covariant Hessian\nin optimization theory and may be a Hessian depending on the definition. The\nHessian matrix was developed by the nineteenth-century mathematician Ludwig\nOtto Hesse. The elements of the required matrix of second partial derivatives are\ngiven by\n\n?2J\n\n?Uj?Zi\n= 1\n\n2?Uj\n{ [f (U + ?Uj + ?Ui ) ? f (U + ?Uj ? ?Ui )]\n\n\n\n4.6 Inequality Constraints 169\n\n[gi (U + ?Uj + ?Ui ) ? gi (U + ?Uj ? ?Ui )]?1\n? [ f (U ? ?Uj + ?Ui ) ? f (U ? ?Uj ? ?Ui )]\n\n[gi (U ? ?Uj + ?Ui ) ? gi (U ? ?Uj ? ?Ui )]?1} (4.50)\n\nThe partial step size for the first partial derivatives should be as small as possible\nto achieve linearity but large enough, relative to the machine precision, to maintain\naccuracy. The partial step size for the second partial derivatives (?Uj ) should be\nabout 5\u201310 times larger than the corresponding (?Ui). The computation of the\nsecond partial derivatives (Eq. 4.50) will require 4N2 evaluations of the performance\nindex and constraint functions. For six control parameters, 144 function evaluations\nare needed. Several methods have been explored to accelerate the computation\nof the second partial derivatives. Since the optimization conditions are not a\nfunction of the second partial derivatives, approximations may be used to speed\nup the search without compromising accuracy. An approximation that worked well\nfor optimization of the Viking orbit insertion maneuver was to set all the terms\nof Eq. (4.50) where i \n= j to zero. For this approximation, 2N + 1 function\nevaluations are required. Another approach was suggested by Fletcher-Powell-\nDavidon. The matrix of second partial derivatives is primed with an approximate\nsolution. Subsequent changes in the control parameters computed during the search\nare used to estimate and thus improve the second partial derivative matrix. This\nbootstrap approach can greatly speed up the search but may lead to instabilities if\nthe search is not properly controlled.\n\n4.6 Inequality Constraints\n\nSometimes the constraint on a Z parameter is not a specific target value but a range\nof values. In other situations, the second-order gradient search described above may\nnot converge to the desired minimum if the initial guess required to start the search is\ntoo far from the solution but wander off toward a local maximum or inflection point.\nFor these reasons, it is often convenient to specify inequality constraints where the\nZ are constrained to a specified range of values.\n\nCLi ? Zi ? CU i (4.51)\n\nAn algorithm has been devised to transform the problem of optimization with\ninequality constraints into the problem of optimization with equality constraints\ndescribed above. At any step in the iteration for a solution, the Zi parameters are\ntested and sorted into the ZC category or ZF category. The algorithm is diagrammed\nin Fig. 4.2.\nThe following conditions result in the Zi target variable being placed in the\nconstrained ZC category:\n\n\n\n170 4 Trajectory Optimization\n\nConstraint Variable\n\nSolution points\n\nJ\ne\n\ne\n\nf\n\nf\n\ni\n\nb\n\nCLi CUi Zi\n\ng,h\nZi\nJ\n\na,c\n\nd,j\n2 b\n\np p\n\nChange of target\nparameter status\n\nP\ner\n\nfo\nrm\n\nan\nce\n\n In\nde\n\nx\n\nFig. 4.2 Inequality constraint status determination\n\n(a) If CLi = CU i , Ci is set equal to CLi and Zi is a hard constraint\n(b) If Zi > CU i , Ci is set equal to CU i and Zi is a soft constraint\n(c) If Zi < CLi , Ci is set equal to CLi and Zi is a soft constraint\n\nThe following conditions result in the Zi target variable being placed in the\nunconstrained ZF category:\n\n(d) If CLi < Zi < CU i and the constraint is released\n(e) If |Zi ? CLi | < ?b and ?J?Zi < 0 and the constraint is released\n(f) If |Zi ? CU i | < ?b and ?J?Zi > 0 and the constraint is released\nThe following conditions result in convergence if true for all Zi .\n\n(g) If |Zi ? CLi | < ?b and CLi = CU i , hard constraint\n(h) If |Zi ? CLi | < ?b and ?J?Zi > 0, soft constraint\n(i) If |Zi ? CU i | < ?b and ?J?Zi < 0, soft constraint\n(j) If CLi < Zi < CU i and\n\n?J\n?Zi\n\n< ?p, a true minimum satisfying the constraints\n\nA soft constraint applies to the current iteration and may be released as the search\nprogresses. A hard constraint is an equality constraint and applies throughout the\nsearch. The tolerance ?b is on the value of the constrained variable and the tolerance\n?p is on the partial derivative of J with respect to Zi . The conditions for control\nof the search and confirmation of a solution are lettered a-j and shown in Fig. 4.2.\nThere are three possible cases that each constraint variable may describe provided\nthe optimization problem has been properly defined and constrained. The constraint\nvariable may either be an increasing monotone across the constraint interval, achieve\n\n\n\n4.7 Mission to Mercury 171\n\na minimum within the constraint interval, or be a decreasing monotone across\nthe constraint interval. If a maximum is sought, the sign of J is changed and the\nalgorithm searches for a minimum. These three cases are illustrated in Fig. 4.2. For\nthe first case, conditions (a) or (c) will select the lower bound and condition (f) will\nrelease the constraint from the upper bound. At the solution point (g,h), the partial\nderivative of J with respect to Zi , the negative of the Lagrange multiplier, indicates\nthat releasing the constraint will result in an increase in J . The solution is thus held\nat the lower bound. For the second case, conditions e or f will release the constraint\nfrom the lower and upper bounds, respectively and a minimum is obtained (d,j)\nbetween the bounds. The third case is simply the mirror image of the first case.\n\n4.7 Mission to Mercury\n\nThe MESSENGER spacecraft was launched on August 3, 2004, on a mission to\nexplore the planet Mercury. The trajectory reencountered the Earth a year after\nlaunch, to obtain a gravity assist, and then proceeded on to several encounters with\nVenus and Mercury before being inserted into Mercury orbit in 2011. The initial\ninjection error at Earth launch resulted in a 20 m/s under burn. Two Trajectory\nCorrection Maneuvers (TCMs) were scheduled to make up the energy deficit and\nplace the spacecraft on the proper trajectory. Two TCMs are necessary to achieve the\ntarget: The first corrects the energy and the second corrects the orbit plane. Because\nof the near 360? transfer, the first maneuver, which is performed shortly after launch,\nis unable to correct the orbit plane. The second maneuver, which is performed\nabout three months after launch, is less efficient in correcting energy or flight time.\nSince there are only two constraints that need to be satisfied related to the position\nrelative to the Earth at the second encounter and there are six maneuver components\navailable to control the trajectory, the remaining four degrees of freedom may be\nused to minimize propellant expenditure.\n\nThe initial Earth launch injection conditions (X0) on August 3, 2004, are\npropagated to the nominal time of Earth return on August 2, 2005. Two TCMs were\ninitially planned for August 18, 2004 and November 19, 2004. The spacecraft state\nat Earth return is determined by numerical integration.\n\nXe = g1(t0, X0, t1, ?V1, t2, ?V2, te)\n\nThe maneuver velocity components, ?V1 and ?V2, are applied as finite burns at\nthe maneuver start times t1 and t2. At the end time (te), the Cartesian state vector is\ntransformed into hyperbolic orbit elements.\n\nHe = g2(Xe)\nHe = [B \u00b7R, B \u00b7T , tp, V?, ??, ??]\n\n\n\n172 4 Trajectory Optimization\n\nThe hyperbolic elements B \u00b7R and B \u00b7T (see Fig. 3.4) are the coordinates of the\napproach asymptote in the target B-plane, tp is the time of closest approach, V? is\nthe approach hyperbolic velocity magnitude, and ?? and ?? are the right ascension\nand declination of the approach asymptote. The optimization problem is to find\nthe velocity change components of the two TCMs that will acquire the target and\neventually arrive at Mercury and minimize propellant consumption which is related\nto the sum of the magnitudes of the maneuver velocity change associated with each\nmaneuver.\n\nThe optimization problem described above must first be cast into the framework\nrequired by the optimization method being used. The following constraint variables,\nconstraint parameters, performance index, and control variables are defined:\n\nZC = [B \u00b7R, B \u00b7T ]\nCC = [?14, 463.00 km,?17, 793.00 km]\n\nJ = |?V1| + |?V2|\nU = [?V1x, ?V1y, ?V1z, ?V2x, ?V2y, ?V2z]\n\nThe B-plane parameters are restored to their nominal prelaunch target values, and all\nthe other hyperbolic parameters at the second Earth flyby including flight time are\npermitted to float. Experience has revealed that the flight time and approach velocity\nerrors are small enough to be corrected by subsequent maneuvers. For the method\nof explicit functions, four additional equations of constraint (ZF ) must be defined.\nA natural choice are the four hyperbolic parameters that are not constrained.\n\nZF = [tp, V?, ??, ??]\n\nA problem with this choice for ZF is the sensitivity of the first maneuver\nto parameters defined after the second maneuver. The first maneuver must be\ndetermined through the second maneuver. For this reason, a preliminary search is\nconducted with ZF defined by tp and the three velocity components of the second\nmaneuver rotated to along track, cross track, and out of plane components. The\ninplane velocity components for the second maneuver are constrained to zero, and\na solution is obtained that is within 5 m/s of optimum.\n\nThe initial guess is input to initialize the optimizer which uses the method of\nexplicit functions. The results after each iteration are given in Table 4.1.\nThe search algorithm attempts to drive the constraint variables to their desired values\nat the same time the performance index is being driven to a minimum value. At\niteration 2, for example, a substantial reduction in J is achieved at the expense of\ndriving the constraint variables away from their desired values. At iteration 4, a\nslight increase in performance index is obtained as the constraint variables nearly\nachieve their objective. From iteration 5 through 9, convergence is achieved as the\noptimization algorithm drives the optimization conditions to smaller values. The\nsolution achieves an optimum within 0.1 mm/s before machine precision prohibits\n\n\n\n4.7 Mission to Mercury 173\n\nTa\nbl\n\ne\n4.\n\n1\nO\n\npt\nim\n\niz\nat\n\nio\nn\n\nby\nex\n\npl\nic\n\nit\nfu\n\nnc\ntio\n\nns\n\nPI\nC\n\non\nst\n\nra\nin\n\nts\nO\n\npt\nim\n\niz\nat\n\nio\nn\n\nco\nnd\n\niti\non\n\nJ\nB\n\n\u00b7R\nB\n\n\u00b7T\n?\nJ\n\n?\nt p\n\n?\nJ\n\n?\nV\n\n?\n?\nJ\n\n?\n?\n\n?\n?\nJ\n\n?\n? ?\n\n1\n30\n\n.0\n65\n\n55\n4\n\n?1\n4,\n\n46\n2.\n\n11\n5\n\n?1\n7,\n\n78\n9.\n\n84\n6\n\n0.\n12\n\n40\nE\n?0\n\n5\n0.\n\n31\n55\n\nE\n+\n\n00\n?0\n\n.1\n10\n\n7E\n+\n\n02\n?0\n\n.3\n65\n\n1E\n+\n\n01\n\n2\n26\n\n.2\n49\n\n67\n2\n\n?1\n4,\n\n28\n7.\n\n21\n7\n\n?1\n7,\n\n34\n7.\n\n51\n5\n\n?0\n.4\n\n37\n5E\n\n?0\n6\n\n?0\n.1\n\n90\n3E\n\n+\n00\n\n0.\n38\n\n55\nE\n\n+\n01\n\n0.\n13\n\n14\nE\n\n+\n01\n\n3\n25\n\n.5\n31\n\n65\n3\n\n?1\n4,\n\n44\n7.\n\n95\n7\n\n?1\n7,\n\n75\n0.\n\n00\n9\n\n?0\n.1\n\n15\n0E\n\n?0\n6\n\n0.\n88\n\n16\nE\n?0\n\n2\n0.\n\n83\n56\n\nE\n+\n\n00\n0.\n\n60\n61\n\nE\n+\n\n00\n\n4\n25\n\n.5\n66\n\n20\n0\n\n?1\n4,\n\n46\n2.\n\n79\n1\n\n?1\n7,\n\n79\n2.\n\n56\n9\n\n?0\n.1\n\n67\n7E\n\n?0\n6\n\n?0\n.2\n\n00\n9E\n\n?0\n1\n\n0.\n12\n\n30\nE\n\n+\n01\n\n0.\n87\n\n70\nE\n\n+\n00\n\n5\n25\n\n.5\n20\n\n88\n8\n\n?1\n4,\n\n46\n2.\n\n54\n0\n\n?1\n7,\n\n79\n2.\n\n17\n9\n\n?0\n.4\n\n40\n2E\n\n?0\n7\n\n?0\n.1\n\n59\n6E\n\n?0\n2\n\n0.\n36\n\n25\nE\n\n+\n00\n\n0.\n30\n\n40\nE\n\n+\n00\n\n6\n25\n\n.5\n13\n\n69\n4\n\n?1\n4,\n\n46\n2.\n\n88\n9\n\n?1\n7,\n\n79\n2.\n\n49\n2\n\n0.\n24\n\n66\nE\n?0\n\n7\n0.\n\n39\n87\n\nE\n?0\n\n2\n?0\n\n.1\n78\n\n9E\n+\n\n00\n?0\n\n.1\n28\n\n2E\n+\n\n00\n\n7\n25\n\n.5\n30\n\n97\n7\n\n?1\n4,\n\n46\n2.\n\n58\n5\n\n?1\n7,\n\n79\n2.\n\n01\n4\n\n?0\n.1\n\n00\n9E\n\n?0\n6\n\n?0\n.1\n\n06\n8E\n\n?0\n1\n\n0.\n74\n\n54\nE\n\n+\n00\n\n0.\n52\n\n84\nE\n\n+\n00\n\n8\n25\n\n.5\n12\n\n83\n7\n\n?1\n4,\n\n46\n2.\n\n74\n0\n\n?1\n7,\n\n79\n2.\n\n46\n6\n\n?0\n.2\n\n35\n1E\n\n?0\n8\n\n0.\n16\n\n84\nE\n?0\n\n2\n0.\n\n34\n85\n\nE\n?0\n\n1\n0.\n\n43\n91\n\nE\n?0\n\n1\n\n9\n25\n\n.5\n12\n\n75\n1\n\n?1\n4,\n\n46\n2.\n\n99\n6\n\n?1\n7,\n\n79\n2.\n\n95\n3\n\n0.\n13\n\n12\nE\n?0\n\n7\n0.\n\n16\n29\n\nE\n?0\n\n2\n?0\n\n.9\n68\n\n1E\n?0\n\n1\n?0\n\n.6\n97\n\n9E\n?0\n\n1\n\n\n\n174 4 Trajectory Optimization\n\nany further reduction. The velocity components of the two maneuvers in the Earth\nmean equator of J2000 are\n\n?V1 = [12.186085,?13.684292,?8.4862428] m/s\n?V2 = [3.6276212,?3.4959270, 1.7057893] m/s\n\nThe first maneuver was a bit large for the maneuver system that had not been tested\nin space and was delayed until August 24, 2004, and only about 80% of the required\nvelocity change was executed at this time. A small makeup maneuver was executed\non September 24, 2004. The maneuver scheduled for November 19, 2004, was\nexecuted as planned.\n\nThe same problem may be solved by the method of gradient projection. This\nmethod requires an awkward choice of which independent parameters are \u201cstate\u201d\nparameters and which are \u201cdecision\u201d parameters. A choice of four UF parameters\nmust be made from two sets of maneuver parameters each of dimension three. The\nfollowing arbitrary partition of maneuver velocity components into the categories\nrequired by gradient projection was used for the search:\n\nUC = [?V1x, ?V1y] (4.52)\nUF = [?V1z, ?V2x, ?V2y, ?V2z] (4.53)\n\nThe gradient projection search algorithm was implemented by making ZF equal\nto UF and using the same explicit function algorithm as above. The search was\nstarted with the maneuver velocity components set to zero, and the results after each\niteration are given in Table 4.2. The first iteration moved the target variables from\nabout 2 million km to within 20,000 km of the desired target. By the third iteration\nthe target variables were within 200 km of their desired value and the performance\nindex was within 1 m/s of optimum. Iterations 4\u20138 were within the linear region of\nthe second partial derivatives, and quadratic convergence is observed. The indication\nof quadratic convergence is an order of magnitude reduction in the optimization\ncondition after each iteration until the machine precision limit is reached.\n\n4.8 Multiple Encounter Optimization\n\nFor the problem of multiple encounter trajectory design, the independent control\nparameters are the components of propulsive maneuvers strategically placed along\nthe flight path to enable the spacecraft to attain the target body. The candidate\nconstraint variables are simply the position or some simple function of the position\nof the spacecraft with respect to the various bodies that the spacecraft encounters\nor some simple function of the independent parameters such as the magnitude or\ndirection of propulsive maneuvers. For a typical trajectory design problem, the\nconstraint variables may be the two components of the position vector in the final\n\n\n\n4.8 Multiple Encounter Optimization 175\n\nTa\nbl\n\ne\n4.\n\n2\nO\n\npt\nim\n\niz\nat\n\nio\nn\n\nby\ngr\n\nad\nie\n\nnt\npr\n\noj\nec\n\ntio\nn\n\nPI\nC\n\non\nst\n\nra\nin\n\nts\nO\n\npt\nim\n\niz\nat\n\nio\nn\n\nco\nnd\n\niti\non\n\nJ\nB\n\n\u00b7R\nB\n\n\u00b7T\n?\nJ\n\n?\nU\n\nF\n\n?\n?\nJ\n\n?\nU\n\nC\n\n?\nZ\n\n?1 C\n?\n\nU\nC\n\n?\nZ\n\nC\n\n?\nU\n\nF\n\n=\n0\n\n1\n0.\n\n00\n00\n\n00\n81\n\n0,\n83\n\n8.\n30\n\n3\n2,\n\n10\n7,\n\n83\n2.\n\n40\n9\n\n0.\n00\n\n00\nE\n\n+\n00\n\n0.\n00\n\n00\nE\n\n+\n00\n\n0.\n00\n\n00\nE\n\n+\n00\n\n0.\n00\n\n00\nE\n\n+\n00\n\n2\n26\n\n.2\n31\n\n57\n5\n\n?4\n1,\n\n36\n9.\n\n35\n1\n\n?9\n82\n\n.8\n76\n\n0.\n35\n\n01\nE\n?0\n\n2\n0.\n\n14\n54\n\nE\n+\n\n00\n?0\n\n.2\n39\n\n3E\n+\n\n00\n?0\n\n.7\n32\n\n4E\n?0\n\n1\n\n3\n26\n\n.3\n23\n\n22\n9\n\n?1\n4,\n\n42\n0.\n\n25\n4\n\n?1\n7,\n\n93\n8.\n\n40\n0\n\n?0\n.2\n\n13\n2E\n\n?0\n1\n\n0.\n57\n\n00\nE\n\n+\n00\n\n0.\n46\n\n45\nE\n\n+\n00\n\n?0\n.1\n\n63\n2E\n\n+\n00\n\n4\n25\n\n.5\n30\n\n79\n9\n\n?1\n4,\n\n46\n2.\n\n66\n9\n\n?1\n7,\n\n80\n5.\n\n15\n0\n\n0.\n13\n\n09\nE\n?0\n\n1\n?0\n\n.3\n02\n\n4E\n+\n\n00\n0.\n\n98\n34\n\nE\n?0\n\n1\n0.\n\n12\n08\n\nE\n+\n\n00\n\n5\n25\n\n.5\n12\n\n55\n3\n\n?1\n4,\n\n46\n2.\n\n60\n1\n\n?1\n7,\n\n79\n1.\n\n85\n2\n\n?0\n.3\n\n13\n4E\n\n?0\n2\n\n0.\n41\n\n77\nE\n?0\n\n1\n?0\n\n.5\n89\n\n5E\n?0\n\n2\n?0\n\n.1\n55\n\n5E\n?0\n\n1\n\n6\n25\n\n.5\n12\n\n40\n3\n\n?1\n4,\n\n46\n2.\n\n99\n8\n\n?1\n7,\n\n79\n2.\n\n99\n6\n\n0.\n41\n\n31\nE\n?0\n\n3\n?0\n\n.5\n04\n\n0E\n?0\n\n2\n0.\n\n87\n46\n\nE\n?0\n\n3\n0.\n\n19\n05\n\nE\n?0\n\n2\n\n7\n25\n\n.5\n12\n\n40\n1\n\n?1\n4,\n\n46\n3.\n\n00\n0\n\n?1\n7,\n\n79\n3.\n\n00\n0\n\n?0\n.4\n\n76\n2E\n\n?0\n4\n\n0.\n58\n\n15\nE\n?0\n\n3\n?0\n\n.1\n01\n\n0E\n?0\n\n3\n?0\n\n.2\n19\n\n7E\n?0\n\n3\n\n8\n25\n\n.5\n12\n\n40\n1\n\n?1\n4,\n\n46\n3.\n\n00\n0\n\n?1\n7,\n\n79\n3.\n\n00\n0\n\n0.\n54\n\n95\nE\n?0\n\n5\n?0\n\n.6\n70\n\n8E\n?0\n\n4\n0.\n\n11\n65\n\nE\n?0\n\n4\n0.\n\n25\n35\n\nE\n?0\n\n4\n\n\n\n176 4 Trajectory Optimization\n\ntarget body B-plane, the time of closest approach to the final target body and the\naltitude of closest approach at some of the intervening bodies. The performance\ncriterion is the sum of the magnitudes of the propulsive maneuvers. At least two\npropulsive maneuvers are placed between each encounter en route to the target body.\nFor example, a multiple encounter mission to Mercury that is launched from Earth\nand encounters the Earth one additional time, Venus two times, and Mercury three\ntimes before arriving at the fourth and final Mercury encounter would have 7 legs\nwith 14 propulsive maneuvers for a minimum total of 42 independent parameters.\nThe constraint variables are the target body B-plane parameters including time of\nclosest approach at the fourth Mercury encounter. This strategy was implemented\nand a multiple encounter trajectory designed from Earth to Mercury. Since this\ntrajectory design is similar to the actual design of the MErcury Surface Space\nENvironment, GEochemistry, and Ranging (MESSENGER) mission to Mercury,\nthe results will be compared.\n\n4.8.1 Multiple Encounter Strategy\n\nApplication of parameter optimization algorithms to the problem of multiple\nplanetary encounter trajectory optimization from Earth launch to the target planet\nencounter is impractical. The number of independent parameters is excessive. For\na seven-encounter mission from Earth to Mercury with 18 propulsive maneuvers,\nfour more than the minimum required, the number of independent parameters is\n54 corresponding to three velocity components for each maneuver. The number of\nfunction evaluations per iteration required by the method of explicit functions is\nfour times the square of the number of parameters or 11,664. Other methods, such\nas gradient projection, would probably not fair any better. Each function evaluation\ninvolves integrating the trajectory from each propulsive maneuver to the final\nplanetary encounter. With current computer technology, the computer processing\ntime would be excessive. Another problem is even more insidious. The sensitivity of\na position perturbation at the target to a velocity perturbation near the Earth is about\n1032 s. In order to successfully target maneuvers, the trajectory calculations would\nneed to be carried out in quadruple precision (116 bits). A velocity perturbation\nof one Angstrom per 20 billon years at Earth launch would result in a 15 km\nperturbation at the final planetary encounter.\n\nThe strategy for reducing sensitivity to velocity perturbations is to divide the\ntrajectory into several legs and then group the legs into segments for optimization.\nA trajectory leg starts shortly after a planetary encounter and ends shortly after the\nnext planetary encounter. A trajectory segment consists of two successive trajectory\nlegs. For a given trajectory, the trajectory segments overlap and this results in the\nnumber of trajectory segments being one less than the number of legs. This strategy\nis illustrated on Fig. 4.3.\n\nThe ith leg is integrated from the initial time (toi) to the final time (tfi) and\nthe integration is stopped at each propulsive maneuver (tai, tbi, tci , \u00b7 \u00b7 \u00b7 ) and at\n\n\n\n4.8 Multiple Encounter Optimization 177\n\nE0 E1\n\nSegment 1\n\nSegment 2\n\nE  Earth\nV  Venus\nM  Mercury\n\nSegment 3\n\nleg 1 leg 2\n\nleg 2 leg 3\n\nleg 3 leg 4\n\nV1 V2 M1\n\nFig. 4.3 Definition of segments and legs\n\n?Xf\n?Vb\n\n?Xf\n?Va\n\n?Xf\n?Vc\n\n?Xe\n\nte, xe\ntf, xf\n\nto, xo\n\nVa Vb Vc\n\n?Xf\n?xo\n\n?xo\n\nFig. 4.4 Trajectory leg schematic diagram\n\nthe nominal time of the planetary encounter (tei). The spacecraft states and partial\nderivatives that are needed by the optimization algorithm are saved. This strategy\nis schematically represented on Fig. 4.4. The trajectory optimization algorithm is\ninitialized with a preliminary design obtained by patching conic sections using Lam-\nbert\u2019s theorem and other design techniques including shooting. This preliminary\ndesign fixes the time of the maneuvers and trajectory end points. The initial state\nis obtained for each leg along with nominal values for the deterministic propulsive\nmaneuvers and planetary encounter aim points. At the conclusion of an optimization\niteration, the propulsive maneuver velocity components are updated along with\nthe time and aim points at each planetary encounter. Because of nonlinearity and\nmachine precision, the initial state and propulsive maneuvers result in the trajectory\nmissing the desired encounter conditions at the planetary encounter associated with\neach leg. The intermediate planetary encounter times and aim points are needed to\nshepherd the trajectory to the final planetary encounter.\n\nFor the ith trajectory leg, the initial state and propulsive maneuvers that occur\nduring the ith leg are input to a precision trajectory propagator and the trajectory\nis integrated from toi to tfi . The spacecraft state at the planetary encounter of the\n\n\n\n178 4 Trajectory Optimization\n\nith leg will differ from the desired B-plane encounter conditions. A correction is\ncomputed for one of the propulsive maneuvers in the ith leg to force the trajectory\nthrough the desired position in the B-plane. The velocity error is left uncontrolled\nand is permitted to accumulate. Restoring the position error will tend to also restore\nthe velocity error. Thus, if the first maneuver in the ith leg is selected,\n\n?Vai =\n[\n?Bpi\n?Vai\n\n]?1\n(Bti ? Bpi) (4.54)\n\nB is a column matrix containing B-plane parameters that are a simple transformation\nof the spacecraft state at encounter into a two-body conic. Bpi contains the first three\nelements of B corresponding to position, and Bti are the desired target values at the\nith encounter.\n\nB = (B \u00b7T ,B \u00b7R, tp, V?, ??, ??)\n\nB \u00b7T and B \u00b7R are the coordinates of the approach asymptote in the target plane\nnormal to the approach asymptote, tp is the time of periapsis passage, V? is the\nmagnitude of the approach velocity vector, and ?? and ?? are the right ascension\nand declination of the approach asymptote, respectively. There is a one to one\ncorrespondence between the Cartesian state of the spacecraft and the B plane\nparameters.\n\nBi (t) = f (Xei, ?i, tei) (4.55)\n\nwhere ? is the gravitational parameter of the ith planet and tei is the time of the\nstate vector Xei at the ith planetary encounter. The incremental velocity change\n(?Vai) is added to Vai and the trajectory integrated again from toi to tfi . The\ntargeting calculations are repeated iteratively until the B-plane error is nulled to an\nacceptable tolerance.\n\nThe 3\u00d73 matrix of partial derivatives in Eq. (4.54) may be obtained from the first\nthree rows of the full state maneuver matrix that may be computed from the matrices\nillustrated in Fig. 4.4.\n\n[\n?Bi\n?Vai\n\n]\n=\n\n[\n?Bi\n?Xei\n\n] [\n?Xei\n?Xoi\n\n] [\n?Xfi\n?Xoi\n\n]?1 [\n?Xfi\n?Vai\n\n]\n\nThe state at the end of the ith trajectory leg is used to initialize the state at the\nbeginning of the i+1th leg. Starting with the first leg and continuing to the final leg,\nadjustments are made to the propulsive maneuvers that result in a smooth trajectory\nfrom launch to the final encounter that passes through the desired aim point at\neach planetary encounter with no position or velocity discontinuities. Since the\npropulsive maneuvers are modeled as finite burns, there is no velocity discontinuity\nassociated with propulsive maneuvers.\n\n\n\n4.8 Multiple Encounter Optimization 179\n\n4.8.2 Trajectory Segment Optimization\n\nThe trajectory optimization algorithm refines the constraint parameters and reduces\nthe total ?V required for propulsive maneuvers. This algorithm is applied iteratively\nuntil no further decrease is obtained. Between each iteration, the trajectory must be\nretargeted to remove position discontinuities introduced by nonlinearity. Because\nof the sensitivity of state perturbations at the end of a trajectory leg to velocity\nperturbations in the previous leg, it will be convenient to break the trajectory into\nsegments that span two successive trajectory legs as illustrated on Fig. 4.3. For a\ngiven trajectory segment, the initial state of the first leg and final state of the second\nleg are constrained to their current values and the only parameters that are permitted\nto vary are those associated with the propulsive maneuvers that occur during the\nsegment and the planetary encounter of the first leg. Since the legs are defined such\nthat there are no propulsive maneuvers after the planetary encounter, constraining\nthe end state of the second leg is equivalent to constraining the planetary encounter\non the second leg.\n\nThe constrained parameter optimization algorithm requires as input target values\nfor the constraint parameters, nominal values for the control parameters and\nconstraint parameters along with their partial derivatives obtained by precision\nnumerical integration of the state and variational equations. In addition, tolerances\non finite difference partial step sizes and convergence tolerances are needed. A linear\ncorrection to the control parameters is output that lowers the performance index and\nholds the constraint parameters at their target values. This processing is repeated\nfor each trajectory segment starting with the first two legs and proceeding to the\nfinal leg. At the completion of each segment, the encounter time and aim point for\nthe first leg in the segment must be updated. This update consists of mapping the\nvelocity change associated with propulsive maneuvers that occur during the first leg\nof each segment to the first leg encounter.\n\n?Bi = ?Bi\n?Vai\n\n?Vai + ?Bi\n?Vbi\n\n?Vbi + ?Bi\n?Vci\n\n?Vci + \u00b7 \u00b7 \u00b7 (4.56)\n\nThe encounter time and aim point for the second encounter need not be updated\nsince they are constrained. The second encounter of a trajectory segment becomes\nthe first encounter of the next segment and is updated as part of the processing of that\nsegment. The updated control and encounter aim points are targeted as described\nabove to remove position discontinuities between the segments caused by nonlin-\nearity. The targeting and optimization processing is repeated until convergence is\nobtained.\n\n\n\n180 4 Trajectory Optimization\n\n4.8.3 Multiple Encounter Example\n\nAs an example, a seven-encounter trajectory from Earth to Mercury is targeted\nto minimize propellant expenditure. This example is close to the MESSENGER\nMission trajectory. The major differences are in the trajectory propagator, and\ninitial conditions assumed. The initial state after launch is determined by processing\nseveral weeks of Doppler and range tracking data, and the resulting optimum\ntrajectory includes removal of actual launch vehicle injection errors. The first leg is a\nreturn to Earth trajectory, and the first segment includes the first encounter of Venus\nleg. Subsequent legs are a return to Venus and four Mercury encounters. In order to\nprevent the trajectory design from intersecting the surfaces of Venus and Mercury,\nthe second Venus encounter altitude is constrained to be no less than 300 km and the\nfirst three Mercury encounter altitudes are constrained to be no less than 200 km.\n\nThe velocity change associated with each maneuver is shown in Table 4.3.\nThe initial solution was obtained from the MESSENGER prelaunch trajectory\ndesign modified to remove the launch vehicle injection error. Because of minor\ntrajectory model errors, probably associated with solar pressure, the first iteration\ndiverges from the prelaunch reference trajectory and the total propulsive ?V is\nabout 1187 m/s. The next four iterations reduce the ?V by about 130 m/s resulting\nprimarily from optimizing allocation between maneuvers on the same leg. Some\n?V is shifted from leg 2 to leg 4 by adjusting the encounter aim point and arrival\ntime at leg 3. The last four iterations refine the propellant allocation among the\nmaneuvers and achieve another 10 m/s reduction in ?V .\n\nThe MESSENGER postlaunch trajectory design results are shown at the bottom\nof Table 4.3. The total ?V of 1042 m/s is 3 m/s less than obtained here. The ?V\nallocation to the individual legs may differ by 10\u201320 m/s. These differences may be\nattributed to modeling errors and curvature of the performance index function near\nthe optimum solution. The performance index function is nearly flat at the solution\npoint. Large changes in the control parameters that satisfy the constraints result in\nsmall changes in the performance index or ?V . This behavior of the performance\nindex function makes it difficult to find the true minimum. However, it does not cost\nmuch to be a little suboptimum.\n\n4.9 Summary\n\nTrajectory optimization performed for navigation involves searching for the initial\nconditions and deterministic propulsive maneuvers that acquire the target, satisfy\nmission constraints, and minimize some performance criterion such as fuel expen-\nditure. Analytic solutions are only approximate because their does not exist a closed\nform solution for the trajectory that is accurate enough. The method of Lagrange\nmultipliers, that is useful for an analytic solution, does not perform well when\nincorporated into a numerical search algorithm. The methods of explicit functions or\ngradient projection provide accurate numerical solutions. Since the solution does not\n\n\n\n4.9 Summary 181\n\nTa\nbl\n\ne\n4.\n\n3\nO\n\npt\nim\n\niz\nat\n\nio\nn\n\nof\nse\n\nve\nn-\n\nle\ng\n\nm\nis\n\nsi\non\n\nto\nM\n\ner\ncu\n\nry\n\nL\nE\n\nG\n1\n\n(E\n0-\n\nE\n1)\n\nL\nE\n\nG\n2\n\n(E\n1-\n\nV\n1)\n\nL\nE\n\nG\n3\n\n(V\n1-\n\nV\n2)\n\nL\nE\n\nG\n4\n\n(V\n3-\n\nM\n1)\n\nL\nE\n\nG\n5\n\n(H\n1-\n\nM\n2)\n\nL\nE\n\nG\n6\n\n(H\n2-\n\nM\n3)\n\nL\nE\n\nG\n7\n\n(M\n3-\n\nH\n4)\n\nM\nV\n\nR\n1a\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nIt\ner\n\nat\nio\n\nn\nM\n\nV\nR\n\n3\nM\n\nV\nR\n\n3\nM\n\nV\nR\n\n3\nM\n\nV\nR\n\n3\nTo\n\nta\nl\n\n1\n20\n\n.5\n3\n\n80\n.6\n\n2\n3.\n\n02\n7.\n\n46\n33\n\n.5\n8\n\n3.\n49\n\n13\n.9\n\n7\n\n5.\n11\n\n30\n4.\n\n33\n2.\n\n11\n20\n\n9.\n26\n\n73\n.2\n\n0\n24\n\n0.\n86\n\n17\n8.\n\n02\n\n2.\n34\n\n4.\n57\n\n2.\n76\n\n1.\n96\n\n11\n87\n\n.1\n6\n\n2\n20\n\n.4\n7\n\n70\n.2\n\n4\n2.\n\n98\n1.\n\n21\n34\n\n.1\n7\n\n1.\n80\n\n4.\n10\n\n5.\n14\n\n30\n3.\n\n49\n1.\n\n72\n20\n\n8.\n92\n\n73\n.6\n\n7\n24\n\n1.\n33\n\n17\n5.\n\n66\n\n3.\n29\n\n4.\n11\n\n0.\n99\n\n0.\n20\n\n11\n53\n\n.5\n1\n\n3\n20\n\n.3\n6\n\n0.\n54\n\n6.\n25\n\n11\n.3\n\n3\n30\n\n.7\n5\n\n2.\n30\n\n2.\n71\n\n5.\n34\n\n30\n1.\n\n65\n0.\n\n94\n12\n\n3.\n85\n\n74\n.3\n\n9\n24\n\n2.\n74\n\n17\n5.\n\n68\n\n4.\n88\n\n92\n.2\n\n0\n0.\n\n26\n0.\n\n22\n10\n\n96\n.3\n\n6\n\n4\n20\n\n.3\n7\n\n0.\n69\n\n2.\n45\n\n11\n.9\n\n1\n0.\n\n29\n0.\n\n41\n2.\n\n49\n\n5.\n46\n\n30\n4.\n\n19\n1.\n\n71\n10\n\n3.\n31\n\n69\n.1\n\n4\n24\n\n3.\n13\n\n17\n5.\n\n87\n\n1.\n82\n\n11\n9.\n\n17\n0.\n\n26\n0.\n\n13\n10\n\n62\n.7\n\n9\n\n5\n20\n\n.7\n4\n\n0.\n66\n\n2.\n40\n\n20\n.7\n\n4\n0.\n\n63\n0.\n\n53\n0.\n\n27\n\n5.\n33\n\n30\n6.\n\n92\n1.\n\n52\n20\n\n0.\n12\n\n73\n.9\n\n1\n24\n\n3.\n03\n\n17\n4.\n\n96\n\n1.\n37\n\n0.\n00\n\n1.\n19\n\n1.\n13\n\n10\n55\n\n.4\n5\n\n6\n19\n\n.9\n5\n\n1.\n60\n\n4.\n85\n\n0.\n37\n\n3.\n65\n\n0.\n60\n\n4.\n19\n\n5.\n72\n\n30\n3.\n\n04\n5.\n\n89\n21\n\n6.\n01\n\n71\n.8\n\n8\n23\n\n9.\n91\n\n17\n5.\n\n82\n\n0\n0\n\n0\n0\n\n10\n53\n\n.4\n9\n\n(c\non\n\ntin\nue\n\nd)\n\n\n\n182 4 Trajectory Optimization\n\nTa\nbl\n\ne\n4.\n\n3\n(c\n\non\ntin\n\nue\nd)\n\nL\nE\n\nG\n1\n\n(E\n0-\n\nE\n1)\n\nL\nE\n\nG\n2\n\n(E\n1-\n\nV\n1)\n\nL\nE\n\nG\n3\n\n(V\n1-\n\nV\n2)\n\nL\nE\n\nG\n4\n\n(V\n3-\n\nM\n1)\n\nL\nE\n\nG\n5\n\n(H\n1-\n\nM\n2)\n\nL\nE\n\nG\n6\n\n(H\n2-\n\nM\n3)\n\nL\nE\n\nG\n7\n\n(M\n3-\n\nH\n4)\n\nM\nV\n\nR\n1a\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n1\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nM\nV\n\nR\n2\n\nIt\ner\n\nat\nio\n\nn\nM\n\nV\nR\n\n3\nM\n\nV\nR\n\n3\nM\n\nV\nR\n\n3\nM\n\nV\nR\n\n3\nTo\n\nta\nl\n\n7\n20\n\n.7\n5\n\n1.\n39\n\n1.\n58\n\n13\n.4\n\n3\n1.\n\n08\n0.\n\n79\n0.\n\n31\n\n5.\n34\n\n30\n7.\n\n15\n1.\n\n88\n20\n\n2.\n27\n\n73\n.8\n\n6\n24\n\n2.\n26\n\n17\n5.\n\n01\n\n0.\n58\n\n2.\n24\n\n0.\n22\n\n1.\n00\n\n10\n51\n\n.1\n4\n\n8\n20\n\n.7\n4\n\n1.\n82\n\n1.\n58\n\n9.\n89\n\n1.\n52\n\n0.\n00\n\n0.\n86\n\n5.\n38\n\n30\n6.\n\n67\n2.\n\n18\n19\n\n9.\n70\n\n73\n.0\n\n9\n1.\n\n32\n0.\n\n33\n\n1.\n20\n\n5.\n78\n\n24\n2.\n\n98\n17\n\n4.\n92\n\n10\n49\n\n.9\n7\n\n9\n20\n\n.7\n4\n\n0.\n69\n\n1.\n03\n\n9.\n20\n\n0.\n53\n\n0.\n64\n\n0.\n33\n\n5.\n37\n\n30\n6.\n\n49\n1.\n\n62\n19\n\n9.\n90\n\n71\n.8\n\n6\n24\n\n2.\n91\n\n17\n4.\n\n91\n\n0.\n88\n\n5.\n81\n\n1.\n25\n\n0.\n53\n\n1.\n24\n\n10\n45\n\n.9\n5\n\nM\nE\n\nSS\nE\n\nN\nG\n\nE\nR\n\n0.\n64\n\n0.\n02\n\n1.\n43\n\n1.\n59\n\n0.\n08\n\n0.\n81\n\n1.\n74\n\n25\n.8\n\n2\n31\n\n2.\n20\n\n3.\n00\n\n6\n20\n\n4.\n82\n\n73\n.7\n\n7\n24\n\n0.\n35\n\n17\n6.\n\n35\n10\n\n42\n.6\n\n5\na M\n\nV\nR\n\n1\nis\n\nth\ne\n\ni\u2019\nth\n\npr\nop\n\nul\nsi\n\nve\nm\n\nan\neu\n\nve\nr\n\nof\nth\n\ne\nin\n\ndi\nca\n\nte\nd\n\nle\ng\n\nin\nm\n\net\ner\n\ns/\nse\n\nco\nnd\n\n\n\nExercises 183\n\ndepend on programming exact partial derivatives, finite difference partial derivatives\nare computed for the search. This is fortunate because a new set of analytic partial\nderivatives would have to be derived for every new problem. Once a solution is\nobtained, the high- precision trajectory can verify optimality by systematically\nperturbing the constraints.\n\nA problem with trajectory optimization is the large number of function eval-\nuations required when there are many constraint and control parameters. For the\nMESSENGER mission, it was necessary to segment the trajectory into overlapping\nsegments and optimize each segment. The resulting segments had to be retargeted\na small amount after each iteration to remove position discontinuities caused by\nnonlinearity. The segments also removed the extreme sensitivity of constraints to\nthe propulsive maneuvers.\n\nExercises\n\n4.1 A cylindrical oil can is being manufactured and, for a given volume, the cost of\nthe steel is proportional to the surface area of the can if it is assumed to have uniform\nthickness. The problem is to find the height and radius that minimize the amount\nof steel. This problem can be formulated as a constrained parameter optimization\nproblem where U1 = r , the radius, and U2 = h, the height.\n\nZc = ?U21 U2\nJ = V = 2?U21 + 2?U1U2\n\nUsing one of the optimization methods described in Sect. 4.4, determine the\noptimum U1 and U2. If the method of explicit functions is selected and Zf =\n?U1U\n\n2\n2 , the matrix inversion is simple and the solution is straightforward.\n\n4.2 A sphere is inscribed inside the oil can of Exercise 4.1. Determine the ratio of\nthe volume of this sphere to the volume of the oil can. This problem was solved by\nArchimedes and a cylinder and sphere were atop his tomb according to Cicero.\n\n4.3 The Hessian matrix (\n?2J\n\n?U?ZF\n) which is used to obtain a minimum in a Newton\u2013\n\nRaphson search can be used to verify that a minimum has been obtained. For the\nsample problem in Sect. 4.5, determine the Hessian and verify that it is positive\nindicating a minimum.\n\n4.4 For interplanetary maneuvers, the spacecraft is often targeted to B \u00b7R and B \u00b7T\nand the time of flight is not corrected and permitted to float. The optimum maneuver\ncan be found by solving a constrained parameter optimization problem.\n\nZc = (B \u00b7R,B \u00b7T )\n\n\n\n184 4 Trajectory Optimization\n\nZf = tp\nJ = |?V|\n\nThis maneuver is called a critical plane maneuver and can be computed from the K\nmatrix defined by\n\n[\n?B \u00b7R, B \u00b7T , tp\n\n?V\n\n]\n\nDetermine the critical plane maneuver directly from the K matrix and the B-plane\nmiss.\n\n4.5 A spacecraft that is approaching Mars is inserted directly into orbit with a\nperiapsis altitude of 1500 km and an orbit period of 24 h. The approach velocity\n(V?) is 2.54 km/s, GM is 42,828 km3/s2, and the radius of Mars is 3310 km. A\nsecond spacecraft with the same approach velocity is inserted into an orbit with a\nperiapsis altitude of 1000 km and the same apoapsis radius as the first spacecraft.\nA maneuver is executed at apoapsis to raise the periapsis altitude to 1500 km.\nAssuming the orbit insertion maneuvers are impulsive, determine the total ?v\nrequired for each strategy. Which strategy is most fuel efficient?\n\n4.6 Show that a Hohmann transfer between two circular orbits minimizes the launch\nenergy from the first orbit and the orbit insertion energy at the second orbit. The\nminimum energy transfer orbit will be tangential at the second orbit and ra will\nequal the radius of the second orbit. Crossing the second orbit requires more energy.\nThe problem is thus reduced to minimizing v with respect to the flight path angle ?\nsubject to the constraint that ra is the radius of the second orbit and r is the radius\nof the first orbit where\n\nv =\n?\n\nGM p\n\nr cos ?\n\n4.7 If ? happens to be zero in Exercise 4.6, minimizing v also minimizes the\nvelocity change since v and the orbital velocity are in the same direction. Compute\nthe launch energy from Earth for a mission to Mars and the orbit insertion energy\nat Mars where re = 0.149 \u00d7 109 km, rm = 0.227 \u00d7 109 km, GM = 0.132 \u00d7\n1012 km3s?2\n\nBibliography\n\nBryson, A. E. and Yu-Chi Ho, Applied Optimal Control, Ginn Blaisdell Pub. Co., Waltham, MA.,\n1969.\n\nFletcher, R. and M.J.D. Powell, \u201cA Rapidly Convergent Descent Method for Minimization\u201d,\nComputer Journal, July, 1963.\n\n\n\nBibliography 185\n\nHoffman, L. H. and R. N. Green,\u201cThrusting Trajectory Minimization Program for Orbital Transfer\nManeuvers\u201d, NASA TN d-1620, June 1971.\n\nMiller, J. K., \u201cDetermination of an Optimal Control for a Planetary Orbit Insertion Maneuver\u201d,\ninternal JPL document TM 392-94, July 20,1972.\n\nMiller, J. K., \u201cA Parameter Search and Optimization Algorithm for the Viking Mars Orbit Insertion\nManeuver\u201d, internal JPL document IOM 392.5-747, April 11,1974.\n\nMiller, J. K., \u201cDetermination of an Optimal Control Subject to Constraints by the Method of\nExplicit Functions\u201d, internal JPL document EM 314\u2013412, February 20,1987.\n\nMiller, J. K., \u201cConstrained Parameter Optimization by the Method of Explicit Functions: Applica-\ntion to MESSENGER Mission\u201d, Paper AAS 05\u2013174, 15th AAS/AIAA Space Flight Mechanics\nConference, Copper Mountain,CO, January 23\u201327, 2005.\n\nMiller, J. K., \u201cA Multiple Encounter Targeing and Optimization Algorithm\u201d, AAS 05\u2013336,\nAAS/AIAA Astrodynamics Specialist Conference, Lake Tahoe, CA, August 7, 2005.\n\nPines, S., \u201cAn accelerated Version of the JPL-MOIOP Numerical Search Optimization Method\u201d,\nRep.No. 73\u201332, Analytical Mechanics Associates Inc., June, 1973\n\nPines, S., \u201cA Direct Gradient Projection Method for Parameter Optimization with Nonlinear\nConstraints\u201d, AMA Rep. No. 75-8, Analytical Mechanics Associates Inc., April, 1975\n\n\n\nChapter 5\nProbability and Statistics\n\nNavigation of planetary spacecraft requires determining a nominal design trajectory\nthat obeys the laws of physics and has a high probability of achieving mission\nsuccess within the constraints of the mission objectives and the cost of the spacecraft\ndesign and mission operations. It is relatively easy to design a trajectory that satisfies\nall the physical laws but cannot be flown. For example, a trajectory describing the\npath of a coin that is tossed on the floor and rolls to a stop remaining on its edge\nis easy to design. However, the perturbations that the coin encounters as it rolls on\nthe floor almost guarantees that it will not remain on its edge. Spacecraft trajectory\ndesign encounters this same problem in many forms. Statistical perturbations of the\ntrajectory along the flight path may result in failure to meet mission objectives if\nnot complete failure as in the case of the coin. Therefore, the trajectory designer\nand navigator must give as much attention to the mathematics of probability and\nstatistics as to the laws of physics.\n\n5.1 Normal Probability Distribution Function (PDF)\n\nAn arrow or unguided rocket would score a direct hit on the target provided they\nwere launched with the proper initial conditions and there were no perturbing\nforces acting during transit. However, a body moving through the atmosphere will\nencounter dust particles or random hits from gas molecules that will deflect it from\nthe target. If a large number of arrows or rockets are launched, a pattern emerges\nfor the distribution of the impacts around the target. It is the characterization of\nthis distribution that is of interest. Consider the case of a body that is launched and\nencounters dust particles on the way to the target. Assume that the dust particles\ndeflect the body a fixed amount either to the right or to the left with equal probability.\nThe geometry is illustrated on Fig. 5.1. The first impact is identified by m = 0 and\nthe body moves an equal amount to the right or to the left. Both paths are shown\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_5\n\n187\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_5&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_5\n\n\n188 5 Probability and Statistics\n\nk = 0 k = 1 k = 2 k = 3\n\nm = 01\n\n1 1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n1\n\n1 6\n\n5\n\n4\n\n3\n\n2\n\n3\n\n6 4\n\n5\n\n615\n\n1010\n\n2015\n\nm = 1\n\nm = 2\n\nm = 3\n\nm = 4\n\nm = 5\n\nm = 6\n\nk = 4 k = 5 k = 6\nx\n\ny\n\nFig. 5.1 Pascal\u2019s triangle\n\nin Fig. 5.1. Each generation of impacts, corresponding to increasing values of m,\ndouble the number of possible paths. At the end of m generations, there are 2m\n\npossible paths. The number beside each of the nodes is the total number of paths\nthat pass through the node. Therefore, the probability that a path will pass through\na given node is the number beside the node divided by the total number of possible\npaths since all paths are equally likely. The triangle illustrated on Fig. 5.1 is called\nPascal\u2019s triangle, and the number of paths passing through each node is given by\n\np(m, k) =\n(\n\nm\n\nk\n\n)\n(\n\nm\n\nk\n\n)\n= m!\n\n(m ? k)! k!\n\nwhere k is the node numbered from the left starting at k = 0. For any given node of\nPascal\u2019s triangle, the number is the sum of the two numbers immediately above.\n\n(\nm + 1\nk + 1\n\n)\n=\n\n(\nm\n\nk\n\n)\n+\n\n(\nm\n\nk + 1\n)\n\nThe rows of Pascal\u2019s triangle are the coefficients of the binomial expansion. It\nwill be shown later that the mth row of Pascal\u2019s triangle may be approximated by\nthe normal probability distribution function (PDF) given by\n\ndP (x)\n\ndx\n= 1\n\n?\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\n\n(5.1)\n\n\n\n5.1 Normal Probability Distribution Function (PDF) 189\n\nafter x is properly scaled. In the limit as m goes to infinity, the approximation is\nexact. The probability that x is in the interval from x1 to x2 is given by\n\nP(x1, x2) =\n? x2\n\nx1\n\n1\n\n?\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\ndx\n\nand\n\n? ?\n??\n\n1\n\n?\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\ndx = 1\n\nA convenient measure of the spread of a PDF is given by the second moment\nabout the y axis, which is the moment of inertia, and when applied to a PDF is\ncalled the variance. The variance is simple to compute and has the property of\ngiving increased weight to the tails of the distribution just as the moment of inertia\ngives more weight to mass that is further from the axis of rotation. The variance is\ngiven by\n\nV =\n? ?\n\n??\nx2 p(x)dx\n\nSince the integral of the normal PDF from minus infinity to infinity is one, the\nfollowing is obtained after differentiating with respect to ? .\n\n? ?\n??\n\nx2\n\n? 4\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\ndx ?\n\n? ?\n??\n\n1\n\n? 2\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\ndx = 0\n\nAfter multiplying by ? 3, the variance is given by\n\nV =\n? ?\n\n??\nx2\n\n?\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\ndx = ? 2\n\n? ?\n??\n\n1\n\n?\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\ndx = ? 2 (5.2)\n\nThe variance (? 2) provides a measure of the error associated with a random variable\nand the reciprocal provides a measure of the accuracy. Since the application of\nvariance is often in its minimization, the square or quadratic form is mathematically\nconvenient since the minimum of a function of ? 2 is also the minimum of a function\nof ? . The simple result obtained for the variance was no accident but followed\ndirectly from the scaling assumed in Eq. (5.1).\n\n\n\n190 5 Probability and Statistics\n\n5.2 n-Dimensional Normal PDF\n\nThe joint PDF of n independent normally distributed random variables\n(y1, y2, . . . yn) is defined as the probability that y is in all of the intervals from\nyi to yi + ?yi . The PDF is obtained by multiplying together n normal PDFs.\n\np(y1, y2, . . . yn) = 1\n(2?)\n\nn\n2 (?y1?y2?y3 . . . ?yn)\n\nexp\n\n(\n?1\n\n2\n\nn?\ni=1\n\ny2i\n\n? 2yi\n\n)\n\nIn matrix notation, the normal joint PDF becomes\n\np(Y ) = 1\n(2?)\n\nn\n2 |A|? 12\n\nexp\n\n(\n?1\n\n2\nYT AY\n\n)\n(5.3)\n\nwhere\n\nY =\n\n?\n????\n\n?y1\n?y2\n...\n\n?y1\n\n?\n????\n\nand\n\nA =\n\n?\n??????????\n\n1\n? 2y1\n\n0 0 . . . 0\n\n0 1\n? 2y2\n\n0 . . . 0\n\n0 0 1\n? 2y3\n\n. . . 0\n\n...\n...\n\n...\n. . .\n\n...\n\n0 0 0 . . . 1\n? 2y1\n\n?\n??????????\n\nIf a new random variable X is defined that is a transformation or mapping of Y then\n\np(X) = 1\n(2?)\n\nn\n2 |B|? 12\n\nexp\n\n(\n?1\n\n2\nXT BX\n\n)\n(5.4)\n\nwhere\n\nX = R Y\nB = RAR?1\n\nThe matrix B is called the information matrix and the inverse of B is called the\ncovariance matrix. Each diagonal element of B?1 is the variance of the associated\n\n\n\n5.3 Bivariate Normal PDF 191\n\nrandom variable. The covariance matrix of the new multidimensional normal PDF\nof the random variables X is given by\n\nB?1 =\n\n?\n???????\n\n? 2x1 ?12?x1?x2 ?13?x1?x3 . . . ?1n?x1?x3\n?21?x2?x1 ?\n\n2\nx2\n\n?23?x2?x3 . . . ?2n?x2?xn\n?31?x3?x1 ?32?x3?x2 ?\n\n2\nx3\n\n. . . ?3n?x3?xn\n...\n\n...\n...\n\n. . .\n...\n\n?n1?xn?x1 ?n2?xn?x2 ?n3?xn?x3 . . . ?\n2\nxn\n\n?\n???????\n\nGiven B?1, the mapping matrix R can be found by extracting the eigenvalues of\nB?1. The matrix R is the matrix of eigenvectors, and the diagonal matrix A?1 has\nthe eigenvalues on the diagonal.\n\n5.3 Bivariate Normal PDF\n\nThe multidimensional normal PDF for n = 2 is called the bivariate normal PDF. The\nprobability that x is in the interval from x1 to x1 + ?x1 and in the interval from x2\nto x2 +?x2 is the probability that x is in the region defined by these intervals. If we\nassume that x1 and x2 are the Cartesian coordinates x and y, respectively, then the\nbivariate PDF gives the probability density associated with areas in the x ? y plane.\nLet X and Y be joint normal random variables. The covariance and determinate of\nB?1 are given by,\n\nB?1 =\n[\n\n? 2x ??x?y\n\n??x?y ?\n2\ny\n\n]\n\n|B?1| = (1 ? ?2)? 2x ? 2y\nand\n\nB = 1\n1 ? ?2\n\n[ 1\n? 2x\n\n? ?\n?x?y\n\n? ?\n?x?y\n\n1\n? 2y\n\n]\n\nThe bivariate normal PDF is thus given by\n\np(x, y) = 1\n2??x?y\n\n?\n1 ? ?2 exp\n\n(\n? 1\n\n2(1 ? ?2)\n\n[\nx2\n\n? 2x\n? 2?xy\n\n?x?y\n+ y\n\n2\n\n? 2y\n\n])\n(5.5)\n\nContours of constant p(x, y) plotted in the x ? y plane are ellipses given by\n\n\n\n192 5 Probability and Statistics\n\nx2\n\n? 2x\n? 2?xy\n\n?x?y\n+ y\n\n2\n\n? 2y\n= C\n\nwhere C is a constant. These ellipses have semi-major and semi-minor axes C?1 and\nC?2, respectively, given by\n\n?21 =\n1\n\n2\n(? 2x + ? 2y ) +\n\n????(? 2x ? ? 2y )\n2\n\n)2\n+ ?2? 2x ? 2y\n\n?22 =\n1\n\n2\n(? 2x + ? 2y ) ?\n\n????(? 2x ? ? 2y )\n2\n\n)2\n+ ?2? 2x ? 2y\n\nThe major axis of the error ellipse is inclined to the x axis at an angle (?) given by\n\n? = 1\n2\n\ntan?1\n(\n\n2??x?y\n? 2x ? ? 2y\n\n)\n\nIt can be shown that the probability that the random variables (x, y) are inside the\nerror ellipse is\n\np(x, y) = 1 ? e\n?\n?\n?C2\n\n2\n\n?\n?\n\nFor integer values of C the corresponding error ellipses are often referred to as the\nC sigma error ellipses. Thus, the probability of X being in the one sigma or three\nsigma error ellipse is 0.393 and 0.989, respectively.\n\nAn example of the application of the bivariate PDF to navigation was provided\nby the Viking mission to Mars. The Viking lander was targeted to a landing site\ndefined by target coordinates xt and yt . Analysis of the accuracy of the orbit of\nthe Viking orbiter and the lander descent trajectory revealed a footprint centered\nat the targeted landing site and oriented as shown schematically in Fig. 5.2. The\nfootprint is jargon for a bivariate PDF. Orbiter reconnaissance images of the landing\nsite region revealed a large crater just outside of the footprint. The crater is also\nshown in Fig. 5.2 overlaid with a grid of rectangles of width ?x and ?y. The center\nof each rectangle within the crater has coordinates (xi, yj ). The probability that\nthe lander will land in the crater is obtained by integrating the associated bivariate\nPDF over the crater area. This integral, in the limit as ?x and ?y approach zero, is\ngiven by\n\nP =\n?\n\np(xi, yj )?x?y\n\nThe numerical integration revealed a probability of less than 10?5, and this was\njudged to be small enough that the lander was not retargeted.\n\n\n\n5.4 Rayleigh PDF 193\n\nFig. 5.2 Lander footprint\n\ntarget\n(xt,yt)\n\nxi, yj\n\nfootprint\n(1s bivariate PDF)\n\ncrater\n\nx\n\ny\n\n5.4 Rayleigh PDF\n\nA special case of the bivariate PDF occurs when ?x and ?y are equal and x and y are\nindependent (? = 0). The resulting error ellipse is a circle and the PDF reduces to\n\np(x, y) = 1\n2?? 2\n\ne\n\n?\n?\n?x2 + y2\n\n2? 2\n\n?\n?\n\nThe probability of the random variable X being in the circle is obtained by\nintegrating the PDF over the circle. A change of variable to polar coordinates\nsimplifies the integration and\n\nP(r, ?) = 1\n2?? 2\n\n? 2?\n0\n\n? r\n0\n\ne\n\n?\n?\n? r2\n\n2? 2\n\n?\n?\nrdrd?\n\nPerforming the ? integration first,\n\nP(r) = 1\n? 2\n\n? r\n0\n\ne\n\n?\n?\n? r2\n\n2? 2\n\n?\n?\nrdr\n\nand the PDF associated with r is given by\n\np(r) = r\n? 2\n\ne\n\n?\n?\n? r2\n\n2? 2\n\n?\n?\n\n\n\n194 5 Probability and Statistics\n\nand is called the Rayleigh PDF. The Rayleigh PDF has many applications in\nprobability and statistics. One application is in setting accuracy requirements for\narmament such as artillery and rockets. Several rounds are fired, and a circle is\ndrawn around the target that encompasses the impacts of exactly half of the rounds.\nThis circle and its associated probability is called the Circular Error Probable in\nmilitary jargon or simply CEP. The probability of impact within the circle may be\nobtained by carrying out the integration of the Rayleigh PDF with respect to r .\n\nP(r) = 1 ? e\n?\n?\n? r2\n\n2? 2\n\n?\n?\n\n(5.6)\n\nThe probability of being in a circle of radius one sigma where the PDF is Rayleigh\nis the same as being in a one sigma error ellipse where the PDF is bivariate. The\nequivalence of these probabilities can be shown by an appropriate scaling of the x\nand y axes of the bivariate PDF. For the CEP, where the probability is one half, the\ncorresponding error ellipse of the bivariate is at 1.17741 sigma.\n\n5.5 Central Limit Theorem\n\nThe artifically contrived problem of an arrow or unguided rocket being deflected to\nthe left or to the right with equal probability is equivalent to the problem of flipping\na coin to decide the path to follow. An interesting result has been obtained. The sum\nof many trials involving a probability distribution function that has only two states\nof equal probability results in the normal distribution function. The central limit\ntheorem considers the problem of a sum drawn from a large number of probability\ndistribution functions of arbitrary distribution. The central limit theorem states,\nin essence, that this sum also has a normal distribution. The proof is nontrivial\nand involves some complex issues. However, the central limit theorem is of such\nimportance to probability and statistics that a simplified outline of this proof,\nprovided by Harry Lass, is given.\n\nConsider an arbitrary probability density function of zero mean and variance ? .\nThe Fourier transform is obtained from the moment generating function and\n\nFx(?) = 1 ? ?\n2?2\n\n2\n+ K3?3 + K4?4 + . . .\n\nThe PDF of the sum of two samples drawn from Fx is obtained by evaluation of\nthe convolution integral associated with the probability distribution of each sample.\nThe convolution of probability density functions involves a double integral that\nsums the probabilities associated with all the ways that two numbers can sum to\na third number. The Fourier transform of the convolved functions is simply the\nproduct of the Fourier transform associated with each function. Therefore, the\n\n\n\n5.6 Monte Carlo Methods 195\n\nFourier transform of the sum of n samples from Fx is obtained by raising Fx to\nthe nth power. As the number of convolutions approaches infinity, the variance of\nthe resulting probability distribution function will also approach infinity. In order\nto bound the resulting variance, the variance of Fx must be scaled down and this is\naccomplished by scaling the variable ? to ??\n\nn\n. The scaling preserves the variance\n\nwithout changing the shape of the probability distribution function. The Fourier\ntransform of the resulting probability distribution becomes,\n\nFy(?) =\n[\n\n1 ? ?\n2?2\n\n2n\n+ K( ??\n\nn\n)\n?3\n\nn\n3\n2\n\n]n\n= f (n)n\n\nMaking use of the relationship\n\nFy = [f (n)]n = exp[n ln f (n)] = exp\n(\n\nln f (n)\n\nn?1\n\n)\n\nThe limit of Fy , as n approaches infinity, is obtained by applying L\u2019Hospital\u2019s rule.\n\nlim\nn?? Fy = limn?? exp\n\n?\n???\n\n? 2?2\n\n2 n\n?2 ? 32K( ??n )?3n?\n\n5\n2 ? 12\n\n?K( ??\nn\n)\n\n?( ??\nn\n)\n\n?4n\n?5\n2\n\n?n?2f (n)\n\n?\n???\n\nlim\nn?? Fy = exp\n\n(?? 2?2\n2\n\n)\n\nIn the limit as n approaches infinity, the inverse Fourier transform of Fy is the normal\nPDF.\n\n5.6 Monte Carlo Methods\n\nNavigation requirements are generally based on an analysis of various errors\nthat affect the determination and control of a spacecraft trajectory. The errors\nin parameters that are of interest are generally expressed in the elements of the\ncovariance matrix associated with these parameters. Instrumentation and spacecraft\nexecution errors are evaluated to determine the covariance matrix that describes\nthe errors in design parameters such as closeness of the spacecraft to the target or\nthe amount of fuel that may be consumed in performing the mission. Conversely,\nthe desired maximum value for the errors in mission design parameters drives the\naccuracy requirements on navigation instrumentation and spacecraft system design.\n\nFor a spacecraft approaching a planet or in a well-determined orbit, the covari-\nance matrix is often used to describe the errors of interest. Since the errors in\ntrajectory parameters in deep space far from a planetary body are small compared to\n\n\n\n196 5 Probability and Statistics\n\nthe magnitude of the parameters being determined, the statistics tend to be normally\ndistributed owing to the central limit theorem. Also, for small perturbations from the\nnominal value of these parameters, the design parameters are linear, the linear theory\nthat orbit determination is based on is validated, and the normal PDF associated with\nthe covariance matrix provides an excellent description of the error distribution.\n\nAs a spacecraft approaches a planetary body and is inserted into orbit or descends\nfrom an orbit to land on a body, the errors in knowledge of trajectory grow and may\nexceed the region where linear theory may be applied. The resulting probability\ndistribution is often distorted from the normal curve. Unfortunately, the probability\ndistribution of the spacecraft state on achieving orbit or at touchdown of a lander\nis of considerable interest to trajectory design. The probability distribution may\nbe determined by application of a simple but powerful technique called Monte\nCarlo mapping named after the gambling casinos of Monte Carlo. The Monte\nCarlo technique consists of defining a mathematical model of the system being\ninvestigated including all the error sources that affect the outcome and performing\na statistical analysis of the outcome of many executions of the mathematical model.\n\nFor application of the Monte Carlo method to navigation analysis, a precision\nmodel of the spacecraft trajectory must be defined. This model involves numerical\nintegration of the equations of motion, including propulsive events, from initial\nconditions determined, for example, on approach to a planetary body to final\nconditions computed in orbit. The error sources include initial spacecraft state and\npropulsion system execution errors. Error sources are described by their associated\nPDF which is generally normal or uniform. A random number generator is used to\ngenerate samples of the PDF associated with each error source. A separate random\nnumber generator is required for each PDF and may not be readily available. Most\ncomputers have a random number generator that will generate random numbers\nbetween 0 and 1 that are uniformly distributed. One method for obtaining these\nnumbers might be to take the first 10 digits of pi and put a decimal point in front\nof them. The next random number may be formed from the next 10 digits of pi.\nThe uniform random number generators for most computers are more sophisticated\nthan this simple example but using pi would suffice since the digits are random. The\nnormal PDF can be formed from uniform random numbers by use of the central limit\ntheorem. For example, 6 random numbers uniformly distributed between ?1 and 1\nare obtained and added together. Since the variance of a single sample is one third,\nthe PDF obtained by adding 6 samples has a variance of 2 and standard deviation?\n\n2. The resultant PDF may be scaled to have unity variance by dividing each sum\nof 6 samples by\n\n?\n2. The result is a PDF that approximates the normal PDF and is\n\nbounded by plus and minus 3\n?\n\n2-sigma. Figure 5.3 shows a histogram with a bin\nwidth of 0.05 generated from 2 million samples of this normal PDF approximation.\nThe normal PDF (dashed line) is also shown for comparison.\n\nRandom numbers generated from a normal PDF with a variance of one are\nmultiplied times the standard deviation of all the independent parameters that\ncontribute to the final result. Included in this set of independent parameters are\ninitial conditions and random parameters associated with propulsive events. The\ntrajectory is propagated from the initial condition to the final condition n times,\n\n\n\n5.6 Monte Carlo Methods 197\n\n40000\n\n30000\n\n20000\n\n10000\n\n0\n-4 -3 -2 -1 0 1 2 3 4\n\nFig. 5.3 Histogram of normal approximation\n\nand the parameters of interest are saved in n random vectors Xi . For each of the n\ntrajectory propagations, new random numbers are drawn for each of the independent\nparameters. The number of Monte Carlo samples (n) generated is limited by the\ncomputer time required to generate each sample. The more samples, the better, and\nthe minimum required is generally around 500. Once the samples are generated, the\nresults may be displayed in a form that is useful for navigation analysis.\n\nThe sample mean is obtained by summing the samples and dividing by the total\nnumber of samples.\n\nX? = 1\nn\n\nn?\ni=1\n\nXi\n\nThe sample variance is obtained by summing the squares of the difference between\nthe samples and the true sample mean and dividing by the number of samples. The\nsample covariance is obtained by summing both the squares and cross-products of\nthe sample differences and dividing by the number of samples (n). The square and\ncross-product of a sample column vector is obtained by taking the outer product or\npost multiplying by its transpose. If the sample mean is used for the true mean, it\ncan be shown that the best estimate of the covariance is obtained by dividing by\nn ? 1 and the best estimate of the sample covariance is given by,\n\nCov = 1\nn ? 1\n\nn?\ni=1\n\n(Xi ? X?)(Xi ? X?)T\n\nThe Monte Carlo method is generally used when the uncertainties of the parameters\nof interest are greater than can be determined using linear theory. As a result, the\n\n\n\n198 5 Probability and Statistics\n\ndistribution is generally not normal and cannot be represented by simple functions.\nTherefore, it is necessary to display the results in a format that permits observation\nof the true distribution. A histogram is useful for this purpose. The maximum and\nminimum values of each parameter are determined, and the range of each variable is\ndivided into 10\u201325 intervals called bins. A bar graph is generated with the number of\nsamples in each bin plotted as a function of the parameter of interest. The histogram\ngives some insight into the probability that certain critical design values may or may\nnot be exceeded.\n\nAs a rule of thumb, the one sigma probability level is of interest for parameters\nthat are loosely controlled. For example, a probability of obtaining some science\nobservation of around 50% may be acceptable if the observation may be easily\nrepeated. For parameters that are critical to mission success, a higher probability\nlevel is often required. A 99% probability of success is generally acceptable for\nsituations where the total mission objectives may not be met but most of the mission\nmay be salvaged in the event of failure. An example of a parameter that is controlled\nto 99% probability is the amount of fuel required to do the mission. If the spacecraft\nruns out of fuel and most of the mission objectives are satisfied, a 99% success rate\nis generally acceptable. For design parameters that can result in catastrophic loss of\nthe mission, a much higher probability of success is required. A failure rate less than\n10?5 is often specified. Examples of requirements that must be met with very high\nprobability of success are planetary quarantine and unintended planetary impact.\n\nThe histogram is generally not a satisfactory tool for evaluating probability levels\nat the high or low end or tails of the PDF. One approach is to display the actual\nsamples on a graph and inspect for samples that may exceed design limits. Figure 5.4\nshows a plot of 250 Monte Carlo samples obtained for analysis of the NEAR\nlanding. Plotted is the sub-latitude point of the NEAR spacecraft as a function\nof time from the beginning of the descent to landing on the surface of Eros. The\nvariations in latitude on the way down are caused by a series of braking maneuvers\ndesigned to slow the spacecraft\u2019s descent and the initial orbit determination error.\nThe spread in latitude for all the sample trajectories reveals one component of the\nlanded footprint. Other parameters may be displayed on similar plots to gain insight\ninto the landing site dispersions. The spread in latitude shown in Fig. 5.4 indicates a\none sigma error of about 2?. The actual landing was within about one degree of the\nintended target.\n\nAnother approach is to order the Monte Carlo samples from low to high and\nestimate the probability level directly from the sample. For example, the cumulative\n99% probability level may be estimated from a sample size of 500 by determining\nthe fifth largest sample. On the average, 1% or about 5 samples will be above the\n99% cumulative probability level. A problem with estimating probability levels\nfrom the tails of a distribution is the uncertainty or confidence associated with\nthese estimates. By application of order statistics using the binomial distribution,\nthe confidence level associated with estimates of the cumulative probability may be\ndetermined.\n\n\n\n5.7 Binomial Theorem 199\n\n\u201320\n\n\u201340\n\n\u201335\n\n\u201330\n\nLa\ntit\n\nud\ne \n\n(d\neg\n\n)\n\n\u201310 0 10 20 30 40 50\nMinutes past \u2013 Feb 12, 2000 \u2013 19 : 00 : 00 UT\n\nFig. 5.4 NEAR landing Monte Carlo samples\n\n5.7 Binomial Theorem\n\nIt has been said that all problems in probability and statistics can be solved\nby flipping coins. This may not be true, but it seems to be true for problems\nassociated with navigation of spacecraft. The binomial theorem is the basis for\nsolving problems associated with flipping coins. The normal probability distribution\nfunction, the gamma function, and the mathematics associated with computing\ngambling odds and predicting elections are all based on the binomial expansion.\nFor navigation, the prediction of where a spacecraft will be in the future and the\namount of fuel that will be needed is an example of application of the binomial\ntheorem.\n\n5.7.1 Confidence Limits\n\nIn determining estimates of cumulative probability levels, the mean and variance of\nthe statistics do not provide a useful measure of the error in these estimates. The\ncloseness of the estimate to the true value is less interesting than the probability\nthat the estimate is bounded by some value. For the cumulative probability, a \u201cbest\u201d\nestimate may be obtained by determining the value that bounds the probability for\n50% of the sample sets obtained. The actual cumulative probability is above the\nestimate for 50% of the sample sets and below the estimate for the other 50%. Thus,\nthe estimate of the 99% cumulative probability from a single sample set of 500\nsamples would bound this probability for 50% of all of the sample sets obtained.\n\n\n\n200 5 Probability and Statistics\n\nThe usefulness of the 99% cumulative probability level obtained in this manner\nmay be called into question since the actual cumulative probability may exceed this\nvalue for half the sample sets. An estimate of the probability that the estimated\ncumulative probability may exceed some value may be obtained by examining the\nvalues of samples that are greater than the fifth highest sample for 500 samples.\nThis probability, referred to as the confidence, may be determined by computing\nthe probability that exactly 4, 3, 2, 1, or 0 samples will exceed the cumulative\nprobability level for a particular sample set.\n\nThe cumulative probability function for the PDF p(x) is defined by,\n\npc(xq) =\n? xq\n\n??\np(x)dx = Prob(x < xq)\n\nThe confidence probability function is defined by,\n\nw(q, xw) = Prob(xq < xw)\n\nFor a Monte Carlo sample set of n samples, the above functions are only defined on\ninteger values and may be made continuous by linear interpolation between these\nvalues. Consider a sample Xk from a set of n samples that are ordered in a decreasing\nmonotone for increasing k. X1 is the highest sample and Xn is the lowest. The\nproblem of determining w may be cast as an application of Bernoulli trials using\nthe binomial theorem. If the probability wk , for the kth sample, that Xk is greater\nthan xq is defined as failure and Xk being less than xq is defined as success, then the\nprobability of failure may be obtained from the binomial theorem and\n\nwk = 1 ?\nk?\n\ni=0\n\n(\nn\n\ni\n\n)\nqi (1 ? q)n?i\n\nwhere q = 1 ? pc is the probability that a particular sample will exceed xq .\nThe quantities being summed are Bernoulli trials that give the probability\n\nthat exactly i samples will exceed xq . The summation is needed to compute the\nprobability that exactly 0 or 1 or . . . k samples exceed xq and this result is subtracted\nfrom 1 to obtain the desired probability. The probability that Xk exceeds the pc\nprobability level is wk . An interesting property of wk is that the probability is\nindependent of the distribution.\n\nk Sample number wk Xk\n0 500 0.992 3.39\n1 499 0.966 3.08\n2 498 0.883 2.69\n3 497 0.742 2.45\n4 496 0.566 2.35\n5 495 0.391 2.28\n\n\n\n5.7 Binomial Theorem 201\n\nAn application of confidence limits to navigation was in the determination of\nthe amount of fuel required for the Viking and Galileo missions. The amount\nof fuel loaded at launch is the amount required for deterministic maneuvers, an\nadditional amount for statistical maneuvers and project reserve for contingencies.\nThe statistical component was determined by Monte Carlo analysis and was sized to\ngive 99% probability of not running out of fuel. In order to account for uncertainties\nin determining the statistical component associated with sample size, the statistical\nfuel budget for Viking was increased by 20%.\n\n5.7.2 Normal PDF from Binomial Coefficients\n\nFor a given row (m) of Pascal\u2019s triangle, the probability (P(k)) that the body will\npass through a given node of number k is given by the number of paths that reach\nnode p(k) divided by the total number of possible paths (2m). All paths are assumed\nto be equally likely.\n\nP(k) = 1\n2m\n\np(k) = 1\n2m\n\nm!\n(m ? k)! k!\n\nConnecting the integer values of p(k) with straight lines, a continuous function may\nbe defined. The derivative of p(k) with respect to k is given by\n\nd\n\ndk\np(k) = p(k + 1) ? p(k)\n\nk + 1 ? k\nThe derivative with respect to k is discontinuous at integer values of k, so the\nderivative is defined approaching k from the right. Extracting common factors from\np(k + 1), the following differential equation is obtained:\n\nd\n\ndk\np(k) = p(k)m ? 2k ? 1\n\nk + 1\nSince the function p(k) is symmetrical about the y axis, as shown in Fig. 5.1, it will\nbe convenient to shift the y axis and define k2 such that it is zero in the middle of\nthe distribution function. Also, for convenience, let m be even.\n\nk2 = k ? m\n2\n\nand\n\ndp(k2)\n\ndk2\n= ?4k2 ? 2\n\n2k2 + m + 2 p(k2)\n\n\n\n202 5 Probability and Statistics\n\nIn the limit as both m and k2 approach infinity and for k2 <<< m\n\ndp(k2)\n\ndk2\n= ?4k2\n\nm\np(k2)\n\nThe differential equation for p(k2) has the solution\n\np(k2) = p(0) e\n?2k22\n\nm\n\np(0) =\n(\n\nm\nm\n\n2\n\n)\n\nThe above formula provides approximate values for the mth row of Pascal\u2019s triangle.\nThe approximation is good for small values of k2 near the middle and for large\nvalues of m. Some typical values for the numbers in Pascal\u2019s triangle are compared\nwith the approximate formula in the table below\n\nk2 m k\n\n(\nm\n\nk\n\n)\np(0)e\n\n?2k22\nm\n\n0 20 10 184,756 184,756\n1 20 11 167,960 167,174\n5 20 15 15504 15,165\n5 40 25 4.02E10 3.95E10\n9 40 29 2.31E09 2.40E09\n\nThe probability that the body defined above will pass through a node at location\nk2 is the value from Pascal\u2019s triangle divided by 2m. The probability of passing\nthrough an interval between two nodes is obtained by integrating or summing p(k2)\nfrom k2(1) to k2(2) and the integral of p(k2) from ?m2 to +m2 is one. The probability\nis given by\n\nP =\n? k2(2)\n\nk2(1)\n\n1\n\n2m\np(k2) dk2\n\nA more convenient method of evaluating the same probability may be obtained\nby scaling k2 by an appropriate factor and normalizing the integral. A change of\nvariable from k2 to x, where x is defined by,\n\nx =\n?\n\n4\n\nm\n? k2\n\nyields\n\n\n\n5.7 Binomial Theorem 203\n\np(x) = C1 e\n?\n?\n? x2\n\n2? 2\n\n?\n?\n\nObserve that for a given probability the ratio of x to ? is constant,\n\nx\n\n?\n= 2k2?\n\nm\n= C2\n\nIn the limit as m approaches infinity, the ratio of k2 to m is\n\nlim\nm??\n\nk2\n\nm\n= lim\n\nm??\n\n?\nm C2\n\n2m\n= 0\n\nand the assumption that k2 is much smaller than m is valid. Since the integral of p(x)\nfrom minus infinity to plus infinity must be one, the final form of p(x) is obtained\nafter evaluating the constant C1.\n\n? ?\n??\n\nexp\n?\n?\n? x2\n\n2? 2\n\n?\n?\n\ndx = ??2?\n\np(x) = 1\n?\n?\n\n2?\ne\n\n?\n?\n? x2\n\n2? 2\n\n?\n?\n\nThe function p(x) is called the normal probability distribution function (PDF) and\nhas wide application in the field of probability and statistics. Many applications\nof the normal PDF involve solving for system parameters that minimize the error\nor spread of the PDF associated with random variables that are of interest. These\nrandom variables may describe the distance of a spacecraft from its intended target\nor the amount of fuel consumed during the mission.\n\n5.7.3 Approximate Binomial Coefficients from Normal PDF\n\nRecall that the difference equation for the binomial coefficients is given by\n\nd\n\ndk2\nBm(k2) = ?4 k2 ? 2\n\n2 k2 + m + 2 Bm(k2)\n\nk2 = k ? m\n2\n\nIn the limit as m becomes much greater than k2, the central part of the distribution\nfunction corresponding to k2 much smaller than m is given by the following\n\n\n\n204 5 Probability and Statistics\n\ndifferential equation:\n\ndBm(k2)\n\ndk2\n= ?4 k2\n\nm\nBm(k2)\n\nwhere Bm are the binomial coefficients for the mth row of Pascal\u2019s triangle. The\ndifferential equation for Bm(k2) has the solution\n\nBm(k2) = Bm(0) e\n?2 k22\n\nm\n\nBm(0) =\n(\n\nm\nm\n\n2\n\n)\n\nThe probability of being in the interval defined by Bm(0) of width one is obtained\nby integrating the PDF from k2 = ? 12 to k2 = + 12 .\n\nBm(0)\n\n2m\n=\n\n?\n1\n\n?\n?\n\n2?\ndx =\n\n?\n1\n\n?\n?\n\n2?\n\n?\n4\n\nm\n? dk2\n\nThe binomial coefficients are thus given by the following formula:\n\nBm(k2) = m!\n(m ? k)! k! ?\n\n?\n2\n\n?\n\n2m?\nm\n\nexp\n\n?2 k22\nm\n\n5.7.4 Stirling Approximation\n\nThe binomial coefficients may also be obtained by direct application of Stirling\u2019s\napproximation to the factorial functions defining the binomial coefficients. The\nStirling approximation to the gamma function is given by\n\nln(n!) ? n ln(n) ? n + 1\n2\n\nln(2?n) = ln\n(?\n\n2?n\n(n\n\ne\n\n)n)\nn! ? ?2?n\n\n(n\ne\n\n)n\nThe results of approximating the binomial coefficients using the Stirling approxi-\nmation and the normal approximation derived in Sect. 5.7.3 are shown in Fig. 5.5.\nThe Stirling approximation for the binomial coefficients is exact for large values\nof m but does not do as well in the interior of the PDF. The normal distribution\napproximation is also exact as m approaches infinity. Observe that the normal and\nStirling approximations are equal at the peak of the distribution corresponding to\n\n\n\n5.7 Binomial Theorem 205\n\nFig. 5.5 Binomial coefficients approximation\n\nk = 50. This suggests that the Stirling approximation has the normal Gaussian\ndistribution embedded. This is indeed the case as the following identity shows:\n\nBm(0) = m!(\nm\n2 !\n)2 ?\n\n?\n2\n\n?\n\n2m?\nm\n\n=\n?\n\n2?m\n(\n\nm\ne\n\n)m\n[?\n\n?m\n(\n\nm\n2e\n\n)m\n2\n]2\n\nThe above identity suggests that the Stirling approximation may be extracted\ndirectly from the binomial coefficients. In the following equation, all the numerators\n\n\n\n206 5 Probability and Statistics\n\nare canceled by the denominators in the preceeding term except for the first\nnumerator which is m!.\n\nm! = m!(\nm\n2 !\n)2\n\n( (\nm\n2 !\n)\n\n(\nm\n4 !\n)2\n\n)2 ( (m\n4 !\n)\n\n(\nm\n8 !\n)2\n\n)4\n\u00b7 \u00b7 \u00b7\n\n(\n2!\n1!2\n\n)N\n\nN = 2 ln mln 2 ?1\n\nwhere N is 2 raised to the number of terms in the approximation for m! minus one.\nN is also the power of two corresponding to the m! that exceeds the desired m!.\nThe desired m! is obtained by interpolation. The terms in the above product may be\napproximated by\n\nm! =\nN?\n\nn=0\n\n?\n??\n\n(\nm!\n2n !\n\n)\n(\n\nm\n2n+1 !\n\n)2\n?\n??\n\n2n\n\n?\nN?\n\nn=0\n\n?\n?? 2\n\n?\n\n2\nm\n2n?\nm\n2n\n\n?\n?\n\n2n\n\nIf Bm(0) is factored out of each of the terms, m! is approximated by\n\nm! ?\nN?\n\nn=0\n\n(?\n2\n\n?\n\n2m?\nm\n\n)2n (\n2\n\nm\n2n ?m\n\n2\n?n\n2\n\n)2n\n\nThe logarithm of m! is approximated by\n\nln m! ? \n(m+1) ? ln\n(?\n\n2\n\n?\n\n2m?\nm\n\n)\nN?\n\nn=0\n2n+ln(2)\n\nN?\nn=1\n\n(n2n?1?m2n+m) (5.7)\n\nThe finite series can be replaced by closed form expressions and an approximation\nfor m! is obtained that is exact in the limit as m approaches infinity. The last term\nis needed to account for the error in the normal binomial coefficients for small m.\nThus, we have a closed form expression for ln(m!) as a function of only m.\n\nln m! ? ln\n(?\n\n2\n\n?\n\n2m?\nm\n\n)[\n2N+1 ? 1\n\n]\n\n+ ln(2)\n[\n1 ? 2N + N2N ? m(2N+1 ? 2) + mN\n\n]\n? 0.08105638054266 m\n\nN = 2\nln m ? ln 2\n\nln 2 (5.8)\n\nThe constant in the above equation was obtained by forcing the approximation\nto equal the actual value of m! at m = 128. Over the range of m from 1 to\n\n\n\n5.8 Maxwell\u2013Boltzmann Probability Distribution 207\n\n158, the above approximation is twice as accurate as the Stirling approximation. If\n5.0862526726\u00d710?6 m is added to the Stirling approximation, both approximations\nagree to 14 decimal places over the same range. This agreement indicates that a\nsimple correction term can be found to make both approximations exactly equal and\nthe deep underlying mathematical basis for both approximations is the normal PDF\nor the binomial coefficients.\n\n5.8 Maxwell\u2013Boltzmann Probability Distribution\n\nSignificant trajectory perturbations have been observed on interplanetary missions\nthat have been attributed to expulsion of gas from the spacecraft. In 1969, the\nMariner 6 spacecraft experienced a large trajectory perturbation and loss of attitude\ncontrol lock on the star Canopus because of hydrogen gas expelled during a scan\nplatform unlatching event. The scan platform was held in the latched position by\npressure from hydrogen gas. Hydrogen gas was expelled by firing a squib and\nventing to a tee. The tee was supposed to vent the gas in opposite directions,\nresulting in no net forces on the spacecraft and the observed trajectory and attitude\nperturbations were a mystery. A complete third spacecraft was built and was sitting\non display in Von Karman Auditorium at the Jet Propulsion Laboratory. After\nsome searching, the tee was located in a large cavity under the scan platform.\nThe cavity served as a big rocket engine and the thrust, computed from kinetic\ntheory, matched the velocity change observed in the orbit determination solution.\nThe applied moment was also consistent with the attitude recovered from sun sensor\ntelemetry. The result of this analysis was used to predict the velocity change that\nMariner 7 experienced a few weeks later. On the Viking Mission in 1975, venting of\ngas trapped in the parachute, at least this was the theory, resulted in a perturbation of\nthe spacecraft for about a week after launch making determination of the spacecraft\norbit difficult. Kinetic theory was used to predict the velocity change associated with\nseveral gas venting events during cruise. Perhaps the most significant application of\nkinetic theory was in analyzing the acceleration of the MESSENGER spacecraft\nafter launch in 2004. The orbit could not be accurately determined for a couple of\nweeks. This acceleration was attributed to liquid evaporating from various surfaces\non the spacecraft with various time constants, depending on solar illumination. It\nwould take about one cubic inch of water distributed over the spacecraft to produce\nenough water vapor to cause the observed acceleration.\n\nSeveral models of particle collisions have been developed for the purpose of\nobserving the kinetics. A simple model involving only particle velocity yields the\nMaxwell\u2013Boltzmann PDF. The position of the particles is resolved into a number of\nprobability assumptions, and the simulation uses Monte Carlo techniques to obtain\nthe velocity distribution. Depending on the assumption used for the probability of\nimpact, two PDFs referred to as the Maxwell\u2013Boltzmann distribution and velocity-\ndependent distribution are obtained. Another model includes both position and\n\n\n\n208 5 Probability and Statistics\n\nvelocity and is completely deterministic. No probability assumptions or Monte\nCarlo sampling is included, and this model verified the velocity-dependent model.\n\nThe equations of motion in the position/velocity-dependent model are simply\nNewton\u2019s laws of motion. These are the equations of motion for an ideal gas, the\nso-called \u201cbilliard ball\u201d theory. The particles move in a straight line until they\nimpact another particle or a wall of the container. Energy and momentum are\nconserved. When the particles collide, the velocity change of the two particles,\nwhich are assumed to be spheres, is along the line connecting the centers. The angle\nbetween the line connecting the spheres and the relative velocity vector is called the\n\u201cscattering\u201d angle or \u201cRutherford scattering\u201d angle for molecules. The scattering\nangle for molecules is a bit more complicated than for billiard balls. It can be shown\nby arguments of symmetry that the scattering angle has no effect on the final PDF.\nIf the scattering angle affected the PDF, then different gases would have different\nPDFs and many of the laws of physics pertaining to gasses would be invalidated.\n\nThe results of a computer simulation of 400,000 particles and 8,000,000 colli-\nsions are shown in Fig. 5.6. Figure 5.6a shows the component velocity distribution\nin some arbitrary direction. Because of symmetry, all directions have the same\ndistribution. The velocity component is sorted into 50 bins. The abscissa is velocity\nand zero velocity is bin 25. The scale is not important, because only the shape of\nthe curve is of interest. For simplicity, the root mean square velocity magnitude is\ninitialized with an average value of one. The particles are also assigned a radius\nof one and all particles have the same mass, also one. The container is sized such\nthat the space between particles averages 30 radii. After proper scaling, it can be\nshown that the particles have the same temperature and pressure as an ideal gas.\nThe ordinate is the number of molecules in each bin. The probability is obtained by\ndividing by the total number of molecules.\n\nAlso shown by the fine line in Fig. 5.6a is the normal distribution predicted from\nMaxwell\u2013Boltzmann theory. At zero component velocity, the velocity-dependent\nmodel is about 3.0% above the Maxwell\u2013Boltzmann PDF. The difference between\nthe velocity-dependent model and the Maxwell\u2013Boltzmann PDF is plotted in\nFig. 5.6b. The peak value of 800 above the 30,000 particles in the associated bin\nin Fig. 5.6a gives an overshoot of 800/30,000 or 2.67%. The difference may be\nattributed to the assumed probability of impact. The Maxwell\u2013Boltzmann computer\nsimulation, which assumes equal probability of impact, gives the same result as\nthe theoretical Maxwell\u2013Boltzmann PDF (a normal curve). The velocity-dependent\nmodel assumes the probability of impact is dependent on the particle velocity and\nis confirmed by computer simulation that includes position. It appears that the only\nway to obtain a Maxwell\u2013Boltzmann PDF by computer simulation is to randomly\nselect the collision participants and ignore their position.\n\nFigure 5.7 shows the same computer simulation results for the velocity magni-\ntude. The velocity magnitude distribution is obtained by mapping three orthogonal\nvelocity component distributions into velocity magnitude and is the well-known\nMaxwell\u2013Boltzmann PDF of Maxwell\u2013Boltzmann theory. Also shown for com-\n\n\n\n5.8 Maxwell\u2013Boltzmann Probability Distribution 209\n\nFig. 5.6 Velocity component distribution comparison\n\nparison is the computer simulation velocity-dependent model results. Here, the\nvelocity-dependent model is about 4% below the Maxwell\u2013Boltzmann PDF (shown\nby a fine line) at the peak which occurs around bin 13. In Fig. 5.7a, the left side of\nbin 1 is zero velocity magnitude. Figure 5.7b shows the difference.\n\n\n\n210 5 Probability and Statistics\n\nFig. 5.7 Velocity-dependent model comparison\n\n5.8.1 Experimental Results\n\nAn experimental verification of the Maxwell\u2013Boltzmann theory was performed in\n1955. The experiment consisted of heating potassium and thallium in an oven to\n900?C and venting the atoms through a velocity selector into a detector. The velocity\nselector was a cylinder with a slot on one side and a curved slot on the other that\nrotated at 4000 rpm such that atoms would cross the cylinder and enter the curved\n\n\n\n5.8 Maxwell\u2013Boltzmann Probability Distribution 211\n\nslot at various transit times depending on their velocity and the rotation rate of\nthe cylinder. The detector would measure the intensity, or number of atoms, at\nthe velocity corresponding to the angle that the cylinder rotates dependent on the\nrotation rate. The device was quite sophisticated, being cooled with liquid nitrogen\nand sealed to provide a high vacuum.\n\nThe results of the potassium and thallium experiments are shown in Fig. 5.8a.\nAlso plotted is the theoretical Maxwell\u2013Boltzmann PDF. The agreement is very\ngood and verifies the overall veracity of the Maxwell\u2013Boltzmann theory. The\nagreement with the position/velocity- dependent model does not, at first, appear\nvery good. Inspection of this comparison shown in Fig. 5.7a reveals a gap between\nMaxwell\u2013Boltzmann theory and the computer model result at the peak intensity or\nmost probable velocity. This gap, if it exists, would not show up in the experimental\nresults because the scaling between intensity and the actual number of molecules is\nnot known precisely. Therefore, the experimental results were scaled to force them\nto equal the Maxwell\u2013Boltzmann theory at the peak. Also, the temperature was\nadjusted so that the low-velocity experimental results matched Maxwell\u2013Boltzmann\ntheory. The problem with these adjustments, which do not affect the experiment\nsince only the shape of the distribution is of interest, is that the PDF is a single\nparameter theory. Once the temperature is fixed, the probabilities and shape of the\ncurve are also fixed. If the gap shown in Fig.5.7a is real, the area between the\ncurves at the peak will be distributed elsewhere. This redistribution is evident in\nFig. 5.8a. Close inspection of the high-velocity side of the curve reveals that the\nexperimental results are above the Maxwell\u2013Boltzmann theory prediction. If these\nresults are accurate, they present a problem, since the integral from zero to plus\ninfinity is one and the experimental results are greater than one. R. C. Miller and\nP. Kusch acknowledged this problem. In their words, \u201cIt is seen that the largest\ndiscrepancies occur on the high velocity side of the maximum, where there is a\nsmall excess of atoms in the experimental distribution. It should be noted that the\nexperimental points could be plotted with the high-velocity side matched to the\ntheoretical curve. The intensities at the maximum velocity would no longer coincide\nand the experimental distribution would then appear to be deficient of atoms on the\nlow velocity side.\u201d In other words, the theoretical curve could be shifted to the right\nby adjusting the temperature, but the area under the curve would still be greater than\none.\n\nAnother approach, that is relatively simple to implement, would be to scale the\ncomputer model results to force the peak to coincide with the Maxwell\u2013Boltzmann\nPDF and adjust the temperature to match the curves on the low-velocity side. These\nresults could then be compared directly with the experimental results. Figure 5.8\nshows the results of this procedure. The experimental results in Fig. 5.8a depart a\nsmall amount from the theoretical Maxwell\u2013Boltzmann PDF at a reduced velocity\nof 1.4. The computer model results in Fig. 5.8b also depart a small amount. One\nmay conclude that the experimental results confirm the velocity-dependent model.\n\nAnother experiment performed by J. F. C. Wang and H. Y. Wachman in 1976\ninvolved venting molecules from an oven into a detector. The observed flight time\nis a measure of velocity magnitude. The results of this experiment are plotted in\n\n\n\n212 5 Probability and Statistics\n\nREDUCED VELOCITY  V\n\n.2 .6\n\n20a\n\nb\n\n15\n\n10\n\n5\n\n0\n1.0 1.4 1.8\n\nIN\nT\n\nE\nN\n\nS\nIT\n\nY\n\n14000\n\n0\n\n2000\n\n4000\n\n6000\n\n8000\n\n10000\n\n12000\n\n0 5 10 15 20\n\nMaxwell Fit\n\nModel2\n\n25\nScaled Velocity Magnitude\n\nS\nca\n\nle\nd \n\nP\nro\n\nba\nbi\n\nlit\ny\n\n30 35 40 45 50\n\nRUN 97\nRUN 99\n\nFig. 5.8 Miller and Kusch experiment and theory comparison\n\nFig. 5.9. The experimental results fall below the theory prediction by about the same\namount and in the same place as the Miller/Kusch results are above the theoretical\ncurve. Both experimenters forced the experimental results to agree at the peak\n\n\n\n5.9 Summary 213\n\n2000\n\nIn\nte\n\nns\nity\n\n (\nar\n\nbi\ntr\n\nar\ny \n\nun\nits\n\n)\n\n400\n\nFlight Time (ms)\n\n600\n\nFig. 5.9 Wang and Wachman experiment and theory comparison\n\nof the PDF. Miller and Kusch scaled up the experimental results and Wang and\nWachman scaled down the theoretical prediction. Since the theoretical prediction\nmust integrate to one from minus infinity to plus infinity, the theory must be higher\non the tails of the distribution function as can be seen in Fig. 5.9. Observe that the\nexperimental results trend back to the best fit to the theory farther out on the tail of\nthe PDF. The position/velocity computer model results shown in Fig. 5.8b also trend\nback on the tail only from the opposite side consistent with the assumptions on how\nthe data was fit to the theory for the two experiments. An alternative explanation for\nthe above observations is that the experimental apparatus used for the experiments\nhad equal and opposite systematic errors. There appears to be no other alternative.\n\n5.9 Summary\n\nStatistical analysis of the outcome of a navigation strategy is performed to determine\nthe probability that the spacecraft will safely arrive at the target or the end of the\nmission and satisfy mission design constraints. These constraints may be related to\nthe probability of impacting the target body, running out of fuel, or acquiring science\ndata. For example, if it is desired to occult a planet, the occultation may be mapped\nto a region in the B-plane and the probability that the spacecraft will pass through\nthis region would constrain the amount of data that would need to be acquired and\nmaneuver placement. These simple constraints may be satisfied by linear mapping\nof the orbit determination error. Since the orbit determination error is a mapping of\nmeasurement errors that may be characterized with high precision, the confidence\nin the results of this analysis is high.\n\nExamination of data residuals confirms the accuracy of the measurements and\nthat the probability distribution is normal or white noise. This result was not easy\n\n\n\n214 5 Probability and Statistics\n\nto obtain but resulted from years of analysis by the Jet Propulsion Laboratory to\ndevelop high precision models and calibrations of the radio metric data, and a\nsimilar analysis was performed to model and calibrate optical data. The normal\ndistribution of the measurement errors and independence of measurements greatly\nsimplifies the statistical analysis. We do not have to be concerned with colored\nnoise or biases. The normal probability distribution function is derived from the\nbinomial coefficients. The binomial theorem is thus the basis for the statistical\nanalysis performed for spacecraft navigation. The binomial coefficients describe the\nresults that are obtained from flipping many coins or rolling dice, and thus have\nmany applications beyond spacecraft navigation.\n\nA powerful method of statistical analysis is referred to as the Monte Carlo\nmethod named after the casinos in Monte Carlo. Weather forecasters refer to this\nmethod as ensemble statistical analysis. An astronaut sitting on top of a rocket or\ncitizens in a hurricane shelter probably feel better if their life depends on ensemble\nstatistical analysis rather than rolling dice. Monte Carlo analysis enables precision\nmapping of measurement and model errors when the system is nonlinear. Civil\nengineers use safety factors to design bridges and buildings. In the past, the safety\nfactors were rather large. The Brooklyn bridge and Empire State building have been\naround for a long time and it does not appear they will fall down soon. Rockets\nand spacecraft are built with much lower safety factors. Statistical analysis permits\noperations much closer to the edge. A critical statistical determination is the amount\nof extra fuel to put in the fuel tanks to complete the mission. When the Viking\nspacecraft arrived in orbit about Mars, there was twice as much fuel as was needed\nto complete the mission. Every extra pound of fuel reduced the science payload by\nthe same amount. Because of problems in selecting launch vehicles and a rocket\nmotor burn failure, the Galileo and Near spacecraft completed their missions with\nlittle fuel remaining in the tanks.\n\nExercises\n\n5.1 Determine the probability of drawing a 5-card royal straight flush (ace, king,\nqueen, jack, and ten of the same suit) from a 52-card deck.\n\n5.2 Determine the probability that the first 5 samples of 500 Monte Carlo samples\nwill be the largest.\n\n5.3 A cannon with a CEP of 50 yards is fired into the Collisiem aiming for the\ncenter. Caesar\u2019s box is 9 feet by 9 feet and located 100 yards from the center of\nthe Collisiem. Assuming that the PDF is constant within the box, determine the\nprobability that the cannon ball will land in Caesar\u2019s box.\n\n5.4 If the cannon in Exercise 5.3 was aimed at Caesar\u2019s box, what is the probability\nof hitting Caesar\u2019s box?\n\n\n\nBibliography 215\n\n5.5 Show that the sum of the binomial coefficients (k) for a given row of Pascal\u2019s\ntriangle (m) is equal to 2m.\n\n5.6 Show that the binomial coefficients are given by\n\nB(m, k) =\n(\n\nm\n\nk\n\n)\n= m!\n\n(m ? k)! k!\n\n5.7 Show that the derivative of p(k) with respect to k holding m constant and\nassuming linear interpolation between values of k is given by\n\nd\n\ndk\np(k) = p(k)m ? 2k ? 1\n\nk + 1\nwhere\n\np(k) = m!\n(m ? k)! k!\n\nBibliography\n\nLass, H. and P. Gottlieb, \u201cProbability and Statistics\u201d, Addison-Wesley, Reading, MA, 1971.\nMiller, J. K., \u201cViking Non-Gravitational Accelerations Resulting From Gas Leaks and Venting\u201d,\n\ninternal JPL document IOM 392.5-585, December 11, 1974.\nMiller, J. K., \u201cMonte Carlo Analysis of Kinetic Theory of Gases\u201d, 16th AAS/AIAA Spaceflight\n\nMechanics Conference, January 2006.\nMiller, J. K., G. R. Hintz and P. J. Llanos, \u201cA New Kinetic Theory of Particle Collisions\u201d, AAS\n\n16\u2013338, Astrodynamics Specialist Conference, August, 2016.\nMiller, R. C. and Kusch, P.,\u201cVelocity Distributions in Potassium and Thallium Atomic Beams\u201d,\n\nPhysical Review, Vol 99. No 4. August 15, 1955.\nWang, J. F. C., Wachman, H. Y. and Goodman, F. O., Dynamics of Gas-Surface Scattering,\n\nAcademic Press, New York, 1976.\n\n\n\nChapter 6\nOrbit Determination\n\nDetermination of the orbit of a spacecraft and all the constant and dynamic\nparameters that affect the orbit is an application of estimation theory. A model\nof the spacecraft motion as a function of initial conditions and certain constant\nand dynamic parameters is developed that may be used to predict the flight path\nand compute the value of measurements that are obtained during the space flight.\nOrbit determination involves adjusting the value of the independent parameters\nthat need to be determined until the computed measurements are close to the\nactual measurements. Since there are many more measurements than independent\nparameters, the solution is found that minimizes the error in the measurements. This\nsolution will also minimize the error in the estimated parameters.\n\nA measure of orbit determination accuracy is the square of the difference between\nthe computed measurement from the model and the actual measurement summed\nover all the measurements. An orbit determination filter processes the measurements\nand computes an update to the estimated parameters starting from an initial guess\nreferred to as the a priori. An orbit determination filter does not actually determine\nan orbit, but takes an initial guess and finds another orbit that is closer to the actual\norbit. The actual orbit is never known because we do not have perfect measurements.\n\nIn searching for a solution, an orbit determination program will sometimes have\nproblems converging. Before computers, astronomers determined orbits with a few\nmeasurements. This process is referred to as deterministic orbit determination and\nan algorithm is devised for determining an orbit about a body with six Doppler\nmeasurements strategically placed around the orbit.\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_6\n\n217\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_6&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_6\n\n\n218 6 Orbit Determination\n\nFig. 6.1 Relationship of measurements to estimated parameters\n\n6.1 Kalman Filter Algorithm\n\nThe Kalman filter algorithm computes updates to the a priori estimated parameters\none measurement at a time. The solution after the current update is used as a priori\nfor the next update. This simple one step algorithm, devised by R. E. Kalman in\nthe early 1960s, provides a simple method of computing parameter estimates on a\ndigital computer and is well suited for many applications.\n\nGiven an a priori estimate of a set of parameters (X0) and the associated\ncovariance P0, a measurement Zm and its covariance and a model of the dynamics,\nthe relationships are illustrated in Fig. 6.1 in two dimensions. Selecting any two\nparameters, the values of the a priori estimated parameters are shown on the left\nalong with the actual value and new estimate of X. The coordinate system is cen-\ntered at the actual value (Xa) which is unknown. However, the mapping function to\nthe measurement space on the right is known for all values of X. A two-dimensional\nmeasurement is shown corresponding to, for example, lines and pixels of an optical\nmeasurement. For most measurement updates, the measurements are uncorrelated\nand Z is one-dimensional. Indeed, lines and pixels are generally processed as two\none-dimensional measurements since they are generally assumed to be independent.\nThe actual measurement Zm is shown along with the measurement(Z0) computed\nfrom the model based on the a priori estimate (X0). The measurement covariance\nPm is indicated by the ellipse drawn around the measurement. The estimated\nmeasurement (Ze) is also shown along with the post fit measurement error (?).\n\nThe computed measurement is obtained from the model and is given by\n\nZ0 = f (X0)\n\n\n\n6.1 Kalman Filter Algorithm 219\n\nThe data residual (?Z) is the difference between the actual measurement and the\ncomputed measurement and the Kalman gain matrix (K) multiplied times the data\nresidual and combined with the a priori (X0) provides a new estimate (Xe).\n\n?Z = Zm ? Z0\n?X = K?Z\n\nXe = X0 + ?X\n\nThe desired solution for Xe is Xa . Since Xa is not known, and can never be known\nexactly, a gain matrix K is desired that moves the solution as close to Xa as can\nbe determined from the information available. Therefore, a solution is sought that\nminimizes the distance of Xe, shown in Fig. 6.1, from the origin. Minimizing the\nsquare of the magnitude of a random column vector, or variance, also minimizes the\nmagnitude and since the column vectors shown in Fig. 6.1 are all examples drawn\nfrom a random probability distribution function, the solution that minimizes the\nvariance of Xe is the desired solution. In the terminology used here, a matrix with\none column is referred to as a column vector or data vector because of the similarity\nto real vectors. The random column vectors of interest are defined to have zero mean\nand are given by\n\n?X0 = X0 ? Xa\n?Xe = Xe ? Xa\n?Zm = Zm ? Za\n?Z0 = Z0 ? Za\n\nFrom the model of the equations of motion and data, the partial derivatives of the\nmeasurement with respect to the estimated parameters may be computed and these\nare given by\n\nA = ?Z\n?X\n\nThe partial derivatives may be used to map column vectors defined in the estimate\nspace to data vectors in the measurement space. The column vector ?X0 thus maps\nto the data vector ?Z0 and\n\n?Z0 = A ?X0\nSome other relationships, shown in Fig. 6.1, are needed to tie X and Z together.\n\n?Xe = ?X0 + ?X\n?Zm = ?Z0 + ?Z\n\n\n\n220 6 Orbit Determination\n\nThe solution for ?Xe is then given by\n\n?Xe = K?Zm + (I ? KA)?X0 (6.1)\n\nand this result can be extended to higher dimension in X and Z even though the\ndimension of Z is usually taken to be one. Exact values for ?X0, ?Xe, ?Z0,\nand ?Zm cannot be determined. However, we can obtain from prior experience\nestimates of their errors. The expected value of ?Xe is given by\n\nPe = E\n(\n?Xe?X\n\nT\ne\n\n)\nAssuming the measurement is independent of the estimated parameters,\n\nE\n(\n?Xe?X\n\nT\ne\n\n)\n= E\n\n(\nK ?Zm?Z\n\nT\nm K\n\nT + (I ? KA) ?X0?XT0 (I ? KA)T\n)\n\nand\n\nPe = KPmKT + (I ? KA)P0(I ? KA)T\n\nwhere\n\nPm = E\n(\n?Zm?Z\n\nT\nm\n\n)\nP0 = E\n\n(\n?X0?X\n\nT\n0\n\n)\nare the measurement and estimated parameters a priori covariances, respectively.\nThe minimum variance estimate is found by taking the variation of Pe with respect\nto the gain matrix K and setting this result to zero.\n\n?Pe = ?KB + BT ?KT\n\nBT = KPm ? P0AT + KAP0AT\n\nFor a minimum, B is zero and the Kalman gain matrix (K) is given by\n\nK = P0AT\n[\nPm + AP0AT\n\n]?1\n(6.2)\n\nSubstituting K into the estimated covariance gives\n\nPe = (I ? KA)P0 (6.3)\n\n\n\n6.2 Weighted Least Squares 221\n\n6.2 Weighted Least Squares\n\nThe same result as obtained for the Kalman Filter may be obtained by a different\napproach to parameter estimation. Since the classical approach grew out of attempts\nto fit data, the minimization of the measurement residual is the objective rather than\nthe error in the estimated parameters. It will be shown that both approaches yield\nthe same result. Referring to Fig. 6.1, the error in the measurement (?m) is given by\n\n?m = Zm ? Ze = ?Z ? A?X\n\nSince some measurements may be more accurate than others, the square of the\nresidual error may be weighted by dividing by its variance. Thus, a minimum\nvariance estimate may be obtained by dividing the measurement errors by their\nstandard deviation. Dividing by the standard deviation is obtained by multiplying\nby the square root of the inverse of the measurement covariance. The weighting\nmatrix is defined by\n\nW = P ?1m\nand the weighted measurement error is\n\n? = W 12 (?Z ? A?X)\n\nThe sum of the squares of the weighted residuals (J ) is the scalar parameter that is\nto be minimized.\n\nJ = ?T ? = (W 12 ?Z ? W 12 A?X)T (W 12 ?Z ? W 12 A?X)\n\nThe minimum J may be found by taking the variation with respect to ?X and\nsetting this result equal to 0.\n\n?J =(W 12 ?Z?W 12 A?X)T (?W 12 A??X)???XT AT (W 12 )T (W 12 ?Z?W 12 A?X)\n\nFor a minimum, ?J is set equal to 0 and the solution for ?X is\n\n?X = (AT WA)?1AT W?Z\n\nAssuming that the a priori error covariance is infinite, the estimated error covariance\nis given by\n\nPe = E(?X?XT )\n\n\n\n222 6 Orbit Determination\n\nFrom the equation for the data update,\n\nAT WA?X?XT (AT WA)T = AT W?Z?ZT WT A\nAT WAPe(A\n\nT WA)T = AT WPmWT A\n\nand\n\nPe = (AT WA)?1\n\nThe weighted least square solution, as derived here, assumes all the data is included\nin A and there is no a priori. The A matrix may be partitioned separating the a\npriori data from the new data and the filter equations put in the same form as for\nthe Kalman filter. The data update for the weighted least squares sequential filter\nbecomes\n\nK = (AT WA + P ?10 )?1AT W (6.4)\nPe = (AT WA + P ?10 )?1 (6.5)\n\nThe two equations for the Kalman gain (Eq. (6.2) and Eq. (6.4)) solve the same\nproblem but do not appear to be equal. The equivalence of these two solutions may\nbe shown by invoking Shur\u2019s identity as was done by Anderson and others in the\nearly 1960s. Shur\u2019s identity gives the inverse of a partitioned matrix.\n\n?\n?A B\n\nC D\n\n?\n?\n?\n? (A ? BD?1C)?1 ?A?1B(D ? CA?1B)?1\n\n?D?1C(A ? BD?1C)?1 (D ? CA?1B)?1\n\n?\n? =\n\n?\n? I1 0\n\n0 I2\n\n?\n?\n\nConsider the following matrix product obtained by application of Shur\u2019s identity.\n\n?\n?P ?10 AT\n\nA ?W?1\n\n?\n?\n?\n? (AT WA + P ?10 )?1 P0AT (W?1 + AP0AT )?1\n\nWA(AT WA + P ?10 )?1 ?(W?1 + AP0AT )?1\n\n?\n?=\n\n?\n? I1 0\n\n0 I2\n\n?\n?\n\nSince the inverse of a symmetric matrix must also be symmetric,\n\n?\n?P ?10 AT\n\nA ?W?1\n\n?\n?\n?\n? (AT WA + P ?10 )?1 P0AT (W?1 + AP0AT )?1\n\n(W?1 + AP0AT )?1AP0 ?(W?1 + AP0AT )?1\n\n?\n?=\n\n?\n? I1 0\n\n0 I2\n\n?\n?\n\nThe equation for the I1 identity submatrix is\n\nI1 = P ?10 (AT WA + P ?10 )?1 + AT (W?1 + AP0AT )?1AP0\n\n\n\n6.3 Square Root Information Filter (SRIF) 223\n\nand\n\nP0 ? P0AT (W?1 + AP0AT )?1AP0 = (AT WA + P ?10 )?1 (6.6)\n\nThe AT W term is factored out of the Kalman gain given by Eq. (6.1).\n\nK = P0AT\n[\nPm + AP0AT\n\n]?1 [(W?1 + AP0AT )W ? AP0AT W ]\nI = [(W?1 + AP0AT )W ? AP0AT W ]\n\nand\n\nK = [P0 ? P0AT (W?1 + AP0AT )?1AP0]AT W\n\nSubstituting the result obtained from Eq. (6.6) results in the weighted least square\nformula for the Kalman gain.\n\nK = (AT WA + P ?10 )?1AT W\n\nThe equivalence of the estimated covariance solutions is simpler to show. Substitute\nthe Kalman gain from the least squares solution into the estimated covariance given\nby the Kalman filter solution and factor out the desired result.\n\nPe = (I ? KA)P0\nPe = P0 ? (AT WA + P ?10 )?1AT WAP0\n\nPe = (AT WA + P ?10 )?1\n[\n(AT WA + P ?10 )P0 ? AT WAP0\n\n]\nPe = (AT WA + P ?10 )?1\n\n6.3 Square Root Information Filter (SRIF)\n\nThe SRIF discrete data update algorithm follows directly from the least square data\nupdate. The least square solution is given by\n\nX? =\n[\nATn ?Wn An\n\n]?1\nATn ?Wn Z?n\n\nThe measurements can be normalized by factoring ?Wn into\n\n?Wn =\n?\n\n?Wn\nT ?\n\n?Wn\n\n\n\n224 6 Orbit Determination\n\nand\n\nX? =\n[\nATn\n\n?\n?Wn\n\nT ?\n?WnAn\n\n]?1\nATn\n\n?\n?Wn\n\nT ?\n?Wn Z?n\n\nBy inspection we can see that\n\nRn =\n?\n\n?Wn An\n\nso after substitution we have\n\nX? = (RTnRn)?1RTn\n?\n\n?WnZ?n\n\nFor the first m measurements, the number of estimated parameters (m) is equal to\nthe number of measurements and Rn is square.\n\nX? = R?1n\n?\n\n?WnZ?n\n\nMultiplying through by Rn gives what is called the data equation.\n\nRn X? =\n?\n\n?WnZ?n = ??n (6.7)\n\nwhere ??n is the normalized measurement. A new measurement can be appended to\nthe data equation resulting in\n\n?\n? Rn?\n\n?Wn+1 An+1\n\n?\n? X? =\n\n?\n? ??n\n\n??n+1\n\n?\n?\n\nAdding additional measurements results in the row dimension of R exceeding the\ncolumn dimension. The information matrix would then be given by\n\n?m = RTnm Rnm\nwhere the row dimension n exceeds the column dimension m. Since Rnm is not\nunique, it can be replaced by an upper triangular Rm of dimension m by m.\n\n?m = RTm Rm\nThe Householder algorithm enables one to obtain the matrix Rm without explicitly\ncomputing ?m. If T is an orthogonal matrix which has the property\n\nT T T = I (6.8)\n\n\n\n6.3 Square Root Information Filter (SRIF) 225\n\nthen we have\n\n?m = RTnm T T T Rnm\nThe Householder algorithm finds a T that gives Rm when multiplied times Rnm.\nThe right side of the data equation (??) is also multiplied by T to obtain a new\ndata equation in upper triangular form. The Householder algorithm thus serves the\nsame purpose in updating the SRIF matrix and right side as the Kalman update\nalgorithm serves to update the covariance and state estimate. An updated state\nestimate can be obtained from the data equation by simply inverting the SRIF matrix\nand multiplying times the right side.\n\n6.3.1 Discrete Process Noise Update\n\nFor the simple case of exponentially time correlated process noise, the differential\nequation may be solved by performing a discrete update over a fixed time interval\nreferred to as a batch.\n\ndp\n\ndt\n=\n\n(?1\n?\n\n)\np + ?(t)\n\nThe solution is\n\np(t) = e\nt ? t0\n\n? p(t0) +\nt?\n\nto\n\ne\n\n?(t ? ? )\n? ?(? )d?\n\nThe variance of p(t) is given by\n\n? 2p(t) = e\n?2(t ? t0)\n\n? ? 2p(t0) +\nt?\n\nto\n\ne\n\n?2(t ? ? )\n? ? 2?(? )d?\n\nThe process noise variance may also be obtained by solution of the following\ndifferential equation,\n\nd? 2p(t)\n\ndt\n=\n\n(?2\n?\n\n)\n? 2p(t) + q?(t)\n\nwhere\n\nq? = 2?\n2\ns\n\n?\n\n\n\n226 6 Orbit Determination\n\nand ? 2s is the steady state noise variance. In difference equation form these give\n\npj+1 = Mpj + ?j\n? 2pj+1 = M2? 2pj + ?q\n\nwhere\n\n?q = (1 ? M2)? 2s ?\n(\n\n2?t\n\n?\n\n)\n? 2s\n\nM = e\n??t\n\n?\n\n?t = tj+1 ? tj\nThe data equation obtained as a result of processing data from tj to tj+1 is given by\n\n?\n? Rp Rpx RpyRxp Rx Rxy\n\n0 0 Ry\n\n?\n?\n?\n? pjxj+1\n\ny\n\n?\n? = ??j\n\nFor the discrete process noise data update, the value of the stochastic parameters\n(pj ) are held constant over the interval tj to tj+1 while the SRIF matrix is mapped\nforward. At the time tj+1, the process noise variance accumulated over this same\ntime interval is introduced via the following data equation as a discrete impulse.\n\nR? ??j = ???\nwhere\n\nR? = 1\n??\n\nReplacing ??j by the equation in terms of pj and pj+1 we have\n\nR? p?j+1 ? R?M p?j = ??? = 0\n\nThe updated data equation is obtained by partitioning and combining with the above\nnoise data equation.\n\n?\n???\n\n?R?M R? 0 0\nRp 0 Rpx Rpy\nRxp 0 Rx Rxy\n\n0 0 0 Ry\n\n?\n???\n?\n???\n\npj\n\npj+1\nxj+1\n\ny\n\n?\n??? =\n\n?\n? 0\n\n??j\n\n?\n?\n\n\n\n6.3 Square Root Information Filter (SRIF) 227\n\nThe data equation is partially triangularized over the first columns corresponding to\nthe process noise terms to obtain\n\n?\n????\n\nR?pj R?ppj R?pxj R?pyj\n0 R+p R+px R+py\n0 R+xp R+x R+xy\n0 0 0 R+y\n\n?\n????\n?\n???\n\npj\n\npj+1\nxj+1\n\ny\n\n?\n??? =\n\n?\n?? ??\n\n?\nj\n\n??j+1\n\n?\n??\n\nwhere the plus superscript is introduced to indicate a change in the numerical values\nafter the process noise update. The stochastic parameter update is completed by\nstripping off the top rows corresponding to pj , those containing the asterisk, and\nthese may be saved along with the right side (???j ) for smoothing.\n\n6.3.2 Solution Epoch\n\nThe SRIF formulation computes an estimate of the spacecraft state, target body\nephemeris, and target body attitude at the initial epoch. This is purely a matter of\nconvenience since the state and covariance at any future epoch may be obtained\nby simply mapping the epoch state solution. An epoch state formulation enables the\ntrajectory and variational partial derivatives to be computed before data is processed\nby the filter. When stochastic parameters are present, the current state cannot be\ndetermined by mapping the epoch state solution. The true epoch state solution is\nobtained by smoothing. Since the final state solution is the solution of most interest\nand it is desirable to avoid smoothing, the contribution of stochastic parameters\nis mapped back to epoch creating what is called a pseudo epoch state solution.\nThe pseudo epoch state solution is an exact least squares fit to the data when it\nis mapped to the current or final state. The pseudo epoch state filter adopted by the\nJet Propulsion Laboratory is really a current state filter when mapped to epochs in\nthe future and used for prediction. In the early 1970s orbit determination was a very\nchallenging problem. The high-precision modeling of the solar system, media and\nstation locations made possible by VLBI has reduced the need for stochastic param-\neters to cover modeling errors. Indeed, most missions are now flown without the\nneed for stochastic parameters and all the data could be processed in a single batch.\n\n6.3.3 Computed and Consider Covariance\n\nAfter all the data has been processed and a solution obtained, the covariance matrix\nof the estimated parameters is computed and mapped to an epoch of interest. The\nSRIF matrix R is inverted to obtain the square root covariance matrix (S) and this\nmatrix is multiplied by its transpose to obtain the covariance matrix (P ).\n\n\n\n228 6 Orbit Determination\n\nR =\n[\n\nRx Rxc\n\n0 Rc\n\n]\n\nS = R?1\n\nP = SST\n\nThe R matrix has been partitioned into (Rx) and Rc. The Rx SRIF matrix contains\nthe state, stochastic parameters, and most of the constant parameters. The Rc\nmatrix contains parameters that are suspect because they represent models that are\nnot as accurate as the data can measure. In the early days of the space program\nstation location errors fell into this category. These are called consider parameters.\nThe estimate of consider parameters obtained above can be too optimistic and\nthe modeling errors associated with these parameters can infiltrate into the other\nestimated parameters which include spacecraft state. One strategy is to just ignore\nthese parameters. This can easily be done by truncating columns pertaining to these\nparameters from (R). The Rc parameters have been conveniently placed at the end\nof R for this purpose. The result is called the computed covariance and is given by\n\nSx = R?1x\nPx = Sx STx\n\nThe reduced set of estimated parameters associated with the computed covari-\nance can enable orbit determination operations to proceed smoothly, but the\ninfiltration of model errors can result in overly optimistic error estimates. In order\nto determine the effect of consider parameters on other estimated parameters, the\nconsider covariance is computed. The consider covariance reveals the sensitivity\nof orbit estimation to modeling errors, but has no affect on the orbit solution. The\nconsider covariance is computed by discarding the rows of R corresponding to Rc\nand replacing them with the a priori consider covariance. The correlation of the\nconsider parameters with the other estimated parameters determined by processing\ndata is preserved. We simply add some negative information to the SRIF matrix\nthat gives us the desired square root covariance for the consider parameters. This\ncan be done by employing some mathematical trickery. Since the triangularization\nof a SRIF matrix is not unique, if matrix can be partially triangularized. The\ntriangularization is stopped at the row corresponding to the first consider parameter\nand the square root consider a priori consider covariance is inserted. This process is\nmathematically equivalent to the following.\n\nRc =\n[\n\nRx Rxc\n\n0 R?c\n\n]\n\n\n\n6.3 Square Root Information Filter (SRIF) 229\n\nwhere R?c = S?1con and for independent consider parameters the square root\ncovariance Scon is a diagonal matrix of consider a priori sigmas. Making use of\nthe Schur identity given in Sect. 6.2, the consider square root covariance is given by\n\nSc = R?1c =\n[\n\nR?1x ?R?1x Rxc S?1con\n0 Scon\n\n]\n\nand the consider covariance is\n\nPc = Sc STc\n\n6.3.4 Smoothing\n\nA current state orbit determination filter provides a best estimate of the spacecraft\nstate at the end of the data arc. An estimate of the state at the beginning of the\ndata arc or at some time in between may be obtained by mapping the final state\nback to the epoch of interest. This mapping may also be obtained by integrating\nthe trajectory backwards from the final state. If there are no stochastic parameters,\nthese mappings will also provide a best estimate. When stochastic parameters are\nincluded, a best estimate may be obtained by processing the data backwards and\nthis is referred to as a smoothed best estimate. If only a few estimation epochs are\nof interest a smoothed best estimate may be obtained while processing the data\nforward. This processing is referred to as single point smoothing and was used by\nthe Galileo project for obtaining an estimate of the probe state at separation.\n\nData is processed from launch to the separation epoch. At the time of separation\nor the time that a smoothed best estimate is desired the data processing is halted.\nThe covariance at this time is given by P(ts)\n\nP (ts) =\n\n?\n??????????\n\nP(p) P (p, x1) 0 P(p, y)\n\nP (x1, p) P (x1) 0 P(x1, y)\n\n0 0 P(xs) 0\n\nP(y, p) P (y, x1) 0 P(y)\n\n?\n??????????\n\nThe smoothed a prior covariance (P(xs)) is a place holder and has no affect on the\ncomputed covariance (P(ts)). The data partials associated with P(xs) are all zero\nup to the time ts . At the smoothing epoch, the computed covariance is updated with\n\n\n\n230 6 Orbit Determination\n\nP(ts)\n+ =\n\n?\n??????????\n\nP(p) P (p, x1) P (p, x1) P (p, y)\n\nP (x1, p) P (x1) P (x1) P (x1, y)\n\nP (x1, p) P (x1) P (x1) P (x1, y)\n\nP (y, p) P (y, x1) P (y, x1) P (y)\n\n?\n??????????\n\nThis update forces the smoothed spacecraft state to be equal to the computed\nspacecraft state and be perfectly correlated. The smoothed spacecraft state also\nassumes the same correlation with stochastic parameters (P(p)) and constant\nparameters (P(y)). The data filter continues to the end of the data arc. The data\npartials for xs remain at zero and the smoothed best estimate is updated through its\ncorrelation with the other estimated parameters. For the implementation of single\npoint smoothing in the orbit determination program used for Galileo, the update at\nthe smoothing epoch was performed by processing six artificial measurements that\nforced the spacecraft state to equal the smoothed state at the smoothing epoch.\n\n6.4 Continuous Filter Equations\n\nA data filter processes data in order to obtain an estimate of parameters that are\nrelated to the data by a mathematical model. Data filters exist in many forms\nand use the covariance of the state parameters, or some equivalent representation,\nalong with the measurements and a simulation of the measurements including\npartial derivatives, to obtain the desired estimate. Data filters may be separated into\ntwo categories depending on how the state covariance is evolved as a function of\ntime. Continuous data filters evolve the state covariance by integration of a matrix\ndifferential equation or Riccati equation and discrete data filters evolve the state\ncovariance by mapping over a finite time interval. Discrete filters are thus obtained\nby solving the continuous equations over some finite time interval. The covariance\nmatrix of the state may be represented by its inverse or information matrix or square\nroot factorizations of either of these matrices.\n\nThe system dynamics may be described as a linear perturbation of a reference\nfunction of the state variables. Given the nominal values of the state variables\ndescribed by the function x?(t) and a perturbation of the state (?x) at the initial\nepoch (t0), the perturbed state variables are described by\n\nx(t) = x?(t) + ?(t, t0) ?x(t0)\n\nwhere the state transition matrix (?) is given by\n\n? = ?x(t)\n?x(t0)\n\n\n\n6.4 Continuous Filter Equations 231\n\nThe state transition matrix may be obtained as a solution of the following differential\nequation or by numerical integration.\n\n?x?(t)\n\n?x(t0)\n= ?x?(t)\n\n?x(t)\n\n?x(t)\n\n?x(t0)\n\n??(t, t0) = F ?(t, t0)\n\nwhere\n\nF = ?x?(t)\n?x(t)\n\nThe above differential equation, describing the evolution of the state variation, may\nbe generalized to include other parameters and process noise.\n\nX? = F X + G\n\n\nwhere G is the mapping of \n, the process noise. Here, the ?\u2019s have been dropped and\nthe variation ?x is represented by X. The state vector variation X may be generalized\nto include constant parameters (y) and stochastic parameters (p) as well as the\ndynamic state variables (x). The process noise (\n) contains white noise (?) on the\nstochastic parameters. Thus we have\n\nX =\n?\n?px\n\ny\n\n?\n? \n =\n\n?\n??0\n\n0\n\n?\n?\n\nThe stochastic parameters (p) provide a means of introducing process noise into the\nstate variables. These are defined by scalar differential equations of the form\n\np?i = ? 1\n?i\n\npi + ?i\n\nwhere ?i is the correlation time and ?i is the white noise associated with the i\u2019th\nstochastic parameter. Thus, white noise is introduced directly to the parameter p\nand indirectly to the state via the mapping matrix F .\n\nAn estimate of the state is obtained from a mathematical model of the system\ndynamics that include measurements processed by a data filter. The \u201cbest\u201d estimate\nof the variation of the state (X?) is described by the following equations,\n\n??\nX = FX? + G\n? + KZ?\n\nZ? = Z ? AX?\n\nA = ?Z\n?X\n\n\n\n232 6 Orbit Determination\n\nwhere K is the Kalman gain, \n? represents an estimate of the process noise, Z are\nthe actual measurements, and A is the matrix of data partials. The Kalman gain\nis computed as a function of the measurement error, the data partials, and the state\nerror covariance (P ). Thus, in order to obtain a complete set of equations that would\nenable the computation of the estimated state we need an equation for the Kalman\ngain and an equation for evolving P as a function of time.\n\nThe covariance of the state estimate is defined by the expected value repre-\nsented by\n\nP = E\n{\nXXT\n\n}\nAs an alternative, we may compute the information matrix (?), the square root of\nthe covariance (S), or the square root of the information matrix (R). The equations\nthat define these matrices are given by\n\nP = ??1\n\nP = SST\n\nP ?1 = RTR\n\nThus, we are interested in obtaining differential equations of the form\n\nP? = P?m + P?q + P?d (6.9)\n?? = ??m + ??q + ??d (6.10)\nS? = S?m + S?q + S?d (6.11)\nR? = R?m + R?q + R?d (6.12)\n\nwhere the subscript m refers to the mapping terms, the subscript q refers to process\nnoise terms, and the subscript d refers to the data update terms.\n\nThe evolution of the covariance as a function of time may be obtained by\nmapping the state covariance obtained at some epoch (t0) to some time in the future\n(t) with the state transition matrix.\n\nP(t) = ?(t, t0) P (t0) ?(t, t0)T\n\nTaking the derivative with respect to time we obtain\n\nP? (t) = ??(t, t0) P (t0) ?(t, t0)T + ?(t, t0) P (t0) ??(t, t0)T\n\nSince the state transition matrix is obtained by integrating\n\n??(t, t0) = F(t) ?(t, t0)\n\n\n\n6.4 Continuous Filter Equations 233\n\nwe obtain after substitution\n\nP?m = FP + PF T (6.13)\n\n6.4.1 Process Noise Term\n\nIn the covariance matrix differential equation, process noise enters as an addition to\nthe covariance. Thus we have\n\nP(t + ?t) = P(t) + G?QGT\n\nwhere ?Q is the covariance of the process noise admitted over the time interval ?t\nand\n\n?Q = Q ?t\n\nwhere Q is the rate of accumulation of process noise. Thus, in the continuum we\nhave\n\nP?q = lim\n?t?0\n\n{\nP(t + ?t) ? P(t)\n\n?t\n\n}\n= G Q GT (6.14)\n\n6.4.2 Data Update Term\n\nThe discrete covariance update may be obtained assuming an additional measure-\nment An+1 is added to a previously determined estimate based on measurements An\nwith covariance Pn.\n\nPn+1 =\n[\nATn?WnAn + ATn+1?Wn+1An+1\n\n]?1\nIn the notation used here, An is a matrix with n rows corresponding to the\nmeasurements and m columns corresponding to the state parameters. An+1 is a row\nmatrix of dimension m. We also have for the covariance update,\n\nP ?1n+1 = P ?1n + ATn+1 ?Wn+1 An+1\nand since\n\n? = P ?1\n\n?n+1 = ?n + ATn+1 ?Wn+1 An+1\n\n\n\n234 6 Orbit Determination\n\nOver the time interval ?t between measurements, information accumulates at a rate\nW and\n\n?Wn+1 = W ?t\n?n+1 ? ?n = ATn+1 W?t An+1\n\nDividing by ?t and taking the limit as ?t approaches zero,\n\n??m = AT W A (6.15)\n\nwe obtain a differential equation for the evolution of the information matrix due to\naddition of data.\n\n6.4.3 Continuous Filter Differential Equations\n\nCollecting the terms derived above, we have the following matrix differential\nequation or Riccati equation for the covariance filter,\n\nP? = FP + PF T + GQGT + P?d\nK = P AT W\n\nand for the information filter,\n\n?? = ??m + ??q + AT W A\nK = ??1 AT W\n\nThe data update term (P?d) is missing from the covariance equation and the mapping\n(??m) and process noise (??q) terms are missing from the information filter equation\nand these may be obtained by transformation using matrix identities. For the\ncovariance and information equations, we need the following matrix identities.\n\nP? = I\nP?? + P?? = 0\n\nP? = ?P????1 = ?P ?? P\n?? = ?P ?1 P? ? = ??P? ?\n\nApplying these identities to the above matrix differential equations, we have\n\nP? = FP + PF T + GQGT ? PAT W AP\nK = P AT W\n\n\n\n6.4 Continuous Filter Equations 235\n\nThe covariance filter in this form is called the continuous form of the Kalman-Bucy\nfilter. For the information filter, we have\n\n?? = ??F ? F T? ? ?GQGT ? + AT W A\nK = ??1 AT W\n\nA similar set of matrix identities, derived by Scheeres, may be developed for the\nsquare root covariance filter (SRCF) and the square root information filter (SRIF)\nthat may be used to transform the covariance time derivative.\n\nP = SST\n\nP? = S?ST + SS?T[\nSS?T ? 1\n\n2\nP?\n\n]\n+\n\n[\nS?ST ? 1\n\n2\nP?\n\n]\n= 0\n\nBecause of symmetry associated with the above terms in the brackets, both terms in\nthe brackets must be zero and\n\nS? = 1\n2\nP? S?T\n\nA similar derivation for the SRIF matrix gives the identity\n\nR? = ?1\n2\nRP? RTR\n\nApplying these identities to the covariance and information filter equations gives the\nfollowing matrix differential equations for the SRCF and SRIF matrices.\n\nS? = 1\n2\n\n[\nFS + SSTF TS?T\n\n]\n+ 1\n\n2\nGQGTS?T ? 1\n\n2\nSSTATWAS\n\nR? = ?1\n2\n\n[\nRF + R?1F TRTR\n\n]\n? 1\n\n2\nRGQGTRTR + 1\n\n2\nR?TAT W A\n\nThe mapping terms for both the SRCF and SRIF contain matrix inverses. These may\nbe eliminated by introducing a different factorization of the square roots. Consider\nthe mapping of the square root covariance from an initial epoch t0 to the epoch t .\n\nP(t) = ?(t, t0) S(t0)S(t0)T ?(t, t0)T\n\nThe mapped square root is simply\n\nS(t) = ?(t, t0) S(t0)\n\n\n\n236 6 Orbit Determination\n\nTaking the derivative with respect to time,\n\nS?(t) = ??(t, t0) S(t0)\nS?(t) = ??(t, t0)?(t, t0)?1S(t)\n\nS?(t) = F(t)S(t)\n\nFor the SRIF matrix we have\n\nS(t)R(t) = I\nS?(t)R(t) + S(t)R?(t) = 0\nR?(t) = ?R(t)S?(t)S(t)?1\n\nR?(t) = ?R(t) F (t)\n\nMaking the above substitutions for the mapping terms, the matrix differential\nequations and Kalman gain for the covariance, information, square root covariance,\nand square root information filters are summarized below.\nCovariance (Kalman-Bucy) Filter\n\nP? = FP + PF T + GQGT ? PAT W AP (6.16)\nK = P AT W (6.17)\n\nInformation Filter\n\n?? = ??F ? F T? ? ?GQGT ? + AT W A (6.18)\nK = ??1 AT W (6.19)\n\nSquare Root Covariance Filter (SRCF)\n\nS? = FS + 1\n2\nGQGTS?T ? 1\n\n2\nSSTATWAS (6.20)\n\nK = SSTAT W (6.21)\n\nSquare Root Information Filter (SRIF)\n\nR? = ?RF ? 1\n2\nRGQGTRTR + 1\n\n2\nR?TAT W A (6.22)\n\nK = R?1R?T AT W (6.23)\n\nThe data update and process noise terms of the above filter equations exhibit a\nsymmetry or duality when the information filters are compared with the covariance\n\n\n\n6.5 Continuous SRIF with Discrete Data Update 237\n\nfilters. For example, the data update term of the information filter may be obtained\nby replacing Q with W and G with AT in the process noise term of the covariance\nfilter. Also, the process noise update term of the information filter may be obtained\nby making similar replacements in the data update term of the covariance filter.\nThese same dual relationships exist for the filters in their square root form. The\nexistence of duality enables algorithms designed for data updating to be used\nfor process noise updating and vice versa. For example, the Potter square root\ncovariance data update algorithm may be used to update process noise in the SRIF.\n\n6.5 Continuous SRIF with Discrete Data Update\n\nThe selection of a filter algorithm depends on many competing criteria related to\naccuracy, computational efficiency, memory utilization, and simplicity of design.\nConsideration of accuracy seems to favor factorized or square root filters and\ncomputational efficiency seems to favor discrete filters. With the proliferation of\npersonal computers, computational efficiency has become less important since\ncomputer processing time is now relatively cheap. Simplicity of design and memory\nutilization favor a continuous approach to filtering. The system dynamics and data\npartial derivatives enter directly into the filter and the need to compute a state\ntransition matrix is completely eliminated. However, data is generally in the form of\ndiscrete data points and may not be easily transformed to the continuous form. This\nsuggests a hybrid approach which allows system dynamics and process noise to be\ntreated continuously and data to be treated as a discrete update.\n\nThe continuous SRIF, with discrete data update, is selected for development of a\nfilter algorithm. Information filters have the advantage that a priori on the constant\nparameters does not have to be placed on the filter until after all the data is processed.\nDuring filtering, the information arrays may be sparse resulting in less computation.\n\n6.5.1 Process Noise Duality\n\nThe continuous process noise update enables one to introduce process noise directly\nas a differential equation to the filter. This form is convenient for describing process\nnoise and enables the investigation of a wide variety of process noise models\nwithout explicitly solving the differential equation. The continuous process noise\nupdate term in the information filter has the same form as the data update term in\nthe covariance filter. The Potter square root covariance data update algorithm [6]\nprovides a means of performing a scalar data update to the square root covariance\nfilter. Because of duality, the discrete Potter data update algorithm can be adapted\nto the SRIF for a discrete scalar process noise update. Taking the limit as ?t\napproaches zero enables one to convert the discrete process noise update to a\ncontinuous process noise update.\n\n\n\n238 6 Orbit Determination\n\nStarting with the process noise update term in the information filter (Eq. (6.18)),\nwhich is the dual of the data update term of the covariance filter (Eq. (6.16)), we\nhave\n\n??q = ??GQGT ? = lim\n?t?0\n\n?n+1 ? ?n\n?t\n\nand in the discrete form,\n\n? = ?? ? ??G?QGT ??\n\nwhere the notation for ?n, the information matrix before the update or priori, is\nreplaced by ?? and ?n+1 is replaced by ?. Since\n\n? = RTR\n\nwe have for the POTTER approximation\n\nRTR = R?T\n[\nI ? v ?QvT\n\n]\nR?\n\nwhere\n\nv = R? G\n?Q = Q?T\n\nIf ?Q and G are assumed to be diagonal (i.e., uncorrelated process noise parame-\nters), then each diagonal element of ?Q is given by a scalar ?qi . Dropping the i\nsubscript, we have for the i\u2019th row of R and diagonal element of ?Q,\n\nI ? ?qvvT = (I ? ??vvT)2\n\nI ? ?qvvT = I ? 2?? vvT + ??2vvTvvT\n\nSince vTv is a scalar, the solution of the above quadratic equation is given by\n\n?? = 1 ?\n?\n\n1 ? vTv?q\nvTv\n\nand\n\nRTR = R?T(I ? ?? vvT)T (I ? ?? vvT)R?\nR = (I ? ?? vvT)R?\n\nR = R? ? ?? R? GGT R?TR?\n\n\n\n6.5 Continuous SRIF with Discrete Data Update 239\n\nIn the continuum we have\n\nR? = ????R? GGT R?TR?\n\nand\n\n??? = 1\n2\n(1 ? vTv?q)? 12 ?q?\n\nIn the limit as ?q and ?t go to zero we have\n\n??? = 1\n2\n\n?q?\n\nand\n\nR? = ?1\n2\n\n?q? R GGT RTR\n\nIf we have more than one stochastic parameter, the ?q? ?s can be assembled into a\ndiagonal matrix Q and we have\n\nR? = ?1\n2\n\nR GQGT RTR (6.24)\n\nThis is the same equation as derived above for the continuous SRIF process noise\nupdate only we have assumed diagonal Q and G.\n\n6.5.2 Numerical Integration of SRIF Matrix\n\nThe continuous SRIF data processing algorithm involves mapping the SRIF matrix\nfrom the time of a discrete data or process noise update to the time of the next\ndata point or process noise update. The mapping is accomplished by numerical\nintegration of the SRIF matrix differential equation. The numerical integration is\nperformed with a suitable algorithm. The fifth order Runge-Kutta-Fehlberg method\nwith error control has been successfully employed. Recall the matrix differential\nequation derived above for the SRIF (Eq. (6.22)) and discard the data update term.\n\nR? = ?RF ? 1\n2\nRGQGTRTR\n\nConsider the following partition.\n\n\n\n240 6 Orbit Determination\n\nR? = ?\n[\n\nRd Rdy\n\n0 Ry\n\n] [\nFd\n\n0\n\n]\n?\n\n?\n?Rp Rpx Rpy0 Rx Ry\n\n0 0 Ry\n\n?\n?\n?\n? 12GQGTRTpRp0\n\n0\n\n?\n?\n\nwhere Rd corresponds to the dynamic parameters and the matrix Fd contains only\nthe rows of F corresponding to the dynamic parameters. This equation simplifies to\n\nR? = ?Rd Fd ? 1\n2\nRp GQG\n\nT RTpRp\n\nWe only have to integrate the top rows of the SRIF matrix corresponding to the\ndynamic parameters and the derivative is a function of only the Rd partition of the\nSRIF matrix. For the simple case of exponentially correlated process noise we have\n\nFd =\n?\n??\n\n?p?\n\n?p\n0 0\n\n?x?\n\n?p\n\n?x?\n\n?x\n\n?x?\n\n?y\n\n?\n??\n\n?p?\n\n?p\n=\n\n?\n????????\n\n? 1\n?1\n\n? 1\n?2\n\n. . .\n\n? 1\n?i\n\n?\n????????\n\nQ =\n\n?\n?????????\n\n2? 2s1\n?1\n\n2? 2s2\n?2\n\n. . .\n\n2? 2si\n?i\n\n?\n?????????\n\nand G is the identity matrix.\n\n6.6 Direct Orbit Determination\n\nDirect orbit determination is a method for determining a spacecraft orbit directly\nfrom measurements. For Doppler data, the measurement recorded on a tracking\ndata file contains the motion of the Earth, the central body, media and other orbit\nperturbations. After removing known components from the Doppler signature, the\nportion of the signature due only to the spacecraft motion relative to the central body\n\n\n\n6.6 Direct Orbit Determination 241\n\ncan be parameterized. A Newton-Raphson method may be applied to obtain the\nsolution. Parameters which yield a nearly diagonally dominant partials matrix are\ndefined. This method is particularly important for orbits around asteroids and comets\nwhere a velocity error of only a few meters per second can place the spacecraft in\nan entirely unknown orbit.\n\nAnother example of direct orbit determination was devised by Hamilton and\nMelbourne for determining the position of a spacecraft far from the Earth. A single\nrange measurement gives the distance to the spacecraft but provides no information\nof the position normal to the line-of-sight or the right ascension and declination of\nthe spacecraft. By observing the rotation of a tracking station about the Earth\u2019s spin\naxis, which appears in the Doppler data like a spacecraft orbiting a planet, the right\nascension and declination may be determined. The accuracy of this measurement\nis about 0.25\u00b5rad or less than one tenth of an arc second which is about the same\naccuracy as the Hubble space telescope.\n\nThe determination of a spacecraft orbit can be hampered by the lack of conver-\ngence of an orbit determination program, in the case of poor a priori information\nor highly nonlinear measurements. The convergence problem is likely to occur\nfollowing a large propulsive maneuver where execution errors may result in a\npoor prediction of the post maneuver orbit. However, the problem may also arise\nfor a spacecraft that is left in orbit unattended for some time. The most common\noccurrences result from launch into Earth orbit and planetary orbit insertion. In\neither of these cases, a guidance or propulsion system failure can leave the spacecraft\non a trajectory far from the nominal that is generally used as the a priori position\nestimate for the orbit determination solution. Due to nonlinearity, a perturbation of\na few degrees in the orbit elements describing orientation or a few percent in period\nmay result in the failure of an orbit determination program to converge.\n\nFor a spacecraft orbiting a planet, the energy required to perturb the spacecraft\norbit far enough away from its original path to cause an orbit convergence problem\nis considerable. A planetary orbit insertion maneuver does have the potential for\nlarge anomalous orbit perturbations. This subject received much attention on the\nViking mission to Mars and the Magellan mission to Venus. If a motor burn anomaly\nlarge enough to cause an orbit convergence problem had occurred on either of these\nmissions, it could have been very difficult to recover.\n\nFor a spacecraft orbiting a comet or asteroid, a relatively small propulsive\nmaneuver can radically alter the orbit. Only a few meters per second of velocity\nchange are required to reverse the direction of the spacecraft velocity vector. If\nthis were to happen due to an anomalous burn, the spacecraft might be left in\na completely unknown orbit. The available data would be Earth-based Doppler\ntracking since the signal could be recovered by pointing the DSN antennas at the\nasteroid, and it is assumed that the spacecraft would be able to acquire celestial\nreferences and point its antenna at Earth even though the relative direction of the\ncentral body is not known. Conventional methods for redetermining the spacecraft\norbit based solely on processing Doppler data in an orbit determination program\nmay not be adequate.\n\n\n\n242 6 Orbit Determination\n\nThe Doppler observable provides a direct measure of the spacecraft velocity\nprojected onto the line-of-sight between the tracking station antenna and the\nspacecraft. The Doppler measurement is a measure of the difference in range over\nsome time interval scaled by a constant determined by the transmitted frequency,\nthe speed of light and the length of the time interval or count time. The range from\nthe tracking antenna to the spacecraft may be expressed as the sum of the directed\ndistances of the spacecraft to the central body, the central body position relative to\nthe Sun, the Earth position relative to the Sun and the location of the tracking station\nrelative to the center of the Earth, including a small correction for media. For the\norbit determination problem, all of the distances referred to above are well known\nexcept for the spacecraft position relative to the central body. The contribution of\nthis component may be isolated by subtracting the effect of the known distances and\nthe media delay from the raw Doppler measurement. A multidimensional Newton-\nRaphson method is then applied for the solution of the spacecraft orbital elements.\n\n6.6.1 Model of Doppler Data Signature\n\nThe spacecraft orbit may be determined in terms of six orbit elements in the plane-\nof-sky coordinate system shown in Fig. 6.2. After deriving a mathematical model\nfor the spacecraft central body component of the Doppler signature, target positions\non the signature are chosen that approximately define six target parameters, each of\nwhich is directly related to one of the orbital elements to be determined.\n\nFigure 6.2 displays the spacecraft orbital plane with respect to the plane-of-sky\ncoordinate system (X,Y,Z). The plane-of-sky is the plane perpendicular to the line-\nof-sight between the Earth and the central body of the spacecraft orbit. The X and Y\naxes lie in the plane-of-sky, and the Z axis points from the central body to the Earth.\nThe plane-of-sky coordinate system is particularly useful for Doppler data, because\nthe line of sight is along the Z axis.\n\nThe spacecraft orbit is oriented with respect to the plane-of-sky as follows: the\nnode \n is the smallest positive angle between the X axis and the line of nodes,\nwhich is the intersection of the plane-of-sky with the spacecraft orbital plane. The\ninclination i is the angle from the plane-of-sky to the spacecraft orbital plane, and\nthe argument of periapsis ? is the angle from the line of nodes to the semi-major\naxis through periapsis. To convert plane-of-sky coordinates to coordinates in the\norbital plane of the spacecraft, rotations through the three angles \n, i, and ? must\nbe performed.\n\n?\n?X3Y3\n\nZ3\n\n?\n? = T\n\n?\n?XY\n\nZ\n\n?\n?\n\nand\n\n\n\n6.6 Direct Orbit Determination 243\n\nFig. 6.2 The plane-of-sky\ncoordinate system\n\nLINE OF\nAPSIDES\n\nPLANE OF SKY\n\nORBIT PLANE\n\nTOWARD EARTH\n\nORBIT\nNORMAL\nZ2, Z3\n\nZ, Z1\n\nX1, X2X\n\n?\n\nw\n\nX3\n\ny\n(INCR.\nDECL.)\n\nLINE OF NODES\n\ni\n\nT =\n?\n? cos ? sin ? 0?sin ? cos ? 0\n\n0 0 1\n\n?\n?\n?\n?1 0 00 cos i sin i\n\n0 ?sin i cos i\n\n?\n?\n?\n? cos \n sin \n 0?sin \n cos \n 0\n\n0 0 1\n\n?\n?\n\nThe object is to determine an approximate two-body elliptical spacecraft orbit in\nterms of six elements, the semi-major axis a, the eccentricity e, the time of periapsis\ntp, the node \n, inclination i, and argument of periapsis ?. This set of orbital elements\nmay be readily converted to a Cartesian initial state vector that may be input to orbit\ndetermination software for further refinement.\n\nThe signature of the spacecraft orbital velocity projected onto the Earth line-\nof-sight is simply the z component of the spacecraft velocity in the plane-of-sky\ncoordinate system. In the spacecraft orbital plane, the spacecraft position is\n\nX3 = r cos ?\nY3 = r sin ?\nZ3 = 0.\n\nwhere ? is the true anomaly, or periapsis-central body-spacecraft angle, and r is the\ndistance from the central body to the spacecraft. Thus the velocity components are:\n\nX?3 = r? cos ? ? r?? sin ?\nY?3 = r? sin ? + r?? cos ?\nZ?3 = 0.\n\n\n\n244 6 Orbit Determination\n\nTo get velocity coordinates in the plane-of-sky, we transpose the rotations through\n\n, i, and ?, respectively.\n\n?\n???\n\nX?\n\nY?\n\nZ?\n\n?\n??? = TT\n\n?\n??????\n\nX?3\n\nY?3\n\nZ?3\n\n?\n??????\n\nThe Doppler measurement K?? is KZ?. After the application of some standard\ntrigonometric identities and two-body orbit element formulas,\n\nr = a (1 ? e\n2)\n\n1 + e cos ?\n\nr ?? =\n?\n\nGM a (1 ? e2)\nr\n\nr? = r ?? e sin ?\n1 + e cos ?.\n\nthe following equation for the Doppler signature is obtained.\n\nK ?? =\n?\n\nGM?\na\n\nsin i?\n1 ? e2 [cos (? + ?) + e cos ?] K (6.25)\n\nGM is the gravitational constant of the central body of the spacecraft orbit, and K\nis a scaling constant which is related to the transmitted frequency. It converts the\nDoppler observable into Hertz:\n\nK = 2 C3 Ft\nc\n\nwhere Ft is the transmitted frequency, C3 = 240/221 is the spacecraft turnaround\nratio, and c is the speed of light. Ft = 2, 112, 200, 640 Hz for X-band Doppler.\n\nThe representation of the Doppler signature is a function of the time-varying true\nanomaly ? rather than an explicit function of time. The signature may be plotted\nas a function of time by performing the following computations: for a fixed time t,\ntime of periapsis tp, and parameters a, e, i, and ?, we may solve for the eccentric\nanomaly E from\n\nt = tp + 1/2? (E ? e sin E) P (6.26)\n\nP is the period, which is related to the semi-major axis a by the standard formula\nfrom two-body elliptical motion,\n\n\n\n6.6 Direct Orbit Determination 245\n\nP = 2 ?\n?\n\na3\n\nGM\n(6.27)\n\nNewton\u2019s method with an initial condition Eo = ?/2 is effective for this\ncomputation. Given the eccentric anomaly E, the true anomaly ? may be obtained\nfrom\n\n? = tan?1\n(\n\nsin ?\n\ncos ?\n\n)\n(6.28)\n\nwhere\n\nsin ? = (sin E) (a/r) (1 ? e2)1/2 and cos ? = cos E ? e\n1 ? e cos E .\n\n6.6.2 Parameterization of Doppler Signature\n\nFigure 6.3 displays the slowly increasing or decreasing amplitude of a simulated\nDoppler signature, on which six target positions are identified. In the case of an\nactual mission, the raw Doppler data may be processed by an orbit determination\nprogram to remove the known components of the signature due to the relative\nmotions of the Sun, Earth, tracking stations and central body of the spacecraft\norbit. The resulting quasi-periodic signature, corresponding to the spacecraft-central\nbody component, may be similarly plotted and the six target positions identified.\nWhen the spacecraft passes through the plane-of-sky, the observed signature is at a\nmaximum or minimum. A maximum is attained moving away from the Earth, and a\nminimum is attained moving toward the Earth. At the zero crossings, the spacecraft\nrange to Earth is at a local minimum or maximum. If the slope is negative at the zero\ncrossing, the spacecraft is on the far side of the central body away from the Earth;\nand if the slope is positive at the zero crossing, the spacecraft is on the near side of\nthe central body toward the Earth.\n\nThe six target positions defined on the signature yield the set of target parameters\n{zi} below:\n\nz1 = t5 ? t1 a semi-major axis\nz2 = t1 tp time of periapsis\nz3 = h2 + h4 e eccentricity\nz4 = h2 ? h4 i inclination\nz5 = t4 ? t2 ? argument of periapsis\nz6 = h6 ? h2 \n the node\n\nThe six parameters relate to the plane-of-sky orbit elements as indicated. The\ndifference in time between t5 and t1 is approximately the orbit period, from which\n\n\n\n246 6 Orbit Determination\n\nTime - Seconds\n\n(t1,h1) (t3,h3) (t5,h5)\n\n(t4,h4)\n\n(t2,h2) (t6,h6)\n\nH\ner\n\ntz\n -\n\n C\nyc\n\nle\ns/\n\nS\nec\n\non\nd\n\nFig. 6.3 The Doppler signature with target positions\n\nthe semi-major axis is obtained from (13). The parameter z2 is the time of the zero\ncrossing with positive slope, which is related to the time of periapsis, and the third\nparameter z3 is related to the eccentricity, because e cos ? determines the bias offset,\nor integrated average, of the graph. The amplitude\n\nz4 =\n?\n\nGM?\na\n\nsin i?\n1 ? e2\n\nis closely related to the inclination in the plane-of-sky. Also, the argument of\nperiapsis affects the downward slope of the signature, which is related to z5, but\nthe dependence is not apparent from Eq. (6.25), which is not time-dependent. The\nnonlinear relationship between ? and time can be observed in Eqs. (6.26)\u2013(6.28).\nFinally, the node in the plane-of-sky is related to a slow change in amplitude,\nmeasured by z6, that may be attributed to the relative motion of the asteroid with\nrespect to the Earth. The node \n changes as the planet or asteroid rotates around\nthe Sun, and consequently around the Earth. A change in node indirectly changes\nthe inclination i and argument of periapsis ?, which causes an upward or downward\nshift in the Doppler signature, measured by the difference in two peaks.\n\nTo the first order, the true anomaly is the only time-dependent parameter in\nthe mathematical model of the spacecraft-central body component of the Doppler\nsignature (11). The equation does not explicitly incorporate the node in the plane-\nof-sky. The relation to \n may be obtained by solving Kepler\u2019s equation. We may\nobtain a first order equation that includes the node by introducing the rotation of the\ncentral body about the Earth as second order inclination and argument of periapsis\nrates. We have for the rotation of the planet or asteroid about the Earth\n\n\n\n6.6 Direct Orbit Determination 247\n\n?e = Rz \u00d7 Vz|Rz|2\n\nwhere Rz and Vz are the position and velocity of the central body with respect to\nthe Earth. Transforming into the plane-of-sky we have\n\n?pos = T ?e\nThe following Euler angle rates may be obtained from the rotation of the plane-of-\nsky coordinate system.\n\n?\n???????\n\ndi\n\ndt\n\n0\n\n0\n\n?\n???????\n\n= ?\n\n?\n??????\n\ncos \n sin \n 0\n\n? sin \n cos \n 0\n\n0 0 1\n\n?\n?????? ?pos\n\n?\n?????\n\n0\n\n0\nd?\n\ndt\n\n?\n????? = ?\n\n?\n??????\n\n1 0 0\n\n0 cos i sin i\n\n0 ? sin i cos i\n\n?\n??????\n\n?\n??????\n\ncos \n sin \n 0\n\n? sin \n cos \n 0\n\n0 0 1\n\n?\n?????? ?pos\n\n6.6.3 Solution by Newton-Raphson\n\nThe determination of the spacecraft orbit convergence problem thus reduces to\nfinding the plane-of-sky orbit elements that generate the observed signature. We\nestimate the vector of orbital parameters O = (a, tp, e, i, ?,\n)T by measuring the\nvector of target parameters Z = (z1, z2, z3, z4, z5, z6)T. Values computed for six\npoints shown in Fig. 6.3 may be compared with the observed values in a Newton-\nRaphson algorithm to solve for the plane-of-sky orbit elements.\n\nThe vector of target parameters Zo is computed from the spacecraft-central body\ncomponent of the Doppler signal. An initial set of orbital elements Oo is processed\nby an orbit determination program, which includes a model of the irregular gravity\nfield of the asteroid, or other central body. The computed signature is obtained\nby integrating the equations of motion of the spacecraft, projecting the spacecraft\nvelocity vector into the line-of-sight relative to Earth, and scaling by the constant K .\nThe target parameters Z1 are computed from the simulated signal.\n\nThe Newton-Raphson method involves the recursive solution of the following\nequation:\n\n\n\n248 6 Orbit Determination\n\nOn+1 = On +\n(\n\n?Z\n\n?O\n\n)?1\n(Zn ? Z0)\n\nwhere Zn is the vector of target parameters computed from the estimated vector\nof spacecraft orbital elements On. Partial derivatives of the target parameters with\nrespect to the elements of Oj are computed by perturbing each orbital element in\nOj from the nominal, generating a signal, measuring the perturbations in the target\nparameters, and computing\n\n? zi\n? oj\n\n, 1 ? (i, j) ? 6.\n\nA new set of reference orbital elements On+1 and corresponding set of reference\ntarget parameters Zn+1 are then computed. The process is continued to convergence.\nSince the computed and measured Z may be obtained along with the partial\nderivatives with high precision, the major weakness is the initial guess of the orbit\nelements. Since a diagonally dominant system will converge from just about any\ninitial guess, it is desirable to define a parameter set that has a matrix of partial\nderivatives that is as close to diagonal as practical. The above parameter set (zi)\nwas selected with this purpose in mind. The near diagonal dominance of the matrix\nof partial derivatives associated with this parameter set ensures convergence over\na wide range of initial starting points. Also, the converged orbit elements may\nbe transformed to a high-precision state vector that may be input directly to orbit\ndetermination software. The accuracy of the Newton-Raphson solution depends\nonly on the accuracy of the independent parameters (measurements) and their\nrelation to the dependent parameters (the model). The accuracy does not depend on\nthe initial guess or partial derivatives which control the convergence to a solution.\n\n6.6.4 Magellan Example\n\nAs an example of the application of the above method, consider the determination\nof the Magellan spacecraft orbit about Venus. Two orbits of raw Doppler data from\nDSS 15 at Goldstone, California and DSS 45 at Canberra, Australia were acquired\non February 7\u20138, 1991, and are shown in Fig. 6.4.\n\nThe gaps in the data coverage were due to a loss of Doppler data while the\nspacecraft was being rotated for the purpose of science data acquisition. Similar\ngaps could be caused by the unavailability of tracking stations or the occultation\nof the spacecraft by the planet. The target parameters described above require\ncomplete data, in the absence of which the parameter set must be modified to make\nbest use of the data available. Because in general complete data is available, the\nsecond approach was to generate simulated data to supplement the actual data.\nFigure 6.5 displays the Magellan spacecraft-Venus component of the Doppler signal\n\n\n\n6.6 Direct Orbit Determination 249\n\nwith simulated data. From a cursory view of Fig. 6.5, some of the plane-of-sky orbit\nelements are apparent. The period is observed to be approximately three hours, and\nthe amplitude indicates a high inclination. The eccentricity is less obvious, but the\nslight negative shift of the curve indicates a small eccentricity. The large difference\nbetween the upward and downward slopes indicates ? is near \u00b190?.\n\nWith complete data the ideal parameters were chosen as described in Fig. 6.3.\nThe resulting convergence ranges for each orbital parameter are displayed in\nFig. 6.6. The arrows indicate the true orbital parameters for the Magellan mission\nat that time. The intervals displayed represent convergence by introducing an\nerroneous initial condition for one orbital parameter at a time, and using the correct\nvalues for the other orbit elements. It was not possible, given time constraints, to\ncompletely characterize a six-dimensional convergence region. However, conver-\ngence was tested by varying all orbit elements from the true values at once, and\nresults indicated a substantial region of convergence.\n\nA second approach was to use only the real data, choosing alternative target\nparameters. We select as parameters positions on the signal consisting of the times of\ntwo consecutive zero crossings which approximately defines the period and phasing\nof the spacecraft orbit and four other points at fixed epochs near the maxima and\nminima of the Doppler signature. The loss of near diagonal dominance resulted in a\nslower convergence rate than other cases, but even with the sparse data, convergence\nwas observed over a wide range of initial values (Fig. 6.7).\n\nA comparison of the convergence obtained by processing a complete data set\nincluding simulated data (Fig. 6.7) with the convergence obtained by processing\nthe actual sparse data set (Fig. 6.6) indicates a substantial range of convergence for\n\n-250000\n\n-300000\n\n-350000\n\n-400000\n\n-450000\n\n-500000\n\n-550000\n19:00 21:00 23:00 1:00\n\nTime - Hours\n\nH\ner\n\ntz\n\nData from February 7, 1991 - February 8, 1991\n\n3:00 5:00\n\nGoldstone\nCanberra\n\nFig. 6.4 Magellan Doppler signature\u2014raw data\n\n\n\n250 6 Orbit Determination\n\n300000\n\n200000\n\n100000\n\n0\n\n-100000\n\n-200000\n\n-300000\n19:00 21:00 23:00 1:00\n\nTime - Hours\n\nH\ner\n\ntz\n\nData from February 7, 1991 - February 8, 1991\n\n3:00 5:00\n\nGoldstone\nCanberra\nStimulated Data\n\nFig. 6.5 Simulated Magellan spacecraft Venus Doppler signature\n\n10200\n\n0.085 70 90\n98 169\n\n110 130 150 170 190\n\n70\n\nw\n\n80\n80 123\n\n90 99 110 120 130\n\n-133 -123\n-124\n\n-113 -103 -93\n-93\n\n-83 -73\n\n0.185\n0.185 0.550\n\n0.285 0.386 0.485 0.585 0.685\n\n10275 10350 10423 10500 10575 10650\n1065010355\n\n-6440 -6240\n-6480 -5210\n\n-6040 -5839 -5640 -5440 -5240\n\n?a\n\ne i\n\nTP\n\nFig. 6.6 Convergence region for Magellan with simulated data\n\nboth. However, the node \n was better determined by the ideal target parameters used\nwith the simulated data. The node is the most difficult of all the orbital elements to\ndetermine, because its effect on the signature is indirect, and because it changes so\nlittle over a few orbital periods.\n\n\n\n6.7 Summary 251\n\n8925\n\n0.08570 90\n98 195\n\n110 130 150 170 190\n\n70\n\nw\n\n80\n84 113\n\n90 99 110 120 130\n\n-223 -183\n-178\n\n-143 -103 -63\n-53\n\n-23 -17\n\n0.185\n0.009 0.725\n\n0.285 0.386 0.485 0.585 0.685\n\n9425 9925 10423 10925 11425 11925\n117699812\n\n-9000 -8000\n-8040 -1998\n\n-7000 -5839 -4000 -3000 -2000\n\n? a\n\nei\n\nTP\n\nFig. 6.7 Convergence region for Magellan with real data\n\n6.7 Summary\n\nOrbit determination is performed by searching for a set of parameters that minimize\nthe error in the measurements computed from a model or by direct solution of the\norbit from a minimum set of observations ignoring the error in the measurements.\nIncluded in the parameters is the initial spacecraft state or orbit elements. The orbit\ndetermined during flight operations is almost exclusively obtained by fitting data\nto a model and direct orbit determination is seldom used. This is contrary to orbits\ndetermined before the invention of the computer when orbit determination was by\ndirect observation. The computer algorithm for searching for a solution is called a\ndata filter. A data filter filters out bad data points. There are many types of data filters\nthat operate on the error of the measurements and the covariance of the estimated\nparameters, the inverse of the covariance, the square root of the covariance, and the\nsquare root of the covariance inverse. Covariance filters may be based on weighted\nleast squares or the Kalman filter algorithm. It can be shown that all of the filter\noptions solve the same problem and get the same result and the performance is\nmore dependent on the implementation than the filter algorithm.\n\nPlanetary spacecraft navigation uses weighted least squares implemented in a\nsquare root information filter. When large number of parameters are estimated, the\ndata filter formulation requires the inversion of a large matrix. The Kalman filter\nalgorithm is a clever algorithm for matrix inversion. An upper triangular square root\ncovariance is easier to invert than a covariance matrix or at least this is the opinion\nof square root filter advocates. The SRIF algorithm follows directly from work of\nGauss and has survived to this day without any significant improvement. During\nthe NEAR mission, 600 parameters were estimated every 3 days for over a year\nwith only minor problems in obtaining solutions for the spacecraft orbit, the Eros\n\n\n\n252 6 Orbit Determination\n\nephemeris, the Eros attitude, gravity harmonics, landmark locations, solar pressure\nmodel parameters, and propulsive maneuvers.\n\nThe discreet form of a data filter may be replaced by continuous differential equa-\ntions for the elements of the covariance matrix. The advantage of the continuous\nformulation is the elimination of the need to compute a state transition matrix for\ndata processing and mapping of stochastic parameters. Once the filter formulation\nhas been obtained for the covariance filter, it can be readily adapted to information,\nsquare root covariance, and square root information filters. A continuous filter was\nimplemented for the NEAR mission but was not used during navigation operations.\nContinuous filtering requires more study before committing to actual mission\noperations.\n\nAn algorithm for performing direct orbit determination was derived for a\nspacecraft in orbit about a body. Six points were spotted on the Doppler signature\nand the orbit that passed through these points was determined by performing a\nNewton-Raphson search. Since there are six orbit elements, there is only one orbit\nsolution and this orbit can be determined to a higher precision than one may suspect.\nDoppler data is very accurate. Direct orbit determination is an interesting backup\nprocedure, but has yet to be implemented during flight operations. In practice,\ndifficulties in determining orbit solutions have been solved by doing more searches.\n\nExercises\n\n6.1 The Kalman filter algorithm is essentially matrix inversion. Show how a matrix\ncan be inverted by formulating a parameter estimation problem and processing the\n\u201cdata\u201d with the Kalman gain matrix and the weighted least square gain matrix.\n\n6.2 An orbit determination analyst notices a ramp of about 3.5 mHz over 20 min\nin the Doppler data. This corresponds to an unknown acceleration of 1.906 \u00d7\n10?10 km/s2. The spacecraft is near Earth and a planet is suspected. In the early\ndays of the space program, planets were sometimes omitted from the equations of\nmotion. What planet is the best guess? It wasn\u2019t Jupiter.\n\n6.3 A single point smoothed estimate requires an update to the computed covari-\nance at the smoothing epoch. Show how this update may be accomplished by\nprocessing six artificial measurements at the smoothing epoch.\n\n6.4 An orbit determination estimate X1 with covariance P1 is obtained by process-\ning data up to t1. Some additional data (Z1,2) is obtained from t1 to t2 and another\nestimate X2 is computed with covariance P2. If the new data is weak, X2 will be\nnearly the same as X1. In a Monte Carlo program, a sample drawn from P2 must\nnearly equal a sample drawn from P1. Thus, we must know the correlation between\nP1 and P2 in order to draw the correct sample at t2. For an optimum filter without\nstochastic parameters, determine the cross correlation matrix P1,2 = E(X1XT2 ).\n\n\n\nBibliography 253\n\n6.5 The samples in Exercise 6.3 may be drawn by forming the matrix\n\nP =\n[\n\nP1 P1,2\n\nP1,2 P2\n\n]\n\nand drawing a sample from P . Drawing a sample from P involves computing the\neigenvalues and eigenvectors of P , generating independent normally distributed\nrandom variables with sigmas equal to the square root of the eigenvalues and\nmultiplying these random variables by the matrix of eigenvectors. If there are\nmore than two orbit determination estimates in the sequence, the dimension of\nthe P matrix may become too large. Determine a sampling algorithm that involves\ndrawing a sample X1 from P1 and computing a conditional sample X2.\n\n6.6 A spacecraft that is a great distance from Earth is being tracked by the DSN. The\ntracking station is 5000 km off the Earth\u2019s spin axis. The tracking station longitude\nerror is 1.5 m and the spin axis error is 1.0 m. The Earth\u2019s radius and rotation rate are\n6150 km and 7.26\u00d710?5 rad/s, respectively. Three Doppler data points are obtained\nat station rise, zenith, and station set. Determine the contribution of the station\nlocation errors in determining the errors in the right ascension and declination of\nthe spacecraft as a function of declination.\n\n6.7 Given the same data as in Exercise 6.6, determine the error in right ascension\nand declination of the spacecraft for perfect station location knowledge and a\nDoppler measurement error of 1.0 mm/s.\n\n6.8 Repeat Exercise 6.7 for a range measurement error of 1 m.\n\nBibliography\n\nBierman, G. J., 1977, Factorization Methods for Discrete Sequential Estimation, Academic Press,\nInc., New York.\n\nBoggs, D.H., \u201cA Partial Step Algorithm for the Nonlinear Estimation Problem\u201d, AIAA Journal,\nVol. 10, No. 5,675\u2013679, May 1972.\n\nDyer, P., and S. R. McReynolds, \u201cExtension of Square Root Filtering to Include Process Noise,\u201d\nJournal of Optimization Theory and Applications, Vol.3, pp.444\u2013458, 1969.\n\nGrewal, M. S., and A. P. Andrews, Kalman Filtering Theory and Practice, Prentice Hall,\nEnglewood Cliffs, NJ, 1993.\n\nKaminski, P. G., A. E. Bryson, Jr., and S. F. Smith, \u201cDiscrete Square Root Filtering:A Survey of\nCurrent Techniques,\u201d IEEE Transactions on Automatic Control,Vol. AC-16,pp.727\u2013736,1971.\n\nMasters, W. C., \u201cDesign and Implementation of Estimation Methods in ODP\u201d, Internal document,\n2 December 1991\n\nMasters, W. C., P. J. Breckheimer, \u201cUpdating Colored Noise and Spacecraft State from One Batch\nto the Next\u201d, Internal document, 19 September 1991\n\nMiller, J. K., \u201cA Single Point Smoothing Algorithm for Athena with Application to Mariner Temple\n2\u201d, IOM 314.4\u2013543, 22 September 1986.\n\nMiller, J. K., \u201cAn Integrated Current State Square Root Information Filter-Smoother \u201d, Internal\ndocument, 27 November 1991.\n\n\n\n254 6 Orbit Determination\n\nMiller, J. K. and Belbruno, E. A., \u201cA Method for the Construction of a Lunar Transfer Trajectory\nusing Ballistic Capture,\u201d AAS 91\u2013100, AAS/AIAA Spaceflight Mechanics Meeting, Houston,\nTX, Feb 11\u201313, 1991.\n\nMiller, J. K., \u201cA Continuous Square Root Ibformation Filter-Smoother with Discrete Data Update\u201d,\nAAS 94\u2013169, AAS/AIAA Spaceflight Mechanics Meeting, Cocoa Beach, FL, February 14,\n1994.\n\nPotter, J. E., and R. G. Stern, \u201cStatistical Filtering of Space Navigation Measurements\u201d, Proc. 1963\nAIAA Guidance and Control Conference, 1963.\n\nRyne, M.S. and Wang, T.C. \u201cApplications of Singular Value Analysis and Partial-Step Algorithm\nfor Nonlinear Orbit Determination\u201d, AAS/AIAA Spaceflight Mechanics Meeting, AAS 91\u2013\n190, Houston, Texas, February, 1991.\n\nScheeres, D. J., \u201cDerivation of a Generalized Form of the SRIF Differential Equation,\u201d Internal\ndocument, 13 July 1993.\n\nWeeks, C. J., Rosario, S. and A. Buschelman, \u201cDirect Determination of a Spacecraft Orbit from\nthe Doppler Data Signature\u201d, AAS 95\u2013144, AAS/AIAA Spaceflight Mechanics Meeting,\nAlbuquerque, NM, February 13, 1995.\n\n\n\nChapter 7\nMeasurements and Calibrations\n\nThe measurement system is a collection of instruments on board the spacecraft\nand on the ground that provide observations of the spacecraft motion with respect\nto Earth and specific target bodies. Instruments of this kind are the Deep Space\nNetwork (DSN), a solid-state imaging (SSI) device, and a laser altimeter. The\nDSN tracking stations transmit radio frequency signals to the spacecraft and\nreceive signals via the spacecraft transponder and antenna. The received signals\nconstitute observations of range and Doppler data by conventional methods and\nobservations of angles by VLBI methods. An SSI allows optical observations of\nplanets, satellites, comets, and asteroids to be made against the background of the\nfixed stars and direct observation of landmarks. A laser altimeter bounces laser\nbeams off the surface of a body and measures the round trip light time.\n\n7.1 Radiometric Tracking Data\n\nThe major components of the radio tracking system include the telecommunication\nsubsystem on-board the spacecraft, the Deep Space Stations (DSSs) of the Deep\nSpace Network (DSN), and the general purpose computers of the Space Flight\nOperations Facility (SFOF) located at the Jet Propulsion Laboratory (JPL) in\nPasadena or other control centers.\n\nThe parts of the telecommunications subsystem used for orbit determination are\nS-band and X-band receivers and coherently driven S- and X-band transmitters.\nThey provide a coherent two-way communications link for tracking observables,\nDoppler and range. Also, the spacecraft carrier is modulated with special tones for\nwideband ?VLBI. The DSN is a network of tracking stations located around the\nglobe at Goldstone, California; Madrid, Spain; and Canberra, Australia. Each DSS\nis a complex of a 72-m antenna and several 34-m antennae and special purpose\nhardware and computers for extracting Doppler, range, and VLBI observables from\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_7\n\n255\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_7&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_7\n\n\n256 7 Measurements and Calibrations\n\nreceived spacecraft signals and VLBI from extragalactic radio sources. This data is\nrelayed via high-speed data lines to the control center where software on general\npurpose computers process the data to obtain estimates of the spacecraft trajectory\nand compute propulsive maneuvers for trajectory control.\n\n7.1.1 Doppler Data\n\nDoppler data is the work horse of the measurement system. Most missions can\nbe navigated with Doppler data as the only data type input to orbit determination\nsoftware. Doppler data provides a direct measure of line-of-sight velocity of a\nspacecraft relative to a tracking antenna. The accuracy of this measurement is about\n1 mm/s when the two-way Doppler count is integrated for 1 min. A single Doppler\nmeasurement provides no information on position or velocity normal to the line-\nof-sight. For those phases of the mission where the spacecraft is being accelerated\nrapidly, such as near a planetary encounter, a series of Doppler measurements permit\na quite accurate complete orbit determination by observing the orbit dynamics\nsignature. When the spacecraft is far from a planet, comet, or asteroid, the\ngravitational accelerations are not sufficient to observe this signature. However,\nthe \u201cvelocity parallax\u201d due to the tracking stations rotation with Earth provides a\nmeasure of position normal to the line-of-sight. By measuring the amplitude and\nphase of the tracking stations signature, the right ascension and cosine of declination\nmay be determined to about 0.25\u00b5rad. Thus, at Jupiter distance, the Earth-relative\norbit determination error is about 200 km.\n\nThe functional definition of Doppler data as line-of sight velocity is useful for\nanalyzing the orbit determination errors that are spacecraft or trajectory dependent\nbut is of little use for analyzing error sources close to the actual measurement such as\nmedia or hardware errors. The actual measurement is a count derived from the signal\nreceived from the spacecraft and a frequency standard maintained at the tracking\nstation that controls the frequency of the transmitted signal. Thus, a precision model\nof the Doppler observable includes a model of the signal path as well as hardware\nelements. In practice, the hardware errors are small compared to media, station\nlocation, and spacecraft dynamics errors.\n\n7.1.2 Doppler Measurement Model\n\nA model of the Doppler observable has been developed that idealizes some of the\nhardware error sources yet precisely models the external environment. This model\nis sufficiently precise for computation of the observable and is essentially the model\ncontained in orbit determination software. Of particular interest are models that are\nexternal to the tracking station hardware yet pertain directly to the signal path.\nMedia and the effect of general relativity on station clocks are examples. Other\n\n\n\n7.1 Radiometric Tracking Data 257\n\nmodels, such as station locations and polar motion, though not directly part of the\nDoppler measurement system, may be treated as measurement calibrations.\n\nThe Doppler measurement is simply an electronic count of the number of cycles\nfrom a frequency standard (Nc) minus the number of cycles of the spacecraft signal\nreceived by the tracking station (Nr) and scaled by the count time interval (?Tc).\nThus we have\n\nZm = (Nc ? Nr) + n\n?Tc\n\nwhere n is the measurement noise which is about 1/10 of a cycle. The received\nfrequency and standard frequency need not be counted individually and differenced\nbut may be added together electronically and the beat frequency counted. This is a\ndetail that is dependent on the hardware implementation. The numerical value of Zm\nis the number that is recorded on a tracking data file and used for orbit determination.\n\nIn the orbit determination software we need to obtain a computed value for Zm\nas a function of parameters that are available. This function can be derived from the\nequations of motion and a physical model of the system. We start by developing a\nfrequency standard that can be compared with the frequency of the transmitted and\nreceived signals. The frequency standard is obtained by scaling a reference oscillator\nfrequency fq , obtained from an atomic clock, to equal the transmitted frequency (ft )\ntimes the spacecraft turn around ratio (C3) which would nominally be the received\nfrequency if there were no spacecraft Doppler shift or additional delay. The turn\naround ratio is necessary so that the downlink will not interfere with the uplink.\n\nNc = C3 ft ?Tc\nwhere for S band Doppler,\n\nC3 = 240\n221\n\nft = 96 fq\n?Tc = T3e ? T3s\n\nThe count time (?Tc) is defined as the difference between the reception time at\nthe start of the count time interval (T3s ) and the reception time at the end of the\ninterval (T3e ). For a schematic representation of these times, see Fig. 7.1. In the\nabove equation, all of the parameters are constant or arbitrarily specified including\nthe reception times. The real information content of the measurement is contained\nwithin the count Nr . Thus, in order to obtain a complete equation for the computed\nmeasurement, we need an equation for Nr . It is tempting to differentiate and work\nin the frequency domain; however, the hardware works with phase which makes\nit convenient to formulate the measurement in terms of phase thus bypassing an\nexplicit equation for the received frequency.\n\n\n\n258 7 Measurements and Calibrations\n\nr12s r12e r23s\n\nr23e\n\nt2s\n\nt1s\nt1e\n\nT1s\nT1e\n\n?Trt/t\nTRANSMIT\n\nET\n\nUTC\n\nRECEIVE\n\n?Tc\n\nT3s\nT3e\n\nt3s\nt3e\n\nt2e\n\nFig. 7.1 Doppler observable schematic diagram\n\nThe equation that relates the measurement to the observable parameters is\n\nNr = 240\n221\n\nNt\n\nwhere\n\nNt = ft (T1e ? T1s )\nft = 96 fq\n\nThe above equation for Nr states that the number of cycles counted at the receiver\nis equal to the number of cycles transmitted Nt times the spacecraft turn around\nratio. This equation is true because they are effectively the same cycles. Thus, the\ninformation content of the measurement is now contained in the transmit times T1e\nand T1s . Since both of these times are unknown, we need some additional equations\nto tie into the observable quantities. At this point in the development, we have the\nfollowing equation for the computed measurement.\n\nZc = (T3e ? T3s ? T1e + T1s )\nC3ft\n\n?Tc\n\nWe need equations for the times in the above equation and these will be\ndeveloped as functions of ephemeris time t . We have for the atomic clock at the\nstation\n\nT = t + F(t, x, y)\n\nThe station time T is equal to the ephemeris time t modified by a small correction\ndue to general relativity and any other parameter that may affect the running of the\n\n\n\n7.1 Radiometric Tracking Data 259\n\nclock. The calibration function (F ) is a function of t , the state of the solar system\n(x), and other constant parameters (y). Here, x and y can be thought of as parameter\nvectors. The relevant times shown in Fig. 7.1 relating to the Doppler measurement\nare\n\nT1s = t1s + F(t1s , x, y)\nT1e = t1e + F(t1e , x, y)\nT3s = t3s + F(t3s , x, y)\nT3e = t3e + F(t3e , x, y)\n\nMaking the above substitutions, the equation for the computed measurement\nbecomes\n\nZc = (t3e ? t3s ? t1e + t1s )\nC3ft\n\n?Tc\n\n+ [F(t3e , x, y) ? F(t3s , x, y) ? F(t1e , x, y) + F(t1s , x, y)] C3ft?Tc (7.1)\nSince the speed of light is constant in any reference frame, we may obtain by\nintegrating along the light path\n\nt3e ? t1e =\n?12e + ?23e\n\nc\n+ ?tm1e + ?tm3e\n\nt3s ? t1s =\n?12s + ?23s\n\nc\n+ ?tm1s + ?tm3s\n\nwhere the ? terms represent the integrated distance along the light path and the tm\n\nterms represent the additional delay caused by media. The distances along the light\npath are obtained by integrating the equations of motion.\n\n?12s =\n?? t2s\n\nt1s\n\n?? dtdt\n\n?23s =\n?? t3s\n\nt2s\n\n?? dtdt\n\n?12e =\n?? t2e\n\nt1e\n\n?? dtdt\n\n?12e =\n?? t3e\n\nt2e\n\n?? dtdt\n\nThese equations are referred to as the light time equations and are solved iteratively\nfor the arguments of integration. The media delay is included in the measurement\n\n\n\n260 7 Measurements and Calibrations\n\nequation by evaluating the calibration function (G) at the appropriate times.\n\n?tm = G(t, x, y)\n?tm1s = G(t1s , x, y)\n?tm1e = G(t1e , x, y)\n?tm3s = G(t3s , x, y)\n?tm3e = G(t3e , x, y)\n\nThe final equation for the computed measurement includes the observable equations\nas well as clock and media calibration functions.\n\nZc = ?12e + ?23e ? ?12s ? ?23s\nc\n\nC3ft\n\n?Tc\n\n+ [F(t3e , x, y) ? F(t3s , x, y) ? F(t1e , x, y) + F(t1s , x, y)] C3ft?Tc\n+ [G(t3e , x, y) ? G(t3s , x, y) + G(t1e , x, y) ? G(t1s , x, y)] C3ft?Tc (7.2)\n\n7.1.3 Data Noise\n\nRecall that the measurement noise is scaled by the count time (?Tc).\n\nZm = Nc ? Nr\n?Tc\n\n+ n\n?Tc\n\n(7.3)\n\nThe data noise is approximately 1/10 of the cycle count and is independent of\nfrequency. For a 60 s count time, the data noise is 1.66 mHz. Doppler data is scaled\nby the count time to make the recorded measurement proportional to velocity. The\nDoppler measurement sensitivity to line-of-sight velocity is given by\n\nZ?? ? 2 C3ft\nc\n\n?? (7.4)\n\nAt S-band frequency, typical values for the constants in the above equation are\n\nC3 = 240\n221\n\nft = 96 fq\nfq = 22 \u00d7 106 Hz\n\nc = 299792.458 km/s\n\n\n\n7.1 Radiometric Tracking Data 261\n\nand for ?? = 1 mm/s the measurement gives the well-known result Z?? = 15.3 mHz.\nIn order to obtain this result, the above equation must be entered with a consistent\nset of units for each of the parameters. At X-band frequency, 1 mm/s velocity\ncorresponds to about 56 mHz.\n\n7.1.4 One-Way Doppler Data\n\nThe one-way Doppler data type provides a measure of the change in the line-of-\nsight range between a DSN station and a spacecraft over some interval of time. The\nmeasurement makes use of the Doppler frequency shift of a source when the receiver\nis moving with respect to the source. When the change in range is divided by the\ntime interval, a measure of the average range rate over the time interval is obtained.\nThe source is a radio signal whose frequency is controlled by an oscillator or clock\non the spacecraft. The transmitted radio wave is received by a DSN tracking station\nand the individual cycles are counted. If the spacecraft is stationary with respect\nto the DSN antenna or there is no net change in range over the count interval, the\nmeasured cycle count divided by the time interval will equal the frequency of the\nradio signal transmitted by the spacecraft. If the spacecraft is moving with respect to\nthe antenna, the difference between the cycle count transmitted and the cycle count\nreceived times the wavelength of the transmitted radio signal is a measure of the\nrange change over the count time interval and is the measurement that may be used\nto determine the orbit of the spacecraft. A problem with one-way Doppler is the\nfrequency of the transmitted radio signal. The frequency control of a radio signal\non a spacecraft is marginal at best. The spacecraft does not have access to high-\nprecision atomic clocks to control the frequency and the measurement is accurate\nto about 1 cm/s even with ultra-stable oscillators on the spacecraft. An atomic clock\non the spacecraft is needed and is under development.\n\nThe first step in processing a one-way Doppler data point is to read the first\ndata record from the tracking data file and obtain the time tag, frequency, and the\nmeasurement. For the first one-way Doppler point, the count time is subtracted from\nthe recorded time tag to initialize the station time associated with receipt of the\nDoppler measurement at the start of the Doppler count. For subsequent one-way\nDoppler points, the start of the Doppler count is exactly the end time of the previous\nDoppler count. Thus, the first Doppler point requires two solutions of the light-time\nequation and subsequent points require only one. When the continuity is interrupted,\nthe time tags are not separated by the exact count time and the one-way Doppler\ncount is restarted.\n\nThe computation of the observable involves integrating the transmitted and\nreceived frequencies over the appropriate time intervals. The transmitted frequency\nis controlled by the oscillator on the spacecraft which tends to drift. The frequency\nmay be modeled as a polynomial function of time given by\n\nft = FRQ0 + FRQ1(t ? tf ) + FRQ2(t ? tf )2\n\n\n\n262 7 Measurements and Calibrations\n\nwhere FRQi are the coefficients of the polynomial and tf is the ephemeris time\nassociated with FRQ0. The FRQ0 coefficient is set equal to the frequency obtained\nfrom the tracking data file data record and the linear and quadratic coefficients\nare generally initially set to zero. The time interval for the integration is from the\nephemeris time at the spacecraft obtained from the light time solution at the start of\nthe count (t2s) to the end of the count (t2s). The required integral is given by\n\nf qt =\n? t2e\n\nt2s\n\nft dt\n\nf qt = FRQ0(t2s ? t2e) + FRQ12\n[\n(t2s ? tf )2 ? (t2e ? tf )2\n\n]\n\n+FRQ2\n3\n\n[\n(t2s ? tf )3 ? (t2e ? tf )3\n\n]\n\nThe received frequency (fr ) may be modeled as a polynomial function of\nreceived station time by mapping the function for the transmit time to the Earth\nand converting to station time.\n\nfr = FRQ0 + FRQ1(t ? tf ) + FRQ2(t ? tf )2\n\nThe received radio signal is integrated over the count time interval defined by the\ntime tags.\n\nf qdn =\n? t3e\n\nt3s\n\nfr dt\n\nf qdn = FRQ0(t3s ? t3e) + FRQ12\n[\n(t3s ? tf )2 ? (t3e ? tf )2\n\n]\n\n+FRQ2\n3\n\n[\n(t3s ? tf )3 ? (t3e ? tf )3\n\n]\n\nThe one-way Doppler observable (Zowd ) is given by\n\nZowd = C3(f qdn ? f qt )\nCOUNT\n\n7.1.5 Three-Way Doppler Data\n\nThe three-way Doppler data type provides a measure of the change in the total\nline-of-sight range from a transmitting DSN station to a spacecraft and back to\na separate receiving station over some interval of time. The measurement makes\nuse of the Doppler frequency shift of a radio signal source that is moving with\nrespect to a receiver. When the change in range is divided by twice the time\n\n\n\n7.1 Radiometric Tracking Data 263\n\ninterval, an approximate measure of the average range rate over the time interval is\nobtained. If the transmitting station is widely separated from the receiving antenna,\nthe interpretation of the measurement as range rate is ambiguous. The three-way\nDoppler measurement is essentially the same as the two-way Doppler measurement.\nThe only significant difference is the inclusion of a second separate tracking station\non the downlink. The three-way Doppler measurement has a geometrical advantage\nover conventional two-way single station Doppler which may be attributed to\nthe baseline between the participating tracking stations. However, the frequency\nstandard must be maintained at two stations resulting in some loss of coherence and\naccuracy. The data processing for three-way Doppler is the same as for two-way\nDoppler except that a second station is substituted in computing the downlink.\n\n7.1.6 Range Data\n\nThe range data type provides a measure of the range between a DSN station and\na spacecraft. The range is inferred from the time it takes a radio signal to travel\nfrom the DSN station to the spacecraft and back to the station. The radio signal\nis transmitted to the spacecraft where it is received and retransmitted back to the\ntracking station. The round trip light-time is determined by impressing a pattern,\nreferred to as a range code, on the transmitted carrier and detecting this pattern in\nthe received radio signal. The range code provides time markers in the transmitted\nand received radio signal that may be measured with high precision by an atomic\nclock. For orbit determination, a computed value of the measurement is obtained\nfrom a mathematical model similar to the model used for Doppler data.\n\nRange data has essentially the same information content as Doppler data. Range\ndata provides the integral of Doppler data over some time interval. This integrated\nDoppler can be determined by differencing two range measurements. The integrated\nDoppler is more accurate than differenced range. However, the range data provides\nthe constant of integration. Doppler data alone determines range through the orbit\ndynamics. For this reason, an orbit determination strategy has evolved to process a\nsingle loosely weighted range point for each station pass to initialize the Doppler.\nProcessing range and Doppler together at the same weight can result in aliasing.\nBoth data types determine the right ascension and declination independently and\nthey may disagree.\n\nThe first step in computing the two-way range observable is to assemble all the\ninput data required by the orbit determination software. These are essentially the\nsame models as used for Doppler data with some minor exceptions. Models of the\ntransmission media, station locations and the affect of General relativity are virtually\nthe same as used for computing the Doppler observable. One exception is the sign\nof delays associated with charged particles in the ionosphere and solar plasma. For\nDoppler data, the charged particles speed up the velocity of the carrier and the delay\nis subtracted. For range data, the velocity of the carrier is slowed down and the delay\nis added as for all the other media delays. The magnitude of the velocity increase\n\n\n\n264 7 Measurements and Calibrations\n\nassociated with charged particles for Doppler data is equal to the velocity decrease\nor delay for range data.\n\nA range data point is read from the tracking data file to obtain the time tag\n(T IMT AG), frequency (FRQCY ), lowest ranging component (NLOW ), and\nthe measurement (ROBS). The light-time equation is solved for the transmit and\nspacecraft times t1 and t2. The station receive time (t3) is equal to T IMT AG.\n\nThe next step is to integrate the ramp tables for the uplink and downlink. The\nramp tables keep the received signals in the center of the carrier bandwidth. Since\nthe range code is modulated on the carrier, the range traveled by the radio signal\nequals the sum of the wavelengths associated with all the cycles between the\nspacecraft and the DSN antenna and is equal to the cycle count times the speed\nof light after correcting for media. The cycle count (fq ) is obtained by integrating\nthe uplink ramp table from t1 to t3. The range observable (Zr ) is computed from the\noutput of the ramp table integration which is scaled by an integer ratio corresponding\nto the frequency dividers used in the actual hardware implementation to give the\nmeasurement in range units (Ru). For S-band frequency, the conversion to range\nunits is\n\nRu = 1\n2\n\nf q\n\nFor X-band frequency, the conversion for the 34-m Az-EL high efficiency antenna\n(HEF) is\n\nRu = 11\n75\n\nf q\n\nand for 34-m Block 5 Receivers (BVR)\n\nRu = 221\n749 \u00d7 2f q\n\nThe range code is a pattern consisting of square waves whose frequency\ndecreases by powers of two. Thus, the range code is repeated at a rate determined by\nthe lowest frequency square wave or range component. This results in an ambiguity\nin the determination of range that must be resolved by introducing information from\nother sources, most notably the Doppler measurement which has no ambiguity. The\nrange ambiguity manifests itself as a roll over to zero in the range unit counter. Thus,\nif the computed number of range units is greater than the ambiguity, the ambiguity\nis repeatedly subtracted from the computed measurement until it is in the proper\nrange. The range ambiguity is computed from NLOW , which is obtained from the\ntracking data file, and is given by\n\nAMBIG = 2(NLOW+6)\n\nThe number of roll overs of the range unit counter is the integer part of\n\n\n\n7.1 Radiometric Tracking Data 265\n\nNa = Integer\n(\n\nRu\n\nAMBIG\n\n)\n\nThe adjusted value for the range unit count is then\n\nRua = Ru ? Na AMBIG\n\nAt the time the computed observable rolls over, it cannot be determined from\nthe computed range alone whether the actual observable has just rolled over or is\nabout to roll over. This ambiguity may be resolved by inspecting the measurement\nresidual. The measurement residual is simply\n\nRESID = ROBS ? Rua\nwhere ROBS is obtained from the tracking data file. If the absolute value of ROBS\nis greater than 1.5 \u00d7 AMBIG, the ambiguity resolution is skipped. Otherwise, the\nfollowing adjustment is made to the computed observable.\n\nIf (RESID > 0.5 \u00d7 AMBIG) Zr = Rua + AMBIG\nIf (RESID < 0.5 \u00d7 AMBIG) Zr = Rua ? AMBIG\n\nOtherwise, Zr = Rua . The residual (RESID) is then recomputed with the new value\nfor Zr .\n\nRESID = ROBS ? Zr\nThis correction to the range measurement can be dangerous. If the ambiguity is\nset too low and the computed measurement is not known within the ambiguity, the\nrange measurement will be in error and the resultant orbit solution can be off by\nseveral hundred kilometers. The range and Doppler residuals could be flat making\nit difficult to detect this error.\n\n7.1.7 Very Long Baseline Interferometry\n\nPlane radio waves from the spacecraft or an extragalactic radio source (EGRS) are\nreceived at two tracking stations separated by an intercontinental baseline as shown\nin Fig. 7.2. As originally implemented, the received signals are clipped, digitized,\nand recorded on video recorders at each tracking station. Special tones are impressed\non the spacecraft transmitted signal to obtain the required bandwidth. The EGRS\nsignal is passed through filters to obtain the proper spectral bandwidth. Since the\nspacecraft signal is considerably stronger than that obtained from an EGRS, the\ntracking strategy consists of recording an EGRS for about 20 min, slewing the\n\n\n\n266 7 Measurements and Calibrations\n\nFig. 7.2 VLBI functional implementation\n\nantennas to the spacecraft and recording for 5 min, and if necessary slewing back\nto the EGRS and recording for another 20 min.\n\nAfter recording the radio signals, it is necessary to bring the two recordings\ntogether at a central correlator. The tapes may be physically transported to the\ncorrelator or played back across high-speed data lines. The function of the correlator\nis to match the two recordings and determine the delay. Correlation involves\nshifting, multiplying, and integrating the bit streams together until a maximum is\nfound. The delay is a measure of the angle between the baseline and the direction\nof the plane radio wave. Differencing the spacecraft and EGRS delay effectively\nprovides a measure of their angular separation. Combining observations on an\nEast-West baseline (Goldstone/ Madrid) with a North-South baseline (Goldstone/\nCanberra) gives a precise measure of spacecraft right ascension and declination\naccurate to about 5 nrad relative to the EGRS. As currently implemented, the\nconfiguration shown in Fig. 7.2 has been updated and replaced by more sophisticated\nsoftware and hardware, but the function and accuracy remains about the same as\noriginally implemented.\n\n7.1.8 Differential Wide Band VLBI\n\nDifferential Very Long Baseline Interferometry (?VLBI) consists of near simul-\ntaneous interferometric tracking of a spacecraft and an angularly nearby EGRS.\nThe accuracy of ?VLBI is dependent on the angular separation of the spacecraft\n\n\n\n7.1 Radiometric Tracking Data 267\n\nand EGRS. Separation angles less than about ten degrees are needed in order to\nachieve cancelation of errors due to media effects and station location uncertainties.\nAn extensive survey of the sky has developed a radio source catalog. To be useful\nfor VLBI observations, the source flux must be greater than 0.20 Jy and the source\nstructure should be smaller than about 5 nrad in diameter. Another consideration\nis the variability of source strength. Once identified, precise VLBI measurements\nof source position are made for inclusion in the source catalog. In the search for\nradio sources, emphasis is given to the portion of the sky near the ecliptic plane\nbecause missions to the planets place spacecraft on trajectories that are within a few\ndegrees of the ecliptic plane. For orbit determination, the difference between the\nEGRS VLBI measurement and the spacecraft VLBI measurement is processed as a\ndata type.\n\n7.1.9 Differential Narrow Band VLBI\n\nThe narrow band VLBI observable provides a measure of the change in the angle\nbetween the wave front of a radio signal from a radio source and the baseline\nbetween two tracking stations in the plane of the tracking stations and radio source\nover an interval of time. Narrow band VLBI differs from wide band VLBI by the\nmanner of detection of the received radio signals. For a spacecraft, narrow band\nVLBI tracks the carrier and determines a count of the number of cycles received\nover an interval of time referred to as the count time. It is directly analogous to\nDoppler. A problem with narrow band VLBI is the existence of a singularity in\nthe measurement at zero declination relative to the Earth\u2019s equator. Therefore, it is\ngenerally only used when wide band VLBI cannot be obtained. Low signal level or\nthe absence of tones on the carrier would preclude wide band VLBI.\n\nFor quasar VLBI, the same algorithm for the light time solution is used as for\nDoppler and spacecraft VLBI. The same approach is used for the quasar as for\nthe spacecraft only the equations for ?12, ?23 and their derivatives with respect\nto time must be modified. Since the quasar is effectively located at infinity, an\ninvariant plane is defined as illustrated in Fig. 7.3 to provide a reference for defining\nt2. The invariant plane is defined, for the purpose of illustration, to be 7000 km\nfrom the center of the Earth and perpendicular to the direction of the quasar being\nobserved. The actual distance of the invariant plane from the center of the Earth\nis arbitrary. Plane radio waves from the quasar will cross this invariant plane at\nthe same time which is taken to be the t2 time. The modifications necessary for\nthe downlink portion of the light time algorithm relate to the computation of ?23\nand its derivatives. First, the spin vector of the Earth in inertial space is computed.\nFor a quasar, some additional signal processing is required. Since the quasar\nradiates essentially white noise, it is necessary to condition the signal to obtain\nthe monochromatic tone required by narrow band VLBI. This is accomplished by\npassing the quasar signal through a pass band filter before recording on the video\nrecorder. The two recordings obtained from the participating stations are correlated\n\n\n\n268 7 Measurements and Calibrations\n\nt2 t2\n\nt3\n\ninvariant plane\n\nto quasar\n\n70\n00\n\n k\nm\n\nr12\nr23\n\nt1\n\nrs2\n\nrs1\n\nFig. 7.3 VLBI quasar geometry\n\nwhich produces a difference in the cycle count over the count time interval. This\ncycle count provides a measure of the change in delay which is a measure of the\nchange in the angle (? ) between the baseline (B) and the direction of the plane radio\nwave front as illustrated in Fig. 7.2. For orbit determination, a computed value of\nthe measurement is obtained from a mathematical model similar to the model used\nfor Doppler data.\n\n7.2 Radiometric Data Calibrations\n\nThe radiometric data observables require high-precision models of the hardware and\npath length from the DSN tracking stations to the spacecraft as well as the location\nof the tracking stations relative to the center of Earth. Some of the contributors\nto the path length are small enough to be ignored or require only approximate\nmodels. The solar radiation pressure on the planets and the momentum transfer\nfrom charged particles impacting the spacecraft can be ignored. Other physical\nperturbations to the path length are included as calibrations, but are not included in\nthe equations of motion of the spacecraft. Examples of calibrations that are included\nare troposphere and ionosphere and the effect of General Relativity on the curvature\nof space and time. The tectonic plate motion of the continents and solid Earth tides\nenter as calibrations. For very high-precision VLBI, the Lorentz contraction of the\nEarth resulting from its velocity relative to the Sun\u2019s barycenter contributes a few\ncentimeters.\n\n\n\n7.2 Radiometric Data Calibrations 269\n\n7.2.1 Clock Calibration\n\nAccording to the special theory of relativity, a clock running in a frame of reference\nthat is moving with respect to an observer\u2019s frame of reference will appear to run\nslower by the observer. According to the general theory of relativity, a clock running\nin a gravitational potential field will run slower than a clock removed from the field.\nTherefore, an observer that is stationary with respect to the solar system will see the\natomic clocks at the tracking stations running slower than his hypothetical clock.\nThe observer is placed stationary with respect to the barycenter of the solar system\nbecause the equations of motion are written with respect to this center and placed\nfar away to escape the effect of the gravitational acceleration of the Sun and planets.\nThe coordinate time thus defined is called post-Newtonian time (PNT).\n\nThe relationship between PNT and the proper time measured by an atomic clock\nis given by the metric. For a particle moving in an orbit around the Sun, the metric\nin isotopic Schwarzschild coordinates is given by\n\nds2 =\n\n(\n1 ? U\n\n2c2\n\n)2\n(\n\n1 + U\n2c2\n\n)2 c2dt2 ?\n(\n\n1 + U\n2c2\n\n)4 (\ndx2 + dy2 + dz2\n\n)\n\nRetaining terms to order c2, the metric may be approximated by\n\nds2 =\n(\n\n1 ? 2U\nc2\n\n)\nc2dt2 ? v2 dt2\n\nwhere\n\nv2 =\n(\n\ndx\n\ndt\n\n)2\n+\n\n(\ndy\n\ndt\n\n)2\n+\n\n(\ndz\n\ndt\n\n)2\n\nSolving for proper time (ds2 = c2 d? 2) we obtain\n\nd?\n\ndt\n=\n\n?\n1 ? 2U\n\nc2\n?\n\n(v\nc\n\n)2\nwhich may be further approximated by\n\nd?\n\ndt\n= 1 ? ?s\n\nc2r\n? 1\n\n2\n\nv2\n\nc2\n? ?e\n\nc2re\n\nwhere the Earth\u2019s gravitational potential is separated from the Sun\u2019s. The atomic\nclock time (? ) is obtained as a function of t by integrating the metric in conjunction\nwith the equations of motion.\n\n\n\n270 7 Measurements and Calibrations\n\n? =\n? t\n\nt0\n\n(1 ? L) dt\n\nwhere\n\nL = ?\nc2r\n\n+ 1\n2\n\nv2\n\nc2\n+ ?e\n\nc2 re\n\nThe function L can be separated into a constant term (L0), secular terms that grow\nwith time (Ls), and periodic terms (Lp). Thus we have\n\nL = L0 + Ls + Lp\nThe constant term (L0) is obtained by averaging L over all time and can be\nrepresented by\n\nL0 = 1\nc2\n\n(\n?\n\nr0\n+ 1\n\n2\nv20\n\n)\n+ ?e\n\nc2 re\n\nwhere r0 and v0 are constants that give the correct average value for L0. For the\nEarth\u2019s orbit about the Sun, r0 is approximately the semi-major axis of the orbit and\nv0 approximately the mean orbital velocity. Since the orbit is nearly an ellipse,\n\n?\n\na\n= 2?\n\nr\n? v2\n\nand for r = a,\n\nL0 ? 3?\n2c2 a\n\n+ ?e\nc2 re\n\nThe secular terms Ls are assumed to be zero because of conservation of energy and\nmomentum. This leaves the periodic terms and these are given by\n\nLp = 1\nc2\n\n(\n?\n\nr\n? ?\n\nr0\n+ 1\n\n2\nv2 ? 1\n\n2\nv20\n\n)\n\nand\n\n? = t +\n? t\n\nt0\n\n?L0 ? 1\nc2\n\n(\n?\n\nr\n? ?\n\nr0\n+ 1\n\n2\nv2 ? 1\n\n2\nv20\n\n)\ndt (7.5)\n\nAn approximate analytic formula for the periodic terms, derived by Brooks Thomas,\nis given by\n\n\n\n7.2 Radiometric Data Calibrations 271\n\n? ? t ? L0 (t ? t0) ? 2\nc2\n\n(r?sb \u00b7 rsb) ?\n1\n\nc2\n(r?cb \u00b7 rbe) ?\n\n1\n\nc2\n(r?ce \u00b7 reb) ?\n\n1\n\nc2\n(r?cs \u00b7 rsb)\n\n? ?j\nc2(?j + ?s)(r?\n\ns\nj \u00b7 rsj ) ?\n\n?sa\n\nc2(?sa + ?s)(r?\ns\nsa \u00b7 rssa) (7.6)\n\nIn the notation used above, the position of the body identified by the subscript is\nwith respect to the body identified by the superscript, where c = the solar system\nbarycenter, s = the Sun, b = the Earth-Moon barycenter, e = the Earth, j = Jupiter,\nand sa = Saturn.\n\n7.2.2 Troposphere Calibration\n\nA radio signal passing through the Earth\u2019s troposphere will be delayed depending\non the dielectric constant of the media and path length.\n\n?tt = Gt(t, x, y)\n\nThe troposphere delay has been conveniently separated into wet and dry components\nthat are functions of delay at zenith (z) and elevation angle (? ).\n\nGt(t, x, y) = Rd + Rw\nThe first term in the above equation represents the nonlinearity of the dry tro-\nposphere mapping function and the second term represents the variation in the\ndry troposphere z height due to local weather. The next two terms are the same\nquantities for the wet troposphere. The troposphere wet and dry mapping functions\nare tabulated as delay as a function of spacecraft elevation angle. Empirical formulas\nfor these mapping functions are given by\n\nRd = zd\nsin ? + Ad\n\nBd + tan ?\nRw = zw\n\nsin ? + Aw\nBw + tan ?\n\nwhere\n\nsin ? = cos ? cos ? cos ? + sin ? cos ? + sin ? sin ?\n? = ?et + ?s ? ?\n\n\n\n272 7 Measurements and Calibrations\n\nThe dry component of the troposphere (Rd) is a function of the delay at zenith (zd),\nthe elevation angle (? ), and constants Ad and Bd that are provided to model the\nbending at low elevation angles. The wet component (Rw) is similarly defined. The\nelevation angle (? ) is computed as a function of the latitude of the tracking station\n(?), the declination of the spacecraft (?), and the local hour angle with respect to\nthe spacecraft (?). The local hour angle is zero when the spacecraft is at zenith and\nis a function of the Greenwich hour angle (?et), the station longitude (?s), and the\nright ascension of the spacecraft (?).\n\nThe troposphere dry component is assumed to be stable and most of the\nvariability is associated with the wet component. The variation in the wet component\nmay be modeled as a periodic variation in the z height (zw). The hourly variation in\nthe wet component of the troposphere appears as a random walk that would require\na high order Fourier series to represent analytically. The variation may be modeled\nas a simple sinusoid with amplitude and frequency selected to be representative of\nthe short-term variation.\n\nzw = zw0 + zw1 sin(?w1 t)\n\n7.2.3 Ionosphere Calibration\n\nA radio signal passing through the ionosphere experiences a reduction in group\nvelocity and an equal increase in phase velocity that is a function of the frequency\nand the number of charged particles along the signal path. The Doppler measure-\nment is dependent on the phase velocity and the advance of the signal is functionally\ndefined by\n\n?ti = Gi(t, x, y)\n\nAn empirical formula for the effect of the ionosphere on the Doppler measurement\nis given by\n\nGi = ?1\nc\n\nn?\nj=0\n\nk Cj X\nj\n\nX = 2\n(\n\nt ? ta\ntb ? ta\n\n)\n? 1\n\nwhere the Cj ,s are coefficients of a polynomial in time (t) from ta to tb normalized\nover the interval of ?1 to +1 and k is a proportionality factor.\n\n\n\n7.2 Radiometric Data Calibrations 273\n\n7.2.4 Earth Platform\n\nThe accuracy of radio metric data is strongly dependent on the calibration of the\nEarth as an observational platform. It is essential to know the location of each\ntracking station on the Earth\u2019s crust to within several centimeters and the location\nof the pole and prime meridian in inertial space to the same accuracy. The locations\nof the DSN stations are computed in a geocentric cylindrical coordinate system.\nBefore VLBI data was available, solutions for the coordinates were obtained from\ntwo-way Doppler tracking of spacecraft encounters with the planets. Included were\nthe Mariner and Viking class spacecraft encounters with the inner planets and\nVoyager and Pioneer class spacecraft encounters with Jupiter and Saturn. As each\nspacecraft encounters one of the planets, the Doppler tracking provides a means\nof precisely estimating the spacecraft orbit relative to the encountered planet and\nalso the coordinates of the tracking stations. For each planetary encounter data arc,\na strong solution for the tracking stations spin radii and longitudes are obtained. A\nstation location database was developed. Since there is no information content in the\nDoppler tracking on the height of the station above the Earth\u2019s equator, the station\nlocation database was augmented with survey data. At the current time, station\nlocations are obtained from VLBI observations of quasars and the accuracy is less\nthan a meter in all coordinates.\n\n7.2.5 Polar Motion\n\nThe Earth is slowing down irregularly. In addition, the Earth\u2019s principal axis\nwobbles about its spin axis with an amplitude slowly varying between 0 and 10 m.\nTiming and polar motion corrections are determined astronomically and provided\nto the orbit determination software by the Earth Orientation Parameters file.\n\n7.2.6 Continental Drift\n\nThe continents are slowly drifting on the Earth\u2019s magma at a rate of about 3 cm per\nyear. Over a period of 120 million years South America drifted away from Africa\nand formed the South Atlantic ocean. The continents are still drifting at about the\nsame rate and carrying along the tracking stations. The rates are tabulated below for\neach tracking station complex in Earth body fixed Cartesian coordinates from the\ninitial epoch of January 1, 2003. These rates are used to adjust the tracking station\ncoordinates.\n\n\n\n274 7 Measurements and Calibrations\n\nContinental drift\n\nDSN station x-cm/year y-cm/year z-cm/year\n\nGoldstone ?1.80 0.65 ?0.38\nMadrid ?3.35 ?0.41 3.92\nAustralia ?1.00 2.42 1.56\n\n7.2.7 Solid Earth Tide\n\nAs the Earth rotates on its axis the tidal forces from the Sun and Moon raise and\nlower the oceans resulting in the tides everyone is familiar with. The Earth\u2019s crust\nand magma are also subjected to the same tidal forces which may be computed by\ntaking the gradient of Eq. (1.9). Every rock or mountain on the planet is stretched\na small amount by these forces. The result is a raising and lowering of the tracking\nstations every 12 h. The amplitude of the displacement of tracking stations from\nthere nominal locations can be as large as 30 cm. A model of solid Earth tides is\nused to adjust the station location coordinates.\n\n7.2.8 Plane Wave Propagation Through Ionized Gas\n\nThe propagation of a plane wave through an ionized gas such as the Sun\u2019s corona is\ndescribed by Maxwell\u2019s equations, specifically the laws of Faraday and Ampere in\nvector form.\n\n?\u00d7 E = ??0 ?H\n?t\n\n?\u00d7 H = ?0 ?E\n?t\n\n+ J\n\nIf we assume a plane transverse wave in the z direction with associated electrical\nfield E, magnetic field H, and current density J, Maxwell\u2019s equations reduce to the\none dimensional wave equation in E.\n\n?2E\n\n?z2\n= ?0?0 ?\n\n2E\n\n?t2\n+ ?0 ?J\n\n?t\n(7.7)\n\nEquations describing the motion of free electrons in a time varying electric field are\nalso needed. The force (F) on an electron in an electric field (E) is proportional to\nthe charge (e), and equal to the mass of the electron times its acceleration in the\ndirection of (F):\n\nF = eE = m d\n2r\n\ndt2\n\n\n\n7.2 Radiometric Data Calibrations 275\n\nThe current density is simply the electron charge (e) times the electron flux, or the\nnumber of electrons that pass through a given area per unit time. The electron flux\nis the product of the electron density (N ) and the velocity of the electrons.\n\nJ = Nedr\ndt\n\nFor a plane transverse wave these equations for the electron reduce to\n\nm\nd2r\n\ndt2\n= eE\n\nJ = Nedr\ndt\n\nwhich, when substituted into the wave equation (7.7) results in the following.\n\n?2E\n\n?z2\n= ?0?0\n\n(\n?2E\n\n?t2\n+ Ne\n\n2\n\nm?0\nE\n\n)\n(7.8)\n\nA solution to this one-dimensional wave equation for an ionized atmosphere is\n\nE = E0 sin [?t ? kz] (7.9)\n\nfrom which we obtain\n\n?2p =\nNe2\n\nm?0\n\nk2 = ?2?0?0\n{\n\n1 ? Ne\n2\n\n?2m?0\n\n}\n= ?2?0?0\n\n{\n1 ? ?\n\n2\np\n\n?2\n\n}\n(7.10)\n\nThe phase velocity of the wave is defined by the locus of points along z where Ez is\nconstant. Thus we have\n\n?t ? kz = constant\n\nwhich implies\n\nv = dz\ndt\n\n= ?\nk\n\n.\n\nSubstituting k from Eq. (7.10), the phase velocity of the wave is\n\nv = c(\n1 ? ?\n\n2\np\n\n?2\n\n) 1\n2\n\n(7.11)\n\nmaking use of the well-known relation c = 1/??0?0.\n\n\n\n276 7 Measurements and Calibrations\n\nFig. 7.4 Wave packets\n1\n\n0.5\n\n\u20130.5\n\n\u20131\n\n0 0.5 1.5 2 2.5 31\n\n0\n\nWe next consider the delay in the group velocity, which is associated with the\nrange data. The concept of group velocity arises when we have electromagnetic\nwaves that are nearly the same frequency traveling in the same direction through\nthe same medium. Because linearity holds for electromagnetic waves, any electro-\nmagnetic wave may be regarded as the sum of its individual frequency components.\nConsider the case of two electromagnetic waves that differ in frequency and wave\nnumber by an infinitesimal amount ?? and ?k, respectively. When added together\nwe obtain the wave packets illustrated in Fig. 7.4.\n\nThe resultant wave is the higher frequency carrier that moves with phase velocity\nv as described above and the wave packets formed by the beating of the two nearly\nequal in frequency waves that move at a different group velocity (u). Doppler\ntracking data is associated with the phase velocity and range data is associated with\nthe group velocity. In a vacuum, the phase and group velocities are equal to the\nspeed of light. The two electromagnetic waves alluded to above are given by\n\n?1 = sin(?t ? kz)\n?2 = sin [(? + ??)t ? (k + ?k)z]\n\nWe must perturb both the frequency and wave number in order to get the correct\nvelocity which is controlled by the medium. The resultant wave is obtained by\nadding. After some trigonometric substitutions we have\n\n? = ?1 + ?2 = 2 cos\n(\n\n??t ? ?kz\n2\n\n)\nsin\n\n[\n(? + ??\n\n2\n)t ? (k + ?k\n\n2\n)z\n\n]\n\nThe carrier is given by the sine term and the modulation of the carrier is given by\nthe cosine term. In a dispersive medium, the carrier wave moves at a velocity greater\nthan the speed of light as shown above and the wave packet described by the cosine\nterm moves at a velocity slower than the speed of light. The velocity of the wave\npacket is obtained in the same manner as described above for the carrier. The locus\nof points along z where the amplitude of the wave packet is constant is given by\n\n\n\n7.2 Radiometric Data Calibrations 277\n\n??t ? ?kz\n2\n\n= constant\n\nThe group velocity is thus\n\nu = dz\ndt\n\n= ??\n?k\n\n= d?\ndk\n\nand we get the desired group velocity.\n\nu = k\n?\n\nc2 = c2\n(\n\n1 ? ?\n2\np\n\n?2\n\n) 1\n2\n\nBecause the group and phase velocities are close to the speed of light, ?p is small\nand we may make the following approximations.\n\nv ? c (1 + ?\n2\np\n\n2?2\n)\n\nu ? c (1 ? ?\n2\np\n\n2?2\n)\n\n7.2.9 Solar Plasma Time Delay\n\nThe phase velocity in a dispersive medium is always greater than the speed of light.\nThis apparent contradiction of special relativity is possible because the radio signal\nphase velocity does not describe the actual velocity of mass or energy, but rather the\nvelocity of a pattern, or mathematical entity. Since it is critical to our analysis that\n?p/? be less than 1.0, it is helpful to estimate it at this time. For this it is necessary\nto estimate N, the electron density in the plasma, which depends on the distance of\nthe signal path from the Sun. Because a spacecraft is occasionally occulted by the\nSun, the closest approach distances of the signal path goes to zero, but at less than 18\nSolar radii, the signal is often degraded beyond usability. At 18 Solar radii, previous\nestimates have placed N at on the order of 103 electrons per cubic centimeter, which\nyields an ?p of less than 1.0 MHz. For an X-band signal, ? = 2? f where f is\napproximately 8.9 GHz. Thus (?2p/?\n\n2) is small, on the order of 10?8. Since N\ndecreases with increasing distance from the Sun, this is an upper bound.\n\nThe range delay associated with a plane wave passing through the Sun\u2019s corona\nis obtained by integrating the group velocity of propagation along the path length.\n\n? t2\nt1\n\ndt =\n? z2\n\nz1\n\ndz\n\nuz\n=\n\n? z2\nz1\n\n1\n\nc\n\n[\n1 + e\n\n2\n\n2m?0?2\nN(z)\n\n]\ndz\n\n\n\n278 7 Measurements and Calibrations\n\nThe electron density varies approximately as the inverse square of the distance from\nthe Sun.\n\nN(z) = N0r\n2\ns\n\nr2\n= N0r\n\n2\ns\n\nR2 + z2\n\nR is the perpendicular distance from the center of the Sun to the light path or the\ndistance of closest approach to the Sun. The constant N0 is the effective electron\ndensity at the surface of the Sun and rs is the radius of the Sun. Carrying out the\nintegration, we have for the delay,\n\nt2 ? t1 = z2 ? z1\nc\n\n+ e\n2\n\n2 cm?0?2\nN0r\n\n2\ns\n\nR\n\n{\ntan?1\n\n(?z1\nR\n\n)\n+ tan?1\n\n(z2\nR\n\n)}\n\nThe time advance of the Doppler signal, which is associated with the phase velocity,\nis the same equation as above except with a minus sign.\n\n7.3 Optical Data\n\nOptical imaging is a powerful data type for determining the position of a spacecraft\nrelative to a nearby central body. This method involves imaging the target body\non a star background. For this purpose, the Solid State Imager (SSI) science\ninstrument on board the spacecraft is well suited as a precision optical mea-\nsurement instrument for navigation. The use of science imaging instruments for\nnavigation was developed during the Mariner 6, 7, and 9 missions and provided\nprime navigation measurements for the Viking, Voyager and many other missions.\nThe SSI instrument was developed specifically for Galileo, replacing standard\nvidicon instruments used on previous missions. The principal attributes of the SSI\ninstrument affecting navigation are its low image distortion and high sensitivity.\nThe low distortion virtually eliminates the need for special calibration and the high\nsensitivity minimizes the exposure time required for imaging dim stars. For optical\nnavigation, the imaged satellite lit limb may be fit and the center determined to better\nthan one pixel. The star background may also be determined to less than one pixel\neven though the star images may spread over several pixels. From the focal length\nand pixel spacing, the angular accuracy may be computed and is about 10\u00b5rad. For\nnavigation analysis there are some systematic errors associated with SSI imaging\nthat must be accounted for. These include shape and albedo variations that cause\nthe center of brightness to not coincide with the center of mass. Image distortion\nalso may impair satellite center determination. For conservatism, an optical center\nfinding error of 1% of the satellite radius is assumed.\n\nOptical data provides a measure of the direction of a vector from a spacecraft to\na point on a target body. The target body may be a planet, asteroid, comet or satellite\nof one of these bodies. When combined with a data type that provides a measure of\n\n\n\n7.3 Optical Data 279\n\ndistance, such as range, a complete three-dimensional fix of the spacecraft may be\ninferred from the data providing a determination of the spacecraft orbit and physical\nparameters describing the central body gravity and inertial properties.\n\nThere are many variations of optical measurement systems that are used for\norbit determination. The most accurate optical measurement systems focus on a\nspecific point on the target body. This point may be the center-of-mass or a point\nassociated with a feature on the surface of the body. The feature may be a crater or\nthe intersection of fracture lines. The point of interest for a crater is the geometric\ncenter of the rim and is referred to as a landmark. Tracking the center of mass\nof primary body satellites, as was done for the Mariner, Viking, Voyager, Galileo\nand Cassini missions, provided sufficient accuracy for these missions but the error\nassociated with determining the center-of-mass from limb data limits the accuracy\nobtainable. Landmark tracking accuracy is limited only by the resolution of the\ncamera. For this reason landmark tracking was used for the NEAR mission where\nhigh accuracy optical and radio metric navigation was required.\n\n7.3.1 Optical Data Processing\n\nThe raw data required for computing the optical observable consists of a sequence\nof images of the target body, the shutter time of each image, the spacecraft and\ncamera attitude at the shutter time and ancillary data such as camera parameters and\na star catalog. The raw data is processed to extract certain geometric parameters\nthat are written to a picture sequence file. The parameters on the picture sequence\nfile define an interface between navigation and measurement data preparation. The\ndetailed data processing required to produce the picture sequence file is analogous\nto the data processing required for Doppler calibration or VLBI correlation.\n\nThe picture sequence file contains a header with the camera focal length, pixel\nand line spacing, the focal plane alignment matrix, camera distortion parameters\nand the boresight offset from the camera axis. The header parameters are obtained\nfrom preflight and inflight test images. A sequence of optical image data records\nare written for each image. Each optical image data record contains the image\nnumber, the image shutter time or time tag, the spacecraft attitude, filter setting,\nexposure time and a sequence of records for each landmark identified on the image.\nThe landmark records contain a unique landmark number and the measurement\nwhich is the pixel and line location of the landmark in the image. The detection,\nidentification, and numbering of landmarks may be performed visually by an optical\nnavigation analyst or by a computer algorithm without human intervention. In\naddition to the picture sequence file, a separate landmark location file is generated\ncontaining a priori landmark locations for each landmark. The line and pixel\ncoordinates of landmarks that appear near the limb in an image are not observed\nvery well. The elevation angle of the spacecraft above the horizon when viewed\nfrom the landmark may be used as a test to reject data points.\n\n\n\n280 7 Measurements and Calibrations\n\nmoving observer (O)\n\nobserver\n\nO(t + t)\n\nO(t ? t)\n\nO(t ? t)\n\nO(t) O(t)\n\nvt\n\nk\n\nvt\n\nS(t \u2013 t)\n\nS(t \u2013 t)\n\nS(t + t)\n\nS(t)S(t)\nr\n\nr r\u2013r\u2013\n\nvt\n\nvt\n\nobserver\n\nsource source\n\nstationary source (S)\n\nmoving source (S)\n\nstationary observer (O)\n\nFig. 7.5 Observer and source relative motion\n\n7.3.2 Planetary and Stellar Aberration\n\nThe observed direction of light from a distance source differs from the actual\ndirection obtained by solution of the light time equation due to the velocity parallax\nof the observer with respect to the photons or incoming wave front. This velocity\nparallax is referred to as aberration by astronomers and is aptly named. The first\ndefinition of aberration in the Webster\u2019s second edition dictionary is deviation from\nwhat is right, natural or normal. Light is red shifted or blue shifted in frequency\ndepending whether the source is moving away from or toward the observer. The\nDoppler frequency shift is determined by the relative velocity. The observed\ndirection of the light wave front is also affected by the motion of the source with\nrespect to the observer but only the source velocity contributes to aberration. This\napparent contradiction of Special Relativity may be resolved by examining the light\ntime solution in conjunction with aberration in an inertial frame. Consider the case\nof an observer moving with respect to a stationary source as shown on the left side\nof Fig. 7.5.\nAssume that closest approach occurs at time t . The observer at time t, identified by\nO(t), will receive an incoming light wave from the direction ? which is the solution\nof the light time equation. The observer was at O(t ? ?) when the photons were\nemitted by the source so aberration should not be confused with the solution of the\nlight time equation. Because of aberration, due to the relative motion of the source\nwith respect to the photons, the observer will see the source in the direction defined\nby the vector ??. The geometry is analogous to rain drops falling straight down. If the\nperson starts to move, the rain drops appear slanted with respect to the local vertical.\n\nNow suppose the observer is stationary and the relative motion of the source\nwith respect to the observer is the same. In this case, shown on the right side of\nFig. 7.5, the source appears to be moving in the opposite direction with velocity v.\n\n\n\n7.3 Optical Data 281\n\nSource\n\nObserver (x,y)\n(moving frame) Observer (x,y)\n\n(stationary frame)\n\n-\n\n- -\n\ny,y\n\n-x,x\n\nv?\n\nk\n\n? ? q\n\nR\n\u2013\n\nR\n\nFig. 7.6 Observer velocity relative to source\n\nThe observer at time t sees a plane wave emanating from the location of the source\nat t ? ? . There is no aberration. This is consistent with Special Relativity since the\nobserver sees the source in the same direction for both cases. Since the Doppler\nshift is dependent on the relative velocity, the observer sees the same Doppler shift\nfor both sides of Fig. 7.5. Furthermore, the speed of light will be the same for both\nobservations due to time dilation and Lorentz contraction.\n\nThe geometry associated with an observer moving with respect to a source is\nillustrated in Fig. 7.6. In the stationary inertial frame, the source emits a photon at\ntime t = 0 from the origin and this photon arrives at the observer at time t = ? with\ncoordinates (x, y). The light time solution vector is R and the travel time is given by\n\n? = R\nc\n\nIf a coordinate system is defined that is moving with the observer (x?, y?) in the\n+x direction with velocity v and the origins coincide at time t = 0, the observed\ndirection of the photon is given by R?. The angle between R and R? is the aberration\nangle ? and\n\nsin(?) = |R \u00d7 R?|\nR R?\n\n(7.12)\n\nThe angle ? is between the velocity vector and the vector from the observer to the\nsource (?R).\n\n\n\n282 7 Measurements and Calibrations\n\nIf classical Galilean motion is assumed, where the speed of light is not constant,\nthe observed vector is given by\n\nP? =\n\n?\n???\n\n1 0 0 0\n?v 1 0 0\n0 0 1 0\n0 0 0 1\n\n?\n??? P =\n\n?\n??????\n\nR\n\nc\n\n?Rv\nc\n\n? R cos ?\nR sin ?\n\n0\n\n?\n?????? (7.13)\n\nwhere time is artificially carried along as the first component of P and R is contained\nin the last three components of P.\n\nP =\n\n?\n???????????\n\nR\n\nc\n\n?R cos ?\n\nR sin ?\n\n0\n\n?\n???????????\n\nThe angle ? is obtained by substituting the position vectors obtained from the second\nthrough third components of P and P? into Eq. (7.1).\n\nsin ? = v sin ?\nc\n\n??????\n?????\n\n1?\n1 + v\n\n2\n\nc2\n+ 2v cos ?\n\nc\n\n??????\n?????\n\nMaking use of the approximation\n\n1?\n1 + v\n\n2\n\nc2\n+ 2v cos ?\n\nc\n\n? 1 ? v cos ?\nc\n\n? v\n2\n\n2c2\n\nand\n\nsin ? cos ? = 1\n2\n\nsin(2?)\n\nthe aberration angle may be approximated to second order by\n\nsin ? ? v\nc\n\nsin ? ? 1\n2\n\nv2\n\nc2\nsin(2?) + . . .\n\n\n\n7.3 Optical Data 283\n\nThe classical result assumes that the speed of light in the moving frame\nis different from the speed of light in the inertial frame at rest. The Lorentz\ntransformation from Special Relativity is used to get the correct result.\n\nP? =\n\n?\n??????????????????\n\n1?\n1 ? v\n\n2\n\nc2\n\n?v\n\nc2\n\n?\n1 ? v\n\n2\n\nc2\n\n0 0\n\n?v?\n1 ? v\n\n2\n\nc2\n\n1?\n1 ? v\n\n2\n\nc2\n\n0 0\n\n0 0 1 0\n0 0 0 1\n\n?\n??????????????????\n\nP\n\nThe Lorentz transformation is given in conventional engineering coordinates where\ntime has the units of time and the existence of c is explicitly acknowledged. Since\nc is a constant, a system of space-time coordinates can be defined with c = 1 and\ntime given the dimension of length. For these coordinates, favored by relativists, the\nLorentz transformation matrix is symmetrical. The advantage of the conventional\ncoordinates used here is that it is immediately obvious that the approximation to\nfirst order reduces to the Galilean transformation given by Eq. (7.2) in the limit as\nc approaches infinity. Since the \u201cat rest\u201d coordinate system is arbitrary, the inverse\nof the Lorentz transformation matrix can be obtained by changing the sign of v.\nThe Galilean transformation also has this property. Another property of the Lorentz\ntransformation is that the Minkowski metric must be preserved.\n\nds2 = c2dt2 ? dx2 ? dy2 ? dz2 (7.14)\n\nSince ds2 is null for a photon (ds2 = 0) then ds?2 must also be null. The observation\nvector in the moving frame is given by\n\nP? =\n\n?\n??????????????????\n\nR\n\nc\n\n?\n1 ? v2\n\nc2\n\n+ Rv cos ?\nc2\n?\n\n1 ? v2\nc2\n\n? Rv\n\nc\n\n?\n1 ? v\n\n2\n\nc2\n\n? R cos ??\n1 ? v\n\n2\n\nc2\n\nR sin ?\n\n0\n\n?\n??????????????????\n\n\n\n284 7 Measurements and Calibrations\n\nWhen P? is substituted into the Minkowski metric (Eq. 7.9) it is demonstrated that\nds?2 is null. Proceeding as for the classical solution, the angle ? corrected for Special\nRelativity is obtained.\n\n? = arcsin\n\n?\n???\n\nv sin ?\n\nc\n+\n\n(\n1 ?\n\n?\n1 ? v2\n\nc2\n\n)\nsin ? cos ?\n\n1 + v\nc\n\ncos ?\n\n?\n???\n\nMaking use of the approximations\n\n?\n1 ? v\n\n2\n\nc2\n? 1 ? 1\n\n2\n\nv2\n\nc2\n\n1\n\n1 + v\nc\n\ncos ?\n? 1 ? v\n\nc\ncos ?\n\nthe first two terms of the series expansion for sin ? are\n\nsin ? ? v\nc\n\nsin ? ? 1\n4\n\nv2\n\nc2\nsin(2?) + . . .\n\nThe aberration corrected vector is in the same plane as the source velocity vector\nand light time solution vector. The calculation of this vector from the aberration\nangle ? and the angle between the velocity vector and the vector from the observer\nto the source (? ) is illustrated in Fig. 7.7. The vector ?in is the light time solution\nfrom the observer to the source. The vector ?? is the direction that the source is\nobserved and the direction that one would point a telescope. The angle ? between\nthese vectors is the aberration angle as defined above. From the geometry, the vector\nformula for planetary aberration is simply\n\n?? =\n{\n?in +\n\n[\n?in sin ?\n\nv sin ?\n\n]\nv ?\n\n[\nsin ?\n\ntan ?\n\n]\n?in\n\n}\n\nIf the source is a star or remote object, the magnitude of the light time solution\nvector approaches infinity. The formula for stellar aberration (??s) may be obtained\nby taking the limit and\n\n??s =\n{\n??in +\n\n[\nsin ?\n\nv sin ?\n\n]\nv ?\n\n[\nsin ?\n\ntan ?\n\n]\n??in\n\n}\n\n\n\n7.4 Altimetry 285\n\nFig. 7.7 Aberration\ncorrection\n\nrin sin k\n\nrin sin k\n\nsin q V\n\nV\n\nr\u2013\n\ntan q\n\nq\n\nrin sin k\n\nrin\n\nk\n\n7.4 Altimetry\n\nAltimetry provides a measure of the magnitude of a vector from a spacecraft to\na target body that may be a planet, asteroid, comet, or a satellite of one of these\nbodies. The altimetry measurement is the distance or slant range from the spacecraft\nto a point on the surface of the target body which is inferred from the time that it\ntakes an electromagnetic wave to traverse the distance. The electromagnetic wave\nis transmitted and the reflected signal received by the altimeter instrument and the\nslant range is determined by multiplying the signal delay time by the speed of light.\nThe altimeter may transmit and receive a radar signal or laser beam. Radar based\naltimeters are limited by range and have only been used for landing spacecraft on a\ntarget body such as the Surveyor spacecraft on the Moon or the Viking spacecraft\non Mars. Laser altimeters can operate out to several hundred kilometers and are thus\nuseful for measurements in orbit about a target body. When combined with optical\nimaging of landmarks, altimetry provides a complete three-dimensional fix of the\nspacecraft orbit. However, since the accuracy is limited by the error in determining\nthe surface of the target body, laser altimetry is only marginally useful for ground-\nbased spacecraft orbit determination. In the future, laser altimetry may be used for\nmedium accuracy autonomous navigation since the measurement may be readily\nobtained on board the spacecraft. An important application of laser altimetry is\nin determining the shape of a target body given the orbit of the spacecraft. This\napplication was used on the NEAR mission to determine a high precision shape\nmodel of Eros that was used to support landing operations.\n\n\n\n286 7 Measurements and Calibrations\n\ntangent plane\n\nspacecraft\n\nra\n\n?ra\n\n?r\nr\n\n?S\n\nrb\n\ntarget body\n\nFig. 7.8 Altimetry observable iteration geometry\n\n7.4.1 Altimetry Data Measurement Model\n\nThe observed vector from the spacecraft to the target body surface is referenced to\na coordinate system that is fixed to the instrument platform that is movable if the\ninstruments are mounted on a scan platform or is fixed to the spacecraft body. The z\naxis is in the direction of the nominal boresight of the instruments, y is to the right\nand x is down. The definition of down is arbitrary, but is generally taken to be in\nthe direction of decreasing declination on the star background. The transformation\nmatrix (T C) describes the pointing direction which is generally taken to be the\ncamera boresight.\n\nThe altimeter may be mounted on the spacecraft at a location that may be as far\naway as a meter from the spacecraft center-of-gravity. The altimeter position must\nbe corrected for this offset and\n\n?rcg = [T C]T rcg\nwhere rcg is the location of the altimeter focal plane relative to the spacecraft center-\nof-gravity in instrument platform coordinates.\n\nThe altimeter boresight is offset slightly from the instrument axes as defined by\ntwo angles ?a and ?a . The vector that defines the altimeter boresight is given by\n\nB?a = [cos ?a sin ?a, sin ?a, cos ?a cos ?a]T\n\nThe vector from the spacecraft to the surface is computed as illustrated in Fig. 7.8.\n\n\n\n7.4 Altimetry 287\n\nThe vector from the center-of-mass of the target body to the altimeter in target body\nfixed coordinates is given by\n\nrb = [T (?, ?,W)](r + ?rcg)\n\nwhere [T (?, ?,W)] is the transformation matrix from J2000 coordinates to the pole\nand prime meridian of the target body as defined by Fig. 1.3. The unit vector ?? is\nthe altimeter boresight direction in target body fixed coordinates given by\n\n?? = [T (?, ?,W)][T C]T B?b\nAn initial guess is needed for the magnitude of ? and this is taken to be\n\n?i = r ? rao\nwhere rao is the average radii of the target body. The first step of the iteration for the\nobservation vector ? is to compute the vector from the center-of-mass of the target\nbody to the surface.\n\nrai = rb + ?i ??\n\nA test is performed to determine if rai is on the surface of the target body. The\nsurface of the target body is obtained from a harmonic expansion of Legendre\npolynomials and associated functions as a function of latitude and longitude.\n\nra =\n??\n\nn=0\n\nn?\nm=0\n\nP mn (sin ?a){Anm cos m?a + Bnm sin m?a}\n\nwhere ?a and ?a are the longitude and latitude at the solution point and Anm and\nBnm are the harmonic coefficients. The longitude and latitude of the surface point\nare given by\n\n?a = tan?1\n(\n\nraiy\n\nraix\n\n)\n\n?a = sin?1\n(\n\nraiz\n\nrai\n\n)\n\nrespectively and the harmonic coefficients (Anm and Bnm) are input constant\nparameters. The error in computing the surface radius vector is\n\n?ra = rai ? ra\nIf |?ra| is less than an input tolerance, nominally 10?7 km, convergence is obtained\nand the observable is computed from ?i . If convergence is not obtained, then ? is\n\n\n\n288 7 Measurements and Calibrations\n\nlengthened or shortened by ?? as shown in Fig. 7.8. In order to compute ??, a\nmodel of the target body surface is needed. This model consists of a vector to a\npoint on the surface and the local tangent plane and ra is the vector to the point on\nthe surface given by\n\nra = [ra cos ?a cos ?a, ra cos ?a sin ?a, ra sin ?a]T\n\nThe surface normal vector may be computed by taking the gradient of the surface\ndefined by\n\nS = ra ?\n??\n\nn=0\n\nn?\nm=0\n\nP mn (sin ?a){Anm cos m?a + Bnm sin m?a}\n\nwhere the surface of interest corresponds to S = 0. The normal vector is then given by\n\nS =\n[\n\n?S\n\n?ra\n\n?S\n\n??a\n\n?S\n\n??a\n\n]\n?\n?????????\n\ncos ?a cos ?a cos ?a sin ?a sin ?a\n\n? sin ?a cos ?a\nra\n\n? sin ?a sin ?a\nra\n\ncos ?a\nra\n\n? sin ?a\nra cos ?a\n\ncos ?a\nra cos ?a\n\n0\n\n?\n?????????\n\nand\n\n?S\n\n?ra\n= 1\n\n?S\n\n??a\n= ?\n\n??\nn=0\n\nn?\nm=0\n\n?P mn (sin ?a)\n\n??a\n{Anm cos m?a + Bnm sin m?a}\n\n?S\n\n??a\n= ?\n\n??\nn=0\n\nn?\nm=0\n\nP mn (sin ?a){?Anm m sin m?a + Bnm m cos m?a}\n\nThe change in the slant range (??) may be computed by application of the law of\nsines to the small triangle shown in Fig. 7.8 whose sides are the extension of the ra\nvector (?ra), the extension of the ? vector (??), and the intersection of the local\ntangent plane with the plane containing ra , ? and rb. The intersection of the local\ntangent plane (ti) with the plane of Fig. 7.8 is given by\n\nti = (rb \u00d7 ra) \u00d7 S\n\nThe angle opposite the ?? side of the triangle is\n\n?? = arccos\n(\n\nti \u00b7 ra\nti ra\n\n)\n\n\n\n7.4 Altimetry 289\n\nand the angle opposite the ?ra side of the triangle is\n\n?ra = arccos\n(\n\nti \u00b7 ?\nti ?\n\n)\n\nThe lengthening or shortening of the ? vector is then obtained from the law of sines\nand\n\n?? = sin ?? ?ra\nsin ?ra\n\n?i+1 = ?i + ??\n\nUsing ?i , a new ?i+1 is computed and repeated until convergence is obtained. If\nconvergence is not obtained after several iterations, the data point is rejected. Since\ntwo solutions are possible, a check is made to determine if the surface intersection\npoint is in view from the spacecraft. The elevation angle (E?) of the spacecraft above\nthe horizon when viewed from the surface may be used as a test.\n\nE? = sin?1\n(\n\n? ? \u00b7S\n? ?S\n\n)\n\nIf E? < 0, the solution is rejected and the range is shortened by\n\n?i+1 = ?i ? 2ra sin E?\nAfter several more iterations, the data point is rejected if a valid solution has not\nbeen found. Once a valid solution has been found, the observable is computed.\n\n7.4.2 Altimetry Variational Partial Derivatives\n\nThe partial derivatives of the altimetry observable with respect to state and constant\nparameters are given by\n\n?Za\n\n?(r0, r?0, q)\n= ?Za\n\n??\n\n[\n??\n\n?rb\n\n?rb\n?r\n\n?r\n?(r0, r?0, q)\n\n+ ??\n?q\n\n]\n\nwhere\n\n?Za\n\n??\n= 1\n\n?rb\n?r\n\n= [T (?, ?,W)]\n\n\n\n290 7 Measurements and Calibrations\n\ntangent body\n\nspacecraft\n\nra\n\nr\n\ndr\n\nd rb\nd rb\n\ndr\n\nd?S r\n\nr\n\n?S\n\nrb\n\nFig. 7.9 Altimetry observable variation geometry\n\nand the partial derivative of ? with respect to the target body fixed spacecraft state\n(rb) may be determined by geometrical construction. The observational geometry is\nshown in Fig. 7.9 where the parallelogram formed by the vector ? and the spacecraft\nposition variation ?rb and the vector constructions are all in the plane of Fig. 7.9.\nThe normal vector S and target body center are not necessarily in the plane of the\nfigure. The spacecraft position variation vector is projected on to the normal vector\nand\n\n??S = S \u00b7 ?rb?S\nThe extension of the observation vector (??), projected on to the normal vector, has\nthe same magnitude as ??S.\n\n??S = ?? ?? \u00b7S\n? ?S\n\nSolving for ?? gives\n\n?? = ?? S \u00b7 ?rb\n? \u00b7S\n\n\n\nBibliography 291\n\nThe required partial derivative may be obtained by taking the limit as ?rb approaches\nzero. In this rudimentary application of differential geometry, the parallelograms\nand triangles with sides defined by variational symbols shrink to a point at the end\nof the ra vector and\n\n??\n\n?rb\n= ?? S\n\n? \u00b7S\n\n7.5 Summary\n\nThe measurements that are used for orbit determination may be separated into\nseveral broad categories. These include radiometric tracking data from the DSN\nand optical imaging and altimetry from the spacecraft. Radiometric measurements\ninclude Doppler, range, and VLBI. Orbit determination involves a three-dimensional\ndetermination of the spacecraft position and velocity. Radiometric data is one\ndimensional and the process of extracting a measurement from instrumentation is\ncleanly separated from navigation. Navigation instrumentation can be designed in\na laboratory with little knowledge of its ultimate use. Therefore, navigators are\nprimarily concerned with the physical quantity being measured and a model of\nthe measurement that can be programmed into orbit determination software and\nneed not be concerned with the details of instrument design. Electrical engineers\ndesign the instrumentation and navigators navigate. The external environment has\nan effect on measurements. If the motion of the spacecraft is not perturbed, these\nenvironmental disturbances are modeled and a correction to the measurement\nis computed by the orbit determination software. Examples are the troposphere,\nionosphere, solar plasma and polar motion for radiometric data, aberration for\noptical data and a shape model of the target body for altimetry.\n\nBibliography\n\nChao, C. C., \u201cNew Tropospheric Range Corrections with Seasonal Adjustment,\u201d Deep Space\nNetwork Progress Report 92-1526, vol. 6, Jet Propulsion Laboratory, Pasadena, California,\npp. 67\u201373, December 15, 1971.\n\nChao, C. C., \u201cA New Method to Predict Wet Zenith Range Correction From. Surface Measure-\nments,\u201d Deep Space Network Progress Report 92u?1526, vol. 14, Jet Propulsion Laboratory,\nPasadena, California, pp. 33\u201341, April 15, 1973.\n\nCurkendall, D, W., \u201cRadio Metric Technology for Deep Space Naviga- tion: A Development\nOverview,\u201d Paper 78-1395, presented at the AAS/AIAA Astrodynamics Conference, Palo Alto,\nCalifornia, August, 1978.\n\nDavis, R. R., \u201cInterplanetary Optical Navigation using Charge- Coupled Devices,\u201d Paper 80-\n1652, presented at the AIAA/ASS Astro- dynamics Conference, Danvers, Massachusetts,\nAugust,1980.\n\n\n\n292 7 Measurements and Calibrations\n\nEllis, J. 1980. Large Scale State Estimation Algorithms for DSN Tracking Station Location\nDetermination. J. Astronaut. Sci. 28, 15\u201330.\n\nHamilton, T. W. and Melbourne, W. G., \u201cInformation Content of a Single Pass of Doppler Data\nfrom a Distant Spacecraft,\u201d The Deep Space Network Space Programs Summary 37\u201339, Vol.\nIII, Jet Propulsion Laboratory, Pasadena, California, 31 May 1966, pp. 18\u201323.\n\nHawkins, S. E., et al., 1997. Multi-Spectral Imager on the Near Earth Asteroid Rendezvous\nMission. Space Science Review 82, 31\u2013100.\n\nLandau, L. D. and Lifshitz, E. M., The Classical Theory of Fields. Butterworth-Heinemann; 4th\nedition (October 1997).\n\nMiller, J. K. and K. H. Rourke, \u201cThe Application of Differential VLBI to Planetary Approach Orbit\nDetermination\u201d, The Deep Space Network Progress Report 42-40, May-June 1977, pp 84\u201390.\n\nMiller, J. K., \u201cThe Effect of Clock, Media and Station Location Errors on Doppler Measurement\nAccuracy\u201d, TDA Progress Report 42-113, Jet Propulsion Laboratory, May 15, 1993.\n\nMoyer, T. D., Formulation for Observed and Computed Values of Deep Space Network Data Types\nfor Navigation, JPL Publication 00-7, October 2000.\n\nRoyden, H. N., D. W. Green, and G. R. Walson, \u201cUse of Faraday-Rotation Data from Beacon\nSatellites to Determine Ionosophere Corrections for Interplanetary Spacecraft Navigation,\u201d\nProc. Satellite Beacon Symposium, Warszawa, Poland, May 19\u201323, 1980, pp. 345\u2013355, 1981.\n\nStratton, J. A., \u201cElectromagnetic Theory\u201d, McGraw-Hill, New York, 1941.\n\n\n\nChapter 8\nNavigation Operations\n\nNavigation operations is the process of identifying a destination, finding the path\nto the destination, and performing the necessary tasks to transport a vehicle to the\ndestination along with the passengers which may be people or science instruments.\nNavigation operations are synonymous with exploration and it is performed by\nengineers and explorers or ordinary people when they get in their car, turn on the\nGPS, and drive to the mall. The GPS navigation system requires a GPS receiver and\na map. GPS alone does not navigate. Spacecraft navigation to the bodies in the solar\nsystem is a bit more complicated than driving to the mall. The closest analogy to\nplanetary spacecraft navigation is the navigation performed on eighteenth-century\nand earlier sailing ships. The navigator knows his home port and has a vague idea of\nthe location of his destination. Once the ship sails beyond the horizon, its location is\nnot known very well. The major problem is determining time. In order to determine\nlongitude, the navigator must know the time in his home port where 12:00 p.m.\nis high noon. If high noon occurs at 1:00 p.m. he knows he is about 700 miles\nWest of his home port depending on his latitude that can be determined from the\nelevation of stars above the horizon. Magellan carried 18 h glasses for his voyage\naround the world. In determining a route, he must have some knowledge of wind\nand ocean currents. For planetary navigation, the navigator knows his home port,\nnamely the Earth. He has a vague idea of his destination. If his destination is a\nplanet, he can go out at night and look up and see his destination. The problem\nof determining where the spacecraft is located and plotting a route is shared with\nsailors of antiquity. Determination of time with atomic clocks enables the navigator\nto determine range to the spacecraft and is the key to planetary orbit determination.\nThe major advantage of planetary spacecraft navigators over sailors of antiquity is\nthat they perform navigation in a comfortable flight operations facility and do not\ndie if they make a mistake.\n\nPlanetary navigation operations consist mainly of collecting data from a number\nof sources, inputing this data to navigation software, determining the orbit, com-\nputing trajectory correction maneuvers, and transmitting maneuver commands to\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_8\n\n293\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_8&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_8\n\n\n294 8 Navigation Operations\n\nthe spacecraft. This process does not require a deep understanding of mathematics\nor navigation and can be performed by anyone with a rudimentary knowledge of\nnavigation and computers. However, the navigation operations team is comprised\nof individuals who are highly educated and dedicated. Their job is to analyze the\nnavigation system and prepare solutions for problems that may arise as well as\nperform the routine navigation operations. The job can be frustrating because the\ninteresting problems arise quickly and often have no solution. Most of the time is\nspent doing routine operations.\n\n8.1 Navigation System\n\nThe navigation system is a collection of hardware, instrumentation, and computer\nsoftware that enable navigation. For planetary spacecraft navigation, the navigation\nsystem is comprised of a spacecraft, the Deep Space Network (DSN), and proce-\ndures that are encoded in software that resides on the spacecraft or on the ground\nat a space flight operations facility. The spacecraft hardware includes transponders,\nimagers, an attitude control system, and a propulsion system. The DSN is comprised\nof tracking stations located at Goldstone California, Madrid Spain, and Canberra\nAustralia and the Space Flight Operations Facility (SFOF) located at the Jet\nPropulsion Laboratory (JPL) and at other locations depending on the mission. The\nSFOF houses the software required to extract and format the data and the navigation\nteam required to operate the navigation software. For some missions, the navigation\nteam and software may be located elsewhere.\n\n8.1.1 Deep Space Network\n\nThe tracking stations that comprise the DSN are in a complex containing a 72-m\nantenna, several 34-m antennae, and special- purpose hardware end computers for\nextracting Doppler, range, and VLBI observables from received spacecraft signals\nand VLBI from extragalactic radio sources. This data is relayed via high-speed data\nlines to the SFOF. Propulsive maneuver commands are sent to a DSS via the same\nhigh-speed data lines and then transmitted to the spacecraft.\n\n8.1.2 Spacecraft\n\nThe spacecraft is designed to enable acquisition of data by the DSN and provide\npropulsive maneuvers to enable the spacecraft to arrive at the target body. The\nhardware systems onboard the spacecraft include transmitters and receivers with\na Doppler transponder, imaging and altimetry instruments, a telecommunications\n\n\n\n8.2 Orbit Determination 295\n\nsystem for downloading images and receiving maneuver commands, an attitude\ncontrol system for pointing cameras and propulsive motors in the desired direction,\nand a propulsion system for changing the flight path of the spacecraft.\n\n8.2 Orbit Determination\n\nThe launch vehicle injects the spacecraft on a trajectory that goes from the launch\nsite to the target body. The initial problem for planetary spacecraft navigation is\nto find the spacecraft after launch. The DSN searches the sky in the direction\nof the predicted launch trajectory. This is a three-dimensional search in tracking\nstation pointing angles and carrier frequency. Near the Earth the search is difficult;\nhowever, as the spacecraft departs the Earth\u2019s gravity the search is easier. The\nspacecraft location in the sky and carrier frequency becomes well defined, provided\nthe spacecraft is headed toward the target planet. Once the spacecraft is located,\norbit determination software determines the trajectory. A block diagram of the orbit\ndetermination software is shown in Fig. 8.1. In the example used here, the Near\nEarth Asteroid Rendezvous software configuration is described. The rectangular\n\nGravity\n\nShape\n\nLandmark\n\nEphemerides\nSpacecraft\n\nPlanet\nAsteriod\n\nStates\nSpacecraft\n\nPlanets\nAsteriod\n\nManeuvers\n\nData\nRadiometric\n\nOptical\nLidar\n\nModels\nGravity\nShape\n\nLandmarks\n\nAttitude\nAsteroid\n\nUpdate\n\nSolution\n(Delta\u2019s)\n\nSolve\n\nSRIF\n\nODP\n\nMedia\nTroposphere\nIonosphere\nEarth Tide\n\nEarth Orientation\nStation Locations\n\nFig. 8.1 Navigation software\n\n\n\n296 8 Navigation Operations\n\nblocks are files that need to be created. The circles are the programs that create the\nfiles. Prior to launch, state vectors for the spacecraft and planets are obtained and\nincluded in a file called STATES. The file MODELS contains the Earth\u2019s gravity\nmodel, propulsive maneuvers, station locations, Earth orientation, solid Earth tides,\ntectonic plate motion, and landmark locations. The troposphere, ionosphere, and\nsolar plasma are contained in the MEDIA file.\n\nThe first file to arrive at the SFOF after launch is the tracking data file (DATA)\ncontaining Doppler and range data. The orbit determination program outputs a SRIF\nmatrix and files of spacecraft ephemeris, central body ephemeris, and central body\nattitude consisting of segments of Chebyshev polynomials. The program SOLVE\ninverts the SRIF along with the measurement residuals to obtain corrections for\nall the estimated parameters. The corrected estimated parameters are fed back to\nODP, and another solution is attempted. When convergence is achieved, the program\nUPDATE is executed to provide files that may be exported to the science team and\nothers outside of navigation.\n\n8.2.1 Orbit Determination Strategy\n\nOrbit determination strategy involves selecting the estimated parameters, acquiring\nthe necessary data, assigning error uncertainties to the measurements and a priori\nestimated parameters and analysis of the residual errors. The estimated parameters\ninclude spacecraft state, central body state, central body Euler angels and spin\nrates, gravity coefficients, propulsive maneuvers, landmark locations, solar pressure\nmodel parameters, and other parameters that are needed for trajectory propagation.\n\nThe amount of data to be processed by the orbit determination filter, or the length\nof the data arc, must also be specified. A given orbit determination run presents\nthe analyst with many options. One strategy is to start with a short data arc and\nobtain convergence. Then the data arc is lengthened, admitting more data, until a\nsatisfactory solution is obtained. If the data arc is too long, the filter may choke on\ntoo much data. Unmodeled errors will eventually destroy the validity of the solution\nand computed statistics. Introduction of stochastic noise in the form of a random\nwalk may help. The stochastic parameters cause the filter to deweight earlier data,\nand thus the filter tends to forget and rely on more recent data. A problem with\nstochastic parameters is they tend to falsely smooth out the residual errors and\nintroduce instability.\n\n8.2.2 Multiple Data Types\n\nThe problem of orbit determination is exacerbated when multiple data types are\nprocessed. For a single data type, which would generally be Doppler only data, the\nsolution is not dependent on the data weight provided all the measurements are given\n\n\n\n8.2 Orbit Determination 297\n\nequal weight and there are no stochastic parameters. When multiple data types are\nprocessed, the solution becomes dependent on relative weight. For example, when\nrange and optical data are processed with Doppler data the solution will depend\non how the optical data is weighted compared to the Doppler data. For planetary\napproach, the optical and Doppler data determine components of the spacecraft state\nthat are orthogonal and a natural separation is obtained. The optical data determines\nthe coordinates in the B plane, and Doppler data determines flight time and the\napproach velocity vector. Range data is redundant to Doppler data but provides\nthe constant of integration. In orbit, the separation is less apparent. For the NEAR\nmission, optical data provided the orientation of the orbit in space and Doppler data\nprovided a measure of the distance traveled by the spacecraft. These measurements\nwere complimentary and provided about one meter in orbit measurement accuracy.\nThis was important for orbit prediction. It was necessary to predict the orbit ten days\ninto the future to an accuracy of about 100 m which required orbit determination\naccuracy of about 1 m. This accuracy could be achieved relative to the center of\nmass of Eros even though the location of landmarks on the surface was known only\nto about 50 m. In computing the optical observable, the offset of the camera from\nthe center of mass of the spacecraft was included.\n\n8.2.3 Simulated Data\n\nAnother technique for detecting problems with orbit convergence is analysis of the\nsignatures in the data residuals. For example, a timing error during a planetary\nencounter has a distinct signature that looks like the tangent function near 90?.\nAnalysis of residual errors requires considerable experience. The first time a new\nerror appears in the data, the signature is generally not recognized. Experience in\nrecognizing these data signatures is best obtained by processing simulated data prior\nto conducting navigation operations.\n\nSimulated data is an important tool for analysis of orbit determination per-\nformance. It proved to be valuable during the NEAR mission which involved\nintroduction of new data types. A simulated tracking data file was prepared that\nconsisted essentially of time tags of the Doppler and range data points. The\nsimulated tracking data file also included header data such as station number\nnecessary for computing the observable. In assigning time tags, care had to be taken\nto assure that the spacecraft was above the horizon. Simulated images of the asteroid\nwere prepared by ray tracing asteroid brightness on the surface of the asteroid to\neach pixel in the camera and a picture sequence file prepared with image time and\ncamera pointing angles. A simulated LIDAR data file was generated that contained\nthe time of each measurement and instrument pointing angles. Media and clock\ncalibration files were prepared and were assumed to be the same for each station.\n\nThe simulated data files were input to the orbit determination software. As each\ndata point was processed, the computed measurement was modified by adding\nnoise obtained from a random number generator to generate a measurement. New\n\n\n\n298 8 Navigation Operations\n\nsimulated data files were output by the orbit determination software with the\nsimulated measurement. The spacecraft state, Eros ephemeris, Eros attitude, and\nall the input model parameters were modified and given to a second party along\nwith the data files and simulated images. The modification of the input a priori\ndata used the same process as adding noise to the measurement; however, for some\ninputs the error was considerably larger than the a priori error would indicate. The\nsecond party did not know the real assumed value of the estimated parameters or\nthe assumed value of the measurements. The second party extracted line and pixel\nlocations from the simulated images, created a landmark tracking file, and ran the\norbit determination software to determine the simulated orbit. If the second party\nfailed to determine the orbit, the process would be repeated until he was successful.\nThere was more than one second party and they all got it right the first time, but\nwe repeated the exercise to be sure. On the Viking mission, we repeated simulated\nnavigation operations many times until we got it right. During mission operations,\nthe NEAR navigation team determined many orbits and computed many maneuvers\nand made no significant mistakes, which proves that practice makes perfect.\n\n8.3 Maneuver Targeting\n\nOnce the orbit has been determined, it may be necessary to perform a propulsive\nmaneuver to steer the spacecraft back on course. Since both the position and velocity\nare in error, requiring the correction of six components of position and velocity, two\npropulsive maneuvers may be required. A propulsive maneuver can correct only\nthree components.\n\n8.3.1 Interplanetary Maneuvers\n\nWhen the spacecraft is far from the target body, the position and velocity errors are\ngenerally relatively small and can easily be corrected to put the spacecraft back on\nthe nominal trajectory. However, this strategy is not optimum with regard to fuel\nusage. The fuel optimum strategy is to propagate the trajectory and determine the\nposition error with respect to the target body. This position error is determined in B\nplane coordinates of B\u00b7R, B\u00b7T , and time of arrival. A single maneuver is targeted to\ncorrect the position error at the target body. The arrival velocity is permitted to float.\nCorrecting position at the target body will also tend to correct velocity. If this is not\ntrue, then two maneuvers will need to be performed. The magnitude of the velocity\ncorrection at the time of the planned maneuver may be very small. The magnitude\nof the velocity correction maneuver increases inversely proportional to time of flight\nto the target body. If encounter time is 2 years in the future, then delaying the\npropulsive maneuver by 1 year will double the required velocity change. This may\nbe a small penalty to pay for minimizing the number of maneuvers. The propulsive\ntrajectory correction maneuver may be delayed and combined with a deterministic\nmaneuver.\n\n\n\n8.3 Maneuver Targeting 299\n\n8.3.2 In Orbit Maneuvers\n\nIf the mission involves inserting the spacecraft into orbit about the target body,\nthe maneuver strategy for interplanetary maneuvers must be modified a little. One\nexception is orbits about Jupiter where the approach to the Galilean satellites\nbehaves more like an interplanetary trajectory. The target parameter set becomes\nthree orbit elements. The use of orbit elements in this context should not be\nconfused with the use of orbit elements for patched conic trajectory propagation.\nThe osculating orbit elements computed at a specific time in an orbit provide a\nmeasure of energy and angular momentum that is as accurate as the input state\nvector (see Sect. 3.1.1). Certain distances, angular orientation, and period are close\nto their actual values, if computed at the right place in the orbit. The input state\nvector is obtained from a high-precision integrated trajectory. In orbit, the principle\nthat a single maneuver can correct the orbit is tested. Two maneuvers are often\nrequired, but, since there are generally many more deterministic maneuvers, the\nsecond maneuver can be combined.\n\n8.3.3 K Matrix\n\nThe K matrix relates propulsive maneuver velocity change to the change in position\nat the target body. When the spacecraft is far from the target body, correcting\nposition errors at the target body also tends to correct velocity errors. If the\nspacecraft trajectory goes from the Earth to the target planet, conservation of energy\nwill result in the spacecraft arriving with the designed velocity. Since velocity errors\nare small, analysis of interplanetary trajectory errors can be performed by mapping\nthe K matrix to the target and the inverse of the K matrix back to the position of\nthe spacecraft where a propulsive maneuver is executed. The K matrix is a covariant\ntensor and its inverse is contravariant.\n\nFor the K matrix, the position at the target is defined by B plane parameters\n(B \u00b7R,B \u00b7T , tl). These parameters may be directly related to the hyperbolic orbit\nelements defined in Sect. 3.1.2.\n\nB \u00b7R = b cos(?)\nB \u00b7T = b sin(?)\n\ntl = tp ?\n?\n\na3\n\nGM\nln(e)\n\nThe parameter tl is called linearized flight time. As a spacecraft approaches a\nplanet, it is accelerated by the gravity of the planet and the time of periapsis is a\nfunction of B, the magnitude of the B vector. In order to remove this dependency,\ntl is defined as the time of arrival if the planet had no mass. The modified B plane\nparameters are thus\n\n\n\n300 8 Navigation Operations\n\nOh = [B \u00b7R,B \u00b7T , tl, V?, ??, ??]\n\nThe state transition matrix defines the mapping from a maneuver to the target\nbody in Cartesian coordinates. The state transition matrix may be determined by\nfinite difference of conic propagation of the trajectory or directly by integration\nof the translational variational equations. The Cartesian state at the target body is\ntransformed to B plane parameters by multiplying by the local Jacobian or partial\nderivative matrix of B plane parameters with respect to Cartesian state.\n\nB = ?Oh\n?X(t)\n\n?X(t)\n?X(t0)\n\n=\n?\n??\n\n?(B \u00b7R,B \u00b7T , tl)\n?(x0, y0, z0)\n\n?(B \u00b7R,B \u00b7T , tl)\n?(x?0, y?0, z?0)\n\n?(V?, ??, ??)\n?(x0, y0, z0)\n\n?(V?, ??, ??)\n?(x?0, y?0, z?0)\n\n?\n??\n\nThe K matrix is the upper right 3 by 3 partition of the 6 by 6 transformed state\ntransition matrix.\n\nK = ?(B \u00b7R,B \u00b7T , tl)\n?(x?0, y?0, z?0)\n\nFor the first 15 years of the space program, interplanetary maneuver analysis\ninvolved B planes and K matrices almost exclusively. For example to compute ?V,\nwe obtain the miss in B plane parameters (? Ok) and multiply by K inverse,\n\n? V = K?1 ? Ok\nwhere ? Ok = (?B \u00b7R,?B \u00b7T ,?tl)\n\nK matrices were also used to map orbit determination errors to the B plane.\nMission design and science objectives could also be mapped to the B plane. The\ncapture radius of a planet and the region in the B plane where occultation occurs\ncan be plotted along with the orbit determination error ellipse, and the probability\nof impact or occultation can be computed. Another useful application of K matrices\nis analysis of singularities. The state transition matrix can never be singular, but K\nmatrices are singular for 180\u2013360? transfers. A Hohmann transfer, which is 180?,\nwill pass through the line of nodes connecting the Earth and the target body. The\nmapping of orbit determination errors to the line of nodes on the far side of the body\nwill be positive semi-definite. For 360? transfers, such as the MESSENGER mission\nreturning to the Earth, the spacecraft will return to the same point in its orbit about\nthe Sun.\n\nAs the space program moved on to orbiting and landing on various bodies,\ninterest in B planes waned. Everyone grew tired of looking at B planes. However,\nthe concept was adapted for analysis of orbits about planets and asteroids. The\nlocal Jacobian of B-plane elements was replaced by a local Jacobian of elliptical\norbit elements, and the same methods that were useful for interplanetary maneuver\nanalysis were adapted to in orbit and landing analysis.\n\n\n\n8.4 Summary 301\n\n8.4 Summary\n\nNavigation operations are conducted by a navigation team in a spaceflight oper-\nations facility. Data is received from the spacecraft at a DSN tracking station,\nformatted into files, and transmitted to the navigation team. The navigation team\nreceives the tracking data and telemetry from the DSN and also receives files\ncontaining calibration data from a variety of sources. These files are processed\nin navigation software to obtain solutions for the spacecraft trajectory and other\nmodel parameters. Examples of model parameters are gravity harmonic coefficients,\npropulsive maneuver thrust or velocity change, and solar pressure acceleration\ncoefficients. The orbit determination solutions are written to files and distributed\nto the science team, spacecraft team, and DSN. The trajectory is propagated to the\ntarget, and propulsive maneuver components are computed to correct the trajectory.\nThe propulsive maneuvers are forwarded to the spacecraft team, and maneuver\ncommands are formatted and transmitted to the spacecraft via the DSN.\n\nDuring flight operations, the DSN, spacecraft team, science team, and navigation\nteam work independently and are not generally colocated. Prior to flight operations,\nthe format and content of the files that are communicated are agreed upon. It is\nimportant to get the file interface correct because of the high degree of compart-\nmentalization of the participants. During the navigation design, it is necessary for\nthe participating teams to work together. However, the compartmentalization often\ncarries over to the design of the navigation system and the resulting design is often\ncompromised due to lack of communication.\n\n\n\nChapter 9\nNavigation Analysis\n\nNavigation analysis is performed to aid mission design and to verify the veracity\nof the navigation system. The latter can be separated into three time ordered phases\nbeing pre-flight, during mission operations, and post-flight. Pre-flight analysis is\nprobably the most important. It involves imagining problems that the navigation\nsystem could have during flight and determining the performance of the proposed\nnavigation system. These problems are resolved and the spacecraft and navigation\nsystem design can be modified as appropriate. After launch, it is too late to alter the\nspacecraft design. During mission operations the spacecraft is generally in the cruise\nmode for long periods of time. Navigation analysis continues as before launch with\nan emphasis on navigation operations. There is not much interest in discovering\nduring cruise that the spacecraft design cannot achieve mission success. Another\nsource of problems arise from unexpected performance of the navigation system.\nThese problems can be mission catastrophic. However, sometimes there is enough\ntime to solve the problem and salvage the mission. This generally only happens if\nthe problem is simple to solve. During mission operations, a computer solution that\ntakes a week to implement will probably be too late. Post-flight analysis could be\nuseful for problems that may arise during future mission operations. However, funds\nare generally not available if the mission was determined to be a success.\n\nOften the navigation analyses described below were performed before the\nspacecraft was launched and the actual spacecraft and mission were not the same\nas analyzed preflight. These differences are usually minor when the analyses are for\nthe original mission design. All of the navigation analyses described below were for\nmissions that were actually flown. In the sections that follow, problems that occurred\nduring navigation design or navigation operations are defined and analyzed in detail.\nSome of these problems are of interest to navigators and some were useful for the\ndesign and implementation of the navigation system. Most of navigation analysis\nis concerned with problems associated with a potential failure of the navigation\nsystem. Since the probability of failure is small, most of the failure modes analyzed\nhave never occurred. However, these low probability failure modes are often the\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3_9\n\n303\n\nhttp://crossmark.crossref.org/dialog/?doi=10.1007/978-3-319-78916-3_9&domain=pdf\nhttps://doi.org/10.1007/978-3-319-78916-3_9\n\n\n304 9 Navigation Analysis\n\nmost interesting from an analysis point of view. The analyses described below are a\nsmall subset of all the analyses performed. The objective is to cover a wide range of\nthe type of problems encountered with emphasis on the first time the problem was\nencountered.\n\n9.1 Viking\n\nTwo Viking spacecraft were launched on separate Titan/Centaur rockets on August\n20,1975 and September 9, 1975 from Cape Canaveral on a mission to explore Mars\nand determine the possible existence of life on Mars. The spacecraft consisted of\nan orbiter and sterilized lander capsule. Viking 1 was inserted into Mar\u2019s orbit on\nJune 19,1976 and the lander touched down on July 20,1976 at the Chryse Planitia.\nViking 2 followed and was inserted into Mars orbit on August 7, 1976 and the\nlander touched down on September 3, 1979 at the Utopia Planitia. For several years\nthe Viking orbiters and landers mapped the Mars topography, searched for life, and\nanalyzed the geology.\n\n9.1.1 Planetary Quarantine\n\nSince the primary purpose of the mission was to determine the existence of life\non Mars, a major concern was the possible introduction of life from Earth and\ncontamination of the planet. The purpose of planetary quarantine analysis was\nto guarantee that the probability of contamination was below an agreed upon\nprobability. The agreements were international and were taken very seriously. The\nlander was sterilized at considerable cost to the project. Navigation was concerned\nwith the probability that large objects like the orbiter, Centaur and various space\njunk, like the shroud, would introduce microbes from Earth to the Mars surface.\nThe probability analysis consisted of sub allocating probabilities to the various\nsources of contamination. The probability equation is similar to Drake\u2019s equation for\ndetermining the possible existence of life in the universe. Navigation was allocated a\nprobability of 3.027 \u00d7 10?5. This navigation suballocation was further suballocated\nto the mission phases. In addition, a fuel allocation that was enough to change\nthe velocity of the orbiter and lander by a total of 41 m/s was allocated. The\nsuballocation of the probability and fuel navigation allocation to the various mission\nphases is given in Table 9.1.\n\nWhen the spacecraft is injected into its trans-Mars trajectory, the Centaur boost\nvehicle and associated hardware follow along and also make the trip to Mars. These\nobjects must be aimed far away from the desired target in order to avoid impacting\nMars. The injection aim point is about 400,000 km away from Mars or about as far\naway as the Moon is from Earth. Figure 9.1 shows the geometry drawn to scale\nfor Viking 2. At this scale Mars appears as a small circle as would the Earth and\n\n\n\n9.1 Viking 305\n\nTable 9.1 Planetary\nquarantine large impactables\nallocation\n\nTrajectory\nphase\n\nProbability\nsub allocation ?V suballocation\n\nInjection 0.227 \u00d7 10?5 7.5 m/s\nMidcourse 0.200 \u00d7 10?5 5.0 m/s\nMOI 2.500 \u00d7 10?5 28.5 m/s\nOrbit\ntrims\n\n0.100 \u00d7 10?5 Nill\n\n\u2013500\n\n\u2013400\n\n\u2013300\n\n\u2013200\n\n\u2013100\n\n0\n\n100\n\n200\n\n300\n\u2013100 0\u2013200 100 200 300\n\n^B \u2022 T, km x 10-3\n\n^\nB\n\n \u2022\n R\n\n, k\nm\n\n x\n 1\n\n0-\n3\n\n400 500 600 700\n\nACHIEVED\nINJECTION\n\nINJECTION TARGET\nTCA = 8/8/76 13:01 GMT\n\nTARGET FOR MOI\nTCA = 8/7/76 11:51MARS\u2019\n\nIMPACT\nRADIUS\n\n99% LAUNCH\nVEHICLE DISPERSION\n\nNOTE:\n*THE 99% LAUNCH VEHICLE DISPERSION IS DEPICTED\nHERE AS A ELLIPSE.  BECAUSE OF NON-LINEARITIES,\nTHE ACTUAL SHAPE IS DISTORTED AND ENCOMPASSES\nTHE ACHIEVED INJECTION POINT.\n\n800\n\nFig. 9.1 Viking 2 injection dispersion\n\nMoon drawn to the same scale. The ellipse, which is actually a cross section of a tri-\naxial ellipsoid, defines the region where 99% of Earth injections would arrive or the\nprobability is 99% that the spacecraft is inside the ellipse. Observe that the achieved\ninjection is outside the 99% ellipse. This would imply that we had a bad injection.\nHowever, careful analysis revealed that, due to nonlinearity, the ellipse shown on\nthe figure is actually bent like a banana. The achieved injection was actually inside\nthe real 99% contour.\n\nThe first midcourse maneuver, which is not performed midcourse but near the\nEarth, delivers the spacecraft to the point in the B-plane shown in Fig. 9.2. Modern\nterminology refers to maneuvers performed during the interplanetary phase of the\nmission as Trajectory Correction Maneuvers (TCMs). The achieved trajectory is\n\n\n\n306 9 Navigation Analysis\n\n0 10,000\n\n\u20135,000\n\n5,000\n\n0\n\nB\u00b7T, km\n\u2013 ?\n\nB\n\u00b7R\n\n, k\nm\n\n\u2013\n?\n\n15,000\n\nMARS\u2019 IMPACT RADIUS\n\nTARGET FOR MOI\n\nOCT 29, 1975\nESTIMATE OF\nENCOUNTER\nCONDITIONS\n\nGUIDANCE\nSUCCESS\nZONE\n\nM/C 1(8.07 m/sec)\n\nTARGET FOR\nFIRST MIDCOURSE\n\n99% TOTAL\nUNCERTAINTY\n(34.1 min)\n(OD + EXECUTION\nERRORS)\n\n20,000\n\nFig. 9.2 Viking 2 first midcourse maneuver dispersion\n\nstatistically closer to the target than at injection and this may be attributed to the\nluck of the draw. The first midcourse was also biased to satisfy planetary quarantine\nper the suballocations given in Table 9.1. It would appear from the figure that the\nprobability of impacting Mars is greater than the planetary quarantine allocation.\nHowever, if the probability of the orbiter being able to perform a subsequent\nmaneuver to move the spacecraft off the capture circle is included in the probability\ncalculation, the probability is within the allocation.\n\nNear Mars, the mapping of maneuver execution errors is much smaller and\nplanetary quarantine constraints are easier to satisfy. Once in orbit, the orbit trim\nmaneuvers are too small to result in impact. Orbit lifetime may result in eventual\norbit decay and impact. This suballocation is considered separately and not included\nin the navigation suballocation. The strategy for the planetary quarantine bias\nrequired for MOI is included in the MOI maneuver design discussed below.\n\n9.1.2 Orbit Insertion Maneuver Design\n\nDuring approach to Mars, the Viking orbiter and lander was maneuvered into a\ntrajectory that provided the optimum initial condition for a large propulsion motor\nburn that inserted the orbiter and lander into an orbit about Mars. The design of\n\n\n\n9.1 Viking 307\n\nthe approach trajectory and orbit insertion burn involved finding the ignition time,\nmagnitude, and direction of two propulsion maneuvers. The constraints on the\ntrajectory design included the period of the inserted orbit, periapsis altitude, latitude\nof the landing site and sun elevation angle at the landing site. Since the number\nof control parameters related to the propulsive motor burns exceeded the number\nof mission constraints, a solution could be found that satisfied the constraints\nand minimized a performance criterion. The performance criterion was the total\namount of fuel consumed. A numerical solution to a classical constrained parameter\noptimization problem was needed. A constrained parameter optimization algorithm\nwas devised by the author for this purpose and is referred to as the method of explicit\nfunctions described earlier in Chap. 4.\n\nThe first problem was to optimize the final approach maneuver in conjunction\nwith the orbit insertion burn. The control parameters are given by the propulsive\nmaneuver components ?V1, ?V2 and the ignition time. The ?V maneuver\ncomponents are the integral of the thrust over the finite burn time of about 40 min.\nThe candidate constraint parameters are period of the post MOI orbit (P0), the\nperiapsis altitude (hp), the latitude of a point in the orbit, referred to as the PER\npoint,?PER , the longitude of the sub PER point at the time of touchdown (?PER)\nand the sun elevation angle of the landing site at touchdown (SEA). The PER point\nis at a fixed true anomaly on the separation orbit and is directly over the lander at\ntouchdown. The performance criterion is\n\nJ = |?V1| + |?V2|\n\nThe constraint on periapsis altitude is necessary to prevent the optimization\nalgorithm from collapsing onto the planet surface. The optimum solution involves\ntargeting to as low a periapsis as possible and then raising periapsis altitude by\ndoing a maneuver at apoapsis. The periapsis altitude was constrained to be 1500 km\nto avoid hitting Mars. At that time, radiometric orbit determination was several\nhundred kilometers. During the actual approach to Mars, optical data was able to\ndetermine the orbit to within 25 km however, optical data was not accepted as a\nprimary data source and was regarded as a backup.\n\nAfter the final approach maneuver was executed, the spacecraft continued about\n10 days to encounter with Mars. During this time additional radiometric tracking\nrevealed that the spacecraft was not on course. The orbit insertion burn was thus\nadjusted to satisfy the important mission constraints. For this optimization, the\nperiapsis altitude was not a target constraint. The desired 1500 km altitude could not\nbe achieved or would require too much fuel. The MOI control parameters, constraint\nparameters, and performance criterion were reduced to\n\nU = (t2, ?V2)\n?c = (P0, ?PER)\n\nJ = |?V2|\n\n\n\n308 9 Navigation Analysis\n\nand the other parameters were permitted to float. Of course, periapsis altitude could\nnot be permitted to float too far from the nominal value of 1500 km. If the tracking\ndata revealed that the spacecraft was getting too close to Mars or too far away, an\nemergency propulsive maneuver would be executed to restore the target periapsis\naltitude.\n\nAnother approach to partially restore hp to its target is to adjust the performance\ncriterion to enable some propellant to be expended to raise or lower hp. Consider\nthe following modification.\n\nJ = |?V2| + G |hp ? 1500.|\n\nThe gain G would achieve this purpose. A value for G may be obtained from the\ntrajectory optimization performed for the last maneuver targeting. The Lagrange\nmultiplier associated with hp may be obtained as a by-product of the optimization.\n\n?hp = ? ?J\n?hp\n\nThe Lagrange multiplier provides a measure of the cost of maintaining hp at\n1500 km. Recall that the optimum solution would allow hp to be much lower. If\nwe set G = ??hp, the optimization algorithm will partially restore hp to 1500 km\nat a cost that has already been committed.\n\n9.2 Galileo\n\nThe Galileo spacecraft was launched to Jupiter on October 18, 1989. An atmo-\nspheric entry probe was released 150 days prior to Jupiter encounter. Following\nprobe release, the orbiter portion of the spacecraft was deflected for a close flyby\nof the Galilean satellite Io. The orbiter was then configured for recording and relay\nto Earth of probe entry data. Immediately following relay of probe data, the orbiter\nwas reconfigured for a Jupiter Orbit Insertion (JOI) motor burn. The orbiter was\nthen inserted into a highly eccentric 200-day orbit about Jupiter. At apojove, a large\nmotor burn raised the perijove radius to a less severe radiation region. The orbiter\nthen began a series of close encounters of the Galilean satellites Europa, Ganymede,\nand Callisto.\n\n9.2.1 Probe Delivery to Jupiter\n\nThe first major orbit determination activity during the Jupiter approach phase is\ndetermination of the spacecraft trajectory so that Trajectory Correction Maneuvers\n(TCMs) can place the probe on the proper Jupiter atmosphere entry trajectory.\nThis process combines trajectory state estimates with the nominal probe-orbiter\nseparation velocity to determine estimates of six Jupiter-relative entry parameters.\n\n\n\n9.2 Galileo 309\n\nThe six entry parameters are latitude, longitude, speed, heading angle, time of entry,\nand entry flight path angle. Entry is at a defined altitude of 450 km above the\nreference ellipsoid with an equatorial radius of 71,398 km and flattening of 0.065.\nThis ellipsoidal surface is assumed to represent the l-bar pressure level in the Jovian\natmosphere. The probe was not expected to encounter perceptible atmosphere until\nabout 100 km below the reference 450 km point, but use of a fixed reference is\nconvenient because of uncertainties in the actual entry point.\n\nDuring the 2-year interplanetary cruise from Earth to Jupiter, the spacecraft is\ntracked to monitor the effect of nongravitational accelerations such as solar pressure,\ngas leaks, and attitude control thruster imbalance. As the spacecraft approaches\nJupiter\u2019s sphere of influence, the orbit determination error was predicted to be about\n500 km. This total error represents a statistical combination of the Jupiter ephemeris\nerror and the 0.25\u00b5rad tracking error characteristic of Doppler tracking.\n\nThe probe is released from the orbiter 150 days prior to entry. Control of the\nsix entry parameters is dependent on the initial position error and the mapping of\nseparation velocity errors to entry. Errors in solar pressure and probe outgassing\nmodeling have little effect on the predicted probe trajectory.\n\n9.2.2 Gravity Focusing\n\nThe mapping of probe position errors from probe separation to entry is best\ndescribed in an orthogonal rotating frame with the X axis parallel to the velocity\nvector (the downtrack direction), the Z axis normal to the plane-of-motion (the\nout-of-plane direction), and the Y axis normal to the velocity vector and in the plane-\nof-motion (the crosstrack direction). The mapping of a spherical position error in\ndowntrack and crosstrack from far out on the approach asymptote to entry is shown\nschematically in Fig. 9.3. Observe that the downtrack error increases as the probe\n\nFOCUSSED\nERROR AT\nENTRY\n\nDOWNTRACK\nX\n\nJUPITER\n\nSPHERICAL\nERROR APPROACHING\nJUPITER\n\nFig. 9.3 Gravity focusing\n\n\n\n310 9 Navigation Analysis\n\napproaches Jupiter (defocuses) whereas the crosstrack error decreases (focuses).\nThe out-of-plane error focusing is similar to the crosstrack error focusing.\n\nThe exact relationships describing gravity focusing of the orbiter state (X, Y,Z)\nwith respect to the initial state at minus infinity (X?, Y?, Z?) have been derived\nby Kent Russell and are given by\n\n?X\n\n?X?\n=\n\n[\n1 ? 2\n\ne cosh(F ) ? 1\n] 1\n\n2\n\n?X\n\n?Y?\n=\n\n(\n?2(e2 ? 1) 12\n\ne\n\n)[\nexp(F )\n\n(e2 cosh2(F ) ? 1) 12\n\n]\n\n?Y\n\n?Y?\n=\n\n(\n1 + exp(F )\n\ne\n\n)[\ne cosh(F ) ? 1\ne cosh(F ) + 1\n\n] 1\n2\n\n?Z\n\n?z?\n=\n\n(\n1 ? exp(F )\n\ne\n\n)\n\nwhere the hyperbolic eccentric anomaly (F) is defined by its relation to the mean\nanomaly (M) as\n\nM = V\n3?\n\nGM\n(t ? tca) = e sinh F ? F\n\nwhere V? is the hyperbolic excess velocity, e is the orbiter eccentricity, tca is the\ntime of closest approach, and GM is Jupiter\u2019s gravity. For the Galileo probe, the\napproach hyperbola has the orbit elements V? = 5.86 km/s, e = 1.0193, and entry\noccurs 276 s before periapsis. From Russell\u2019s equations, the crosstrack focusing is\n0.19, the out-of-plane focusing is 0.04, and the downtrack defocusing is 10.0. The\ncoupling of crosstrack into downtrack is 1.91. For a 500 km spherical delivery error\non the approach asymptote, the downtrack error at entry is 5080 km, the crosstrack\nerror is 98 km, and the out-of-plane error is 20 km.\n\n9.2.3 Probe Entry Dispersions\n\nA detailed covariance analysis was performed to determine the dispersions of Jupiter\nrelative atmosphere entry parameters. Computer simulations of data scheduling,\ntrajectory propagation, data filtering, and mapping resulted in the probe delivery\nentry parameter errors given in Table 9.2. The effect of gravity focusing is somewhat\nobscured by Jupiter\u2019s rotation rate. Since the probe enters near Jupiter\u2019s equator at a\nheading angle that is about due East, the latitude dispersion is predominantly caused\nby the out-of-plane trajectory error. Similarly, the flight path angle error is related\n\n\n\n9.2 Galileo 311\n\nTable 9.2 Predicted probe\ndelivery entry parameter\nerrors\n\nEntry parameter Error (99%)\n\nLatitude 0.05?\n\nLongitude 2.7?\n\nTime-of-entry 256 s\n\nSpeed 0.035 km/s\n\nHeading angle 0.16?\n\nFlight path angle 0.94?\n\nto the crosstrack error. The downtrack error maps into the time-or-entry error. The\nlongitude error is related to the time-of-entry error by Jupiter\u2019s rotation rate.\n\n9.2.4 Probe Entry Flight Path Angle\n\nProbe entry flight path angle, the angle between the relative velocity vector and local\nhorizontal plane, is the most critical entry parameter. It was required to deliver the\nprobe to an entry angle corridor with 99% probability between ?7.2? and ?10.0?.\nThe upper limit is related to skip out of the Jovian atmosphere and the lower limit\nis related to structural limitations. For the purpose of analysis, it is convenient\nto relate entry parameters to orbit determination errors in the B-plane coordinate\nsystem shown in Fig. 3.4 which has its T-axis parallel to the Jupiter equatorial plane.\nSince the Jupiter equatorial plane, the ecliptic plane, and the trajectory plane are\nnearly coplanar, B \u00b7 T is essentially in the trajectory plane and B \u00b7 R is essentially\nperpendicular to the trajectory plane. On the approach asymptote, B \u00b7 T is nearly\nin the crosstrack direction defined above and B \u00b7 R is nearly in the out-of-plane\ndirection. The magnitude of the B-vector is the hyperbolic impact parameter. The S-\nvector shown in Fig. 3.4 is the unit vector in the direction of the approach asymptote.\nIt is in the direction of the hyperbolic excess velocity (V?) and is in the downtrack\ndirection on the approach asymptote.\n\nThe entry flight path angle is most strongly dependent on the encounter impact\nparameter (B) which is a measure of the \u201cmiss\u201d of the approach hyperbola\nasymptote with respect to the center of the planet. The relationship between the\nimpact parameter (B) and the inertial entry angle ?I is given by\n\ncos ?I = B?\nre\n\n(\n2GM\nV 2?\n\n+ re\n)\n\nAn approximate relationship for the relative flight path angle, which assumes 90?\nheading, is given by\n\n\n\n312 9 Navigation Analysis\n\n\u201313\n\n\u201312\n\n\u201314\n\n\u201311\n\n\u201310\n\nNAVIGATION\nREQUIREMENT\n\nLIMITS\n\nR\nE\n\nLA\nT\n\nIV\nE\n\n E\nN\n\nT\nR\n\nY\n A\n\nN\nG\n\nLE\n g\n\ne,\n d\n\neg\n\n\u20139\n\n\u20138\n\n\u20137\n\n\u20136\n\n\u20135\n\n\u20133\n\n\u20134\n\n723 724722\n\n99% DELIVERY\n\u00b1 1300 km\n\n725 726\n\nIMPACT PARAMETER B x 103 km\n\n727 728 730729\n\nre  = 71398 km\nV  =  5.86 km/sec\nVI  =  59.9 km/sec\nm  =  0.126 x 109 km3/sec2\n\nwJ  =  1.77 x 10\n-4 rod/sec\n\n\u20138.6 deg TARGET\n\nFig. 9.4 Probe entry angle delivery\n\ntan ?e = sin ?I\ncos ?I ? ?J reVI\n\nwhere ?J is Jupiter\u2019s rotation rate, VI is the inertial entry velocity, and re is the\nreference entry radius.\n\nIn terms of B, expected delivery error to Jupiter was approximately 1300 km\n(99%). This delivery error is dominated by the Jupiter ephemeris error. The effect\nof this error on entry angle delivery is shown in Fig. 9.4. The relative entry angle\nis plotted as a function of the hyperbolic impact parameter. Superimposed on the\nabscissa is the targeted B and the 99% orbit determination delivery error. Projected\nonto the ordinate is the 99% relative entry angle dispersion. The entry angle delivery\nerror is shown to be about 1.1?. The margin indicated by these results is small but\nadequate.\n\n9.2.5 Probe Entry Angle-of-Attack\n\nAnother aspect of probe delivery is control of the entry angle-of- attack which is the\nangle between the relative velocity vector at entry and the probe spin axis. Since the\nprobe has no active attitude control, it is necessary to deploy the probe in an attitude\nsuch that it will enter the perceptible Jovian atmosphere at near zero angle-of- attack.\nSince the plane of the orbit is near Jupiter\u2019s equatorial plane, the angle-of-attack dis-\npersion is the difference between the relative entry angle and true anomaly or inertial\n\n\n\n9.2 Galileo 313\n\nlongitude dispersion at entry. The 99% angle-of-attack delivery caused by trajectory\nerrors is about 0.6?. This is well within the Galileo project requirement of 4.5?.\n\n9.2.6 Trajectory Bending\n\nAs the orbiter approaches Jupiter, the gravitational acceleration causes the orbiter\nto deviate from the approach asymptote. The resultant bending of the trajectory can\nbe measured with ?V LBI and range data and the position of the orbiter relative\nto Jupiter may be inferred. The trajectory of the orbiter may be obtained from\nsolution of\n\nr = r0 + V?(t ? t0) +\n??\n\nGM\n\nr3\nr dtdt\n\nFor orbit determination, the partial derivatives of the observable with respect\nto the estimated parameters are needed. In the simplified analysis presented here,\nthe observable is orbiter position (X,Y,Z) and the Jupiter position (Xp, Yp, Zp)\nis estimated. When the orbiter is far out on the approach asymptote, these partial\nderivatives may be approximated as follows:\n\n?X\n\n?Xp\n=\n\n?? ?2GM\nr3\n\ndtdt\n\n?Y\n\n?Yp\n=\n\n??\nGM\n\nr3\ndtdt\n\n?Z\n\n?Zp\n=\n\n??\nGM\n\nr3\ndtdt\n\nwhere\n\nr = Xp ? X\n\nIn the limit, the above integrals may be evaluated by making the assumption that\nvelocity (V?) remains constant on the approach asymptote and by performing a\nchange of variable from time to r.\n\nlim\nr???\n\n?X\n\n?Xp\n= ?2GM\n\nV 2?\n1\n\n2r\n= ?2 exp(F )\n\ne\n\nlim\nr???\n\n?Y\n\n?Yp\n= GM\n\nV 2?\n1\n\n2r\n= exp(F )\n\ne\n\nlim\nr???\n\n?Z\n\n?Zp\n= GM\n\nV 2?\n1\n\n2r\n= exp(F )\n\ne\n\n\n\n314 9 Navigation Analysis\n\nwhere\n\nr = a(e cosh(F ) ? 1)\n\nand\n\nlim\nF??? cosh(F ) =\n\nexp(?F)\n2\n\nThe above result may also be derived from Russell\u2019s equations by taking the limit\nas F approaches minus infinity. An interesting observation is that on the approach\nasymptote, the crosstrack and out-of-plane partial derivatives are equal and the\ndowntrack partial derivative is greater by a factor of two. Recall that the crosstrack,\nout-of-plane, and downtrack directions are nearly coincident with the B\u00b7T, B\u00b7R, and\ntime-of-flight or S directions, respectively. This implies that the Jupiter approach\norbit determination B \u00b7R and B \u00b7T errors is equal and the S orbit determination error\nis one half of the B \u00b7 R and B \u00b7 T errors. The orbit determination error is proportional\nto the reciprocal of the measurement sensitivity. Of course these idealized results\nprovide only an approximate insight into the actual errors.\n\n9.2.7 Jupiter Approach Orbit Determination\n\nThe Jupiter approach orbit determination error as a function of time from encounter\nis shown in Fig. 9.5. The orbit determination error is mapped to the Jupiter B-\nplane. Prior to Encounter (E) minus 40 days, the B-plane errors are dominated by\nJupiter\u2019s ephemeris error. Starting at about E-40 days, the ?VLBI measurements\nbegin to sense the gravitational acceleration of Jupiter. The B \u00b7 R and B \u00b7 T errors are\napproximately equal as predicted by the above analysis. The S error is predicted to\nbe less than B \u00b7 R and B \u00b7 T errors by a factor of two. The time-of-flight error (TL),\nwhich is equivalent to the S error divided by V?, is greater than predicted by the\nabove simplified analysis until about E-5 days. However, the qualitative agreement\nwith the results of detailed computer simulations that include optical and Doppler\ndata is good. At about E-5 days, the B \u00b7 R error levels off at around 25 km. This\nmay be attributed to a systematic optical center finding error of 1% of Io\u2019s radius.\nNear Jupiter periapsis, the orbit determination error decreases rapidly because of the\nstrong orbit dynamics signature in the Doppler data.\n\nThe same orbit determination error is shown on the right side of Fig. 9.5 mapped\nto Io closest approach. The in-plane B \u00b7 T and TL components tend to follow the\nJupiter relative TL component shown on the left side of Fig. 9.5. The ratios of Io\nrelative B.T and TL errors to the Jupiter relative TL error may be computed from\nthe orbiter and Io velocities. The orbiter trajectory crosses Io\u2019s orbit at an angle of\n36?. From the geometry, the ratios of Io-relative B \u00b7 T and TL errors to the Jupiter\nrelative TL error are 16 and 1.25, respectively. This result may also be obtained from\n\n\n\n9.2 Galileo 315\n\n10,000\n\na b\n\n1,000\n\n100\n\n10\n\n\u201370 \u201360 \u201350 \u201340\nTIME FROM ENCOUNTER (days)\n\n\u201330\n\nTL (sec)\n\nB\u2022R (km)\n\nB\u2022T (km)\n\n\u201320 \u201310 0\n\nO\nR\n\nB\nIT\n\n D\nE\n\nT\nE\n\nR\nM\n\nIN\nA\n\nT\nIO\n\nN\n E\n\nR\nR\n\nO\nR\n\n A\nT\n\n Io\n(1\n\n ?\n)\n\n10,000\n\n1,000\n\n100\n\n10\n\n\u201370 \u201360 \u201350 \u201340\nTIME FROM ENCOUNTER (days)\n\n\u201330\n\nTL (sec)\n\nB\u2022R (km)\n\nB\u2022R (km)\n\nB\u2022T (km)\nB\u2022T (km)\n\n\u201320 \u201310 0\n\nO\nR\n\nB\nIT\n\n D\nE\n\nT\nE\n\nR\nM\n\nIN\nA\n\nT\nIO\n\nN\n E\n\nR\nR\n\nO\nR\n\n A\nT\n\n J\nU\n\nP\nIT\n\nE\nR\n\n(1\n ?\n\n)\n\nFig. 9.5 Jupiter approach orbit determination errors\n\nthe gravity focusing formulas. The Io-relative B.R component shown in Fig. 9.5 is\nmuch better determined because of the effect of Jupiter gravity focusing. The orbit\nestimate at E-5 days is used for the TCM at E-3 days that delivers the orbiter to Io.\n\n9.2.8 Relay Link\n\nThe Galileo mission probe-to-orbiter communications relay link is illustrated\nschematically in Fig. 9.6. The link begins with transmission of coded science and\nengineering data from a transmitter within the probe descent module through a\nrelatively broad-beam antenna fixed to the aft end of the probe so that normally\nits axis is oriented along the local vertical. The signal is received by the relatively\nnarrow-beam Relay Radio Antenna (RRA) on-board the orbiter and retransmitted\nin real time to the DSN through the orbiter high gain antenna. A few days after\nprobe separation, the RRA is deployed to a position such that the antenna axis will\nbe pointing in the direction of the predicted probe location approximately 20 min\nafter probe entry. This optimizes relay link performance during the first 30 min of\nthe relay. During the latter half of the relay, the RRA is repointed several times so as\nto minimize the RRA aspect angle. Ten days before probe entry, the RRA pointing\nis updated in accordance with the improved orbit determination.\n\nThe dynamic behavior of the link geometry as a function of time past entry is\nalso illustrated in Fig. 9.6. Note that at signal acquisition, the signal enters the RRA\n\n\n\n316 9 Navigation Analysis\n\nEARTH\n\nEARTH\n\nEARTH\n\nHGA\n\nHGA\n\nHGA\n\nRRA\n\nRRA\n\nENTRY ~ 1 bar + 450 km\n\nNOTE: Probe falls\nvertically in Jupiter\u2019s\natmosphere after 0.1 bar\n\nCL\nOU\n\nD\n\nJU\nPIT\n\nER\n\u2019s R\n\nOT\nAT\n\nION\n\n0.1 bar\n\nE+30 min\n~7 bar\n\nE+40 min\n~10 bar\n\nE+8 min\n~1 bar\n(H = 0 km)\n\nE+2 min,\nCHUTE DEPLOYMENT,\nACQUISITIONE+60 min\n\n~19 bar\nPROBE EOM\n\nRRA\n\nTOP\n OF \n\nIONO\nSPHER\n\nE\n\nFig. 9.6 Relay link geometry\n\nto the left of the RRA axis, while 30 min later, it enters to the right of the axis. If the\nRRA remains inertially pointed, the signal arrives far off the RRA axis at the end of\nprobe mission. The dashed line represents a repointing of the RRA to improve the\nrelay link performance in the later portion of the mission.\n\nFour pertinent antenna angles are defined in Fig. 9.7. The reference direction for\nthe probe aspect angle is the local vertical. The orbiter aspect angle is referenced to\nthe +Z-axis of the orbiter. The direction of the axis of the RRA is also referenced\nto th orbiter Z-axis. Then, the operating point in the RRA pattern is defined by the\ndifference between these two angles.\n\nThese angles may all be calculated at any time during the probe mission, based\non reference trajectories for the orbiter and the probe, allowing the RRA and probe\nantenna gains to be calculated. However, the values for probe and orbiter antenna\naspect angles at any given time will be perturbed by deviations in the trajectories of\nthe two spacecraft and by errors and changes in the attitudes of the two spacecraft.\nIt should be noted that for probe and orbiter trajectories, the relative motion of\nthe probe in the orbiter frame of reference is almost exclusively in the cone-angle\ndirection. The RRA may be articulated in this direction by rotation of the boom on\nwhich it is mounted. RRA pointing in the clock or cross-cone direction is controlled\nby orientation of the de-spun portion of the dual-spin orbiter spacecraft.\n\nDelivery orbit determination errors of the relay link parameters for a data arc\nending at the time of probe separation and knowledge orbit determination errors at\n10 days before encounter are given in the Table 9.3.\n\n\n\n9.2 Galileo 317\n\nRELAY RADIO ANTENNA\n\nTO EARTH\n\nHIGH GAIN ANTENNA\n\n+Z\n\nAO\n\nAO = ORBITER ASPECT ANGLE\nAP = PROBE ASPECT ANGLE\nq = PRA ASPECT ANGLE =  |AS-AO|\nAS= PRA POINTING ANGLE\n\nAS\n\nAP\n\n3RJ\n\nRJ\n\nq\n\nFig. 9.7 Aspect angle definition\n\nTable 9.3 Predicted probe delivery entry parameter errors\n\nRelay link delivery errors\n\nParameter Requirement error (99%) Capability error (99%)\n\nOrbiter aspect angle 2.0? 1.8?\n\nProbe aspect angle 3.0? 2.4?\n\nTime-of-entry 480 s 256 s\n\n9.2.9 Jupiter Orbit Insertion\n\nThe final event of the Jupiter approach phase is insertion of the orbiter into orbit\nabout Jupiter. Immediately following the relay of probe data, the orbiter is placed\ninto a 200-day period orbit around Jupiter by the Jupiter Orbit Insertion (JOI)\nmaneuver. The initiation of the JOI maneuver is time critical because the relay link\nends after Jupiter periapsis and delay results in expenditure of additional propellant\nto get into orbit. The amount of propellant required for JOI and subsequent orbit\ntrims is also dependent on how accurately the orbiter is delivered to Io and prior\nknowledge of Io delivery that would permit a late update of the JOI motor burn. A\nfinal Jupiter approach TCM is performed 3 days prior to Io encounter. This TCM\n\n\n\n318 9 Navigation Analysis\n\nis based on data taken up to 5 days prior to Io encounter. The Io relative orbit\ndetermination error is shown in Fig. 9.5 as a function of time from encounter. At E-5\ndays the B \u00b7 T orbit determination error is about 60 km. The post JOI orbit period is\nmost sensitive to the in-plane B \u00b7T delivery to Io. The B \u00b7T orbit determination error\ndecreases to around 25 km at E-1.5 days. A systematic optical center finding error\nof 1% of Io\u2019s radius holds the B \u00b7 T and B \u00b7 R errors at this level. A late update of\nthe JOI maneuver is planned based on data taken up to E-1.5 days. This late update\nresults in a savings of several kilograms of propellant for the orbit trim subsequent\nto the JOI motor burn.\n\n9.2.10 Probe Entry Trajectory Reconstruction\n\nThe final orbit determination activity associated with the Jupiter approach phase\nis reconstruction of the probe entry trajectory. Of particular interest is the probe\nentry flight path angle. The determination of Jupiter atmosphere scale height is\ndependent on accurate knowledge of the entry angle. On-board probe measurement\nof deceleration cannot accurately determine whether the probe is descending rapidly\nthrough a relatively thin atmosphere or entering on a shallow angle through a dense\natmosphere.\n\nThe entry angle reconstruction procedure consists of tracking the orbiter during\nthe entire Jupiter approach phase through Io closest approach. A smoothed best\nestimate of spacecraft trajectory state relative to Jupiter is determined at the time\nof separation. The separation spring impulse is added to the probe velocity and the\nprobe trajectory state is mapped ahead to the reference entry altitude. This state\nvector and its covariance are provided to the Jupiter atmosphere scientists.\n\nData types that are used for reconstruction include Doppler, range, ?V LBI , and\noptical imaging of Io. Orbiter accelerometer data of the separation impulse is also\nincluded. The major error sources that affect entry angle reconstruction are Jupiter\u2019s\nephemeris, execution errors associated with TCMs, and velocity perturbations of\nthe probe and orbiter that occur during the separation sequence. Radio metric\ntracking data through Jupiter closest approach provides a powerful solution for\nJupiter\u2019s ephemeris. When ?V LBI data is included, the TCMs both before and\nafter separation including the orbit deflection maneuver may be determined with\nprecision.\n\nThe major error sources that affect entry angle reconstruction are velocity\nperturbations of the probe and orbiter that occur during the separation sequence.\nDuring this sequence, the orbiter turns to the attitude required for zero angle-of-\nattack at entry. A spin-up maneuver is performed to give the probe the required\nangular momentum to maintain a stable attitude during the 150-day ballistic transit\nto the Jovian atmosphere. The probe is separated from the orbiter by springs and the\norbiter then performs a spin-down and returns to normal cruise attitude.\n\nA feature of the separation sequence is that two-way lock is lost when the orbiter\nturns off Earth-line. An accurate measurement of separation velocity is obtained\n\n\n\n9.3 Pioneer 319\n\nfrom Doppler data. The total orbiter velocity change associated with the turn, spin-\nup, separation springs, spindown, and return to cruise attitude may be determined\nto 1 mm/s when the orbiter returns to Earth-line and two-way lock is reestablished.\nHowever, the velocity given to the probe cannot be completely separated from the\norbiter velocity changes associated with the spin up, spin down, and turns. The probe\nvelocity must be inferred from the observed orbiter velocity change.\n\nAnalysis has shown that it is difficult to meet the entry angle reconstruction\nerror requirement of 0.15? (99%) with the sequence defined above. There are\nseveral methods being studied to reduce the entry angle reconstruction error. They\ninclude use of orbiter accelerometer data, performing an Earth-line separation and\nentering the Jovian atmosphere at some small angle-of-attack, special calibrations\nof the attitude control system, and performing a more accurate calibration of the\nseparation springs. Assuming perfect determination of the velocities associated with\nseparation, the probe entry angle could be reconstructed to an accuracy of 0.05?\n(99%). With worst case estimates of separation velocity errors and no calibrations,\nthe reconstruction error could be as bad as 0.45? (99%). The current best estimate\nof entry flight path angle reconstruction error is 0.2? (99%). With implementation\nof some or all of the above methods, the goal is to meet the atmosphere science\nrequirement on entry angle reconstruction.\n\n9.3 Pioneer\n\nIn July of 1992, the Pioneer Venus Orbiter (PVO) spacecraft began a series of orbits\nthat entered the Venus atmosphere. At first the orbit periapsis just grazed the upper\natmosphere but, because of the perturbing effect of the sun, the periapsis altitude was\npushed deeper into the atmosphere. With the limited propellant available, a series\nof propulsive maneuvers were executed to raise the periapsis altitude and extend the\nlife of the spacecraft.\n\nDuring the entry phase, navigation is required for support of propulsive maneu-\nvers and entry science. Of particular interest to science is the determination of the\nvelocity change imparted to the spacecraft while in the Venus atmosphere. The\nvelocity change may be directly related to the drag experienced by the spacecraft and\nhence the atmospheric density. Determination of the spacecraft orbit was extremely\nhampered by the lack of tracking data. Continued deterioration of solar cells resulted\nin a critical power shortage that limited the time that the spacecraft transmitter was\noperated. As a result, tracking coverage was limited to a total of 2 h for each orbit.\n\nA strategy was planned for determining the orbit with the limited data available.\nThe strategy involved determining the velocity change directly and then relating this\nquantity to the atmospheric drag.\n\n\n\n320 9 Navigation Analysis\n\n9.3.1 Orbit Determination Strategy\n\nThe orbit determination strategy defines the data types and data acquisition required\nfor orbit determination. For PVO, the data type is two way coherent Doppler\nobtained by tracking the spacecraft from the Deep Space Network. During times\nof high spacecraft activity, such as during maneuvers or when the spacecraft is\nperturbed by external forces, it is desired to have continuous tracking coverage.\nWith the solar array degradation being experienced by PVO, the total tracking\ncoverage during the atmospheric entry phase is about 2 h per day. Science playback\nand commanding for maneuvers require about 30 min of coverage at periapsis and\napoapsis. With this as a baseline tracking coverage, a study was undertaken to\ndetermine the minimum coverage needed to meet science and mission accuracy\nrequirements. Tracking data was simulated and the strategy for placement of\ntracking passes varied to determine the optimum tracking coverage. As a general\nrule, it was discovered that the length of individual tracking passes spaced around\nthe orbit had little effect on orbit determination accuracy. Orbit determination\naccuracy is primarily determined by the number and geometric placement of the\npasses. For example, it was found that six tracking passes each 15 min in length and\ngeometrically spaced evenly around the orbit would determine the orbit nearly as\nwell as continuous tracking coverage. However, an hour of tracking at periapsis and\nanother hour in the vicinity of apoapsis does not do nearly as well.\n\nFurther investigation of the placement of tracking passes revealed that the num-\nber of passes required per revolution could be substantially reduced by processing\nseveral consecutive orbits of data. With this strategy, three consecutive orbits con-\ntaining three periapsis passages would require four tracking passes per revolution to\nobtain orbit determination accuracy comparable to continuous coverage. The four\ntracking passes would be 15\u201330 min in length and placed at periapsis, apoapsis, and\nroughly geometrically in between at plus and minus 4 h from periapsis.\n\n9.3.2 Orbit Determination Results from 1980\n\nIn order to quantify and verify these observations, a series of atmospheric entry\npasses from 1980 were selected and the data processed in a manner similar to that\ndescribed above. First a baseline case was run processing all the data available.\nThese were orbits number 503 through 506 extending from April 20 to April\n23, 1980. The estimated parameters were spacecraft state, the maneuver velocity\ncomponents at apoapsis 505, and the magnitude of the velocity change that occurred\nduring each periapsis passage. The atmospheric drag was modeled as a small retro\npropulsive maneuver in a direction opposite to the nominal direction of the velocity\nvector at periapsis. The length of the burn was taken to be about 300 s which is\napproximately the length of time that the spacecraft was in the atmosphere. It will\nbe shown later that the detailed modeling of the atmospheric drag is not critical\n\n\n\n9.3 Pioneer 321\n\nsince the orbit determination filter responds primarily to the total impulse. The filter\nmodel also included stochastic acceleration components around the entire orbit and\nsolar radiation pressure.\n\nThe results of processing the baseline case for orbit numbers 503 through 506 are\nshown in Fig. 9.8. The abscissa is time measured in days from periapsis passage 503\nwhich is assigned the day number 503. The ordinate is milli Hertz (mHz) of Doppler\nresidual. Except for the data near periapsis, the fit is good to within 15 mHz which\ncorresponds to a velocity error of 1 mm/s. Analysis of these residuals indicates that\nthe data near periapsis is corrupted by errors in modeling the Venus gravity field. A\nbetter fit may be obtained by estimating gravity harmonics or deleting the data near\nperiapsis as has been demonstrated on previous missions.\n\nHere, we have elected to fit through the periapsis data and the results are tabulated\nbelow in Table 9.4. Shown is (?V ) that was estimated at each of the periapsis\npassages indicated under the heading \u201cRevolution.\u201d Atmospheric drag was modeled\nas a finite motor burn directed opposite to the nominal velocity vector and centered\naround periapsis with a nominal burn time of 300 s.\nThe associated orbit period change (?Pbase) was computed from the partial\nderivative of period with respect to velocity and given by\n\n300\n\n150\n\n0\n\n\u2013150\n\n\u2013300\n502.5 503.5 504.5 505.5503 504\n\nRevolution\n\nD\nop\n\npl\ner\n\n r\nes\n\nid\nua\n\nl \u2013\n (\n\nm\nH\n\nz)\n\n505\n\nFig. 9.8 Pioneer orbits 503\u2013505 data residuals\u2014continuous tracking\n\nTable 9.4 Pioneer 1980 orbit\ndetermination baseline\n\n?V\n\n(mm/s)\n?Pbase\n(s)\n\n?P80\n(s)Revolution\n\n503 1.863 0.573 0.574\n\n504 0.413 0.128 na\n\n505 60.07 18.463 18.522\n\n\n\n322 9 Navigation Analysis\n\n?Pbase = ?P\n?vp\n\n?V\n\n?P\n\n?vp\n= 6? vp a\n\n5\n2\n\nGM\n3\n2\n\na = ?GM\nh\n\nh = v2p ?\n2GM\n\nrp\n\nwhere vp is the velocity at periapsis, rp is the radius of periapsis, and GM is\nthe Venus gravitational constant. For comparison, the period change obtained in\n1980 at the time of the actual atmospheric entry is also shown (?P80). The period\nchanges agree within 0.06 s even though obtained by somewhat different methods.\nSubsequent analysis of additional orbit cases has shown general agreement to within\n10 ms. The differences may be attributed to small perturbations from the sun and\nnongravitational accelerations. During the 1992 atmospheric entry phase much less\ntracking data was available as discussed above. As a test, the sparse data tracking\nstrategy can be applied to the 1980 data. The tracking data residuals are shown in\nFig. 9.9.\n\nSince the spacecraft is normally occulted by the planet near periapsis this data\nis deleted. Included are two 30 min tracking data arcs just before and after the\nsimulated occultation and several 15 min tracking data arcs spaced around the orbit.\nThe resulting ?V ?s and corresponding period changes are shown in Table 9.5.\n\nFig. 9.9 Pioneer orbits 503\u2013505 data residuals\u2014sparse tracking\n\n\n\n9.3 Pioneer 323\n\nTable 9.5 Pioneer 1980 orbit\ndetermination sparse data\n\n?V\n\n(mm/s)\n?Psparse\n(s)\n\n?Pbase\n(s)Revolution\n\n503 1.851 0.569 0.573\n\n504 0.409 0.126 0.128\n\n505 60.05 18.487 18.463\n\nThe sparse data solution compares quite favorably with the solution obtained by\nprocessing all the available data.\n\n9.3.3 Estimation of Drag\n\nThe estimation of drag from orbit tracking data involves separating the velocity\nimparted to the spacecraft associated with atmospheric drag from the velocity\nimparted by all other sources including both gravitational and nongravitational\naccelerations. The significant other sources include the Venus gravity harmonics,\nsolar tide, solar radiation pressure, and any spacecraft propulsive or attitude\nmaneuvers. Over a relatively short data arc of a few hours, the solar tide and\nnongravitational accelerations are predictable and do not contribute significantly to\nthe drag estimation error. The Venus gravity harmonics, on the other hand, result in a\nlarge perturbation of the orbit that reaches a maximum near periapsis just where the\ndrag acceleration attains a maximum. Thus, the main orbit determination problem\nis separating the gravity harmonic perturbation from the drag perturbation.\n\nIn order to gain some insight into the problem of drag estimation it is useful\nto examine the response of the tracking data to errors in the values of key\nparameters involved in the estimation process. The tracking data response to\nestimated parameters is most useful when displayed as perturbations on the data\nresidual which is referred to as the parameter signature. Figure 9.10 shows data\nresidual signatures of the two key parameter sets describing gravity harmonics and\ndrag. The drag is described by the atmospheric density and is the curve consisting of\nthe o\u2019s, the lower curve. The gravity harmonic truncation error is approximated by\nthe sum of the perturbations caused by the gravity harmonics of degree 21 and is the\ncurve described by the x\u2019s, the upper curve. The representation of the gravity field\ntruncation error by the highest degree harmonics available is somewhat arbitrary.\nThe actual error in the truncation of the gravity field is some weighted average of\nall the harmonics that have been omitted from the solution.\n\nThe data residual signatures of atmospheric density and gravity harmonics shown\nin Fig. 9.10 were obtained by the following procedure. First, a single orbit of\nDoppler data was fit and residuals similar to those shown in Fig. 9.8 were obtained.\nThese residuals are simply a plot of the difference between the actual measurement\nobtained at the tracking station and the measurement computed from a model of\nthe system after the parameters of the model have been adjusted by least squares\nto minimize the residual error. At this point we intervene and generate a simulated\n\n\n\n324 9 Navigation Analysis\n\nFig. 9.10 Pioneer drag and gravity harmonic signatures\n\ndata set of measurements that are equal to the computed measurements. When we\nprocess this new data set, the residuals are exactly zero for each data point. Next,\nwe adjust some parameter in the model that we are interested in and process the\nsimulated data thus exposing the sensitivity of the adjusted parameter. Shown in\nFig. 9.10 is the result of performing this procedure for atmospheric density and the\ndegree 21 gravity harmonics. The orbit determination filter effectively looks at these\ntwo curves and separates one parameter from another based on the characteristic\nresponse or signature of the parameter. If we restrict the orbit determination solution\nto data near periapsis, say from 42,000 to 46,000 s on Fig. 9.10, the filter will not be\nable to determine the drag since the perturbation of the spacecraft is dominated by\ngravity harmonics in this region. However, the gravity harmonics tend to conserve\nenergy around a closed orbit and their signature is periodic whereas the atmospheric\ndrag reduces the energy resulting in a signature that grows with time. An hour or\nso of tracking data after periapsis reveals a secular growth in the atmospheric drag\nsignature that may be easily separated from the gravity harmonics signature by the\nfilter. Comparison of the atmospheric density residual with the gravity harmonic\nresidual indicates that the orbit period change associated with the drag may be\nestimated to an accuracy of about 15 ms.\n\n9.3.4 Relating Drag ?V to Period Change\n\nThe orbit determination software provides an estimate of the ?V attributable to\ndrag as the spacecraft flies through the Venus atmosphere. The problem faced by\nscience is to relate this ?V to the parameters of a detailed spacecraft aerodynamic\n\n\n\n9.3 Pioneer 325\n\nand planet atmosphere model. The procedure that has been used in the past is\nto map the spacecraft state to some reference epoch and compute the difference\nbetween the osculating orbit periods with and without the effect of atmospheric\ndrag. The atmospheric scientists may then adjust the parameters of their model until\nthey obtain the same period difference at the same reference epoch. The theory of\nsmall perturbations then applies provided the velocity change associated with the\ndrag acceleration is small compared to the spacecraft velocity at periapsis. This is\ncertainly the case since the spacecraft is moving at approximately 10 km/s relative\nto the planet and the velocity change attributable to drag is on the order of 1 m/s.\n\nConsider a simplified model consisting of flat plate drag and a simple exponential\natmosphere. We thus have for the force model,\n\nAd = ?Cd A\nm\n\nq\n\nq = 1\n2\n\n? v2\n\n? = ?o e\n?(r ? ro)\n\nho\n\nwhere ?o, ro, and ho are the atmosphere base density, reference altitude, and\nscale height, respectively and Cd , A, m, and v are the spacecraft drag coefficient,\nreference area, mass, and speed, respectively. The atmospheric density (?), drag\nacceleration (Ad), and dynamic pressure (q) are functions of these quantities.\n\nThe above drag equations in conjunction with the two body equations of motion\nare solved for ?VR .\n\n?VR = Cd A\nm\n\n?rp\n\n?\n?GMho\n\n2e\n(1 + e)\n\n?rp = ?o e\n?(rp ? ro)\n\nho\n\nThe actual Venus atmosphere has considerable more structure than is represented\nby the simple exponential atmosphere and furthermore it is not convenient to solve\nfor atmospheric model parameters in orbit determination software. Since the filter\nprimarily responds to the total impulse and is insensitive to the time variation of the\nacceleration in the atmosphere, a much simpler model of the drag should suffice.\nAfter some experimentation, a model was selected where the drag is a constant\nacceleration over a fixed interval of time. The direction is opposite to the velocity\nvector and therefore the spacecraft executes a gravity turn trajectory during the time\nthat the acceleration is active and is ballistic when the acceleration is inactive. The\nactual acceleration describes a bell shaped curve as a function of time centered at\nperiapsis and this is replaced by a constant acceleration over a fixed time interval\ncentered at periapsis. The width of the time interval is selected such that the modeled\n\n\n\n326 9 Navigation Analysis\n\nacceleration profile is close to the actual acceleration profile. The total integrated\ndrag acceleration is thus given by\n\n?Vc = Ac ?Tc\nWe desire a value for the time interval (?Tc) such that the constant acceleration\n(Ac) is close or a best fit to the actual acceleration. This will occur when the constant\nacceleration is some constant K times the actual peak acceleration experienced by\nthe spacecraft at periapsis and is given by\n\nAc = K Ap\nAp = ?Cd A\n\nm\nqp\n\nqp = 1\n2\n\n?p v\n2\np\n\nWe may solve the above equations for ?Tc by equating ?Vc with the actual\nintegrated velocity change which is approximately ?VR and obtain\n\n?Tc = 2(1 + e)\nv2p\n\n?\n?GMh0\n\ne\n\nwhere, from inspection, the value of K is seen to be a little less than one and has\nbeen arbitrarily assigned the value\n\nK = 1?\n2\n\nThe atmosphere reconstruction procedure thus consists of estimating the total\nintegrated velocity change or ?V experienced by the spacecraft during passage\nthrough the atmosphere and relating this quantity to the parameters of a detailed\nprecise model of the spacecraft and atmosphere.\n\nConsider the following numerical experiment that may be performed on a\ncomputer. A trajectory program is initialized with the spacecraft state about 5 min\nprior to periapsis. The trajectory is integrated through the Venus atmosphere and\nterminated 5 min after periapsis. A precision integrator is employed and all the\nsignificant force models are turned on that perturb the spacecraft. For the first\nintegration, the atmospheric density is set equal to zero and the osculating period\nat the end of the trajectory is recorded as Pnom. We repeat the integration, only this\ntime we turn on the atmosphere and at the end of the trajectory we compute the\nchange in the osculating period which is\n\n?Pint = P ? Pnom\n\n\n\n9.3 Pioneer 327\n\nIn order to test the linearity, we may compute the expected osculating period change\nfrom\n\n?P = ?P\n?v\n\n?V\n\n?PR = ?P\n?v\n\n?VR\n\nwhere ?V is obtained by direct integration of the drag acceleration. The partial\nderivative is also computed from osculating orbit elements obtained by trans-\nformation of the Cartesian state vector at periapsis. We next take the precision\nintegrated ?V and divide by ?Tc of 100 s to obtain a constant acceleration A100 for\ncomparison. A third precision integrated trajectory is computed using the constant\nacceleration model and the osculating period (P100) is computed at the reference\nepoch 5 min after periapsis. A fourth precision integrated trajectory is computed\nonly this time the entire ?V is applied as an impulse at periapsis resulting in Pimp.\nFinally, this entire experiment is repeated at several atmospheric base densities\nresulting in ?V \u2019s that range from a fraction of a millimeter per second to over a\nmeter per second and the results are displayed in Table 9.6.\n\nShown in Table 9.6 is the velocity change (?V ) obtained by numerical integra-\ntion and the velocity change (?VR) obtained from the formula. We would expect\nclose agreement since both of these results are based on the same equations of\nmotion and the difference represents only errors in the approximations. Also shown\nis the period change that would be predicted by the partial derivative assuming\nlinearity of the equations of motion. When compared with the precision integrated\nperiod change the error is about 1%. A more relevant comparison is between the\nperiod change obtained by integrating the drag assuming an exponential atmosphere\nand the period change obtained by integrating a constant acceleration. Here, the\nagreement is generally less than 0.1%. It is reasonable to assume that the actual\nmodeling error attributable to orbit determination software based on a constant\nacceleration model will also be less than 0.1%. In order to obtain this accuracy\nthe actual integrated drag acceleration must be compared. If the osculating periods\nare compared, they must be corrected for nonlinearity or the error will be about 1%.\n\nTable 9.6 Drag ?V and resulting period change\n\n?V\n\n(m/s)\n?VR\n(m/s)\n\n?Pint\n(s)\n\n?P\n\n?v\n?V\n\n(s)\n\n?P\n\n?v\n?VR\n\n(s)\n\n?Pimp\n(s)\n\n?P100\n(s)\n\n0.2016 \u00d7 10?3 0.2016 \u00d7 10?3 0.06295 0.06220 0.06221 0.06257 0.06254\n0.2016 \u00d7 10?2 0.2016 \u00d7 10?2 0.6226 0.6220 0.6221 0.6224 0.6219\n0.2016 \u00d7 10?1 0.2016 \u00d7 10?1 6.2186 6.220 6.2205 6.220 6.2183\n0.201677 0.201690 62.1525 62.201 62.205 62.166 62.150\n\n1.008444 1.008467 310.02 311.01 311.03 310.09 310.01\n\n\n\n328 9 Navigation Analysis\n\n9.3.5 Covariance Analysis Results\n\nIn order to determine the orbit determination error, a covariance analysis of all the\nerror sources that contribute must be performed. Since the actual orbit determination\nerror is primarily a function of the mapping of the gravity field error, it is difficult to\nassign a numerical value. Analysis of residuals indicates that the gravity harmonics\ncontribute about 15\u201320 ms one sigma to the period estimation error and about\n200 m to the periapsis altitude estimation error. Another component of the orbit\ndetermination error is data noise which is related to the orbit determination error by\nthe measurement error, number of data points, and observability of the system.\n\nFor PVO atmosphere entry we are primarily interested in predicting the space-\ncraft state at periapsis and reconstructing the drag acceleration. Both of these\nnavigation requirements are related to prediction and estimation of the period\n(P ) and periapsis altitude (Hp). In order to gain some insight into the affect of\ndata noise, a covariance analysis was performed where the amount and geometric\nplacement of the data was varied. The results are shown in Table 9.7.\n\nThe first case consisted of processing all the data available form orbits 503\nthrough 505. The period error attributable to data noise is about 6 ms in period and\nless than a meter in periapsis altitude. If the gravity field were perfectly known, these\nwould have been the orbit determination errors when the experiment was performed\nback in 1980. However, when the affect of gravity harmonic errors is included, the\nactual orbit determination error is about 20 ms in period and 200 m in periapsis\naltitude.\n\nThe second case shows the orbit determination error attributable to data noise\nfor the sparse tracking expected in 1992 as shown in Fig. 9.9. The data noise period\nerror of 21 ms is now comparable to the gravity harmonic period error. The periapsis\naltitude error remains relatively unaffected by the reduced data. Since the orbit\ndetermination error is now dominated by data noise we are much more susceptible\nto degradation from loss of data quality or loss of tracking data.\n\nThe third and final case is intended to show the accuracy of predicting the next\nperiapsis based on data taken up to a few hours after the previous periapsis passage.\nThese results indicate that the time of the next periapsis may be predicted to well\nwithin the required 1 s and the periapsis altitude can be predicted to about 200 m\nwhen gravity harmonics are taken into account. These predictions assume a ballistic\narc free of maneuvers and will deteriorate some when maneuvers are included.\n\nTable 9.7 Pioneer orbit determination errors\n\nData (Arc) Sigma P (s) Sigma Hp (km)\n\nContinuous tracking apoapsis 503 to apoapsis 506 5.74 \u00d7 10?3 .334 \u00d7 10?3\nSparse tracking apoapsis 503 to apoapsis 506 20.9 \u00d7 10?3 1.20 \u00d7 10?3\nSparse tracking apoapsis 503 to periapsis 505 + 1 h 34.2 \u00d7 10?3 1.21 \u00d7 10?3\n\n\n\n9.4 Near Earth Asteroid Rendezvous 329\n\n9.4 Near Earth Asteroid Rendezvous\n\nPrior to the NEAR mission, little was known about Eros except for its orbit,\nspin rate, and pole orientation, which could be determined from ground based\ntelescope observations. Radar bounce data provided a rough estimate of the shape\nof Eros. On December 23, 1998, after an engine misfire, the NEAR spacecraft flew\nby Eros on a high velocity trajectory that provided a brief glimpse of Eros and\nallowed for an estimate of the asteroids pole, prime meridian, and mass. This new\ninformation, when combined with the ground based observations, provided good a\npriori estimates for processing data in the orbit phase. After a 1 year delay, NEAR\norbit operations began when the spacecraft was successfully inserted into a 320 \u00d7\n360 km orbit about Eros on February 14, 2000. Since that time, the NEAR spacecraft\nwas in many different types of orbits where radiometric tracking data, optical\nimages, and NEAR Laser Rangefinder (NLR) data allowed a determination of the\nshape, gravity, and rotational state of Eros. The NLR data, collected predominantly\nfrom the 50-km orbit, together with landmark tracking from the optical data has\nbeen processed to determine a 24th degree and order shape model. Radiometric\ntracking data and optical landmark data were used in a separate orbit determination\nprocess. As part of this latter process, the spherical harmonic gravity field of Eros\nwas primarily determined from the 10 days in the 35-km orbit . Although the gravity\nfield of Eros has been determined to degree and order 10, differences between the\nmeasured gravity field and one determined from a constant density shape model\nare detected only to degree and order 6. The offset between the center-of-figure\nand the center-of-mass is only about 30 m indicating a very uniform density (1%\nvariation) on a large scale (35 km). Variations to degree and order 6 (about 6 km)\nmay be partly explained by the existence of a 100 m regolith or by small internal\ndensity variations. The best estimate for the J2000 right ascension and declination\nof the pole of Eros is ? = 11.3692 \u00b1 0.003? and ? = 17.2273 \u00b1 0.006?,\nrespectively. The rotation rate of Eros is 1639.38922 \u00b1 0.00015?/day which gives\na rotation period of 5.27025547 h. No wobble for Eros has been detected that is\ngreater than 0.02?. Solar gravity gradient torques would introduce a wobble of at\nmost 0.001?.\n\nThe original plan for Eros orbit insertion called for a series of rendezvous burns\nbeginning on December 20, 1998, that would insert the NEAR spacecraft into Eros\norbit in January 1999. As a result of an unplanned termination of the first rendezvous\nburn, NEAR continued on its high-velocity approach trajectory and passed within\n3900 km of Eros on December 23, 1998. At this time, it was not possible to place\nthe NEAR spacecraft in orbit about Eros. Instead, a modified rendezvous burn was\nexecuted on January 3, 1999, which resulted in the spacecraft being placed on a\ntrajectory that slowly returned to Eros with a subsequent delay of the Eros orbit\ninsertion maneuver until February 2000. The flyby of Eros provided a brief glimpse\nand allowed for a crude estimate of the pole and prime meridian with an error of\n2? along with a 10% mass solution. Orbital operations commenced on February 14,\n2000, with an orbit insertion burn that placed the spacecraft into a nearly circular\n\n\n\n330 9 Navigation Analysis\n\nTable 9.8 Eros orbit segments\n\nSegment\n\nStart\ndate time\n(UTC)\n\nLength\n(days)\n\nOrbit (km\n\u00d7 km)\n\nPeriod\n(days)\n\nInc. (deg.)\nATEa\n\nInc. (deg.)\nSPOSb\n\n1 2/14/00 15:33 10.1 366 \u00d7 318 21.8 35 176\n2 2/24/00 17:00 8.1 365 \u00d7 204 16.5 33 172\n3 3/3/00 18:00 29.3 205 \u00d7 203 10.0 37 171\n4 4/2/00 02:03 9.8 210 \u00d7 100 6.6 55 178\n5 4/11/00 21:20 10.8 101 \u00d7 99 3.4 59 177\n6 4/22/00 17:50 8.0 100 \u00d7 50 2.2 64 179\n7 4/30/00 16:15 68.1 51 \u00d7 49 1.2 90 160\n8 7/7/00 18:00 6.3 50 \u00d7 35 1.0 90 165\n9 7/14/00 03:00 10.6 37 \u00d7 35 0.7 90 163\n10 7/24/00 17:00 7.1 50 \u00d7 37 1.0 90 161\n11 7/31/00 20:00 8.2 51 \u00d7 49 1.2 90 159\n12 8/8/00 23:25 18.0 52 \u00d7 50 1.2 105 178\n13 8/26/00 23:25 10.0 102 \u00d7 49 2.3 112 179\n14 9/5/00 23:00 37.3 102 \u00d7 100 3.5 115 150\n15 10/13/00 05:45 7.6 100 \u00d7 50 2.2 130 179\n16 10/20/00 21:40 5.0 52 \u00d7 50 1.2 133 178\n17 10/25/00 22:10 0.8 50 \u00d7 20 0.7 133 168\n\naATE Asteroid True Equator\nbSPOS Sun Plane of Sky\n\n350 km orbit. A series of propulsive burns lowered the spacecraft orbit to a 50 km\nand then a 35 km circular orbit where the data acquired allowed precise estimates\nof Eros physical parameters. Table 9.8 lists the orbit phases for the NEAR mission\nincluded in this study from the beginning on February 14, 2000 to the close flyby\nwithin 5 km of the surface of Eros on October 25, 2000.\n\nEstimates of the initial attitude and spin rate of Eros, as well as of reference\nlandmark locations used for optical navigation, were obtained from images of\nthe asteroid. In the planned navigation strategy, these initial estimates were used\nas a priori values for a more precise refinement of these parameters by an orbit\ndetermination technique which processes optical measurements combined with\nDoppler and range tracking. Although laser altimetry could be included in the\norbit determination process, these data were processed separately using the orbits\ndetermined from the optical and radiometric data.\n\nIn addition to allowing accurately determined orbits about Eros, the gravity\nharmonics place constraints on the internal structure of Eros. The shape model\nwas obtained by processing optical landmark and laser altimetry data. This shape\nmodel was then integrated over the entire volume, assuming constant density, to\nproduce a predicted gravity field. A comparison of the true gravity field with this\npredicted gravity field from the shape model then provides insight into Eros\u2019 internal\nstructure. The location of the center of mass derived from the first degree harmonic\n\n\n\n9.4 Near Earth Asteroid Rendezvous 331\n\ncoefficients directly indicates the overall mass distribution. The second degree\nharmonic coefficients provide insight into the orientation of Eros principal axes.\nHigher degree harmonics may be compared with surface features to gain additional\ninsight into mass distribution.\n\n9.4.1 Orbit Determination Strategy\n\nSeveral strategies have been used to determine the NEAR orbits and the phys-\nical parameters of Eros. The data types used for determining NEARs orbit are\nradiometric X-band (8.4 GHz downlink) Doppler and range, and optical imaging\nof landmarks. A SRIF filter is used to process the data and this sequential filter\nis designed to handle up to 800 parameters including 18 state parameters. The\nestimated parameter set includes initial spacecraft state, propulsive maneuvers, solar\npressure parameters, stochastic accelerations, Eros ephemeris, Eros attitude and\nrotation state, and physical parameters that describe the size, shape, and gravity\nof Eros. Eros physical parameters include gravitational harmonics to degree and\norder 12, inertia tensor elements, and the location of over 100 landmarks. The\nsolution for nongravitational accelerations presents a particular challenge to the\norbit determination filter. These accelerations include attitude control gas leaks\nand solar pressure. The solar pressure is modeled as a collection of reflecting\nsurfaces with 12 separate parameters. Solar pressure mismodeling and any residual\naccelerations associated with outgassing from the spacecraft are lumped together\nand treated both as a constant acceleration and as stochastic accelerations. The\nstochastic accelerations are modeled as three orthogonal independent exponentially\ncorrelated process noise components with an amplitude of 1.0 \u00d7 10?12 km/s2 and\na correlation time of 1 day. The total number of estimated parameters for a typical\norbit determination solution is about 600.\n\nThe differences in the moments of inertia may be determined from the gravity\nharmonic coefficients, but a particular moment of inertia about any axis cannot\nbe determined from these difference alone. In the orbit determination software,\nthe joint solution for both the gravity and rotational motion of Eros permits a\ndetermination of the principal moments of inertia provided the angular acceleration\n(or wobble about the principal axes) can be detected by the orbit determination\nfilter. The solution strategy involved processing several days of data at a time to\nconverge slowly on the orbit solution. First, about 2 days of data are processed\nand the solution is fed back to the filter and the data are processed again. This\nprocess is repeated until convergence is achieved. At this point several more days\nof data are introduced to the filter and processed iteratively until another solution\nis obtained. Additional data are introduced in batches of several days until all the\ndata are processed. Otherwise, processing longer batches of data, especially at the\nbeginning of the mission, resulted in divergence. Once the filtering is complete, the\nspacecraft trajectory, Eros ephemeris, and Eros attitude files are produced containing\n\n\n\n332 9 Navigation Analysis\n\nChebyshev polynomials as a function of time. Gravity harmonic, landmark location,\nmaneuver parameter, and shape harmonic coefficient files are also produced.\n\nOptical tracking of landmarks in the imaging data taken by NEAR\u2019s Multi-\nspectral Imager (MSI) is a powerful data type for determining NEARs trajectory\nand the rotation of Eros. Tracking individual landmarks, which are small craters,\nenables orbit determination accuracies on the order of the camera resolution\nor several meters. This exceeds the accuracy that can be obtained from radio\nmetric data alone, from fitting limb data or from any measurement scheme that is\ndependent on developing a precise shape model. We need only develop a database\nof landmarks and identify the landmarks on more than one image in order to obtain\nuseful information about the spacecraft orbit or Eros\u2019 rotation. The procedure of\nidentifying and cataloging landmarks is aided by referring the landmarks to a model\nof the topographic surface or shape model. The actual identification of individual\nlandmarks depends upon observing them in an image having many landmarks of\nvarious sizes to provide a context.\n\nIn addition to the one data arc (July 3 to August 7) used to determine the gravity\nfield and rotation of Eros, three other data arcs were used to process the NLR data\n(April 30 to June 1, June 1 to July 3, and August 7 to September 12). For all the\ndata arcs, the attitude of Eros is fixed to the solution obtained from the gravity\nsolution data arc. This is to maintain consistency when comparing the estimated\ngravity solution with the shape model gravity solution. Once a good solution was\nobtained for both the spacecraft trajectory and Eros attitude as a function of time,\nsome additional processing was required to transform the results to a more usable\nformat and to solve for the shape. The solution for the shape of Eros is obtained by\nprocessing NLR data in a separate program that reads the spacecraft ephemeris and\nEros attitude files.\n\nAlthough Eros is a very irregular body, the gravitational potential is modeled by\na spherical harmonic expansion with normalized coefficients (Cnm, Snm) given by\n\nU = GM\nr\n\n??\nn=0\n\nn?\nm=0\n\n( r0\nr\n\n)n\nPnm(sin(?) [Cnm cos(m?) + Snm sin(m?)]\n\nwhere n is the degree and m is the order, Pnm are the Legendre polynomials and\nassociated functions, r0 is the reference radius of Eros (16.0 km), ? is the latitude,\nand ? is the longitude. The harmonic coefficients of degree one are set to zero since\nthe origin of the coordinate system is chosen to be the center of mass of the body.\nThis expansion converges outside the smallest sphere enclosing Eros. All the NEAR\ndata employed are outside this sphere and so spherical harmonics is the simplest way\nto compare the gravity and shape models. All gravity and shape results are mapped\nonto a sphere of radius 16 km. For mapping the gravity field to the surface of Eros,\none must use alternative methods such as direct integration over the volume of Eros\ndefined by the shape model.\n\n\n\n9.4 Near Earth Asteroid Rendezvous 333\n\n9.4.2 Eros A Priori Physical Model\n\nDetermination of the spacecraft orbit about Eros is intimately associated with the\ndevelopment of an accurate physical model of Eros. Eros is the principal source\nof perturbations on the spacecraft\u2019s trajectory and the principal source of data for\ndetermining the orbit. The model of Eros used for orbit determination is similar to\nthe model used for science investigation. The major difference is in emphasis of\ndetail.\n\nDuring a particularly close Earth approach (0.15 AU) in January 1975, there\nwas a coordinated ground-based observation campaign to characterize the physical\nnature of Eros. Photometric, spectroscopic, and radar measurements provided a\ndiverse data set that allowed the asteroid\u2019s size, shape and spectral class to be\ndetermined. Eros is an S-class asteroid with a geometric albedo of about 0.27. The\nabsolute magnitude of Eros (at zero phase angle and one AU from both the sun and\nEarth) is 11.16. From the light curve, which reaches 1.47 magnitudes in amplitude,\nthe rotation period and pole direction were determined.\n\nDuring the December 1998 flyby, a crude estimate of Eros mass and pole\nlocation was obtained. The pole location confirmed ground-based measurements\nto an accuracy of about 2?. Observation of the lit portions of Eros by the\nMultispectral Imager (MSI) permitted a rough shape determination. The gravity\nharmonic coefficients were computed from this shape determination, by numerical\nintegration assuming constant density. Light curve data obtained during the flyby\nyielded a precise rotation rate for Eros and enabled location of the prime meridian\nwith respect to a large crater discernible in the images. This information was used\nas a priori data for the orbit phase solution.\n\n9.4.3 Orbit Determination Solution\n\nIn addition to the models describing the estimated parameters, calibrations obtained\nfrom other models are applied to the Doppler, range and optical data. The calibration\ndata included seasonal and daily troposphere and ionosphere models based upon\non-site GPS and weather measurements and a solar plasma model. DSN station\nlocations are modeled to about 4 cm accuracy with Earth precession, nutation, polar\nmotion, ocean tidal loading, solid Earth tide, and tectonic plate motion. A landmark\nfile consisting of a priori landmark locations and unique identification numbers was\nassembled along with a picture sequence file that contained camera pointing and\nimage coordinates for each landmark that was identified. Additional models that\nwere needed for parameter estimation include the spacecraft clock model, a solar\npressure model, propulsive maneuvers, and initial state vectors for the equations\ndescribing the motion of the spacecraft, planets and Eros.\n\nThe gravity and pole solution data arc, which included Doppler, range and\noptical imaging of landmarks, extended from July 3, 2000 through August 7, 2000.\nNearly continuous Doppler data were processed and the post fit residuals for this\n\n\n\n334 9 Navigation Analysis\n\n.024\nN\n\nE\nA\n\nR\n D\n\nop\npl\n\ner\n r\n\nes\nid\n\nua\nls\n\n \u2013\n (\n\nH\nz)\n\n.018\n\n.012\n\n.006\n\n.000\n\n\u2013.006\n\n\u2013.012\n\n\u2013.018\n\n\u2013.024\n7/03/00\n\n17:00:00\n7/19/00\n\n17:00:00\n8/04/00\n\n17:00:00\n\nFig. 9.11 NEAR Doppler residuals\n\nsolution are shown in Fig. 9.11. The ordinate is the measurement residual in hertz.\nA spacecraft radial velocity component of 1 mm/s measured along the line of sight\nfrom a particular DSN tracking station corresponds to approximately 0.054 Hz of\nDoppler phase shift over the count time interval which is typically 60 s. The Doppler\nsignature shown in Fig. 9.11 reveals noise with a periodic amplitude of 0.002 Hz\n(0.03 mm/s) rms.\n\nOptical data residuals are shown in Fig. 9.12. The ordinate of this figure is the\nmeasurement error in pixel(x) or line (y) direction in an image. One line subtends\n165\u00b5rad and one pixel 95\u00b5rad. In a 50 km orbit, the line and pixel measurement\nerror translate to 5.6 m and 3.2 m, respectively, when observing landmarks on the\nends of Eros. The rms of the measurement error is about two lines and pixels\nand permits sub-meter accuracy when more than 3000 optical observations are\nprocessed by the orbit determination filter. High-precision orbits are obtained by\nprocessing optical data since individual landmarks may be located with an accuracy\nof a few meters with respect to the center of mass. With the optical data giving\nhighly accurate orbits with an accuracy of about 1.5 m, the range data are able to tie\ndown the Eros ephemeris.\n\nIncluding the NLR data in the orbit determination solution does not improve the\nspacecraft orbit. The shape model has errors on the order of a hundred meters which\nis far greater than the orbit error. However, the NLR data were useful for determining\na shape model that is accurate to about 100 m. This was accomplished by processing\na high precision spacecraft ephemeris file and Eros attitude file, obtained from the\norbit determination solution, in a separate program that solves only for the shape\nmodel harmonic coefficients and NLR bias parameters. The post fit residuals are\nshown in Fig. 9.13.\n\n\n\n9.4 Near Earth Asteroid Rendezvous 335\n\n20\nN\n\nE\nA\n\nR\n o\n\npt\nic\n\nal\n r\n\nes\nid\n\nua\nls\n\n \u2013\n (\n\npi\nxe\n\nls\n)\n\n15\n\n10\n\n5\n\n0\n\n\u20135\n\n\u201310\n\n\u201315\nline\npixel\n\n\u201320\n7/03/00\n\n17:00:00\n7/19/00\n\n17:00:00\n8/04/00\n\n17:00:00\n\nFig. 9.12 NEAR optical residuals\n\n800\n\nN\nE\n\nA\nR\n\n N\nLR\n\n r\nes\n\nid\nua\n\nls\n \u2013\n\n (\nm\n\n)\n\n600\n\n400\n\n200\n\n0\n\n\u2013200\n\n\u2013400\n\n\u2013600\n\n\u2013800\n4/30/00\n\n17:00:09\n6/01/00\n\n17:00:09\n7/03/00\n\n17:00:09\n8/04/00\n\n17:00:09\n\nFig. 9.13 NLR residuals\n\nThe rms error is 109 m and measurement errors greater than 400 m were rejected\nby the filter. The large rms error of the NLR measurement belies the accuracy of\nthe NLR since this residual error is dominated by modeling errors in determining\nthe shape. The instrument error is only a few meters. Since the modeling error is\nunbiased, a considerable reduction in the determination of the mean radius of Eros\n\n\n\n336 9 Navigation Analysis\n\nmay be expected when the 263,490 NLR observations are processed. Eros volume\nmay be estimated to an accuracy of less than 1% using this solution strategy.\n\n9.4.4 Eros Results\n\nThe solution for Eros\u2019 physical parameters is summarized in Table 9.9.\nThe mass and volume combine to give a bulk density of 2.67 g/cm3 with an\n\naccuracy of 1%. The errors for the pole and GM are at the formal statistical errors\nfrom the solution covariance but scaled higher by a factor of three to give a more\nrealistic error. The GM solution based upon the radio metric data only is very\nsensitive to the initial pole value. The GM solution with the optical data is 10 times\nmore accurate than the radio metric only solution. However, when the pole is fixed\nto the optically determined values, the radio metric GM solution agrees well with\nthe optical solution and the uncertainty decreases.\n\nTable 9.9 Eros physical parameters\n\nParameters Values\n\nSize and density\n\nVolume 2503 \u00b1 25 km3\nBulk density 2.67 \u00b1 0.03 g/cm3\nXcg of figure ?9.7 m\nYcg of figure 2.4 m\n\nZcg of figure 32.6 m\n\nMass properties\n\nMass (6.6904 \u00b1 0.003) \u00d7 1015 kg\nGM (optical radiometric) (4.4631 \u00b1 0.0003) \u00d7 10?4 km3/s2\nGM (radiometric) (4.4584 \u00b1 0.0030) \u00d7 10?4 km3/s2\nGM (radiometric and optical pole) (4.4621 \u00b1 0.0015) \u00d7 10?4 km3/s2\nIxx (normalized) 17.09 km2\n\nIyy (normalized) 71.79 km2\n\nIzz (normalized) 74.49 km2\n\nX principal axis 9.29? East (definition)\nPole (optical)\n\nRight ascension 11.369 \u00b1 0.003?\nDeclination 17.227 \u00b1 0.006?\nRotation rate 1639.38885 \u00b1 0.0005?/day\nPrime meridian 326.06? (at epoch and equinox J2000)\n\nPole (radiometric)\n\nRight ascension 11.363 \u00b1 0.01?\nDeclination 17.230 \u00b1 0.02?\nRotation rate 1639.38922 \u00b1 0.0002?/day\n\n\n\n9.4 Near Earth Asteroid Rendezvous 337\n\n9.4.5 Shape Model\n\nThe Eros shape model obtained from the NLR data is in the form of harmonic\ncoefficients through degree and order 24. One may use the harmonic expansion to\ncompute the radius of Eros as a function of latitude and longitude. The resulting\ntopographic map, shown in Fig. 9.14, reveals two mountainous looking features\nabout the size of Mount Everest. This is an illusion since these features are simply\nthe elongated ends of Eros. The contour lines shown are accurate to about 100 m, and\nthis can be verified by comparing the shape of Eros projected into two dimensions\nto actual images of Eros taken by the MSI. Where the curvature is high, the shape\nmodel error is as high as 200 m.\n\nThe accuracy of the shape model may also be confirmed by computing the radius\nvectors for reference landmarks whose locations have been determined to about\n5 m. The locations of about 43 landmarks were confirmed to be on the shape model\nsurface with an rms error of about 50 m. A few of the landmarks were above or\nbelow the shape model surface by as much as 200 m in the regions of Eros where\nthe nadir pointed NLR intersected the surface at a high incidence angle.\n\nEven though the local variation in the shape model error suggests an accuracy\nof about 100 m, the error in determining the average radius integrated over the\nentire surface is much smaller. The trajectory error and instrument measurement\nerror combined are about 10 m. Since the shape model error associated with the\nharmonic coefficients is unbiased, the error in determining the average radius, which\nis directly related to the volume determination, may be reduced considerably by\ntaking many measurements and statistically averaging. This averaging, which is\nimplicitly performed by the orbit determination filter, is effective when a large\nnumber of measurements are processed, since the error in the average radius is\nreduced by the square root of the number of measurements. For 263,490 NLR\n\nFig. 9.14 Eros shape model\n\n\n\n338 9 Navigation Analysis\n\nmeasurements, the modeling error may be reduced by a factor of about 500, which\nis well below the level where systematic errors dominate. Thus the volume of Eros\nand the low order shape harmonic coefficients may be determined to an accuracy\nof 1% provided the surface is sampled randomly and systematic errors associated\nwith the trajectory and instrument biases are about 10 m. The NLR data acquisition\nstrategy for NEAR resulted in fairly uniform coverage of Eros, owing to the circular\n50 km polar orbit and the relatively rapid rotation of Eros. The random character\nof the sampling is at very small scales. Statistically, NLR samples that measure the\nsurface at the top of boulders are compensated by samples that fall in craters. This\nmathematical property of laser altimetry gives this method a distinct advantage over\noptical imaging where shadows tend to obscure the surface at small scales.\n\n9.4.6 Gravity Harmonics\n\nDetermination of the gravity harmonic coefficients of Eros is a direct result of the\nspacecraft orbit determination process necessary to navigate the spacecraft. The\nharmonic coefficients are estimated by observing the acceleration of the spacecraft\nin orbit. As the spacecraft is maneuvered closer to Eros, the degree of the harmonic\nexpansion must be increased in order to provide the required accuracy for orbit\nprediction. This results in determining Eros gravity field to fairly high precision. At\ndegree 10, the uncertainty or noise in the gravity field is roughly equal to the signal\nas given by the rms of the coefficients.\n\nAn a priori gravity model can be developed by integrating the potential function\nover the shape model determined by NLR or MSI observations assuming constant\ndensity. The results are shown in Table 9.10 for comparison. The close agreement\nof the gravity coefficients obtained from spacecraft dynamics and those obtained\nfrom the NLR-derived shape model provides a high degree of confidence in the\nresults when used for NEAR spacecraft navigation. Since the shape-derived gravity\ncoefficients assumed a constant density, the closeness of the agreement for the two\nsets of coefficient values (Table 9.17) indicates that the material within the interior\nof Eros is nearly of uniform density.\n\nOf particular interest are the first degree and order terms of the harmonic\nexpansions. For the spacecraft orbit solution, these terms were explicitly set to zero\nforcing the center of the coordinate system to coincide with the center of mass of\nEros. Thus, the values of these coefficients from the shape model provide a direct\nmeasure of the offset of the center of figure from Eros center of mass, since the\nvector from the origin to the center of mass may be determined by multiplying the\nfirst degree and order coefficients by the reference radius (16 km). The coefficients\nshown in Table 9.17 reveal that the center of figure offset vector for Eros, obtained\nindependently from NLR measurements, is (?9.7, 2.4, 32.6). This result indicates\nthat the bulk density of the octants of Eros, defined arbitrarily by the planes of\nthe reference coordinate axes, agrees within one percent. This is another strong\nindication of the uniformity of Eros internal structure.\n\n\n\n9.4 Near Earth Asteroid Rendezvous 339\n\nTable 9.10 Eros gravity harmonic coefficients\n\nCoefficient (R0 =16.0 km) Solution spacecraft dynamics Solution shape model integration\nC10 0 0.001175\n\nC11 0 ?0.000348\nS11 0 0.000088\n\nC20 ?0.052478 (0.000051) ?0.052851\nC21 0 0.000102\n\nS21 0 0.000012\n\nC22 0.082483 (0.000061) 0.083148\n\nS22 ?0.027909 (0.000035) ?0.028197\nC30 ?0.001400 (0.000030) ?0.001747\nC31 0.004059 (0.000006) 0.004086\n\nS31 0.003375 (0.000006) 0.003401\n\nC32 0.001791 (0.000016) 0.002127\n\nS32 ?0.000691 (0.000016) ?0.000840\nC33 ?0.010373 (0.000027) ?0.010492\nS33 ?0.012104 (0.000027) ?0.012216\nC40 0.012900 (0.000070) 0.013077\n\nC41 ?0.000106 (0.000014) ?0.000145\nS41 0.000136 (0.000015) 0.000165\n\nC42 ?0.017488 (0.000035) ?0.017647\nS42 0.004577 (0.000030) 0.004624\n\nC43 ?0.000320 (0.000044) ?0.000313\nS43 ?0.000141 (0.000044) ?0.000194\nC44 0.017552 (0.000062) 0.017694\n\nS44 ?0.009009 (0.000061) ?0.009118\n\nThe gravity field of Eros as a function of latitude and longitude is shown in\nFig. 9.15 for harmonics up to degree 8. The gravity field is displayed in milligals\n(1 gal = 1 cm/s ) on a sphere with a radius of 16 km. The central body (GM) term\nof the harmonic expansion is not included in computing the acceleration and this\naccounts for the negative values. Comparison of the gravity field map with the\ntopographic map shown in Fig. 9.14 does not reveal a high degree of correlation.\nThe ends of Eros stand out, but surface features on a smaller scale are not seen.\nThis is because the surfaces of constant gravity potential do not conform well to\nthe shape of Eros and, when displayed on a sphere, the ends of Eros are given more\nweight than the central part. The advantage, however, for displaying the gravity field\non a sphere is that the formal gravity uncertainty is very nearly uniform and is about\n0.3 mgals for coefficients to degree 6 and 2.0 mgals to degree 8. Instead of using\nFig. 9.14, a more meaningful comparison is to compare the Eros gravity map with\nthe gravity map obtained from the Eros shape model assuming constant density.\nSince the gravity map from Eros shape would look very much like the actual Eros\ngravity map, the difference between the two maps is plotted as a function of latitude\n\n\n\n340 9 Navigation Analysis\n\nFig. 9.15 Radial acceleration\n\n90\n\n60\n\n30\n\n0\n\n\u201330\n\n\u201360\n\n\u201390\n\u2013180 \u2013150 \u2013120 \u201390 \u201360 \u201330 0\n\nLongitude (deg)\n30 60 90 120 150 180\n\n5\n\n4\n\n3\n\n2\n\n1\n\n0\n\nA\ncc\n\nel\ner\n\nat\nio\n\nn \n(m\n\nga\nl)\n\nLa\ntit\n\nud\ne \n\n(d\neg\n\n)\n\n\u20131\n\n\u20132\n\n\u20133\n\n\u20134\n\n\u20135\n\nFig. 9.16 Bouguer map\n\nand longitude. This difference map (estimated gravity minus gravity from shape\nintegration) is known as a Bouguer map and is shown in Fig. 9.16 for coefficients\nthrough degree 6. Differences in the gravity field reveal peaks and valleys uniformly\ndistributed over Eros with maxima and minima of 3\u20134 mgal. The Bouguer variations\nare about ten times the formal uncertainty derived from the gravity covariance and\nthese differences are about 1\u20132% of the maximum gravity amplitude.\n\nGiven the Bouguer map, there is no unique solution for the mass distribution of\nEros. Several possible explanations for the observed mass deficiency at the ends of\nEros include a less dense regolith covering on the order of 100 m distributed perhaps\nuniformly over the surface of Eros or a more dense concentration of material near\nthe center of Eros. At degree 6, a 100 m uniform covering with a density contrast\nof 0.6 g/cm3 produces a signature of ?1.0 and ?0.4 mgal at the asteroid ends. The\n\n\n\n9.4 Near Earth Asteroid Rendezvous 341\n\nobserved signature therefore requires a higher density contrast, thicker regolith, or\na variable thickness regolith that may be correlated with greater thicknesses for\nthe highest potential areas. The Bouguer map also displays a shift of the negative\nanomaly to the northern hemisphere indicating less dense material. This may be\nrelated to higher potential areas also being shifted to the north where less dense\nregolith may accumulate. An increase in density of 5% for the central part of Eros,\nin the form of a sphere with 20% of the volume of Eros, results in a ?3.0 mgal\nsignature in the Bouguer map and very nearly matches the observed variation in\nFig. 9.14.\n\n9.4.7 Polar Motion\n\nAn important result that may be obtained from the NEAR data is an estimate of\nthe moments of inertia about the principal axes. As described earlier, the moments\nof inertia provide insight into the radial distribution of mass. Estimates of the\nmoments of inertia cannot be obtained if Eros is in principal axis rotation and there\nis no free precession. Therefore, one of the priorities of the NEAR mission is to\nmeasure the free precession of Eros. Precession results from disturbances of Eros\u2019\nrotational motion from quakes, impacts, or gravitational torques. The free precession\nresulting from distinct events will damp out depending on the rate of internal energy\ndissipation. The forced precession from external gravity sources persists, but is low\nin amplitude. The Sun\u2019s gravity gradient produces a small forced precession and\nnutation.\n\nThe response of Eros to the solar gravity gradient torque depends on the orbit of\nEros, the attitude and body fixed spin vector of Eros at some reference epoch, and the\ninertia tensor. All of these parameters may be solved for with high precision except\nthe diagonal elements of the inertia tensor and the components of spin in body fixed\ncoordinates normal to the spin axis. The second degree gravity harmonic coefficients\nprovide the differences in the values of the diagonal elements of the inertia tensor,\nbut the trace or any one diagonal element is needed to complete the inertia tensor.\nThe complete inertia tensor may be obtained by numerical integration of the shape\nmodel. In order to minimize the error, only the smallest diagonal element is needed\nto complete the gravity harmonic based inertia tensor. Thus, the Ixx term of the\nshape model inertia tensor is used to construct the gravity based inertia tensor.\n\nThe determination of the spin vector components normal to the spin vector is\nneeded to completely determine the free precession of Eros. These spin vector\ncomponents place the angular momentum vector in Eros body-fixed coordinates.\nThe normal spin vector components are too small to be resolved; however, the\nmagnitude of the spin vector can be determined with very high precision. This high\nprecision measurement is obtained by observing for several weeks small craters near\nthe ends of Eros whose motions can be observed at the one meter level. The motion\nof the principal z axis projected onto the sky is shown in the top plot in Fig. 9.17 as\na function of right ascension and declination. The amplitude of the free precession\n\n\n\n342 9 Navigation Analysis\n\nFig. 9.17 Eros polar motion\n\nis about 36 milliarcseconds and the forced precession over 3 days moves the pole\nand angular momentum vector about one arc second. This motion is too small to\ndetect by the orbit determination filter. The precession is about 0.01? over 9 years,\nwhich is well beyond the lifetime of the NEAR mission. However, the short-period\nnutation has an amplitude of 0.02? over 6 months, as shown on the bottom plot of\nFig. 9.17, and this could be detected. The solution obtained by processing 6 weeks\n\n\n\n9.5 MESSENGER 343\n\nof navigation data does not indicate free precession above that induced by the Suns\ngravity. However, this does not rule out free precession from other sources with\namplitudes up to as much as 0.02?.\n\n9.5 MESSENGER\n\nFor a month after the launch of the MESSENGER mission to Mercury, the\nspacecraft trajectory was perturbed by nongravitational accelerations that resulted in\na migration of several thousand kilometers in the target B-plane. It is speculated that\nthe accelerations were due to outgassing of water trapped in the composite materials\nof the spacecraft. Nongravitational accelerations are difficult to model, leading to\ninconsistent solutions for the spacecraft state from Doppler and range data. These\nnongravitational accelerations may be modeled as a sum of exponentially decaying\nstochastic vectors with different correlation times.\n\nImmediately after a spacecraft is launched on an interplanetary trajectory,\ntracking data is acquired, and an orbit determination solution is computed for\nthe outgoing trajectory and mapped to the target planet. The initial solution\nincludes estimates of the spacecraft state, and of small turbulent accelerations that\nact on the spacecraft during the first few weeks, referred to as nongravitational\naccelerations. These accelerations are usually attributed to errors in the solar\npressure or propulsion models. Although nongravitational accelerations are very\nsmall, on the order of 10?11 km/s2, the orbit determination process is very sensitive\nto them. When they are not estimated accurately, it is difficult to obtain convergence,\nand the Doppler and range solutions are inconsistent. After a few weeks, the\nnongravitational accelerations diminish, and good solutions are obtained. However,\nafter the Viking spacecraft was launched, significant nongravitational accelerations\nattributed to air trapped in the lander parachute were observed for several weeks.\n\nFor a month after the launch of the MESSENGER mission to Mercury, the\nspacecraft was perturbed by nongravitational accelerations that resulted in a migra-\ntion of several thousand kilometers in the target B-plane. These accelerations were\ngreater in magnitude and lasted longer than usual. It is conjectured that they may\nbe attributed to outgassing of water vapor and other gases trapped in the newer\ncomposite materials of the spacecraft.\n\nIt is difficult to model accelerations due to volatile elements escaping from\nthe spacecraft, which are assumed to be comprised of water vapor, and radiate in\nall directions. Only the total acceleration of the spacecraft can be estimated from\nDoppler and range data. Most volatile elements evaporate after a few days. Isotropic\nradiation (in all radial directions equally) results in negligible net acceleration of\nthe spacecraft, and would not be observed. However, differences in the surface\ntemperature of the spacecraft would result in anisotropic radiation. Initially, more\ngas would radiate toward the Sun, resulting in net accelerations away from the Sun.\nLater, because the same amount of gas is present on both sides, the net acceleration\nwould be toward the Sun. The correlation time of surfaces exposed to the Sun would\n\n\n\n344 9 Navigation Analysis\n\nbe greater than that of surfaces in shade. A stochastic model of gas radiated with\nseveral correlation times seems appropriate.\n\n9.5.1 Initial Post-Launch Orbit Determination\n\nAfter launch, the data types were X-band Doppler and range, with one sigma\nerrors of 0.1 mm/s and 0.7 m, respectively. Figure 9.18 displays Doppler and range\nresiduals from initial orbit determination results for the first month after launch\nof the MESSENGER mission. Only one stochastic vector is used to represent\n\nFig. 9.18 Doppler data only solution\n\n\n\n9.5 MESSENGER 345\n\nnongravitational accelerations. The data arc extends from shortly after launch on\n8/3/04 07:13:35 GMT and extends to 9/4/2004. The estimated parameters are the\ninitial state, Earth ephemeris, a propulsive maneuver on 8/24/2004, solar pressure\nmodel parameters and one stochastic acceleration vector Ae?t/? , where A is a\nstochastic three-dimensional vector with white noise components of one sigma\n1 \u00d7 10?12 km/s2 (one nanometer/s2), and ? is a 2-day correlation time (172,800 s).\nOne such vector has usually been adequate to model nongravitational accelerations\nafter launch. The data consisted of radiometric Doppler weighted at 6 mHz and\nloosely weighted range. It shows an apparent range bias of 1000 range units (about\n143 m) until the first maneuver and about 200 range units after the maneuver. The\nDoppler residuals show an rms error of about 10 mHz (0.175 mm/s) for the first 9\ndays decreasing to about 6 mHz there after. The early sinusoidal signature in the\nDoppler data can be attributed to a slow spacecraft spin which was not modeled.\n\nFigure 9.19 shows the same data arc and estimation strategy, but the Doppler\ndata is loosely weighted and the range data is weighted at 500 range units. Now\nthe range solution fits well, but the Doppler signature shows scalloping that might\nbe attributed to a time error. It is unlikely that the discrepancy between Figs. 9.18\nand 9.19 can be explained by problems with the data. The observed error must\nbe attributable to a common source, which could not be a tracking station, since\ntracking stations around the Earth all give consistent results. The likely cause of this\ndiscrepancy is unmodeled accelerations acting on the spacecraft. A more accurate\nmodel for the accelerations is required.\n\nOne way to model a stochastic acceleration would be to represent each\ncomponent as an orthogonal series, such as a Fourier sine series or a set of\nTchebyshev polynomials. The coefficients would be estimated as stochastic\nparameters. The interval of the series expansion would move forward in time\nas batches of data are processed, and as noise introduced to the filter modulates the\ncoefficients.\n\nHere an alternate approach is applied. The orbit determination filter is already\ndesigned to process one exponentially correlated stochastic vector. Instead, a sum of\nseveral exponentially correlated stochastic acceleration vectors with generic integer\ncorrelation times is used. For five sets of stochastic acceleration vectors, a total of\n15 components are estimated. To illustrate the method, MESSENGER Doppler and\nrange tracking data are processed from launch through the first 4 months of the\nmission. The resulting time history of nongravitational accelerations is analyzed to\nverify the reasonableness of the results. The suspected outgassing could come from\nseveral sources. A single stochastic acceleration vector may not suffice because the\ntime constant of the exponential decay is unknown and more than one source may\nbe present. This suggests a stochastic model consisting of a sum of exponentially\ndecaying stochastic acceleration vectors with varying time constants. While one\nmight expect such a series to model effectively only processes that are exponentially\ndecaying, it will be shown later that such a model can represent any function over\na reasonable time interval much the same as a half range Fourier expansion can\nbe used. Figure 9.20 shows the result for the same data arc where the number of\nstochastic acceleration vectors was increased from one to five with correlation times\n\n\n\n346 9 Navigation Analysis\n\nFig. 9.19 Range data only solution\n\nof 1, 2, 4, 8, and 16 days. A much better fit to the data is obtained. The position and\nvelocity errors along the line-of-sight from the tracking stations are less than 20 m\nand 0.1 mm/s, respectively.\n\nIn Fig. 9.21, the time history of stochastic nongravitational accelerations\nattributable to outgassing is broken down by components. Ax is the component\nof the acceleration along the spacecraft-Sun line. The Ay and Az acceleration\ncomponents are normal to the Sun line with Ay in the orbit plane and Az normal\nto the orbit plane. Solar pressure acceleration is not included. It would contribute\nanother 60 nm/s2 in the Ax direction. The accelerations were obtained by summing\nthe five stochastic acceleration vectors described above. The dominant component\nis along the Sun line away from the Sun as one might expect. The volatile elements\non the Sun side of the spacecraft would be heated to a higher temperature and\n\n\n\n9.5 MESSENGER 347\n\nFig. 9.20 Doppler and range data solution\n\nconsequently apply more force in this direction. The reversal in direction of the\nnormal components would be explained by the presence of different sources\noutgassing in a given direction. One source would expel gas with a short time\nconstant and be over taken by another source with a longer time constant.\n\nThe individual components of the acceleration along the Sun line due to the\nexponential model with various correlation times are shown in Fig. 9.22. Initially,\nthe acceleration is dominated by components with 1-day and 8-day correlation\ntimes. After several weeks, the 8-day and 16-day components dominate. The\nmigration from high frequency to low frequency components is consistent with the\ninitial outgassing of the more highly volatile elements with short time constants.\n\n\n\n348 9 Navigation Analysis\n\n40\n\n30\n\nAx\n\nAx Acceleration away from Sun\nAy Acceleration normal to Sun\n     line in orbit plane\nAz Acceleration normal to\n     orbit plane\n\nAz\n\nAy\n\n20\n\n10\n\nA\ncc\n\nel\ner\n\nat\nio\n\nn \n\u2013 \n\n(n\nm\n\n/s\n2 )\n\n0\n\n\u201310\n\n\u201320\n\n\u201330\n\n\u201340\n8/03/04\n\n00:00:00\n8/11/04\n\n00:00:00\n8/19/04\n\n00:00:00\n8/27/04\n\n00:00:00\n\nFig. 9.21 Outgassing acceleration time history\n\nFig. 9.22 Stochastic acceleration components along the sun line\n\n\n\n9.5 MESSENGER 349\n\nAfter the supply of gas is largely exhausted, the longer time constant, less volatile\nelements then dominate, but at a diminished amplitude.\n\nThe filter can go unstable if too much stochastic white noise is introduced. It\nis desirable to have a stochastic model with coefficients that vary slowly as the\nacceleration is changing. Since the correlation time of each component is fixed,\nthe filter adjusts the amplitude of each component at the beginning of each batch\nof data that is processed. This adjustment must be small since the a priori white\nnoise is only 1.0 nm/s2 while the observed acceleration is as high as 40.0 nm/s2. The\nexponential character of each of the components confirms that small adjustments\nare taking place.\n\nFigure 9.23 shows Doppler and range residuals for a long arc solution from\nlaunch to December 9, 2004. The filter estimation strategy is the same, but two\nadditional maneuvers on September 24, 2004 18:00:46 GMT and November 18,\n2004 19:31:04 GMT are included. The rms range error is less than 70 range units or\n10 m over the entire data arc. The solution mapped to the B-plane at Earth return in\nAugust of 2005 is within a few hundred km of short arc solutions with data through\nMay of 2005.\n\nFigure 9.24 shows the outgassing acceleration history for the long arc solu-\ntion. The solution is good through mid November where accelerations of about\n5.0 \u00d7 10?12 nm/s2 appear. These are probably associated with some unmodeled\naccelerations related to attitude and solar pressure mismodeling. Attempts to extend\nthe long arc solution beyond December 9, 2004 into January of 2005 resulted in the\nsolution migrating a few thousand km in the b-plane at Earth return on August 3,\n2005. While this error is small for this time in the mission, orbit determination and\nlong term prediction require high precision modeling of small accelerations on the\norder of 1.0 \u00d7 10?12 nm/s2.\n\n9.5.2 Estimated Accelerations from Assumed Water Vapor\n\nFigure 9.24 indicated that the magnitude of the unmodeled accelerations was\napproximately 40.0 nm/s2. If water vapor is the dominant source, it would be\nof interest to compute the amount of water necessary to cause the observed\naccelerations. The kinetic theory of gases will be used to determine the net thrust.\nGas vented to space applies an acceleration to a spacecraft in a manner similar to\nthat of a rocket engine. A small amount of gas released to space from a spacecraft\nwill expand to the vacuum of space and exert a pressure against the spacecraft.\nGas confined to a closed container would produce no net force. Gas evaporating\nfrom materials in the side of the spacecraft would expand against the side of the\nspacecraft, but be unobstructed in the direction away from the spacecraft, resulting\nin a net pressure transient and acceleration of the spacecraft. From Newton\u2019s laws,\nthe pressure of a gas on a spacecraft is equal to the rate of change of momentum\nassociated with the gas molecules striking the spacecraft.\n\n\n\n350 9 Navigation Analysis\n\nFig. 9.23 Filter performance over 4 months\n\nThe velocity of a gas molecule may be obtained from the kinetic theory of gasses\n(Eq. 1.46) and is given by\n\nv?2 = 3RT\nM\n\nIf it is assumed that the gas is vented at a constant rate, then from Newton\u2019s law,\n\nF = v? dm\ndt\n\n= MscAsc\n\nwhere m is the mass of gas vented, Msc is the spacecraft mass, and Asc is the\nspacecraft acceleration. Solving for the gas mass flow rate,\n\n\n\n9.5 MESSENGER 351\n\n40\n\n30\n\nAx\n\nAx Acceleration away from Sun\nAy Acceleration normal to Sun line\n     in orbit plane\nAz Acceleration normal to orbit plane\n\nAz\n\nAy\n\n20\n\n10\n\nA\ncc\n\nel\ner\n\nat\nio\n\nn \n- \n\nm\n/s\n\n2\n\n0\n\n\u201310\n\n\u201320\n\n\u201330\n\n\u201340\n8/03/04\n\n00:00:00\n10/06/04\n00:00:00\n\n12/09/04\n00:00:00\n\nFig. 9.24 Outgassing solution over 4 months\n\ndm\n\ndt\n= Msc?\n\n3RT\nM\n\nAsc\n\nFrom Fig. 9.24, the spacecraft acceleration component attributable to outgassing is\nobserved to decay exponentially after launch with a time constant (? ) of about 5\ndays.\n\nAsc = A0e\n?t\n?\n\nwhere A0 = 4.0 \u00d7 10?8 m/s and ? = 432, 000 s. After substituting the spacecraft\nacceleration and integrating from 0 to ?, the total mass of gas expended is\n\n?m = MscA0??\n3RT\nM\n\nIf the gas expended is water vapor (M = 0.018 kg/mol) at room temperature (293?\nK), the total amount of water vapor expended is approximately 0.014 kg. For this\ncalculation, the gas constant (R) is 8314 kg \u00b7 m2/(s2 \u00b7 mol \u00b7 K), and the mass of the\nspacecraft (Msc) is 512 kg. Using 61 cubic inches of water per kilogram, less than\none strategically placed cubic inch of water can cause the observed acceleration.\nSomewhat more water would be needed if distributed over the spacecraft.\n\n\n\n352 9 Navigation Analysis\n\n9.5.3 Curve Fitting with Exponential Functions\n\nThe functions chosen for modeling are stochastic exponentials because one such\nfunction is built into the stochastic model and filter used for orbit determination. It\nmight be expected that a series of exponentially decaying functions would only\nbe effective when applied to the modeling of exponentially decaying processes.\nHowever, a truncated series of this type can be shown to represent any piecewise\ncontinuous function on an interval as effectively as that of other truncated series\nrepresentations by common orthogonal functions that arise from Sturm-Liouville\nproblems, such as half-range expansions or polynomial series.\n\nFigure 9.25 shows a comparison of a triangle function, over an interval normal-\nized from 0 to 1, with several fifth degree representations. The coefficients of a sine\nseries was computed from the half range Fourier expansion and by least squares.\nSurprisingly, the least squares fit does much better than the Fourier expansion. A\nsum of 5 decaying exponentials with varying time constants was fit to the same\ntriangle. It is even more surprising that the decaying exponentials did better than the\nFourier series. The apparent explanation is that the least square fit is able to better\nalias the higher degree terms that are simply truncated by the Fourier series. One\nreason for the difference is the criterion for best estimate of f(t) on the interval [0,1].\nThe least squares best estimate f? of the form\n\nf? (x) =\nN?\n\nn=1\nCnsin(nx)\n\nFig. 9.25 Comparison of triangle function with various representations\n\n\n\n9.5 MESSENGER 353\n\nis to choose the constants Ci to minimize\n\nm?\ni=1\n\n(\nf? (xi) ? f (xi)\n\n)2\n\nwhere x1, . . . xm are measurement points in the interval [0, 1]. The constants in the\nFourier series estimate for f(x) are computed by integration on [0,1]\n\nCn =\n? 1\n\n0\nf (x) sin(nx)dx\n\nand minimize\n\n? 1\n0\n\n|f? (x) ? f (x)|2 dt\n\nIn order to gain some insight into the nature of curve fitting versus expansions\nbased on orthogonal functions, consider the ramp function shown in Fig. 9.26. The\nfirst five terms of the convergent Fourier half range expansion is compared with a\nleast square fit to the same sine function series, a least square fit to a sum of decaying\nexponential functions and power series obtained from both the sine function and\nexponential function sum. The curve fitting and power series methods result in a\nhigh precision fit over the interval [0,1], while the Fourier series, by comparison,\ndoes not perform very well.\n\nFig. 9.26 Comparison of ramp function with various representations\n\n\n\n354 9 Navigation Analysis\n\nThe reason is obvious from close examination of the power series method for the\ndecaying exponentials. We approximate each exponential function by the first five\nterms of its power series expansion.\n\ne?xn ? 1 ? nx + n\n2\n\n2! x\n2 ? n\n\n3\n\n3! x\n3 + n\n\n4\n\n4! x\n4 ? n\n\n5\n\n5! x\n5\n\nSuppose an arbitrary function of x is represented as a sum of five exponentially\ndecaying functions.\n\nf (x) ?\n5?\n\nn=1\nCn e\n\n?xn\n\nso that\n\nf (x) =\n5?\n\nn=1\nCn(1 ? nx + n\n\n2\n\n2! x\n2 ? n\n\n3\n\n3! x\n3 + n\n\n4\n\n4! x\n4 ? n\n\n5\n\n5! x\n5)\n\nTo fit the ramp function, the\n?\n\nn Cn must be 1 and all the Cn associated with\npowers of x multiplied by the appropriate factors in the exponential series must sum\nto 0. The ramp function has only the linear term. All the other powers of x must be\nannihilated. In matrix notation the above equation becomes\n\n?\n?????????????????????????\n\n1 1 1 1 1 1\n\n0 ?1 ?2 ?3 ?4 ?5\n\n0\n1\n\n2!\n22\n\n2!\n32\n\n2!\n42\n\n2!\n52\n\n2!\n\n0\n1\n\n3!\n23\n\n3!\n33\n\n3!\n43\n\n3!\n53\n\n3!\n\n0\n1\n\n4!\n24\n\n4!\n34\n\n4!\n44\n\n4!\n54\n\n4!\n\n0\n1\n\n5!\n25\n\n5!\n35\n\n5!\n45\n\n5!\n55\n\n5!\n\n?\n?????????????????????????\n\n?\n????????\n\nC0\n\nC1\n\nC2\n\nC3\n\nC4\n\nC5\n\n?\n????????\n\n=\n\n?\n????????\n\n0\n1\n0\n0\n0\n0\n\n?\n????????\n\nInverting the matrix and multiplying times the right side results in the following\ncoefficients.\n\n{Cn} = {217\n60\n\n, ?5, 5, ?31\n3\n, 1\n\n1\n\n4\n, ?1\n\n5\n}\n\n\n\n9.6 New Horizons 355\n\nThe error in the power series expansion is caused by the higher than 5? terms of\nthe exponential series that have been truncated. If a least square fit of the data over\nthe interval 0\u20131 is performed, the error will be less because the truncation error is\naliased. The coefficients for the least square fit that are directly comparable to Cn are\n\n{Cn} = {2.78, ?8.15, 12.99, ?13.50, 7.73, ?1.85}\n\nObserve that the least square coefficients {Cn} are greater than the power series\ncoefficients {Cn}. Given any collection of functions with enough available powers of\nx, the least squares solution will effectively generate a power series representation\nof the function to be modeled.\n\nA least squares series solution using a small number of functions is clearly better\nable to alias the error from truncating higher order terms, but as more terms are\nadded to a least squares solution, all lower order constants Ci must be recomputed,\nand experimentation indicates the constants Ci can grow without bound. This\nobservation is more apparent for the triangle function. The properties of orthogonal\nseries of eigenfunctions such a Fourier series are well known, and may be found in\nany reference that discusses Sturm-Liouville theory and boundary value problems.\n\n9.6 New Horizons\n\nNavigation of the New Horizons spacecraft during approach to Pluto and its satellite\nCharon presented several new challenges related to the distance from the Earth\nand Sun and the dynamics of two body motion when the mass ratio results in the\nbarycenter being outside the radius of the primary body. Since the Earth is about\n30 a.u. from the spacecraft during the approach to Pluto and Charon, the round trip\nlight time is greater than 8 h making two-way Doppler tracking difficult. The great\ndistance from the Sun also reduces the visibility of Pluto since Pluto receives about\n1/900 of the solar radiation as the Earth. The two body motion involves Pluto and\nCharon moving in elliptic orbits about each other, and the system mass is a simple\nfunction of the period and semi-major axis of the orbit. The period can be measured\nto high precision from Earth based telescope observations and the orbit diameter\ncan be measured to a precision of perhaps 100 km enabling the system mass to be\ndetermined within 1 %.\n\nThe mass ratio or the allocation of mass between Pluto and Charon is more\ndifficult to discern from Earth based observations. Pluto and Charon orbit about\ntheir barycenter in elliptical orbits whose semi-major axes are inversely proportional\nto their mass. Therefore, the mass ratio can only be determined by observing the\nmotion on a star background over some time and removing the heliocentric orbital\nmotion. Since these measurements are difficult to make from Earth based telescopes,\nit is expected that the mass ratio and corresponding orbit sizes about the barycenter\nwill not be determined accurately until spacecraft based optical measurements are\nobtained during approach.\n\n\n\n356 9 Navigation Analysis\n\nThe New Horizons approach navigation strategy must be designed to enable\nprecision determination of the Charon orbit about Pluto and the spacecraft orbit\nrelative to Pluto and Charon as well as to control the spacecraft approach trajectory\nand deliver the spacecraft to a position for science observations. The initial\nnavigation activity after detection of Pluto is to separate the orbit of Charon from\nthe orbit of Pluto about their common barycenter. In order for these observations\nto be useful, Charon must be separated from Pluto by more than 100 pixels. As a\nby product, a more precise estimate of the system mass and spacecraft trajectory is\nobtained. As the spacecraft approaches the planetary system, the aim point relative\nto Pluto and the timing of Charon in its orbit is determined to an accuracy that\npermits an orbit correction maneuver to be executed so that the spacecraft is placed\non the correct trajectory for science observations. If a substantial time adjustment\nis necessary to intercept Charon in its orbit about Pluto, it is important that this\nmaneuver be performed as early as possible. Time change maneuvers are expensive\nto perform when the spacecraft is close to the Pluto/Charon system. During the\napproach to Pluto and Charon, the time of closest approach is not well determined.\nThe error in the time of closest approach is proportional to the error in the range from\nEarth which is dominated by the Pluto and Charon ephemeris error. The distance of\nthe spacecraft from Pluto and Charon cannot be determined with high precision until\nthe spacecraft is close enough to observe the position parallax. This occurs during\nthe final 1\u20132 days before encounter for Pluto only observations or during the final\n2\u20134 days before encounter for observations of both Pluto and Charon. The timing\nof science observations during flyby is critically dependent on knowledge of the\ntime of closest approach. A late update of the encounter sequence timing is planned\nbased on optical navigation images acquired during approach.\n\n9.6.1 Pluto and Charon Approach\n\nThe Pluto/Charon approach phase begins at about 120 days prior to Pluto encounter.\nNavigation activities that are performed during the approach phase include initial\ndetection of Pluto, search for co-orbitals, ephemeris refinement, and a sequence of\napproach maneuvers that are designed to place the spacecraft on a trajectory that\nis optimum for science observations. The detection of Pluto as early as possible\nis advantageous from the standpoint of ephemeris verification and improvement\nto assure early tracking in support of the initial approach TCM and subsequent\nmaneuvers. The optical measurement is obtained from an image of either Pluto\nor Charon using the LORRI or MVIC camera. The accuracy of this data type\nis a function of the picture element (pixel) spacing and the focal length of the\ncamera optics. For the LORRI camera, the resolution is about 5\u00b5rad per pixel\nand for the MVIC the resolution is about 20\u00b5rad per pixel. Detection depends on\nPluto\u2019s brightness as seen from the spacecraft and the imaging cameras sensitivity.\nThe sensitivity of the camera depends on its light gathering capability (i.e., its\naperture), the lens/filter/sensor light transfer and conversion efficiency, and the\n\n\n\n9.6 New Horizons 357\n\n15\n\n10\n\n5\n\n0\n0 50 100 150 200 250\n\nDays from Pluto encounter\n\nPluto apparent magnitude = 10 at P - 510 days\n\nCharon apparent magnitude = 10 at P - 210 days\n\nA\npp\n\nar\nen\n\nt M\nag\n\nni\ntu\n\nde\n\n300 350 400 450 500 550 600\n\nPluto\nCharon\n\nFig. 9.27 Pluto/Charon apparent magnitude\n\nvarious electronic processes that produce image noise. The MVIC and LORRI\ncameras are able to detect an object when the brightness is greater than magnitude\n10. Figure 9.27 gives the apparent magnitude of Pluto and Charon as the spacecraft\napproaches the system. The figure shows the point on approach at which the\ntheoretical apparent magnitude is brighter than magnitude 10 for Pluto and Charon.\nPluto reaches apparent magnitude 10 at about 510 days prior to closest approach\nand Charon at about 210 days prior to closest approach.\n\nAs the spacecraft range closes, Pluto\u2019s image will become brighter and expand\nthus improving the optical navigation image location accuracy. Optical navigation\nbegins to exceed the performance of Earth-based observations approximately when\nthe spacecraft camera resolution exceeds that of Earth-based telescopes. Figure 9.28\nshows the resolution of the two spacecraft cameras as a function of time from\nPluto. A value of 0.043 arcsec/pixel is used as the reference Hubble resolution of\nthe Wide Field Planetary Camera. The plot shows that resolution of the primary\nMVIC camera becomes better than that of Earth-based observations at 44 days\nbefore the encounter, whereas the LORRI camera resolution exceeds the Earth-\nbased resolution at 170 days before the encounter.\n\n9.6.2 Pluto Approach Time-of-Flight Determination\n\nAs the spacecraft approaches Pluto and Charon from a great distance, the orbit\ndetermination error relative to Pluto is a statistical combination of the independently\ndetermined spacecraft and Pluto ephemeris errors. The spacecraft is initially too\nfar from Pluto to make use of direct observation of Pluto. As the spacecraft enters\n\n\n\n358 9 Navigation Analysis\n\n7000\n\n6000\n\n5000\n\n4000\n\n3000\n\n2000\n\n1000\n\n0\n0 50 100\n\nDays from Pluto encounter\n\nC\nam\n\ner\na \n\nre\nso\n\nlu\ntio\n\nn \n(1\n\n p\nix\n\nel\n) \n\n- \nkm\n\n150 200\n\nLORRI: 170 days\n\nMVIC: 44 days\n\nMVIC\nLORRI\nHubble ST\n\nFig. 9.28 Camera resolution versus hubble space telescope\n\nPluto\u2019s sphere of influence, the Doppler and range measurements are able to detect\nthe gravitational acceleration of the Pluto/Charon system and the onboard optical\nnavigation camera is able to detect the Pluto and Charon angular position on the star\nbackground. These measurements, either processed separately or in combination,\ncan determine the approach velocity and position in the B-plane with high precision.\nThe velocity determination error is within 1 mm/s in all three Cartesian components\nand the position error is about 5\u00b5rad times the range from the spacecraft to Pluto\nfor the two Cartesian components in the B-plane. The third component of position,\nalong the down track or time-of-flight direction, is not very well determined.\nThe time-of-flight error is determined by observation of the Pluto gravitational\nacceleration by the Doppler and range data or the position parallax associated with\nthe angular motion of Pluto and Charon on the star background.\n\nFor Doppler data, an approximate analytic formula for the time-of-flight error\nmay be derived that provides insight into the problem of time-of-flight or range-\nto-go determination. The time-of-flight error is simply the range-to-go distance\nerror times the approach velocity (V?). The geometry is illustrated in Fig. 9.29. As\nthe spacecraft approaches Pluto, it is accelerated by Pluto\u2019s gravity. The approach\nvelocity magnitude and direction is known to very high precision as a result of\ntracking the spacecraft and observing Pluto\u2019s motion for years. The velocity along\nthe line-of-sight from Earth (??) can also be measured with high precision by the\nDSN. The change in velocity magnitude is given by\n\n?v = r? ? V?\n\n\n\n9.6 New Horizons 359\n\nFig. 9.29 Planetary approach\ndoppler measurement\naccuracy Spacecraft\n\nEarth\n\nPlanet\n\n?dop r\n\nr\n\nThe velocity change can be obtained by integrating the gravitational acceleration\nduring approach to Pluto.\n\n?v =\n? t\n\n??\nGMp\n\nr2\ndt\n\nSince the integrated acceleration is small relative to V?, the range may be\napproximated by\n\nr ? V? t\n\nand\n\n?v ?\n? t\n\n??\nGMp\n\nV 2? t2\ndt\n\nresulting in\n\n?v ? ?GMp\nV 2? t\n\nThe sensitivity of the approach velocity with respect to time-of-fight variation is\nobtained by taking the partial derivative.\n\n??v ? GMp\nV 2? t2\n\n?t\n\nThe sensitivity of the Earth line-of-sight range rate to approach velocity is simply\nits projection onto the approach velocity vector and\n\n??? ? GMp cos ?dop\nV 2? t2\n\n?t\n\n\n\n360 9 Navigation Analysis\n\nFig. 9.30 Planetary approach\noptical measurement accuracy\n\nSpacecraft\n\nPlanet\n\nr\n\ns\n\naopt\n\nB\n\nA formula for the time-of-flight error (?(t)) as a function of time from Pluto and\nDoppler measurement error is then given by\n\n?(t) ? V\n2? t2\n\nGMp cos ?dop\n? (??)\n\nFor optical data, another approximate formula may be derived for the time-of-\nflight error. The geometry is illustrated on Fig. 9.30. As the spacecraft approaches\nPluto from a great distance, images of Pluto on a star background provide a\nstrong determination of the direction of the approach asymptote. As the spacecraft\napproaches Pluto, the angular position of Pluto on the star background will begin\nto move away from the approach asymptote direction because of position parallax.\nThe observation of Pluto\u2019s motion on the star background may be used to determine\nthe range-to-go and time-of-flight.\n\nFrom the geometry, the tangent of the angle between Pluto and the approach\nvelocity vector is given by\n\ntan ?opt = B\ns\n\nThe distance (s) from the spacecraft to the B-plane may be approximated by\n\ns ? V? t\n\nTaking the partial derivative of ?opt with respect to t gives\n\nsec2?opt ??opt ? ?B\nV? t2\n\n?t\n\nThe formula for the time-of-flight error as a function of time from Pluto closest\napproach and optical measurement error is then given by\n\n?(t) ? V? t\n2\n\nB cos2 ?opt\n? (?opt )\n\n\n\n9.6 New Horizons 361\n\nFig. 9.31 Analytic Pluto approach time-of-flight error\n\nThe error in the time-of-flight estimation as a function of time from Pluto\nclosest approach is shown in Fig. 9.31 for Doppler data, Doppler and Pluto optical\ndata and Doppler, Pluto optical and Charon optical data. For this analysis V? is\n13.7 km/s, B is 13,000 km for the aim point and 19,000 km for the radius of Charon\u2019s\norbit and ?dop is 14?. The Doppler and optical measurement errors are 1.1 mm/s\nand 5\u00b5rad, respectively, assuming the LORRI camera. Pluto observation science\nrequires knowledge of the time-of-flight to be less than 100 s which corresponds\nto about 1300 km down track error. As shown in Fig. 9.29, the Doppler only orbit\ndetermination error does not decrease below 100 s until about 6 h before closest\napproach, too late to be of use for a science instrument pointing update. With optical\ndata, the time-of-flight error is about 39 s 1 day before Pluto closest approach. The\naddition of Charon optical data decreases the error about 50% from that obtained\nwith only Pluto optical data. The Charon orbit baseline is about 50% greater than\nthe baseline provided by the approach asymptote aim point and Pluto.\n\n9.6.3 Pluto and Charon Approach Covariance Analysis\n\nA detailed covariance analysis was performed of navigation and orbit errors during\napproach to Pluto and Charon. This analysis included all the error sources that\naffect navigation accuracy and the data acquisition strategy that will be used. The\norbit determination error is determined by filtering simulated data using the same\nsquare root information filter that will be used for flight operations. The filtered best\n\n\n\n362 9 Navigation Analysis\n\nestimate of the orbit is mapped to Pluto closest approach to provide a common basis\nfor comparison.\n\nDuring approach to the Pluto/Charon system, the spacecraft orbit determination\nerror relative to Pluto is a statistical combination of the spacecraft ephemeris error\nand the planet ephemeris error. Both of these ephemerides are determined by Earth\nbased observations. The spacecraft ephemeris error is determined by radio metric\ntracking data acquired by the DSN and the planet ephemeris error is determined\nby telescope observations. Both of these determinations are accurate to about one\nthousand kilometers. For the Pluto ephemeris error, it is assumed that an observation\ncampaign will be conducted about 1 year before Pluto encounter to reduce the\neffect of long-term velocity mapping errors. An approach ephemeris error of several\nthousand kilometers is sufficient to ensure initial acquisition of Pluto and control the\napproach to Pluto/Charon until optical data is acquired by the imager onboard the\nspacecraft. The approach navigation strategy is to acquire radio metric and optical\ndata during the distant approach and refine the spacecraft orbit relative to Pluto. A\nsequence of maneuvers are planned to maneuver the spacecraft to the desired aim\npoint in the Pluto B-plane. These maneuvers are scheduled after performing a trade\nbetween the improved knowledge of the spacecraft orbit as more data is acquired\nand the cost in propellant of delaying the adjustment to the aim point.\n\nThe estimated parameters during approach to Pluto and Charon include space-\ncraft state, propulsive maneuver components, solar pressure model parameters,\nstochastic accelerations and Pluto and Charon ephemerides, gravity, pole, prime\nmeridian, and rotation rate. For navigation, the accuracy of spacecraft ephemeris\nestimation is of prime interest. The sensitivity of the spacecraft ephemeris estima-\ntion error for various data acquisition strategies in shown in Figs. 9.32 through 9.34.\nOn these figures, the spacecraft position error is shown as a function of time\nfrom Pluto closest approach mapped to the Pluto B-plane. Figure 9.32 shows the\nspacecraft orbit determination error for Doppler and range data starting at 20 days\nbefore Pluto encounter and continuing to encounter. Prior to encounter minus 20\ndays, the Doppler and range data cannot measure the Pluto/Charon gravitational\nacceleration and the orbit is determined from Earth based observations. As can be\nseen in Fig. 9.32, the Doppler and range orbit determination error does not improve\nuntil a few hours before encounter which is consistent with the analytic result\nshown in Fig. 9.31 for the time-of-flight error. Studies of planetary approach orbit\ndetermination show that the B-plane position errors are theoretically one half the\ndown track position or time-of-flight error. Since the down track (s) position error is\nequal to V? times the time-of-flight error the numerical values shown in Fig. 9.32 a\nfew hours before encounter for the B-plane position are roughly a factor of 26 times\nthe time-of-flight numerical values allowing for the mixed units.\n\nFigure 9.33 shows the spacecraft orbit determination error when optical obser-\nvations of Pluto are included with the radio metric data. The components of\nthe spacecraft position error in the B-plane, the plane normal to the approach\nvelocity vector, are reduced proportional to the range from Pluto times the angular\nmeasurement error. The angular measurement error is 5\u00b5rad associated with the\nLORRI camera. For the MVIC camera, these results should be inflated by about\n\n\n\n9.6 New Horizons 363\n\n100000\n\n10000\n\n1000\n\n100\n\n10\n-20 -15 -10\n\nDays from Pluto Closest Approach\n\nPluto  B-Plane Error Mapping\n\nBSIGMX (km)\nBSIGMN (km)\n\nTOF (s)\n\nB\nS\n\nIG\nM\n\nX\n/B\n\nS\nIG\n\nM\nN\n\n/T\nO\n\nF\n (\n\n1 \nS\n\nig\nm\n\na)\n\n-5 0\n\nFig. 9.32 Pluto approach\u2014Doppler and range data only\n\n10000\n\n1000\n\n100\n\n10\n\n1\n-20 -15 -10\n\nDays from Pluto Closest Approach\n\nPluto  B-Plane Error Mapping\n\nBSIGMX (km)\nBSIGMN (km)\n\nTOF (s)\n\nB\nS\n\nIG\nM\n\nX\n/B\n\nS\nIG\n\nM\nN\n\n/T\nO\n\nF\n (\n\n1 \nS\n\nig\nm\n\na)\n\n-5 0\n\nFig. 9.33 Pluto approach\u2014Doppler, range and optical imaging of Pluto\n\n\n\n364 9 Navigation Analysis\n\na factor of four (20\u00b5rad). Several events occur during approach that temporarily\ndistort this simplified analysis. Most notably, a propulsive maneuver executed at\nencounter minus 7 days inflates the mapped orbit determination error until the\nDoppler and range data are able to resolve the spacecraft velocity a couple of days\nlater. At about encounter minus 13 days, the B-plane errors are suddenly reduced\nby the introduction of new optical images. A uniform reduction in B-plane position\nerror occurs when the images are acquired on a uniform time schedule as occurs\nfrom encounter minus 13 days through encounter. Throughout the approach to Pluto,\nuntil a few days before encounter, the time-of-flight error remains essentially the\nsame as for the Doppler and range only case shown in Fig. 9.32. As discussed above,\nthe time-of-flight error is reduced when the position parallax can be observed as\nshown in Fig. 9.31. This occurs about 1 day before Pluto closest approach.\n\nWhen observations of Charon are included during approach, the approach\norbit determination errors are essentially the same as obtained with only Pluto\nobservations until about 2 days before encounter as shown in Fig. 9.34. Since the\nbaseline provided by the Pluto/Charon orbit is about 50% larger than the baseline\nprovided by the Pluto/B-plane aim point, the time-of-flight error is about 50%\nsmaller. This provides significantly more margin for a late science instrument\npointing update. It should be noted that introduction of Charon data adds some\ncomplexity to the approach orbit estimation strategy. The orbit determination filter\nmust be able to solve for the Charon orbit and gravity with considerably more\naccuracy than has been determined by Earth based observations. However, even\n\n10000\n\n1000\n\n100\n\n10\n\n1\n\n0.1\n-20 -15 -10\n\nDays from Pluto Closest Approach\n\nPluto  B-Plane Error Mapping\n\nBSIGMX (km)\nBSIGMN (km)\n\nTOF (s)\n\nB\nS\n\nIG\nM\n\nX\n/B\n\nS\nIG\n\nM\nN\n\n/T\nO\n\nF\n (\n\n1 \nS\n\nig\nm\n\na)\n\n-5 0\n\nFig. 9.34 Doppler, range and optical imaging of Pluto and Charon\n\n\n\n9.6 New Horizons 365\n\nwith Pluto only observations, the dynamics of Pluto and Charon\u2019s orbit must be\nincluded in the solution. The barycenter of Pluto/Charon is outside the surface of\nPluto and uniform motion of Pluto on a star background during approach cannot be\nassumed.\n\n9.6.4 Spacecraft Orbit Reconstruction\n\nAs the spacecraft encounters the Pluto/Charon system, the gravitational perturbation\nof the spacecraft and observation of craters on both Pluto and Charon permit an\naccurate determination of the spacecraft trajectory and certain physical parameters\nthat characterize both Pluto and Charon. The improvement in the spacecraft\nephemeris during the encounter phase is useful for determining where the spacecraft\nis headed after encounter. An extended mission to the Kuiper belt is planned. The\ndetermination of Pluto and Charon physical parameters is useful for future missions\nto Pluto/Charon and is of interest for science investigations.\n\nDuring the encounter phase, radio metric data and many images of Pluto and\nCharon are obtained. Table 9.11 shows the results of processing this data from\nbefore encounter until several days after encounter. In addition to the parameters\nestimated for approach navigation, some additional parameters are estimated that\ndescribe Pluto and Charon. These include the pole and prime meridian angles,\nrotation rate, gravitational parameters, and the location of craters on the surface\nof Pluto and Charon. Optical imaging of Pluto and Charon when combined with\nDoppler tracking data should enable determination of the location of craters relative\nto the respective centers of mass to an accuracy of about 100 m. The observations\nthat are most useful are obtained within several hours of encounter. During this time\ninterval, the bodies rotate several degrees enabling a determination of the poles,\nprime meridians and rotation rates. The accuracy is optimistically estimated to be\nabout 0.05? as given in Table 9.11. The a priori values for the poles and rotation\n\nTable 9.11 Pluto and Charon parameter estimation errors\n\nError (1 sigma)\nParameters Pluto/Charon nominal values Pluto Charon\n\nPole and prime meridian\n\n? (deg) 313.02 0.05 0.075\n\n? (deg) 9.09 0.05 0.075\n\nW(deg) 236.77 0.05 0.075\n\nW? (deg/day) ?56.3623195 3.0\u00d710?4 4.5\u00d710?4\nMass properties\n\nGM (km3/s2) 874.05/73.16 0.41\u00d710?3 0.33\u00d710?2\nGravity harmonics\n\nC20 0/0 0.81\u00d710?2 Not available\n\n\n\n366 9 Navigation Analysis\n\nrates assume that both Pluto and Charon rotate at the orbital period of the Charon\norbit about Pluto and are thus in gravity lock. This assumption is not necessary\nfor determination of these parameters since the data obtained during encounter will\nbe much more powerful than Earth based observational data including the Hubble\nspace telescope. The solution will not be a priori limited. If Pluto and Charon are in\ngravity lock and the orbit is not exactly circular, the pole and prime meridian angles\nwill librate about their nominal values. Further study is needed to determine if the\nlibration angles will be large enough to be detected.\n\nPluto and Charon gravitational parameters are determined from the Doppler\ntracking data acquired during encounter. The values for the errors given in\nTable 9.11 were obtained by detailed covariance analysis of simulated data.\nWhen combined with the volume of the bodies obtained from optical imaging,\na refined estimate of the bulk densities may be obtained that will be at least an\norder of magnitude better than obtained from Earth based observations. Also,\nobservation of the Charon orbit about Pluto will enable an even more precise\ndetermination of the system mass, an artifact of the equations of motion, that is\nof marginal interest to physical science but is essential for accurate ephemeris\ndevelopment. The normalized gravitational harmonic C20, which is related to the\noblateness, can be resolved to an accuracy of about 0.008 which is at least an order\nof magnitude greater than the nominal value expected from analysis of the spin and\nhydrodynamics. The flyby distances will probably be too great for the Doppler data\nto detect gravity harmonics.\n\nIn addition to the physical parameters of Pluto and Charon, the orbit of Charon\nabout Pluto and the heliocentric orbit of the Pluto/Charon barycenter will be\ndetermined. This \u201cnormal point\u201d will permit an improved ephemeris for these\nbodies.\n\n9.7 Phobos\n\nThe Phobos gravity field provides useful insight into the physical makeup of Phobos\nand is needed for determination of the orbit of a spacecraft in the vicinity of Phobos.\nWhen combined with a figure model and observations of the forced libration of\nPhobos in its orbit about Mars, certain physical parameters such as mean density\nand moments of inertia may be determined.\n\nDirect observation of the gravity field of Phobos is limited. The most accurate\ndata that has been obtained is from tracking spacecraft that have flown by or orbited\nnear Phobos. These observations have yielded an important determination of the\nmass. Indirect determination of the gravity field may be obtained from the figure\nmodel. An extensive map of the Phobos topography has been obtained from stereo\nimaging of the surface by the Mariner 9 and Viking missions. The resulting figure\nmay be integrated to obtain gravity harmonic coefficients, the inertia tensor, and\nvolume assuming constant density. The rotational motion of Phobos may then be\n\n\n\n9.7 Phobos 367\n\nintegrated around one Martian orbit and the results compared with observation of\nthe forced libration to obtain some insight into the internal structure of Phobos.\n\n9.7.1 Phobos Inertial Properties\n\nThe combination of a photographic determination of the figure of Phobos with\nobservations of spacecraft and Phobos dynamics provides an estimate of some of\nthe inertial properties of Phobos. With this limited knowledge, some insight of\nthe internal structure of Phobos may be inferred. The most useful information is\ncontained in the low degree gravity harmonics and moments of inertia.\n\nThe key mass properties that have been determined are given in Table 9.12. The\ngravitation constant (GM) has been determined by tracking spacecraft that have\nflown in the immediate vicinity of Phobos, most recently the Soviet Phobos Mission,\nand the mass is obtained by simply dividing by the universal gravitation constant.\nIntegration over the observed surface of Phobos gives the volume (V ) and the mean\ndensity is simply the mass divided by the volume.\nIntegration of the first moment over the volume of Phobos gives the center of figure\nrelative to the center of the planetocentric coordinate system. The center of the\nplanetocentric coordinate system is the center of mass as determined by observation\nof spacecraft and Phobos dynamics. If the density of Phobos is uniform, the center\nof figure as defined by the above integration is also the center of mass. Thus, the\ndifference may be attributed to inhomogeneity of Phobos or the accuracy of the data.\nThe observed offset from the Viking measurements was too small to be significant\nand was incorporated into the reduction of the images. This supports a fairly uniform\nmass distribution for Phobos as far as can be determined from the first moment.\n\nAnother perspective of the mass distribution of Phobos may be obtained from\nthe integration of the second moment over the volume of Phobos. The results of\nthis integration for the inertia tensor are given in Table 9.13. The orientation of\nthe Phobos centered coordinate axes are also defined by observation of spacecraft\nand Phobos dynamics. The x axis of Phobos points toward the center of Mars on\nthe average and the z axis is normal to the Phobos orbit plane. Therefore, the\nPhobos centered body fixed axes should also be principal axes since this is the\norientation that is attained in the steady state over many revolutions. From the\ncross products of inertia given in Table 9.13, we may compute the location of the\nprincipal axes of Phobos figure and these are given in Table 9.14. The offset of the\n\nTable 9.12 Phobos mass\nproperties\n\nParameter Value Units Definition\n\nGM 7.22 \u00d7 10?4 km3/s2 Gravitation parameter\nM 1.082 \u00d7 1016 kg Mass\nV 5.673 \u00d7 1012 m3 Volume\n? 1.91 g/cm3 Mean density (cgs)\n\n\n\n368 9 Navigation Analysis\n\nTable 9.13 Phobos inertia\ntensor\n\nI =\n?\n?? Ixx Ixy IxzIxy Iyy Iyz\n\nIxz Iyz Izz\n\n?\n??\n\nPhobos centered body fixed coordinates\n\nI =\n?\n?? 4.72 ?.0338 ?.0341?.0338 5.50 ?.0280\n\n?.0341 ?.0280 6.48\n\n?\n?? \u00d7 1023 kg ? m2\n\nPhobos centered principal axes\n\nI =\n?\n?? 4.72 0 00 5.50 0\n\n0 0 6.48\n\n?\n?? \u00d7 1023 kg ? m2\n\nTable 9.14 Phobos principal\naxes of inertia directions\n\nAxis Latitudea\n\n(deg)\nLongitudea\n\n(deg)\n\nxp 1.14 2.53\n\nyp 1.53 92.5\n\nzp 88.1 235.8\na Phobos centered inertial\n\nfigure principal axes of inertia from the Planetocentric coordinate system may be\nattributed to asymmetric mass distribution or accuracy of the data. The small offset\nthat is observed also supports a uniform distribution of Phobos density within the\naccuracy of the observations.\n\n9.7.2 Phobos Gravity Field\n\nThe gravity harmonic coefficients may also be obtained by integration over the\nfigure of Phobos assuming constant density. The results of this integration are given\nin Table 9.15. The harmonic coefficients through degree and order two may be\ndirectly related to the center of gravity and part of the inertia tensor and thus provide\nessentially the same insight into the mass distribution as has been discussed above.\nFor the center of gravity, these relationships are\n\nxcg = C11r0\nycg = S11r0\nzcg = C10r0\n\nand for the inertia tensor\n\nIxx ? Iyy = ?4Mr2oC22\n\n\n\n9.7 Phobos 369\n\nTable 9.15 Phobos gravity field\n\nGMp = 7.22 \u00d7 10?4 km3/s2, r0 = 11.1 km\nCoefficient m = 0 m = 1 m = 2 m = 3 m = 4\n\nC2m ?0.1035E+00 0.2556E-02 0.1457E-01\nS2m 0.2098E-02 0.1269E-02\n\nC3m 0.8243E-02 ?0.4800E-02 ?0.3091E-02 0.6721E-03\nS3m 0.2093E-02 ?0.3110E-03 ?0.1323E-02\nC4m 0.1892E-01 0.1949E-02 ?0.4758E-03 ?0.2116E-03 0.6139E-04\nS4m ?0.9897E-03 ?0.5637E-03 0.1983E-03 ?0.3234E-04\n\nIyy ? Izz = Mr2o (C20 + 2C22)\nIzz ? Ixx = ?Mr2o (C20 ? 2C22)\n\nIxy = ?2Mr2oS22\nIyz = ?Mr2oS21\nIxz = ?Mr2oC21 (9.1)\n\nThe above six equations for the inertia tensor elements place constraints on the\nrelationship between the inertia tensor and gravity harmonic coefficients. However,\nonly five of these equations are independent. The third equation may be obtained\nby adding the first two equations. For this reason, it is not possible to completely\ndescribe the inertia tensor from gravity measurements alone.\n\nThe higher degree terms of the gravity field expansion are useful for predicting\nthe acceleration of a spacecraft that orbits near Phobos. Thus, they are vital\nfor precision navigation. In their own right, the higher order gravity harmonics\nprovide some insight into the homogeneity of Phobos when they are compared\nwith those obtained from the figure assuming constant density (i.e., the coefficients\nin Table 9.15). At this time, a direct determination of the higher order harmonic\ncoefficients that would be obtained by tracking spacecraft is not available.\n\n9.7.3 Phobos Rotational Dynamics\n\nConsider the rotational equations of motion that relate the observed angular\nacceleration ?? and body-fixed spin rates to the applied moment (M).\n\nM = I ?? + ? \u00d7 H\nH = I ?\n\n\n\n370 9 Navigation Analysis\n\nTable 9.16 Mars gravity field\n\nGMm = 42828.44 km3/s2, rm = 3, 394. km\nCoefficient m = 0 m = 1 m = 2 m = 3 m = 4\n\nC2m ?0.1960E-02 0 ?0.5473E-04\nS2m 0 0.3140E-04\n\nC3m 0.3145E-04 0.4477E-05 ?0.5579E-05 0.4845E-05\nS3m 0.2690E-04 0.2895E-05 0.3607E-05\n\nC4m ?0.1889E-04 0.3494E-05 ?0.2077E-06 0.4175E-06 ?0.3614E-08\nS4m 0.3990E-05 ?0.2199E-05 0.1625E-07 ?0.2765E-06\n\nAs Phobos orbits Mars, Phobos is subjected to a torque from the gradient of the\nMars gravity field. The total applied moment to Phobos is obtained by integrating\nthis force times the moment arm over the density and volume of Phobos.\n\nM =\n???\n\nV\n\n(\nr \u00d7 dF\n\ndm\n\n)\n?(r, ?, ?) dV (9.2)\n\nThe gravitational force (F) is exerted on an elemental volume element of mass dm.\nThis force is obtained from the Mars gravity field and is given by\n\ndF\ndm\n\n= fg(rp, ?, ?,W,GMm, rm,CMnm, SMnm)\n\nwhere rp is the vector from the center of Mars to an elementary volume element\nof Phobos, GMm is the gravitational constant of Mars, rm is the reference radius\nof Mars, and CMnm and SMnm are the Mars gravity coefficients as determined by\nBalmino and are given in Table 9.16.\n\nFor the orbit of Phobos about Mars, a state vector was computed at Mars\nperiapsis from the orbit elements given in Table 9.17. The above rotational equations\nof motion were integrated over one complete orbit of Mars in conjunction with\nthe translational equations of motion and the moment obtained by simultaneous\nrepeated integrations over Phobos\u2019s volume. Of particular interest is the forced\nlibration in longitude of Phobos. This is simply the inertial attitude about the z axis\nminus the mean rotation about the same axis. The amplitude of 0.994? obtained by\nnumerical integration provides some insight into the radial distribution of density.\n\n9.7.4 Analytic Approximation of Forced Libration\n\nThe moment about Phobos\u2019s coordinate axes may be approximated by assuming that\nthe Mars gravity gradient is constant over the entire volume of Phobos. With this\nassumption, the moment about Phobos is determined by the second degree gravity\nharmonics of Phobos which are related to a certain ratio of the moments of inertia.\n\n\n\n9.7 Phobos 371\n\nTable 9.17 Initial conditions\n\nParameters Values\n\nPhobos ephemeris Phobos-centered\n\nXo =\n\n?\n??????\n\napo\nepo\n\npo\nipo\n?po\n\n?\n?????? Xo =\n\n?\n??????\n\n9378.5 km\n\n.015364\n\n242.703 deg\n\n1.0324 deg\n\n227.073 deg\n\n?\n??????\n\nPhobos attitude and rates Rotations from Phobos centered frame\n\n?o =\n\n?\n?????????\n\n?o\n\n?o\n\nWo\n\n?xo\n\n?yo\n\n?zo\n\n?\n?????????\n\n?o =\n\n?\n?????????\n\n0 deg\n\n90 deg\n\n0 deg\n\n1.077\u00d710?4 rad/s\n1.077\u00d710?4 rad/s\n8.725\u00d710?3 rad/s\n\n?\n?????????\n\nThe gravitational force of Mars on an elementary mass element of Phobos may be\napproximated by\n\ndF = GMm|rp ? r|3 (rp ? r) dm\n\nwhere rp is the vector from the center of Mars to the center of Phobos. Substituting\nthe gravity force into the moment equation we obtain\n\nM = GMm\n???\n\nV\n\nr \u00d7 (rp ? r)\n|rp ? r|3 ?(r, ?, ?) dV (9.3)\n\nwhere the distance from Mars to the mass elements may be obtained by projecting\nthe location of the mass elements onto the Mars-Phobos vector ignoring parallax,\n\n|rp ? r| = rp ? rp \u00b7 r\n\nand the required inverse cube may be approximated by the first two terms of the\nTaylor series\n\n1\n\n|rp ? r|3 =\n1\n\nr3p\n\n[\nr2p + 3rp \u00b7 r\n\nr2p\n\n]\n\nReplacing the vectors by components we obtain\n\n\n\n372 9 Navigation Analysis\n\nM = GM\nr5p\n\n???\nV\n\n?\n? yzp ? zypzxp ? xzp\n\nxyp ? yxp\n\n?\n? [r2p +3(xxp +yyp +zzp)] ?(r, ?, ?)dV (9.4)\n\nSince the origin of the coordinate system is the center of mass, the first order terms\nin x, y, and z integrate to zero and the second order terms integrate to moments and\nproducts of inertia.\n\nM = 3 GMm\nr5p\n\n?\n??ypzp(Izz ? Iyy) + (y\n\n2\np ? z2p)Iyz ? xpzpIxy + xpypIxz\n\nxpzp(Ixx ? Izz) + (z2p ? x2p)Ixz ? xpypIyz + ypzpIxy\nxpyp(Iyy ? Ixx) + (x2p ? y2p)Ixy ? ypzpIxz + xpzpIyz\n\n?\n??\n\n(9.5)\nAs Phobos rotates about Mars, the x coordinate axis very nearly points towards\nMars and the moment about Phobos may be approximated by\n\nM ? 3 GMm\nr5p\n\n?\n? 00\n\nxpyp(Iyy ? Ixx)\n\n?\n? (9.6)\n\nFor small angular deviations of the x coordinate axis in longitude we have\n\nM ? 3 GMm\nr3p\n\n?\n? 00\n\n??(Iyy ? Ixx)\n\n?\n? (9.7)\n\nThe rotational equations of motion may also be simplified for the special case of\nrotation and moments only about the z axis. Thus Euler\u2019s equations of motion may\nbe approximated by\n\nM ?\n?\n? 00\n\nIzz ??\n\n?\n? (9.8)\n\nWe thus obtain the following second order differential equation for the rotation of\nPhobos.\n\n?? = 3 GMm\nr3p\n\nIyy ? Ixx\nIzz\n\n??\n\nThe forcing function is simply the difference between Phobos\u2019s x coordinate axis\nand the vector from Mars to Phobos which is defined by\n\n?? = ? ? ?\n\n\n\n9.7 Phobos 373\n\nwhere ? is the true anomaly of Phobos orbital motion about Mars.\nThe orbital motion of Phobos about Mars may be described by Kepler\u2019s equation\n\nand we have\n\nM = E ? e sin E\n\nwhere M is now the mean anomaly, E is the eccentric anomaly, and e is the orbit\neccentricity. We also have the relationships\n\nM =\n?\n\nGMm\n\na3p\n(t ? tp) = n(t ? tp)\n\nwhere ap is the semi major axis of Phobos orbit, tp is the time of periapsis passage,\nand n is the mean motion. An approximate formula for ? may be obtained by\nassuming the point on the circle that defines E is coincident with the point on the\norbit that defined ?. Thus we have\n\nE ? M = e sin E (9.9)\n\nand from the geometry shown in Fig. 3.1\n\nsin(? ? E) ? c sin E\nr\n\nIf the point on the circle shown in Fig. 3.1 is coincident with the point on the ellipse,\nthen r ? a ? b, sin(? ? E) ? ? ? E, M ? E and since c = ae\n\n? ? E = e sin M (9.10)\n\nAdding equations Eq. (9.9) and Eq. (9.10) an approximate equation for ? as a\nfunction of time is obtained\n\n? = nt + 2e sin nt\n\nThe differential equation for the rotation of Phobos about the z axis thus becomes\n\n?? = 3? n2(nt + 2e sin nt ? ?)\n\nwhere\n\n? = Iyy ? Ixx\nIzz\n\nTaking the Laplace transformation we obtain\n\n\n\n374 9 Navigation Analysis\n\ns2? ? s?0 ? ??0 = 3? n\n3\n\ns2\n+ 6? en\n\n3\n\n(s2 + n2) ? 3? n\n2?\n\nSolving for ? as a function of s we obtain\n\n? = s\ns2 + 3? n2 ?0 +\n\n1\n\ns2 + 3? n2 ??0 +\n3? n3\n\ns2(s2 + 3? n2) +\n6? n3e\n\n(s2 + n2)(s2 + 3? n2)\nTransforming from the frequency domain back to the time domain we obtain\n\n? = nt + 6? e\n3? ? 1 sin nt + ?0 cos(\n\n?\n3? nt) + 1?\n\n3?\nsin(\n\n?\n3? nt)\n\n[\n??0\n\nn\n? 1 ? 6? e\n\n3? ? 1\n]\n\n(9.11)\n\nThe above equation describes the rotation of Phobos as a function of the initial\nattitude(?0), initial attitude rate(??0), gravity torque forcing function, and inertial\nproperties of Phobos. Over many Phobos orbits, energy dissipation will result in the\namplitude of the attitude oscillations attaining a minimum. This minimum energy\ncondition imposes the following boundary condition on the initial attitude and\nattitude rate at periapsis.\n\n?0 = 0.\n\n??0 =\n(\n\n1 + 6? e\n3? ? 1\n\n)\nn\n\nSubstituting the boundary conditions into the equation of motion, we obtain for the\nattitude of Phobos\n\n? = nt + 6? e\n3? ? 1 sin nt + Af sin(nt\n\n?\n3? + ?f ) (9.12)\n\nObserve that this equation contains an additional term for the free libration of\nPhobos of amplitude Af and phase ?f . The minimum energy boundary condition\nresults in this term vanishing except for a small residual that may be attributed to\nother external forcing functions and the initial attitude and rate that existed when\nPhobos became locked in rotation with Mars. The forced libration may be separated\nfrom the free libration through their respective frequency signatures. The amplitude\nof the forced libration from Eq. (9.12) is 0.978? where ? = 0.12037 and e = 0.0151.\nThis compares very well with the result (0.9937?) obtained by numerical integration\nof the rotational equations of motion.\n\n\n\nExercises 375\n\n9.8 Summary\n\nNavigation analyses are performed to verify that the navigation system will deliver\na spacecraft to its destination and satisfy mission constraints associated with the\nspacecraft design and acquisition of science data. These objectives are satisfied by\ndesigning the trajectory and computing the probabilities of successful execution\nof the mission. A secondary purpose of analysis is to anticipate possible failure\nmodes and design procedures for recovery. Analyses that have been performed in\nsupport of various missions have been described in some detail. These examples\nhave been selected from a long list of navigation design and operations that have\nbeen experienced over many years. The criterion for selection of examples are those\nthat provide insight into the navigation system and operations. Some of the more\ndramatic examples have not been included. Little is learned when a spacecraft blows\nup or falls in the ocean.\n\nThe first example of navigation analysis is associated with planetary quarantine.\nSince this was a major concern of the Viking mission to Mars, the analysis is\ndescribed in detail. The next example is the Galileo probe delivery. This problem\nwas of interest because of the narrow entry corridor that was targeted 150 days\nbefore arrival at Jupiter. The Pioneer (PVO) mission provided an opportunity to\nanalyze atmospheric entry. The Magellan mission used aerodynamic braking to\ncontrol the orbit around Venus. The NEAR mission was analyzed in detail since\nthis mission presented many new challenges and the introduction of new data\ntypes. The MESSENGER post launch perturbation from outgassing provided an\nopportunity to analyze small nongravitational accelerations. The New Horizons\nspacecraft was the first to navigate to Pluto. The long round trip light time of 8 h\npresented many challenges in orbit determination and data acquisition. Finally, the\nnumerous missions to Phobos, a satellite of Mars, provided data that was used to\npredict the libration of Phobos. Since small perturbations to the attitude of a body\ncan have a large effect on the gravity field determination, future analysis of missions\nto binary comets or asteroids will benefit.\n\nExercises\n\n9.1 During approach to Jupiter, the original navigation design involved separating\nthe probe from the orbiter at encounter minus 50 days at a cost of 50 m/s. The 50 m/s\nwas needed to deflect the orbiter from an entry trajectory to the orbit insertion aim\npoint. In order to save ?V, the separation was moved back to encounter minus 150\ndays. Determine the savings in ?V.\n\n9.2 Show that for a heading angle due East in the same direction as Jupiter\u2019s\nrotation, the relative entry angle is given by\n\n\n\n376 9 Navigation Analysis\n\ntan ?e = sin ?I\ncos ?I ? ?J reVI\n\ncos ?I = B?\nre\n\n(\n2 GM\nV 2?\n\n+ re\n)\n\nwhere ?J is Jupiter\u2019s rotation rate, re is the entry radius, VI is the inertial velocity at\nentry, V? is the hyperbolic excess velocity, GM is Jupiter\u2019s gravitational constant,\nand ?i is the inertial entry angle.\n\n9.3 For the separation at minus 150 days in Exercise 9.1, the 99% impact parameter\ndelivery error is \u00b11300 km. Determine the 99% relative entry angle delivery error\nfor V? = 5.86 km/s, B = 724, 300 km, re = 71, 398 km, Vi = 59.9 km/s, ?j =\n1.77 \u00d7 10?4 rad/s and GM = 0.126 \u00d7 109 km3/s2.\n9.4 For the estimation of atmospheric drag on a spacecraft in orbit about a planet\nwith an atmosphere, the relationship between the velocity change at periapsis and\nthe period of the orbit is needed. Show that\n\n?P\n\n?vp\n= 6? vp a\n\n5\n2\n\nGM\n3\n2\n\n9.5 A spacecraft is in a circular 30 km orbit about Eros. The plane of the orbit (x?y)\nis perpendicular to the sun line. The sun is in the plus z direction. A maneuver is\nexecuted as the spacecraft crosses the x axis that places the spacecraft in a circular\norbit that flies over the sub-solar point which is on the z axis. The spacecraft makes\na 90? turn and flies over the subsolar point on the surface of Eros. Determine the\nmaneuver components in the inertial x, y, z coordinate system. The gravitational\nparameter of Eros is 4.463 \u00d7 10?4 km3/s2.\n9.6 In turning the spacecraft to the maneuver attitude in Exercise 9.4, an error\nresults in the rocket motor being pointed in the direction of the spacecraft velocity\nvector. The thrust is in the opposite direction that the rocket motor is pointed.\nThe magnitude of the burn or ?V remains the same as for subsolar over-flight.\nDetermine the periapsis radius of the resulting trajectory.\n\n9.7 A model of Phobos is suspended on the surface of the Earth with an axel along\nthe z axis and the x axis pointing down. If Phobos is perturbed by a small torque\nabout the z axis, determine the period of oscillation. The moments of inertia of\nPhobos are Ixx = 4.72, Iyy = 5.50, Izz = 6.48, GMe = 398, 600 km3/s2, re =\n6378 km. From the observed period, the gravity gradient may be determined and\nthus we have a crude gravity gradiometer.\n\n\n\nBibliography 377\n\nBibliography\n\nBursa, M., Z. Martinec, K. Pec 1990. Principal Moments of Inertia, Secular Love Number and\nOrigin of Phobos. Adv. Space Res. Vol 10, No 3\u20134, pp.(3)67\u2013(3)70.\n\nCapen, E. B. and A. E. Joseph, \u201cSoftware Requirements Document Viking Project - MOIOP\u201d, JPL\nReport, 1973.\n\nDunham, D. W., McAdams, 1. V., Mosher, L. E. and Helfrich, C. E., \u201cManeuver Strategy for\nNEAR\u2019s Rendezvous with 433 Eros\u201d, Paper IAF-97-A.4.01 presented at the 48th International\nAstronautical Federation Congress, Turin, Italy, Oct. 6\u201310,1997.\n\nDunham, D. W., et al, 1999. Recovery of NEAR\u0160s a?Mission to Eros. International Astronautical\nCongress Paper IAF-99-Q.5.05, Amsterdam, The Netherlands.\n\nDuxbury, T. C. 1989. The Figure of Phobos.Icarus 78, 169\u2013180.\nFarquhar, R. W., ed., 1995. Special Issue on thea?Near Earth Asteroid Rendezvous Mission. J.\n\nAstronaut. Sci. 43.\nFarquhar, R. W., Dunham, D. W. and McAdams,1. V., \u201cNEAR Mission Overview and Trajectory\n\nDesign,\u201d J Astron. Sciences, Vol. 43, No.4, Oct.-Dec. 1995, pp. 353\u2013371.\nGuo, Y., R. W. Farquhar, \u201cNew Horizons Mission Design for the Pluto-Kuiper Belt Mission\u201d,\n\nAIAA paper 2002\u20134722, AIAA/AAS Astrodynamics Specialist Conference, Monterey, Cali-\nfornia, August 5\u20138, 2002.\n\nGuo, Y., R. W. Farquhar, \u201cNew Horizons Pluto-Kuiper Belt Mission: Design and Simulation of\nthe Pluto-Charon Encounter\u201d, IAC paper 02-Q.2.07, 53rd International Astronautical Congress\nThe World Space Congress-2002, Houston, Texas, October 5\u20138, 2002.\n\nGuo, Y., R. W. Farquhar, \u201cNew Horizons Mission Design for the Pluto-Kuiper Belt Mission\u201d,\nAIAA paper 2002\u20134722, AIAA/AAS Astrodynamics Specialist Conference, Monterey, Cali-\nfornia, August 5\u20138, 2002.\n\nGuo, Y., R. W. Farquhar, \u201cNew Horizons Pluto-Kuiper Belt Mission: Design and Simulation of\nthe Pluto-Charon Encounter\u201d, IAC paper 02-Q.2.07, 53rd International Astronautical Congress\nThe World Space Congress-2002, Houston, Texas, October 5\u20138, 2002.\n\nKonopliv, A.S., W.B. Banerdt, and W.L. Sjogren 1999. Venus Gravity: 180th Degree and Order\nModel. Icarus 139, 3\u201318.\n\nKeating, G. M., J. Y. NicholsonIII, and L. R. Lake, \u201cVenus Upper Atmosphere Structure\u201d, Journal\nof Geophysical Research, vol. 85, no. A13, pp 7941\u20137956, December 30, 1980.\n\nKing-Hele, D., Theory of Satellite Orbits in an Atmosphere, Butterworths, London, 1964.\nKolyuka, Y. F., S. M. Kudryavtsev, V. P. Tarasov, V. F. Tikhonov, N. M. Ivanov, V. S. Polyakov,\n\nV. N. Potchukaev, O. V. Papkov, E. L. Akim, R. R. Nasirov 1990. Report of the International\nProject \u201cPhobos\u201d Experiment \u201cCelestial Mechanics\u201d, in press.\n\nMcAdams, 1. V., Dunham, D. W., Helfrich, C. E., Mosher, L. E. and Ray, 1. c., \u201cManeuver\nHistory of the NEAR Mission: Launch through Earth Swingby Phase,\u201d Paper rSTS 98-c-23,\n21st International Symposium on Space Technology and Science, Sonic City, Omiya Japan,\nMay 24\u201331, 1998.\n\nMcAdams, J. V., D. W. Dunham, R. W. Farquar, T. H. Taylor, B. G. Williams, \u201cTrajectory\nDesign and Maneuver Strategy for the MESSENGER Mission to Mercury\u201d, Paper 05\u2013173,\n15th AAS/AIAA Space Flight Mechanics Conference, Copper Mountain,CO, January 23\u201327,\n2005.\n\nMiller, J.K. and F. T. Nicholson, \u201cGalileo Jupiter Approach Orbit Determination\u201d, The Journal of\nthe Astronautical Sciences, Vol 32, No 1, January-March, 1984, pp 63\u201379.\n\nMiller, J. K., Weeks, C. J. and Wood, L. J., \u201cOrbit Determination Strategy and Accuracy for a\nComet Rendezvous Mission,\u201d J Guidance, Control, and Dynamics, Vol. 13, No.5, Sep.-Oct.\n1990., pp. 775\u2013784.\n\nMiller, J. K., Williams, B. G., Bollman, W. E., Davis, R. P., Helfrich, C. E., Scheeres, D. 1., Synnott,\nS. P., Wang, T. C. and Yeomans, D. K., \u201cNavigation Analysis for Eros Rendezvous and Orbital\nPhases,\u201d J Astron. Sciences, Vol. 43, No.4, Oct.-Dec. 1995, pp. 453\u2013476.\n\n\n\n378 9 Navigation Analysis\n\nMiller, J. K., et. al., \u201cNavigation Analysis for Eros Rendezvous and Orbital Phases\u201d, The Journal\nof the Astronautical Sciences, Vol 43, No 4, October-December 1995, pp 453\u2013476\n\nMiller, J. K., P. G. Antreasian, R. W. Gaskell, J. Giorgini, C. E. Helfrich, W. M. Owen, B. G.\nWilliams and D. K. Yeomans, Determimation of Eros Physical a?Parameters for NEAR Earth\nAsteroid Rendezvousa?Orbit Phase Navigation. AAS paper 99\u2013463, AAS/AIAA Astrodynamics\nSpecialist Conference, Girdwood, Alaska., 1999\n\nMiller, J. K., P. G. Antreasian, J. J. Bordi, S. Chesley, C. E. Helfrich, A. Konopliv, W. M. Owen,\nT. C. Wang, B. G. Williams and D. K. Yeomans, Determination of Eros\u0160 Physical Parameters\nfrom Near Earth Asteroid Rendezvous Orbit Phase Navigation Data. AIAA paper 2000\u20134422,\nAAS/AIAA Astrodynamics Specialist Conference, Denver, Colorado, 2000.\n\nMiller, J. K. et alia, \u201dDetermination of the Shape, Gravity and Rotational State 0f Asteroid 433\nEros\u201c, Icarus, Vol. 155 Number 1, pp. 3\u201317, January 2002.\n\nMiller, L. J., J. K. Miller and W. E. Kirhofer, \u201cNavigation of the Galileo Mission,\u201d Paper 83\u20131002,\npresented at the AIAA 21 st Aero- space Science Meeting, Reno, Nevada, January 1983.\n\nMottinger, N. A., \u201cDSN Coverage Requirements for PVO Reentry\u201d, IOM 314.7\u2013165, 5 February\n1992\n\nO\u2019Neil, W. J., and R. T. Mitchell, \u201cGalileo Mission Overview,\u201d Paper 83\u20130096, presented at the\nAIAA 21st Aerospace Science Meeting, Reno, Nevada, January, 1983.\n\nPeale, S. J. 1977. Rotational histories of the natural satellites. In Planetary Satellites (J. Burns, Ed),\npp. 87\u2013112. Univ. of Arizona Press, Tucson.\n\nRourke, K. H., \u201cNavigation of the 1982 Jupiter Orbiter-Probe Mission, \u201d paper presented at\nthe AAS/AIAA Astrodynamics Specialists Conference, Jackson Hole, Wyoming, September,\n1977.\n\nRyne, M. S., N. A. Mottinger, P. R. Menon, J. K. Miller, \u201cNavigation of Pioneer 12 During Atmo-\nspheric Reentry at Venus\u201d, AAS 93\u2013712, AAS/AIAA Astrodynamics Specialist Conference,\nVictoria, B.C., Canada, August 16, 1993.\n\nRussell, R. K., \u201cThe Effect of Atmospheric Drag on Position and Velocity Errors of Orbiting\nSpacecraft\u201d, JPL\n\nRussell, R. K., \u201cGravity Focussing of Hyperbolic Trajectories,\u201d Technical Memorandum 391\u2013424,\nJet Propulsion Laboratory internal document, Pasadena, California, 30 March 1973.\n\nScheeres, D. J., \u201cAnalysis of Orbital Motion Around 433 Eros,\u201d 1. Astron. Sciences, Vol. 43, No.4,\nOct.-Dec. 1995, pp. 427\u2013452.\n\nThomas, P. C. et alia, \u201cEros: Shape, Topography, and Slope Processes\u201d, Icarus, Vol. 155 No 1, pp\n18\u201337, January 2002.\n\nVojvodich, N. S., et al., Galileo Atmospheric Entry Probe Mission Description,u? Paper 83\u20130100,\npresented at the AIAA 21st Aerospace Science Meeting, Reno, Nevada, January, 1983.\n\n\n\nAnswers to Selected Exercises\n\nChapter 1\n\n1.1 For an ideal basketball and golf ball, the golf ball would rebound to a height of\n10.9 m. For a real basketball and golf ball dropped on a driveway, the height\nwas only about 4 m which resulted in the golf ball being lost on the garage\nroof.\n\n1.2 A 3\u00d73 matrix containing the outer product of r\n?a\n?r\n\n= ??\nr3\n\n[\nI ? 3 r ? r\n\nr2\n\n]\n\n1.3\n\nMy(? = 0) = 3 GM\nr3\n\n(Izz ? Ixx) rxrz\nr2\n\n= 3 GM\nr3\n\n(Izz ? Ixx) sin ? cos ?\n\n1.4\n\nrl = kz cos ? ? kx sin ? + kz cos ? ? kx sin ?\n?r = kz sin ? ? kx cos ? ? kz sin ? + kx cos ?\n\n1.5\n\n?? = 3\n2\n\n(\nGM\n\nr3\n\n)[\nIzz ? Ixx\n\nIzz\n\ncos ?\n\n?e\n\n]\n= 2.450 \u00d7 10?12 rad/s\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3\n\n379\n\nhttps://doi.org/10.1007/978-3-319-78916-3\n\n\n380 Answers to Selected Exercises\n\n1.6 This problem makes use of the following:\n\n[\n?(I\n)\n\n?Ie\n\n]T\n= \nT ?I\n\nT\n\n?Ie\n\n?IT\n\n?Ie\n=\n\n?\n?1 0 0 1 1 00 1 0 1 0 1\n\n0 0 1 0 1 1\n\n?\n?\n\n1.7 v? = 725 m/s\n1.8 Assume that the volume swept out by all the molecules between collisions\n\nis equal to the volume of the container and the frequency of collisions is\nthe reciprocal of the mean time between collisions. The mean free path is\napproximately 5.029 \u00d7 10?7 m and the number of collisions per second for\none molecule is 9.639 \u00d7 108.\n\n1.9 Tyrannosaurus rex\u2019s watch will have gained 0.61 s and will read Jan 1 2017\n12:00:01 AD if we round up. Photon\u2019s watch will read Jan 1, 65,000,000\n12:00:00 BC. Photon will have no memory of the trip and t rex was probably\nwiped out by an asteroid, but his watch survived.\n\n1.10 For 30? integration step size and evaluating function on right side of interval,\n? 90\n\n0\nsin(x)dx ? ?\n\n6\n[sin(30) + sin(60) + sin(90)] = 1.23\n\nFor evaluation in middle of interval,\n\n? 90\n0\n\nsin(x)dx ? ?\n6\n\n[sin(15) + sin(45) + sin(75)] = 1.01\n\nFor 10? integration step size and evaluation on right side of interval the integral\nwas 1.084 and for evaluation in middle of interval the integral was 1.0013\n\nChapter 2\n\n2.1 R = 15,255 ft, H = 1800 ft\n2.2 R = 5.80 miles\n2.3 The thrust is 1164 pounds and the drag force is 19.8 pounds.\n2.4 The equations of motion are\n\ny = v0 sin(?)t ? t\n2\n\n2g0\n\nx = v0 cos(?) t\n\n\n\nAnswers to Selected Exercises 381\n\nand the trajectory is\n\ny = tan(?) x ? g0\n2v20 cos\n\n2 ?\nx2\n\n2.9\n\nC20 = 1\nMa2\n\n???\nV\n\n(?1\n2\n\nx2 ? 1\n2\n\ny2 + z2) ?(r, ?, ?) dV\n\nC21 = 1\nMa2\n\n???\nV\n\nxz ?(r, ?, ?) dV\n\nS21 = 1\nMa2\n\n???\nV\n\nyz ?(r, ?, ?) dV\n\nC22 = 1\n4Ma2\n\n???\nV\n\n(x2 ? y2) ?(r, ?, ?) dV\n\nS22 = 1\n2Ma2\n\n???\nV\n\nxy ?(r, ?, ?) dV (1.1)\n\nChapter 3\n\n3.2 For F negative, sinh(F ) + cosh(F ) = eF which for large negative F is\nvery small. Since eF is obtained by differencing two very large numbers\n(sinh(F ), cosh(F )) their is a loss of significance.\n\n3.3 sin ? =\n(\n\nGM\n\nvh\n\n)\ne sin(?)\n\n3.4 The first spacecraft had an orbit insertion maneuver of 1021 m/s and the second\nspacecraft had an orbit insertion maneuver of 975 m/s followed by a maneuver\nat apoapsis of 30 m/s for at total of 1005 m/s. The second strategy is more fuel\nefficient.\n\n3.7 1.638 years\n\nChapter 4\n\n4.1 The radius of the can is h = ( V2? ) and the height is twice the radius.\n4.2 1/3\n4.3 The relevant term that determines the sign of the Hessian is given by 16a2U2 ?\n\n16b2U1. Since a is greater than b, the Hessian is positive and the solution is a\nminimum.\n\n\n\n382 Answers to Selected Exercises\n\n4.4 The critical plane is defined in the velocity space. A maneuver performed in\nthis plane will acquire the target and minimize ?V .\n\n4.6 In computing the partial derivatives of v with respect to ? , the partial of ra with\nresect to ? is zero. The terms that multiply ?v/?? are factored out and divided\nto form a fraction. The denominator may be discarded and the numerator is zero\nonly if ? is zero.\n\nChapter 5\n\n5.1 p = 4\n(\n\n52\n2\n\n)\n= 1.539 \u00d7 10?6\n\n5.2 p =\n(\n\n500\n5\n\n)\n= 3.265 \u00d7 10?14\n\n5.3 Caesar\u2019s box is in a narrow annulus of width 3 yards where the PDF is constant.\n\n? = 50\n1.17741\n\np =\n\n?\n???? e\n\n?98.52\n2? 2 ? e\n\n?101.52\n2? 2\n\n?\n???? 3200? = 4.96 \u00d7 10?5\n\n5.4 The probability of hitting Caesar\u2019s box, if that is the target, is approximately\n\np = 1 ? e\n?32\n2? 2 = 2.49 \u00d7 10?3\n\n5.5 The binomial coefficients for m = 2 are obtained from\n\n(1 + x)m = 1 + 2x + x2\n\nSince each coefficient for the next row of Pascal\u2019s triangle is the sum of the two\ncoefficients in the row above, B(m + 1, k + 1) = B(m, k) + B(m, k + 1) and\nthe solution is\n\nB(m, k) = m!\n(m ? k)! k!\n\nwhere (\nm\n\nk\n\n)\nm + 1\nk + 1 =\n\n(\nm\n\nk\n\n)\n+\n\n(\nm\n\nk\n\n)\nm ? k\nk + 1\n\nafter factoring out B(m,k). The demonstration is complete if B(2, k) = 1, 2, 1\nwhich it does.\n\n\n\nAnswers to Selected Exercises 383\n\nChapter 6\n\n6.1 The rows of the matrix are A(i, j). The measurement covariance (Pm), the\ninverse of the a prior matrix (P0) and the estimated parameter a prior are set\nequal to zero. The number of measurements, which are assumed to be exact, is\nequal to the dimension of the matrix. Both the Kalman gain and the weighted\nleast square gain give A(i, j)?1.\n\n6.2 Venus is the best guess since the maximum acceleration from Mars would\nbe too small. In the real world, it was Mars. An early version of an orbit\ndetermination program left Mars out of the Equations of motion because the\nacceleration was believed to be too small to be detected. The actual ramp in\nthe Doppler data was smaller than postulated for this problem and Venus was\nincluded in the equations of motion.\n\n6.3 E(X2XT1 ) = K E(Z1,2XT1 ) + (I ? KA) E(X1XT1 )\nSince the data taken after t1 is uncorrelated with X1, E(Z1,2XT1 ) = 0 and\n\nP1,2 = P2\n6.4 Draw a sample from P1 ? P2 = KAP1 and add it to X1.\n\nChapter 9\n\n9.1 33.3 m/s\n9.4 ?Vx = ?3.858 m/s, ?Vy = 0, ?Vz = 3.858 m/s\n9.5 rp = 3.04 km. The spacecraft crashes into Eros.\n\n\n\nIndex\n\nA\nAberration, 34, 280\u2013285, 291\nAerodynamic forces, 53\u201354\nAltimetry, 66, 68, 76, 285\u2013291, 330, 338,\n\n394\nAltimetry variational partial derivatives,\n\n289\u2013291\nAmbiguity, 264, 265\nAmpere, 274\nAnderson, 222\nAngle of attack, 312\u2013313, 319\nAngular momentum, 10, 11, 96, 97, 114, 125,\n\n135\u2013140, 146, 150, 299, 318, 341, 342\nApostle, 43\nApparent magnitude, 357\nA priori, 68, 218\u2013222, 228, 229, 237, 241, 279,\n\n296, 298, 330, 333, 338, 349, 365, 366\nAtlas, 109\nAtmosphere reconstruction, 326\nAtmospheric drag, 91, 95, 319\u2013321, 323, 324,\n\n376\nAtmospheric entry, 320, 322, 375\nAtomic clock, 49, 257, 258, 261, 269, 293\nAvogadro, 21, 48\n\nB\nBelbruno, E.A., 133\nBernoulli, John, 158, 200\nBinomial coefficients, 201\u2013207, 214, 215, 382\nBinomial expansion, 188, 199\nBinomial theorem, 199\u2013207, 214\nBivariate normal PDF, 191\u2013193\nBoltzmann, 20, 21\nBoltzmann\u2019s constant, 20, 21\n\nBoresight, 279, 286, 287\nB-plane, 106, 172, 176, 178, 184, 213, 300,\n\n305, 311, 314, 343, 349, 358, 360,\n362\u2013364\n\nC\nCanberra, 248, 249, 255, 266, 294\nCapture, 131, 133\u2013137, 139\u2013142, 300, 306\nCapture orbit, 132\u2013136, 139, 140, 142\nCartesian, 31, 58, 60, 68, 76, 87, 92, 96, 100,\n\n110, 146, 171, 178, 191, 242, 273, 300,\n327, 358\n\nCassini, 122, 128\u2013132\nCentaur, 304\nCentral limit theorem, 194\u2013196\nChebyshev, Pafnuty Lvovich, 296, 331, 345\nChebyshev polynomials, 296, 331, 345\nChristoffel, 24, 25\nCircular error probable (CEP), 194\nClassical orbit elements, 102\u2013104, 107, 146\nClock calibration, 269\u2013271\nCoherent, 255, 320\nComet atmosphere, 83\u201390\nComputed covariance, 228, 229\nComputed measurement, 218, 219, 258\u2013260,\n\n264, 265, 297, 323, 324\nComputed statistics, 296\nConfidence limits, 199\u2013201\nConic, 7, 92, 109, 116\u2013119, 126\u2013133, 146,\n\n150, 153, 154, 177, 178, 299, 300\nConsider covariance, 227\u2013229\nContinuous, 39, 41, 66, 133, 200, 201,\n\n230\u2013240, 251, 320, 321, 328, 333, 352\nContravariant tensor, 299\n\n\u00a9 Springer International Publishing AG, part of Springer Nature 2019\nJ. Miller, Planetary Spacecraft Navigation, Space Technology Library 37,\nhttps://doi.org/10.1007/978-3-319-78916-3\n\n385\n\nhttps://doi.org/10.1007/978-3-319-78916-3\n\n\n386 Index\n\nConvergence, 7, 170, 172, 174, 179, 241,\n247\u2013250, 287, 289, 296, 297, 331, 343\n\nCorona, 274, 277\nCorrelation time, 231, 331, 343\u2013345, 347, 349\nCount time, 241, 257, 260\u2013262, 267, 268, 334\nCovariance matrix, 190, 191, 195, 196, 227,\n\n228, 233, 251\nCovariant tensor, 299\nCurve fitting, 352\u2013355\n\nD\nDalton, 21\nData\n\narc, 229, 230, 273, 296, 316, 322, 323, 328,\n332, 333, 345, 349\n\nequation, 24, 225\u2013227\nnoise, 226, 260\u2013261, 328\npartial, 6, 229, 232\nresidual, 213, 219, 297, 321\u2013323, 334\nsignature, 242\u2013245, 297, 324\nupdate, 222, 223, 226, 232\u2013234, 236\u2013240\n\nDeep Space Network (DSN), 49, 241, 252,\n255, 261\u2013264, 268, 273, 274, 291, 294,\n295, 301, 315, 320, 333, 334, 358, 362\n\nDeep Space Station (DSS), 248, 255, 294\nDifferential narrow band VLBI, 267\u2013268\nDifferential wide band VLBI, 267\nDiffuse radiation, 55, 56\nDirect orbit determination, 240\u2013251\nDiscrete data update, 223, 237\u2013240\nDiscrete process noise, 225\u2013227\nDoppler, 41, 66, 180, 217, 240\u2013242, 244, 248,\n\n255\u2013258, 261, 263, 265, 267, 273, 276,\n279\u2013281, 291, 294, 296, 309, 320, 321,\n330, 331, 334, 343\u2013345, 347, 349, 355,\n358\u2013361, 364, 365\n\nDrag, 1, 53, 91, 95, 319\u2013321, 323\u2013328, 376\nDrag coefficient, 54, 91, 325\nDynamic parameters, 6, 14, 15, 75, 239, 240\n\nE\nEarth platform, 273\nEarth return, 139\u2013140, 171, 349\nEccentricity, 29, 45, 98, 114, 133, 134, 147,\n\n242, 245, 249, 310, 373\nEgorov, E.A., 131, 133, 142\nEigenvalues, 11, 191, 252\nEinstein, Albert, 23, 24, 41\nEllipse, 95, 96, 98, 99, 104, 107, 114, 148, 153,\n\n164, 191\u2013194, 218, 270, 300, 305, 373\nEnergy, 2, 4, 8, 18, 20, 22, 23, 29, 30, 45\u201347,\n\n51, 53\u201356, 58, 84, 87, 95\u201397, 114, 116,\n\n117, 121, 122, 125\u2013129, 133, 136,\n140\u2013142, 144, 146, 150, 151, 154, 171,\n184, 208, 241, 270, 276, 299, 324, 341,\n374\n\nEphemeris, 1, 119, 130, 227, 251, 258, 262,\n296, 298, 309, 312, 314, 318, 331, 332,\n334, 345, 356, 357, 362, 365, 366, 371\n\nEquations of motion, 1\u201349, 91, 92, 95, 96, 111,\n122, 133, 196, 208, 219, 247, 257, 259,\n269, 270, 325, 327, 366, 369, 370, 372,\n374, 380, 383\n\nEros, 63, 143, 198, 251, 285, 297, 329\nEros gravity harmonic coefficients, 339\nEros Orbit Insertion (EOI), 329\nEros orbit segments, 330\nEros physical parameters, 330, 331, 336\nError ellipse, 192\u2013194, 300\nEuclidean, 27\nEuler, 45, 49, 76, 110, 372\n\nangles, 12\u201314, 246\nExplicit functions, 14, 158\u2013166, 172\u2013174, 176,\n\n180, 183, 244\nExponentially decaying stochastic vectors, 345\nExtragalactic, 256, 265, 294\nExtragalactic Radio Source (EGRS), 256,\n\n265\u2013267, 294\n\nF\nFehlberg, 46\nFlight path, 38, 138, 143, 174, 217, 295\n\nangle, 109, 110, 120, 127, 154, 184,\n309\u2013312, 318, 319\n\nForced libration, 366, 367, 370\u2013374\nFour-body, 131\u2013142, 154\nFourier expansion, 345, 352\nFourier transform, 194, 195\nFree precession, 341, 343\nFrequency standard, 256, 257, 263\nFundamental theorem of calculus, 41\u201343, 58\n\nG\nGalilean, 282, 283, 299, 308\nGalileo, 122, 201, 214, 229, 230, 278, 279,\n\n308\u2013319, 375\nGas law, 18\u201320, 52\nGauss, Carl Friedrich, 251\nGeneral dynamics, 109\nGeneral relativity, 1, 2, 22\u201341, 46, 47, 92, 256,\n\n258, 263, 269\nGenesis, 132, 139\u2013140, 142, 154\nGlobal positioning system (GPS), 293, 333\nGoldstone, 248, 255, 266, 274, 294\n\n\n\nIndex 387\n\nGradient projection, 160\u2013164, 166, 167,\n174\u2013176, 180\n\nGravitational variational equations, 75\u201376\nGravity\n\nassist, 122, 124, 126\u2013128, 136, 151, 154,\n171\n\nfocusing, 309\u2013310, 315\n\nH\nHalf range expansion, 352, 353\nHamilton, T.W., 240\nHarmonic coefficients, 64\u201366, 68\u201370, 73, 75,\n\n78, 79, 81, 82, 287, 301, 331\u2013334,\n337\u2013339, 366, 368, 369\n\nHarmonic model, 334\nHeiskanen, W.A., 58\nHesse, Ludwig Otto, 168\nHessian, 168, 183, 381\nHigh speed data, 256, 266, 294\nHill, George William, 141\nHimeros, 90\nHiten, 132\u2013134, 154\nHohmann transfer, 117\u2013121, 128, 155, 184,\n\n300\nHohmann, Walter, 117, 121\nHubble, 241, 357, 366\nHyperbola, 95, 96, 99, 104, 106\u2013108, 110, 121,\n\n126, 129, 138, 148, 153, 165, 310, 311\n\nI\nInequality constraints, 158, 164, 169\u2013171\nInertia tensor, 10\u201312, 14, 16, 17, 48, 68, 79,\n\n81, 83, 331, 341, 366\u2013369\nInformation matrix, 65, 190, 224, 230, 232,\n\n234, 238\nInjection, 108\u2013110, 118\u2013121, 135, 171, 180,\n\n304, 305\nInjection flight plane, 108\u2013110, 120, 121\nIonosphere calibration, 272\u2013273\nIsotropic, 27\u201330, 38\u201340, 343\n\nJ\nJacobi, Carl Gustav, 122\nJacobi constant, 125, 128, 142\nJacobi integral, 122\u2013125, 128, 132, 133,\n\n140\u2013142\nJansky,\nJet Propulsion Laboratory (JPL), 207, 214,\n\n227, 255\nJupiter, 122, 128\u2013130, 252, 273, 299, 308\u2013311,\n\n313\u2013315, 317, 318, 375, 376\n\nJupiter Orbit Insertion (JOI), 308, 317\u2013318\n\nK\nKalman filter, 218\u2013223, 251, 252\nKalman, R.E., 218\nKennedy, 110\nKinetic theory, 1, 18\u201322, 46, 207, 349, 350\nK matrix, 184, 219, 220, 299\u2013301\nKuiper belt, 365\nKusch, P., 211\u2013213\n\nL\nLagrange, Joseph Lewis, 111, 122, 133, 135,\n\n139, 141, 161\nLagrange multipliers, 161\u2013167, 171, 308\nLagrange points, 122, 133, 135, 141\nLambert, Johann Heinrich, 110\nLambert\u2019s problem, 110\u2013116\nLandmark tracking, 279, 298, 329\nLaplacian, 87\nLASER, 66, 68, 76, 285, 329, 330, 338\nLass, Harry, 194\nLegendre, Adrien-Marie, 56, 58, 60, 67, 69,\n\n77, 90, 287, 332\nLegendre polynomials, 56, 58, 60, 67, 77, 90,\n\n332\nLight deflection, 39\u201341\nLight time equations, 264, 280\nLine-of-nodes, 146, 152, 242, 243, 300\nLine-of-sight, 241, 242, 247, 256, 260, 262,\n\n334, 346, 358, 359\nLorentz, 269, 281, 283\nLunar A, 132, 136\n\nM\nMadrid, 255, 266, 274, 294\nMajor axis, 192\nManagement of angular momentum, 136\nManeuver, 6, 134, 143, 145\u2013149, 151, 152,\n\n154, 169, 171, 172, 174, 176\u2013178, 180,\n182\u2013184, 213, 241, 293\u2013295, 305\u2013308,\n317, 318, 320, 329, 332, 345, 356, 362,\n364, 376\n\nManeuver targeting, 298\u2013301, 308\nMantle, 83, 84, 87\nMariner, 207, 273, 278, 279, 366\nMars gravity field, 370\nMars Orbit Insertion (MOI), 45\nMass element, 8, 56, 57, 59\u201361, 67, 69, 73, 74,\n\n86, 371\nMaxwell, 274\n\n\n\n388 Index\n\nMeasurement system, 256, 257, 279\nMelbourne, W.G., 240\nMercury, 22, 29\u201330, 46, 171\u2013174, 176, 177,\n\n180, 181, 343\nMESSENGER, 171, 176, 180, 182, 183, 207,\n\n300, 343\u2013355, 375\nMidcourse maneuver, 305, 306\nMiller, R.C., 211\u2013213\nMinor axis, 164\nMission operations, 47, 121, 143, 144, 298,\n\n303\nMolecular weight, 18, 21, 48, 53\nMoment, 9, 11, 14, 15, 17, 47, 48, 189, 194,\n\n207, 331, 367, 369\u2013372\nMoment of inertia, 9, 16, 189, 331\nMomentum, 2\u20135, 19, 21, 45, 46, 52, 54\u201356, 95,\n\n145, 208, 268, 270, 349\nMonte Carlo, 195\u2013201, 207, 214, 252\nMoon, 47, 68, 131\u2013140, 142, 153, 154, 274,\n\n285, 304, 305\nMoritz, H., 58\nMultiple data types, 296\u2013297\nMultiple planetary encounter, 176\nMultispectral imager (MSI), 332, 333, 337,\n\n338\nMuses A, 132\n\nN\nn-body, 1, 4\u20135\nn-dimensional normal PDF, 190\u2013191\nNear Earth Asteroid Rendezvous (NEAR), 46,\n\n56, 143, 329\u2013343\nNear LASER Rangefinder (NLR), 329\nNew Horizons, 355\u2013366, 375\nNewton, 2, 4, 7, 8, 18, 21\u201323, 27, 43, 46, 56,\n\n58, 103, 112, 160, 167, 208, 244, 349,\n350\n\nNewton-Raphson, 147, 240, 247\u2013248, 251\nNLR data, 329, 332, 334, 337, 338\nNongravitational accelerations, 309, 322, 323,\n\n331, 343, 345, 346, 375\nNumerical integration, 6, 7, 32, 38, 39, 41\u201346,\n\n79, 95, 96, 130, 167, 171, 179, 192,\n231, 239\u2013240, 341, 370, 374\n\nO\nOccultation, 213, 249, 300, 322\nOne-way Doppler, 261\u2013262\nOptical, 67, 76, 218, 278, 279, 285, 297, 314,\n\n318, 329\u2013334, 336, 338, 355\u2013358,\n360\u2013366\n\ndata, 214, 278\u2013285, 291, 297, 307, 329,\n333, 336, 360\u2013362\n\ndata residuals, 334\nimaging of landmarks, 333\n\nOptimization, 6, 157\u2013184, 307, 308\nOptimizer, 157, 172\nOrbit Correction Maneuver (OCM), 148, 356\nOrbit insertion, 45, 148, 169, 184, 241,\n\n306\u2013308, 329, 375\nOutgassing, 78, 84\u201386, 89, 309, 331, 343,\n\n345\u2013349, 351, 375\n\nP\nParticle, 4, 18, 23\u201326, 46, 52, 207, 208, 269\nPascal\u2019s triangle, 188, 201, 202, 204, 382\nPatched conic, 118, 129, 130, 299\nPerformance criterion, 158, 160, 164, 180, 307\nPerformance index, 144, 158, 161, 168, 172,\n\n179, 180\nPerihelion, 29\u201330\nPhobos gravity field, 366, 368\u2013369\nPhobos inertial properties, 367\u2013368\nPhobos inertia tensor, 368\nPhobos mass properties, 367\nPhobos rotational dynamics, 369\u2013370\nPhoton, 26, 28, 30\u201334, 36, 38\u201340, 46, 49,\n\n54\u201356, 280, 281, 283, 380\nPicture sequence file, 279, 297, 333\nPioneer venus orbiter (PVO), 319\nPixel, 218, 278, 279, 297, 298, 334, 335,\n\n356\u2013358\nPlane-of-sky (POS), 143, 242, 243, 245\u2013247,\n\n249\nPlanetary quarantine, 198, 304\u2013306, 375\nPlanetocentric, 5, 81, 367, 368\nPlate model, 77\nPluto, 355\u2013366\nPolar motion, 257, 273, 291, 341\u2013343\nPolyhedral model, 62\u201363, 72\u201374\nPost-Newtonian time (PNT), 269\nPotassium and thallium experiments, 211\nPrecession, 29, 30, 46, 48, 150\u2013152, 333,\n\n341\u2013343\nPrinciple moments of inertia, 331\nProbability, 187\u2013215, 300, 303\u2013306, 311, 382\nProbability analysis, 304\nProbability Distribution Function (PDF),\n\n187\u2013189, 194, 195, 203, 214, 219\nProbe entry, 308, 310\u2013313, 315, 318\u2013319\nProcess noise, 225\u2013227, 231\u2013234, 236\u2013240,\n\n331\nProcess noise duality, 237\u2013239\n\n\n\nIndex 389\n\nPropulsive maneuvers, 143\u2013145, 174, 176\u2013179,\n183, 251, 256, 294, 296, 298, 301, 319,\n331, 333\n\nPsyche, 90\nPyramid model, 59\u201370, 72\u201375\n\nQ\nQuadratic convergence, 174\n\nR\nRange, 31, 53, 90, 92, 128, 130, 133, 169, 180,\n\n198, 206, 207, 241, 245, 248, 250, 255,\n261\u2013265, 277, 279, 285, 288, 289, 291,\n293, 294, 296, 297, 304, 313, 318, 327,\n330, 331, 343\u2013345, 349, 352, 356\u2013360,\n362, 364\n\ndata, 263\u2013265, 276, 296, 297, 313, 334,\n343, 345\u2013347, 358, 362\u2013364\n\nRayleigh, 194\nRayleigh PDF, 193\u2013194\nReconstruction, 318\u2013319, 326, 365\u2013366\nRelay link, 315\u2013317\nRelay Radio Antenna (RRA), 315, 316\nRiccati, 234\nRiemann, 4, 23, 41\nRigid body, 7, 8, 12\nRocket equation, 51\u201353, 91\nRotational equations of motion, 7\u201314, 369,\n\n372, 374\nRotational variation equations, 14\u201318\nRotation matrix, 11\nRunge Kutta, 38, 43\u201346, 239\nRussel, R.K., 310, 314\n\nS\nSaturn, 128\u2013132, 271, 273\nS-band, 255, 260, 264\nSchwarzschild, 23, 24, 27\u201330, 38\u201341, 269\nSecond order gradient, 158, 167\u2013169\nShape model, 62, 66\u201368, 73, 76\u201383, 291, 329,\n\n330, 332, 334, 337\u2013339, 341\nShur, 222\nShur\u2019s identity, 222\nSignature, 240, 242\u2013245, 247, 250, 256, 297,\n\n314, 323, 324, 334, 340, 341, 345\nSimulated data, 249, 250, 297\u2013298, 324, 361,\n\n366\nSmoothing, 227, 229, 230, 252\nSolar gravity gradient, 329, 341\nSolar panel, 143, 145, 146, 149\nSolar plasma, 31, 263, 277\u2013278, 291, 296, 333\n\nSolar pressure, 6, 54\u201356, 91, 145, 146, 148,\n180, 251, 296, 301, 309, 331, 345, 346,\n349, 362\n\nSolid state imaging (SSI), 278\nSpace Flight Operations Facility (SFOF), 255,\n\n294, 296\nSpecial relativity, 22, 23, 26, 55, 276, 280, 281,\n\n283\nSpecific impulse, 52, 53\nSpecular radiation, 56\nSphere-of-influence, 130\nSquare root information filter (SRIF), 64, 66,\n\n67, 223\u2013230, 235\u2013240, 251, 296, 331,\n361\n\nState transition matrix, 7, 116, 230\u2013232, 251,\n300\n\nStatistics, 187\u2013214, 296\nStirling, 204\u2013207\nStochastic parameters, 226\u2013231, 251, 252,\n\n296, 297, 331\nSubsolar overfly, 149\u2013150\nSun elevation angle (SEA), 307\nSurveyor, 285\n\nT\nTargeting, 111, 116, 118, 130, 144\u2013148, 150,\n\n153, 178, 179, 298\u2013301, 308\nTaylor, B.G., 31, 43, 371\nTchebyshev polynomials, 345\nTemperature, 20\u201322, 48, 51, 53, 84, 87\u201390,\n\n208, 211, 343, 346, 351\nThermodynamic, 87\u201390\nThomas, B., 271\nThree-body, 122\u2013132, 140, 154\nThree-way Doppler, 262\u2013263\nTime-of-flight, 314, 357\u2013362, 364\nTisserand, Francois Felix, 122, 124, 125, 128\nTitan, 304\nTopographic map, 337, 339\nTrace, 68, 83, 341\nTrajectory\n\nbending, 35, 313\u2013314\ndesign, 6, 22, 95\u2013155, 174, 176, 180, 196,\n\n307\nleg, 128, 176\u2013179\nsegment, 128, 132, 134, 176, 179\n\nTrajectory correction maneuver (TCM), 293,\n298, 305, 308, 315, 317, 356\n\nTranslational variational equations, 6\u20137, 75,\n300\n\nTriangular plate, 74\nTriangular shape, 77\nTroposphere calibration, 271\u2013272\n\n\n\n390 Index\n\nTwo-body, 99, 102, 109, 111, 117, 119, 122,\n126, 128, 130\u2013132, 150, 153, 154, 178,\n242, 244\n\nTwo-way, 255, 263, 273, 318, 320\nTwo-way Doppler, 256, 263, 273, 356\n\nV\nVariational partial derivatives, 6, 7, 75, 227,\n\n289\u2013291\nVelocity parallax, 256, 280\nVenus atmosphere, 319, 324\u2013326\nVenus gravity, 321, 323\nVernal equinox, 109\nVery Long Baseline Interferometry (VLBI),\n\n227, 255, 256, 265\u2013269, 273, 279, 291,\n294, 313, 314, 318\n\nViking, 22, 45, 154, 158, 169, 192, 201, 207,\n214, 241, 273, 278, 279, 285, 298,\n304\u2013308, 343, 366, 367, 375\n\nvis viva, 97\u2013100, 125\nVoyager, 122, 273, 278, 279\n\nW\nWachman, H.Y., 211, 213\nWang, J.F.C., 211, 213\nWeak stability boundary, 139\nWeighted least squares, 221\u2013223, 251\nWerner, R.A., 63, 72, 73\n\nX\nX-band, 244, 255, 261, 264, 276, 331, 344\n\n\n\tPreface\n\tContents\n\t1 Equations of Motion\n\t1.1 Introduction\n\t1.2 Particle Dynamics\n\t1.3 n-Body Equations of Motion\n\t1.4 Translational Variational Equations\n\t1.5 Rotational Equations of Motion\n\t1.6 Rotational Variational Equations\n\t1.7 Kinetic Theory of Gases\n\t1.8 General Relativity Equations of Motion\n\t1.8.1 Einstein Field Equation\n\t1.8.2 Geodesic Equation\n\t1.8.3 Isotropic Schwarzschild Coordinates\n\t1.8.4 Mercury Perihelion Shift\n\t1.8.5 Radar Delay\n\t1.8.6 Light Deflection\n\n\t1.9 Numerical Integration\n\t1.9.1 Fundamental Theorem of Calculus\n\t1.9.2 Runge-Kutta Numerical Integration\n\n\t1.10 Summary\n\tExercises\n\tBibliography\n\n\t2 Force Models\n\t2.1 Rocket Equation\n\t2.2 Aerodynamic Forces\n\t2.3 Solar Pressure\n\t2.4 Gravity Models\n\t2.4.1 Harmonic Expansion Model\n\t2.4.2 Point Mass Model\n\t2.4.3 Pyramid Model\n\t2.4.4 Polyhedral Model\n\t2.4.5 Mass Distribution of an Irregularly Shaped Body\n\t2.4.6 Pyramid Gravity Model Comparison with Eros Harmonic Model\n\t2.4.7 Comparison of Gravity Model Mass Distributions\n\t2.4.8 Comparison of Density Distributions for Eros-Shaped Gravity Models\n\t2.4.9 Comparison of Gravity Model Accelerations\n\t2.4.10 Comparison of Gravity Model Accuracy and Computational Speed\n\t2.4.11 Gravitational Variational Equations\n\n\t2.5 Shape Model\n\t2.5.1 Triangular Plate Model\n\t2.5.2 Harmonic Expansion Shape Model\n\t2.5.3 Gravity Harmonic Expansion from Shape Model\n\n\t2.6 Comet Atmosphere\n\t2.6.1 Outgassing Model\n\t2.6.2 Jet Model\n\t2.6.3 Thermodynamic Model\n\n\t2.7 Summary\n\tExercises\n\tBibliography\n\n\t3 Trajectory Design\n\t3.1 Restricted Two-Body Trajectories\n\t3.1.1 Elliptical Orbit\n\t3.1.2 Hyperbolic Orbit\n\t3.1.3 Injection Flight Plane Hyperbolic Trajectory\n\t3.1.4 Lambert's Problem\n\n\t3.2 Interplanetary Transfer\n\t3.2.1 Hohmann Transfer\n\n\t3.3 Three-Body Trajectory\n\t3.3.1 Jacobi Integral\n\t3.3.2 Tisserand's Criterion\n\t3.3.3 Gravity Assist Vector Diagram\n\t3.3.4 Cassini Trajectory Design\n\n\t3.4 Four-Body Trajectory\n\t3.4.1 Moon Capture of Projectile Launched from Earth\n\t3.4.2 Angular Momentum and Energy Management\n\t3.4.3 Genesis Earth Return Trajectory\n\t3.4.4 Jacobi Integral and Capture\n\n\t3.5 NEAR Orbit Phase Trajectory Design\n\t3.5.1 Spacecraft and Mission Constraints\n\t3.5.2 Targeting Strategy\n\t3.5.3 Targeting Algorithm\n\t3.5.4 NEAR Trajectory Design\n\t3.5.5 Approach Through 100km Orbit\n\t3.5.6 Subsolar Overfly Through 50km Orbit\n\t3.5.7 Transfer to Southern Illuminated 35km Orbit\n\t3.5.8 Active POS Control, Polar Orbits, and Plane Flip\n\t3.5.9 Northern Illuminated 50km and 35km Orbits\n\n\t3.6 Summary\n\tExercises\n\tBibliography\n\n\t4 Trajectory Optimization\n\t4.1 Parameter Optimization\n\t4.2 Statement of Problem\n\t4.3 Condition for Optimum Solution\n\t4.3.1 Lagrange Multipliers\n\t4.3.2 Explicit Functions\n\t4.3.3 Gradient Projection\n\n\t4.4 Sample Problem\n\t4.4.1 Solution by Method of Lagrange Multipliers\n\t4.4.2 Solution by Method of Explicit Functions\n\t4.4.3 Solution by Method of Gradient Projection\n\n\t4.5 Second-Order Gradient Search\n\t4.6 Inequality Constraints\n\t4.7 Mission to Mercury\n\t4.8 Multiple Encounter Optimization\n\t4.8.1 Multiple Encounter Strategy\n\t4.8.2 Trajectory Segment Optimization\n\t4.8.3 Multiple Encounter Example\n\n\t4.9 Summary\n\tExercises\n\tBibliography\n\n\t5 Probability and Statistics\n\t5.1 Normal Probability Distribution Function (PDF)\n\t5.2 n-Dimensional Normal PDF\n\t5.3 Bivariate Normal PDF\n\t5.4 Rayleigh PDF\n\t5.5 Central Limit Theorem\n\t5.6 Monte Carlo Methods\n\t5.7 Binomial Theorem\n\t5.7.1 Confidence Limits\n\t5.7.2 Normal PDF from Binomial Coefficients\n\t5.7.3 Approximate Binomial Coefficients from Normal PDF\n\t5.7.4 Stirling Approximation\n\n\t5.8 Maxwell\u2013Boltzmann Probability Distribution\n\t5.8.1 Experimental Results\n\n\t5.9 Summary\n\tExercises\n\tBibliography\n\n\t6 Orbit Determination\n\t6.1 Kalman Filter Algorithm\n\t6.2 Weighted Least Squares\n\t6.3 Square Root Information Filter (SRIF)\n\t6.3.1 Discrete Process Noise Update\n\t6.3.2 Solution Epoch\n\t6.3.3 Computed and Consider Covariance\n\t6.3.4 Smoothing\n\n\t6.4 Continuous Filter Equations\n\t6.4.1 Process Noise Term\n\t6.4.2 Data Update Term\n\t6.4.3 Continuous Filter Differential Equations\n\n\t6.5 Continuous SRIF with Discrete Data Update\n\t6.5.1 Process Noise Duality\n\t6.5.2 Numerical Integration of SRIF Matrix\n\n\t6.6 Direct Orbit Determination\n\t6.6.1 Model of Doppler Data Signature\n\t6.6.2 Parameterization of Doppler Signature\n\t6.6.3 Solution by Newton-Raphson\n\t6.6.4 Magellan Example\n\n\t6.7 Summary\n\tExercises\n\tBibliography\n\n\t7 Measurements and Calibrations\n\t7.1 Radiometric Tracking Data\n\t7.1.1 Doppler Data\n\t7.1.2 Doppler Measurement Model\n\t7.1.3 Data Noise\n\t7.1.4 One-Way Doppler Data\n\t7.1.5 Three-Way Doppler Data\n\t7.1.6 Range Data\n\t7.1.7 Very Long Baseline Interferometry\n\t7.1.8 Differential Wide Band VLBI\n\t7.1.9 Differential Narrow Band VLBI\n\n\t7.2 Radiometric Data Calibrations\n\t7.2.1 Clock Calibration\n\t7.2.2 Troposphere Calibration\n\t7.2.3 Ionosphere Calibration\n\t7.2.4 Earth Platform\n\t7.2.5 Polar Motion\n\t7.2.6 Continental Drift\n\t7.2.7 Solid Earth Tide\n\t7.2.8 Plane Wave Propagation Through Ionized Gas\n\t7.2.9 Solar Plasma Time Delay\n\n\t7.3 Optical Data\n\t7.3.1 Optical Data Processing\n\t7.3.2 Planetary and Stellar Aberration\n\n\t7.4 Altimetry\n\t7.4.1 Altimetry Data Measurement Model\n\t7.4.2 Altimetry Variational Partial Derivatives\n\n\t7.5 Summary\n\tBibliography\n\n\t8 Navigation Operations\n\t8.1 Navigation System\n\t8.1.1 Deep Space Network\n\t8.1.2 Spacecraft\n\n\t8.2 Orbit Determination\n\t8.2.1 Orbit Determination Strategy\n\t8.2.2 Multiple Data Types\n\t8.2.3 Simulated Data\n\n\t8.3 Maneuver Targeting\n\t8.3.1 Interplanetary Maneuvers\n\t8.3.2 In Orbit Maneuvers\n\t8.3.3 K Matrix\n\n\t8.4 Summary\n\n\t9 Navigation Analysis\n\t9.1 Viking\n\t9.1.1 Planetary Quarantine\n\t9.1.2 Orbit Insertion Maneuver Design\n\n\t9.2 Galileo\n\t9.2.1 Probe Delivery to Jupiter\n\t9.2.2 Gravity Focusing\n\t9.2.3 Probe Entry Dispersions\n\t9.2.4 Probe Entry Flight Path Angle\n\t9.2.5 Probe Entry Angle-of-Attack\n\t9.2.6 Trajectory Bending\n\t9.2.7 Jupiter Approach Orbit Determination\n\t9.2.8 Relay Link\n\t9.2.9 Jupiter Orbit Insertion\n\t9.2.10 Probe Entry Trajectory Reconstruction\n\n\t9.3 Pioneer\n\t9.3.1 Orbit Determination Strategy\n\t9.3.2 Orbit Determination Results from 1980\n\t9.3.3 Estimation of Drag\n\t9.3.4 Relating Drag V to Period Change\n\t9.3.5 Covariance Analysis Results\n\n\t9.4 Near Earth Asteroid Rendezvous\n\t9.4.1 Orbit Determination Strategy\n\t9.4.2 Eros A Priori Physical Model\n\t9.4.3 Orbit Determination Solution\n\t9.4.4 Eros Results\n\t9.4.5 Shape Model\n\t9.4.6 Gravity Harmonics\n\t9.4.7 Polar Motion\n\n\t9.5 MESSENGER\n\t9.5.1 Initial Post-Launch Orbit Determination\n\t9.5.2 Estimated Accelerations from Assumed Water Vapor\n\t9.5.3 Curve Fitting with Exponential Functions\n\n\t9.6 New Horizons\n\t9.6.1 Pluto and Charon Approach\n\t9.6.2 Pluto Approach Time-of-Flight Determination\n\t9.6.3 Pluto and Charon Approach Covariance Analysis\n\t9.6.4 Spacecraft Orbit Reconstruction\n\n\t9.7 Phobos\n\t9.7.1 Phobos Inertial Properties\n\t9.7.2 Phobos Gravity Field\n\t9.7.3 Phobos Rotational Dynamics\n\t9.7.4 Analytic Approximation of Forced Libration\n\n\t9.8 Summary\n\tExercises\n\tBibliography\n\n\tAnswers to Selected Exercises\n\tAnswers to Selected Exercises\n\tChapter 1\n\tChapter 2\n\tChapter 3\n\tChapter 4\n\tChapter 5\n\tChapter 6\n\tChapter 9\n\n\tIndex\n\n"}